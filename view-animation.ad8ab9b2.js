parcelRequire=function(e,r,n,t){function i(n,t){function o(e){return i(o.resolve(e))}function c(r){return e[n][1][r]||r}if(!r[n]){if(!e[n]){var l="function"==typeof parcelRequire&&parcelRequire;if(!t&&l)return l(n,!0);if(u)return u(n,!0);if(f&&"string"==typeof n)return f(n);var p=new Error("Cannot find module '"+n+"'");throw p.code="MODULE_NOT_FOUND",p}o.resolve=c;var a=r[n]=new i.Module(n);e[n][0].call(a.exports,o,a,a.exports,this)}return r[n].exports}function o(e){this.id=e,this.bundle=i,this.exports={}}var u="function"==typeof parcelRequire&&parcelRequire,f="function"==typeof require&&require;i.isParcelRequire=!0,i.Module=o,i.modules=e,i.cache=r,i.parent=u;for(var c=0;c<n.length;c++)i(n[c]);if(n.length){var l=i(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):t&&(this[t]=l)}return i}({36:[function(require,module,exports) {

},{}],136:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getContext=w;const e=exports.ONE=1,t=exports.SRC_ALPHA=770,E=exports.COLOR_ATTACHMENT0=36064,o=exports.COLOR_BUFFER_BIT=16384,r=exports.TRIANGLES=4,T=exports.TRIANGLE_STRIP=5,s=exports.ONE_MINUS_SRC_ALPHA=771,x=exports.ARRAY_BUFFER=34962,p=exports.ELEMENT_ARRAY_BUFFER=34963,R=exports.STREAM_DRAW=35040,_=exports.STATIC_DRAW=35044,A=exports.DYNAMIC_DRAW=35048,S=exports.CULL_FACE=2884,N=exports.BLEND=3042,I=exports.STENCIL_TEST=2960,L=exports.DEPTH_TEST=2929,U=exports.SCISSOR_TEST=3089,C=exports.UNSIGNED_BYTE=5121,F=exports.UNSIGNED_SHORT=5123,n=exports.UNSIGNED_INT=5125,D=exports.FLOAT=5126,M=exports.RGBA=6408,O=exports.FRAGMENT_SHADER=35632,l=exports.VERTEX_SHADER=35633,G=exports.LINK_STATUS=35714,P=exports.LINEAR=9729,c=exports.TEXTURE_MAG_FILTER=10240,B=exports.TEXTURE_MIN_FILTER=10241,u=exports.TEXTURE_WRAP_S=10242,H=exports.TEXTURE_WRAP_T=10243,X=exports.TEXTURE_2D=3553,g=exports.TEXTURE0=33984,i=exports.CLAMP_TO_EDGE=33071,b=exports.COMPILE_STATUS=35713,W=exports.FRAMEBUFFER=36160,f=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function w(e,t){const E=f.length;for(let o=0;o<E;++o)try{const E=e.getContext(f[o],t);if(E)return E}catch(e){}return null}
},{}],94:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=exports.WEBGL_EXTENSIONS=exports.WEBGL_MAX_TEXTURE_SIZE=exports.HAS_WEBGL=exports.DEBUG_WEBGL=void 0,exports.inherits=p,exports.getUid=_;var e=require("./webgl.js");const t=exports.DEBUG_WEBGL=!0;let o,r,E=!1;if("undefined"!=typeof window&&"WebGLRenderingContext"in window)try{const t=document.createElement("CANVAS"),s=(0,e.getContext)(t,{failIfMajorPerformanceCaveat:!0});s&&(exports.HAS_WEBGL=E=!0,exports.WEBGL_MAX_TEXTURE_SIZE=o=s.getParameter(s.MAX_TEXTURE_SIZE),exports.WEBGL_EXTENSIONS=r=s.getSupportedExtensions())}catch(e){}exports.HAS_WEBGL=E,exports.WEBGL_MAX_TEXTURE_SIZE=o,exports.WEBGL_EXTENSIONS=r;const s=exports.VERSION="v4.6.4";function p(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}let n=0;function _(e){return e.ol_uid||(e.ol_uid=++n)}
},{"./webgl.js":136}],137:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js");const s=function(s){const r=e.VERSION?e.VERSION.split("-")[0]:"latest";this.message="Assertion failed. See https://openlayers.org/en/"+r+"/doc/errors/#"+s+" for details.",this.code=s,this.name="AssertionError"};(0,e.inherits)(s,Error),exports.default=s;
},{"./index.js":94}],187:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ADD:"add",REMOVE:"remove"};
},{}],188:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PROPERTYCHANGE:"propertychange"};
},{}],96:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=n,exports.getValues=e,exports.isEmpty=o;const t=exports.assign="function"==typeof Object.assign?Object.assign:function(t,n){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");const e=Object(t);for(let t=1,n=arguments.length;t<n;++t){const n=arguments[t];if(void 0!==n&&null!==n)for(const t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}return e};function n(t){for(const n in t)delete t[n]}function e(t){const n=[];for(const e in t)n.push(t[e]);return n}function o(t){let n;for(n in t)return!1;return!n}
},{}],153:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindListener=t,exports.findListener=n,exports.getListeners=r,exports.listen=i,exports.listenOnce=s,exports.unlisten=c,exports.unlistenByKey=u,exports.unlistenAll=d;var e=require("./obj.js");function t(e){const t=function(t){const n=e.listener,r=e.bindTo||e.target;return e.callOnce&&u(e),n.call(r,t)};return e.boundListener=t,t}function n(e,t,n,r){let o;for(let l=0,i=e.length;l<i;++l)if((o=e[l]).listener===t&&o.bindTo===n)return r&&(o.deleteIndex=l),o}function r(e,t){const n=e.ol_lm;return n?n[t]:void 0}function o(e){let t=e.ol_lm;return t||(t=e.ol_lm={}),t}function l(t,n){const o=r(t,n);if(o){for(let r=0,l=o.length;r<l;++r)t.removeEventListener(n,o[r].boundListener),(0,e.clear)(o[r]);o.length=0;const r=t.ol_lm;r&&(delete r[n],0===Object.keys(r).length&&delete t.ol_lm)}}function i(e,r,l,i,s){const c=o(e);let u=c[r];u||(u=c[r]=[]);let d=n(u,l,i,!1);return d?s||(d.callOnce=!1):(d={bindTo:i,callOnce:!!s,listener:l,target:e,type:r},e.addEventListener(r,t(d)),u.push(d)),d}function s(e,t,n,r){return i(e,t,n,r,!0)}function c(e,t,o,l){const i=r(e,t);if(i){const e=n(i,o,l,!0);e&&u(e)}}function u(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);const n=r(t.target,t.type);if(n){const e="deleteIndex"in t?t.deleteIndex:n.indexOf(t);-1!==e&&n.splice(e,1),0===n.length&&l(t.target,t.type)}(0,e.clear)(t)}}function d(e){const t=o(e);for(const n in t)l(e,n)}
},{"./obj.js":96}],144:[function(require,module,exports) {
"use strict";function e(){return!0}function t(){return!1}function r(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TRUE=e,exports.FALSE=t,exports.UNDEFINED=r;
},{}],245:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./functions.js");const s=function(){};s.prototype.disposed_=!1,s.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},s.prototype.disposeInternal=e.UNDEFINED,exports.default=s;
},{"./functions.js":144}],183:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stopPropagation=o,exports.preventDefault=e;const t=function(t){this.propagationStopped,this.type=t,this.target=null};function o(t){t.stopPropagation()}function e(t){t.preventDefault()}t.prototype.preventDefault=t.prototype.stopPropagation=function(){this.propagationStopped=!0},exports.default=t;
},{}],205:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Disposable.js"),i=l(t),s=require("../events.js"),n=require("../functions.js"),r=require("../events/Event.js"),o=l(r);function l(e){return e&&e.__esModule?e:{default:e}}const h=function(){i.default.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}};(0,e.inherits)(h,i.default),h.prototype.addEventListener=function(e,t){let i=this.listeners_[e];i||(i=this.listeners_[e]=[]),-1===i.indexOf(t)&&i.push(t)},h.prototype.dispatchEvent=function(e){const t="string"==typeof e?new o.default(e):e,i=t.type;t.target=this;const s=this.listeners_[i];let r;if(s){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(let e=0,i=s.length;e<i;++e)if(!1===s[e].call(this,t)||t.propagationStopped){r=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){let e=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];e--;)this.removeEventListener(i,n.UNDEFINED);delete this.dispatching_[i]}return r}},h.prototype.disposeInternal=function(){(0,s.unlistenAll)(this)},h.prototype.getListeners=function(e){return this.listeners_[e]},h.prototype.hasListener=function(e){return e?e in this.listeners_:Object.keys(this.listeners_).length>0},h.prototype.removeEventListener=function(e,t){const i=this.listeners_[e];if(i){const s=i.indexOf(t);e in this.pendingRemovals_?(i[s]=n.UNDEFINED,++this.pendingRemovals_[e]):(i.splice(s,1),0===i.length&&delete this.listeners_[e])}},exports.default=h;
},{"../index.js":94,"../Disposable.js":245,"../events.js":153,"../functions.js":144,"../events/Event.js":183}],155:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};
},{}],226:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unByKey=l;var e=require("./index.js"),t=require("./events.js"),n=require("./events/EventTarget.js"),r=o(n),i=require("./events/EventType.js"),s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}const u=function(){r.default.call(this),this.revision_=0};function l(e){if(Array.isArray(e))for(let n=0,r=e.length;n<r;++n)(0,t.unlistenByKey)(e[n]);else(0,t.unlistenByKey)(e)}(0,e.inherits)(u,r.default),u.prototype.changed=function(){++this.revision_,this.dispatchEvent(s.default.CHANGE)},u.prototype.dispatchEvent,u.prototype.getRevision=function(){return this.revision_},u.prototype.on=function(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=(0,t.listen)(this,e[s],n);return i}return(0,t.listen)(this,e,n)},u.prototype.once=function(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=(0,t.listenOnce)(this,e[s],n);return i}return(0,t.listenOnce)(this,e,n)},u.prototype.un=function(e,n){if(Array.isArray(e))for(let r=0,i=e.length;r<i;++r)(0,t.unlisten)(this,e[r],n);else(0,t.unlisten)(this,e,n)},exports.default=u;
},{"./index.js":94,"./events.js":153,"./events/EventTarget.js":205,"./events/EventType.js":155}],145:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getChangeEventType=c;var t=require("./index.js"),e=require("./ObjectEventType.js"),s=l(e),i=require("./Observable.js"),n=l(i),o=require("./events/Event.js"),r=l(o),u=require("./obj.js");function l(t){return t&&t.__esModule?t:{default:t}}const a=function(t,e,s){r.default.call(this,t),this.key=e,this.oldValue=s};(0,t.inherits)(a,r.default);const h=function(e){n.default.call(this),(0,t.getUid)(this),this.values_={},void 0!==e&&this.setProperties(e)};(0,t.inherits)(h,n.default);const p={};function c(t){return p.hasOwnProperty(t)?p[t]:p[t]="change:"+t}h.prototype.get=function(t){let e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},h.prototype.getKeys=function(){return Object.keys(this.values_)},h.prototype.getProperties=function(){return(0,u.assign)({},this.values_)},h.prototype.notify=function(t,e){let i;i=c(t),this.dispatchEvent(new a(i,t,e)),i=s.default.PROPERTYCHANGE,this.dispatchEvent(new a(i,t,e))},h.prototype.set=function(t,e,s){if(s)this.values_[t]=e;else{const s=this.values_[t];this.values_[t]=e,s!==e&&this.notify(t,s)}},h.prototype.setProperties=function(t,e){for(const s in t)this.set(s,t[s],e)},h.prototype.unset=function(t,e){if(t in this.values_){const s=this.values_[t];delete this.values_[t],e||this.notify(t,s)}},exports.default=h;
},{"./index.js":94,"./ObjectEventType.js":188,"./Observable.js":226,"./events/Event.js":183,"./obj.js":96}],109:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectionEvent=void 0;var t=require("./index.js"),e=require("./AssertionError.js"),r=a(e),i=require("./CollectionEventType.js"),n=a(i),s=require("./Object.js"),o=a(s),h=require("./events/Event.js"),u=a(h);function a(t){return t&&t.__esModule?t:{default:t}}const p={LENGTH:"length"},c=exports.CollectionEvent=function(t,e){u.default.call(this,t),this.element=e};(0,t.inherits)(c,u.default);const l=function(t,e){o.default.call(this);const r=e||{};if(this.unique_=!!r.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()};(0,t.inherits)(l,o.default),l.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},l.prototype.extend=function(t){let e,r;for(e=0,r=t.length;e<r;++e)this.push(t[e]);return this},l.prototype.forEach=function(t){const e=this.array_;for(let r=0,i=e.length;r<i;++r)t(e[r],r,e)},l.prototype.getArray=function(){return this.array_},l.prototype.item=function(t){return this.array_[t]},l.prototype.getLength=function(){return this.get(p.LENGTH)},l.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new c(n.default.ADD,e))},l.prototype.pop=function(){return this.removeAt(this.getLength()-1)},l.prototype.push=function(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()},l.prototype.remove=function(t){const e=this.array_;let r,i;for(r=0,i=e.length;r<i;++r)if(e[r]===t)return this.removeAt(r)},l.prototype.removeAt=function(t){const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new c(n.default.REMOVE,e)),e},l.prototype.setAt=function(t,e){const r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new c(n.default.REMOVE,r)),this.dispatchEvent(new c(n.default.ADD,e))}else{let i;for(i=r;i<t;++i)this.insertAt(i,void 0);this.insertAt(t,e)}},l.prototype.updateLength_=function(){this.set(p.LENGTH,this.array_.length)},l.prototype.assertUnique_=function(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new r.default(58)},exports.default=l;
},{"./index.js":94,"./AssertionError.js":137,"./CollectionEventType.js":187,"./Object.js":145,"./events/Event.js":183}],258:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./events/Event.js"),r=s(t);function s(e){return e&&e.__esModule?e:{default:e}}const u=function(e,t,s){r.default.call(this,e),this.map=t,this.frameState=void 0!==s?s:null};(0,e.inherits)(u,r.default),exports.default=u;
},{"./index.js":94,"./events/Event.js":183}],231:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./MapEvent.js"),i=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const n=function(t,e,o,n,r){i.default.call(this,t,e,r),this.originalEvent=o,this.pixel=e.getEventPixel(o),this.coordinate=e.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==n&&n};(0,t.inherits)(n,i.default),n.prototype.preventDefault=function(){i.default.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},n.prototype.stopPropagation=function(){i.default.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},exports.default=n;
},{"./index.js":94,"./MapEvent.js":258}],225:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WEBGL=exports.MSPOINTER=exports.POINTER=exports.TOUCH=exports.GEOLOCATION=exports.CANVAS_LINE_DASH=exports.DEVICE_PIXEL_RATIO=exports.MAC=exports.WEBKIT=exports.SAFARI=exports.FIREFOX=void 0;var e=require("./index.js");const t="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",o=exports.FIREFOX=-1!==t.indexOf("firefox"),r=exports.SAFARI=-1!==t.indexOf("safari")&&-1==t.indexOf("chrom"),n=exports.WEBKIT=-1!==t.indexOf("webkit")&&-1==t.indexOf("edge"),s=exports.MAC=-1!==t.indexOf("macintosh"),i=exports.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,x=exports.CANVAS_LINE_DASH=function(){let e=!1;try{e=!!document.createElement("CANVAS").getContext("2d").setLineDash}catch(e){}return e}(),p=exports.GEOLOCATION="geolocation"in navigator,E=exports.TOUCH="ontouchstart"in window,O=exports.POINTER="PointerEvent"in window,a=exports.MSPOINTER=!!navigator.msPointerEnabled,d=exports.WEBGL=e.HAS_WEBGL;
},{"./index.js":94}],160:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./events/EventType.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}exports.default={SINGLECLICK:"singleclick",CLICK:t.default.CLICK,DBLCLICK:t.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};
},{"./events/EventType.js":155}],207:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./MapBrowserEvent.js"),r=i(t);function i(e){return e&&e.__esModule?e:{default:e}}const n=function(e,t,i,n,s){r.default.call(this,e,t,i.originalEvent,n,s),this.pointerEvent=i};(0,e.inherits)(n,r.default),exports.default=n;
},{"./index.js":94,"./MapBrowserEvent.js":231}],318:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};
},{}],311:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t,e){this.dispatcher=t,this.mapping_=e};t.prototype.getEvents=function(){return Object.keys(this.mapping_)},t.prototype.getHandlerForEvent=function(t){return this.mapping_[t]},exports.default=t;
},{}],296:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.POINTER_TYPE=exports.POINTER_ID=void 0;var t=require("../index.js"),e=require("../pointer/EventSource.js"),o=s(e);function s(t){return t&&t.__esModule?t:{default:t}}const i=function(t){const e={mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout};o.default.call(this,t,e),this.pointerMap=t.pointerMap,this.lastTouches=[]};(0,t.inherits)(i,o.default);const n=exports.POINTER_ID=1,u=exports.POINTER_TYPE="mouse",r=25;function c(t,e){const o=e.cloneEvent(t,t),s=o.preventDefault;return o.preventDefault=function(){t.preventDefault(),s()},o.pointerId=n,o.isPrimary=!0,o.pointerType=u,o}i.prototype.isEventSimulatedFromTouch_=function(t){const e=this.lastTouches,o=t.clientX,s=t.clientY;for(let t,i=0,n=e.length;i<n&&(t=e[i]);i++){const e=Math.abs(o-t[0]),i=Math.abs(s-t[1]);if(e<=25&&i<=25)return!0}return!1},i.prototype.mousedown=function(t){if(!this.isEventSimulatedFromTouch_(t)){n.toString()in this.pointerMap&&this.cancel(t);const e=c(t,this.dispatcher);this.pointerMap[n.toString()]=t,this.dispatcher.down(e,t)}},i.prototype.mousemove=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.move(e,t)}},i.prototype.mouseup=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=this.pointerMap[n.toString()];if(e&&e.button===t.button){const e=c(t,this.dispatcher);this.dispatcher.up(e,t),this.cleanupMouse()}}},i.prototype.mouseover=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.enterOver(e,t)}},i.prototype.mouseout=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}},i.prototype.cancel=function(t){const e=c(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},i.prototype.cleanupMouse=function(){delete this.pointerMap[n.toString()]},exports.default=i;
},{"../index.js":94,"../pointer/EventSource.js":311}],327:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../pointer/EventSource.js"),n=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t){const e={MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture};n.default.call(this,t,e),this.pointerMap=t.pointerMap};(0,t.inherits)(r,n.default);const i=["","unavailable","touch","pen","mouse"];r.prototype.prepareEvent_=function(t){let e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=i[t.pointerType]),e},r.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},r.prototype.msPointerDown=function(t){this.pointerMap[t.pointerId.toString()]=t;const e=this.prepareEvent_(t);this.dispatcher.down(e,t)},r.prototype.msPointerMove=function(t){const e=this.prepareEvent_(t);this.dispatcher.move(e,t)},r.prototype.msPointerUp=function(t){const e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)},r.prototype.msPointerOut=function(t){const e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)},r.prototype.msPointerOver=function(t){const e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)},r.prototype.msPointerCancel=function(t){const e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)},r.prototype.msLostPointerCapture=function(t){const e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)},r.prototype.msGotPointerCapture=function(t){const e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)},exports.default=r;
},{"../index.js":94,"../pointer/EventSource.js":311}],328:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../pointer/EventSource.js"),i=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t){const e={pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture};i.default.call(this,t,e)};(0,t.inherits)(r,i.default),r.prototype.pointerDown=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerMove=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerUp=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerOut=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerOver=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerCancel=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.lostPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.gotPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},exports.default=r;
},{"../index.js":94,"../pointer/EventSource.js":311}],329:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../events/Event.js"),i=n(e);function n(t){return t&&t.__esModule?t:{default:t}}const s=function(t,e,n){i.default.call(this,t),this.originalEvent=e;const s=n||{};this.buttons=this.getButtons_(s),this.pressure=this.getPressure_(s,this.buttons),this.bubbles="bubbles"in s&&s.bubbles,this.cancelable="cancelable"in s&&s.cancelable,this.view="view"in s?s.view:null,this.detail="detail"in s?s.detail:null,this.screenX="screenX"in s?s.screenX:0,this.screenY="screenY"in s?s.screenY:0,this.clientX="clientX"in s?s.clientX:0,this.clientY="clientY"in s?s.clientY:0,this.ctrlKey="ctrlKey"in s&&s.ctrlKey,this.altKey="altKey"in s&&s.altKey,this.shiftKey="shiftKey"in s&&s.shiftKey,this.metaKey="metaKey"in s&&s.metaKey,this.button="button"in s?s.button:0,this.relatedTarget="relatedTarget"in s?s.relatedTarget:null,this.pointerId="pointerId"in s?s.pointerId:0,this.width="width"in s?s.width:0,this.height="height"in s?s.height:0,this.tiltX="tiltX"in s?s.tiltX:0,this.tiltY="tiltY"in s?s.tiltY:0,this.pointerType="pointerType"in s?s.pointerType:"",this.hwTimestamp="hwTimestamp"in s?s.hwTimestamp:0,this.isPrimary="isPrimary"in s&&s.isPrimary,e.preventDefault&&(this.preventDefault=function(){e.preventDefault()})};(0,t.inherits)(s,i.default);let r=!1;s.prototype.getButtons_=function(t){let e;if(t.buttons||r)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},s.prototype.getPressure_=function(t,e){let i=0;return i=t.pressure?t.pressure:e?.5:0},function(){try{const t=new MouseEvent("click",{buttons:1});r=1===t.buttons}catch(t){}}(),exports.default=s;
},{"../index.js":94,"../events/Event.js":183}],171:[function(require,module,exports) {
"use strict";function e(e,n,t){let o,u;const i=t||r;let f=0,s=e.length,l=!1;for(;f<s;)(u=+i(e[o=f+(s-f>>1)],n))<0?f=o+1:(s=o,l=!u);return l?f:~f}function r(e,r){return e>r?1:e<r?-1:0}function n(e,r){return e.indexOf(r)>=0}function t(e,r,n){const t=e.length;if(e[0]<=r)return 0;if(r<=e[t-1])return t-1;{let o;if(n>0){for(o=1;o<t;++o)if(e[o]<r)return o-1}else if(n<0){for(o=1;o<t;++o)if(e[o]<=r)return o}else for(o=1;o<t;++o){if(e[o]==r)return o;if(e[o]<r)return e[o-1]-r<r-e[o]?o-1:o}return t-1}}function o(e,r,n){for(;r<n;){const t=e[r];e[r]=e[n],e[n]=t,++r,--n}}function u(e,r){const n=Array.isArray(r)?r:[r],t=n.length;for(let r=0;r<t;r++)e[e.length]=n[r]}function i(e,r){const n=e.indexOf(r),t=n>-1;return t&&e.splice(n,1),t}function f(e,r){const n=e.length>>>0;let t;for(let o=0;o<n;o++)if(r(t=e[o],o,e))return t;return null}function s(e,r){const n=e.length;if(n!==r.length)return!1;for(let t=0;t<n;t++)if(e[t]!==r[t])return!1;return!0}function l(e,r){const n=e.length,t=Array(e.length);let o;for(o=0;o<n;o++)t[o]={index:o,value:e[o]};for(t.sort(function(e,n){return r(e.value,n.value)||e.index-n.index}),o=0;o<e.length;o++)e[o]=t[o].value}function c(e,r){let n;return!e.every(function(t,o){return n=o,!r(t,o,e)})?n:-1}function x(e,n,t){const o=n||r;return e.every(function(r,n){if(0===n)return!0;const u=o(e[n-1],r);return!(u>0||t&&0===u)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.binarySearch=e,exports.numberSafeCompareFunction=r,exports.includes=n,exports.linearFindNearest=t,exports.reverseSubArray=o,exports.extend=u,exports.remove=i,exports.find=f,exports.equals=s,exports.stableSort=l,exports.findIndex=c,exports.isSorted=x;
},{}],330:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),o=require("../pointer/EventSource.js"),i=s(o),r=require("../pointer/MouseSource.js");function s(t){return t&&t.__esModule?t:{default:t}}const n=function(t,e){const o={touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel};i.default.call(this,t,o),this.pointerMap=t.pointerMap,this.mouseSource=e,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500};(0,t.inherits)(n,i.default);const c=200,u="touch";n.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},n.prototype.setPrimaryTouch_=function(t){const e=Object.keys(this.pointerMap).length;(0===e||1===e&&r.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},n.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},n.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},n.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},n.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},n.prototype.touchToPointer_=function(t,e){const o=this.dispatcher.cloneEvent(t,e);return o.pointerId=e.identifier+2,o.bubbles=!0,o.cancelable=!0,o.detail=this.clickCount_,o.button=0,o.buttons=1,o.width=e.webkitRadiusX||e.radiusX||0,o.height=e.webkitRadiusY||e.radiusY||0,o.pressure=e.webkitForce||e.force||.5,o.isPrimary=this.isPrimaryTouch_(e),o.pointerType="touch",o.clientX=e.clientX,o.clientY=e.clientY,o.screenX=e.screenX,o.screenY=e.screenY,o},n.prototype.processTouches_=function(t,e){const o=Array.prototype.slice.call(t.changedTouches),i=o.length;function r(){t.preventDefault()}let s,n;for(s=0;s<i;++s)(n=this.touchToPointer_(t,o[s])).preventDefault=r,e.call(this,t,n)},n.prototype.findTouch_=function(t,e){const o=t.length;let i;for(let r=0;r<o;r++)if((i=t[r]).identifier===e)return!0;return!1},n.prototype.vacuumTouches_=function(t){const e=t.touches,o=Object.keys(this.pointerMap),i=o.length;if(i>=e.length){const s=[];let n,c,u;for(n=0;n<i;++n)c=o[n],u=this.pointerMap[c],c==r.POINTER_ID||this.findTouch_(e,c-2)||s.push(u.out);for(n=0;n<s.length;++n)this.cancelOut_(t,s[n])}},n.prototype.touchstart=function(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)},n.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},n.prototype.touchmove=function(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)},n.prototype.moveOverOut_=function(t,e){const o=e,i=this.pointerMap[o.pointerId];if(!i)return;const r=i.out,s=i.outTarget;this.dispatcher.move(o,t),r&&s!==o.target&&(r.relatedTarget=o.target,o.relatedTarget=s,r.target=s,o.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(o,t)):(o.target=s,o.relatedTarget=null,this.cancelOut_(t,o))),i.out=o,i.outTarget=o.target},n.prototype.touchend=function(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)},n.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},n.prototype.touchcancel=function(t){this.processTouches_(t,this.cancelOut_)},n.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},n.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},n.prototype.dedupSynthMouse_=function(t){const o=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){const t=[i.clientX,i.clientY];o.push(t),setTimeout(function(){(0,e.remove)(o,t)},this.dedupTimeout_)}},exports.default=n;
},{"../index.js":94,"../array.js":171,"../pointer/EventSource.js":311,"../pointer/MouseSource.js":296}],319:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../events.js"),n=require("../events/EventTarget.js"),i=y(n),r=require("../has.js"),o=require("../pointer/EventType.js"),s=y(o),u=require("../pointer/MouseSource.js"),c=y(u),p=require("../pointer/MsSource.js"),l=y(p),a=require("../pointer/NativeSource.js"),h=y(a),f=require("../pointer/PointerEvent.js"),v=y(f),E=require("../pointer/TouchSource.js"),d=y(E);function y(t){return t&&t.__esModule?t:{default:t}}const _=function(t){i.default.call(this),this.element_=t,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()};(0,t.inherits)(_,i.default);const g=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];_.prototype.registerSources=function(){if(r.POINTER)this.registerSource("native",new h.default(this));else if(r.MSPOINTER)this.registerSource("ms",new l.default(this));else{const t=new c.default(this);this.registerSource("mouse",t),r.TOUCH&&this.registerSource("touch",new d.default(this,t))}this.register_()},_.prototype.registerSource=function(t,e){const n=e,i=n.getEvents();i&&(i.forEach(function(t){const e=n.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(n))}.bind(this)),this.eventSourceList_.push(n))},_.prototype.register_=function(){const t=this.eventSourceList_.length;let e;for(let n=0;n<t;n++)e=this.eventSourceList_[n],this.addEvents_(e.getEvents())},_.prototype.unregister_=function(){const t=this.eventSourceList_.length;let e;for(let n=0;n<t;n++)e=this.eventSourceList_[n],this.removeEvents_(e.getEvents())},_.prototype.eventHandler_=function(t){const e=t.type,n=this.eventMap_[e];n&&n(t)},_.prototype.addEvents_=function(t){t.forEach(function(t){(0,e.listen)(this.element_,t,this.eventHandler_,this)}.bind(this))},_.prototype.removeEvents_=function(t){t.forEach(function(t){(0,e.unlisten)(this.element_,t,this.eventHandler_,this)}.bind(this))},_.prototype.cloneEvent=function(t,e){const n={};for(let i=0,r=g.length;i<r;i++){const r=g[i][0];n[r]=t[r]||e[r]||g[i][1]}return n},_.prototype.down=function(t,e){this.fireEvent(s.default.POINTERDOWN,t,e)},_.prototype.move=function(t,e){this.fireEvent(s.default.POINTERMOVE,t,e)},_.prototype.up=function(t,e){this.fireEvent(s.default.POINTERUP,t,e)},_.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(s.default.POINTERENTER,t,e)},_.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(s.default.POINTERLEAVE,t,e)},_.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(s.default.POINTEROVER,t,e)},_.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(s.default.POINTEROUT,t,e)},_.prototype.cancel=function(t,e){this.fireEvent(s.default.POINTERCANCEL,t,e)},_.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},_.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},_.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},_.prototype.makeEvent=function(t,e,n){return new v.default(t,n,e)},_.prototype.fireEvent=function(t,e,n){const i=this.makeEvent(t,e,n);this.dispatchEvent(i)},_.prototype.fireNativeEvent=function(t){const e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},_.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,c.default.prepareEvent(e,this),e)},_.prototype.disposeInternal=function(){this.unregister_(),i.default.prototype.disposeInternal.call(this)},exports.default=_;
},{"../index.js":94,"../events.js":153,"../events/EventTarget.js":205,"../has.js":225,"../pointer/EventType.js":318,"../pointer/MouseSource.js":296,"../pointer/MsSource.js":327,"../pointer/NativeSource.js":328,"../pointer/PointerEvent.js":329,"../pointer/TouchSource.js":330}],300:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./has.js"),i=require("./MapBrowserEventType.js"),n=c(i),s=require("./MapBrowserPointerEvent.js"),o=c(s),r=require("./events.js"),d=require("./events/EventTarget.js"),h=c(d),a=require("./pointer/EventType.js"),l=c(a),u=require("./pointer/PointerEventHandler.js"),_=c(u);function c(t){return t&&t.__esModule?t:{default:t}}const p=function(t,i){h.default.call(this),this.map_=t,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*e.DEVICE_PIXEL_RATIO:e.DEVICE_PIXEL_RATIO,this.down_=null;const n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new _.default(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=(0,r.listen)(this.pointerEventHandler_,l.default.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=(0,r.listen)(this.pointerEventHandler_,l.default.POINTERMOVE,this.relayEvent_,this)};(0,t.inherits)(p,h.default),p.prototype.emulateClick_=function(t){let e=new o.default(n.default.CLICK,this.map_,t);this.dispatchEvent(e),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,e=new o.default(n.default.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;const e=new o.default(n.default.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},p.prototype.updateActivePointers_=function(t){const e=t;e.type==n.default.POINTERUP||e.type==n.default.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==n.default.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},p.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);const e=new o.default(n.default.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(r.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},p.prototype.isMouseActionButton_=function(t){return 0===t.button},p.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);const e=new o.default(n.default.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new _.default(document),this.dragListenerKeys_.push((0,r.listen)(this.documentPointerEventHandler_,n.default.POINTERMOVE,this.handlePointerMove_,this),(0,r.listen)(this.documentPointerEventHandler_,n.default.POINTERUP,this.handlePointerUp_,this),(0,r.listen)(this.pointerEventHandler_,n.default.POINTERCANCEL,this.handlePointerUp_,this)))},p.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;const e=new o.default(n.default.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},p.prototype.relayEvent_=function(t){const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new o.default(t.type,this.map_,t,e))},p.prototype.isMoving_=function(t){return Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},p.prototype.disposeInternal=function(){this.relayedListenerKey_&&((0,r.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&((0,r.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(r.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),h.default.prototype.disposeInternal.call(this)},exports.default=p;
},{"./index.js":94,"./has.js":225,"./MapBrowserEventType.js":160,"./MapBrowserPointerEvent.js":207,"./events.js":153,"./events/EventTarget.js":205,"./pointer/EventType.js":318,"./pointer/PointerEventHandler.js":319}],201:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};
},{}],301:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};
},{}],147:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};
},{}],111:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=s;var e=require("./AssertionError.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new r.default(t)}
},{"./AssertionError.js":137}],265:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DROP=void 0;var t=require("../asserts.js"),e=require("../obj.js");const i=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}},n=exports.DROP=1/0;i.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,(0,e.clear)(this.queuedElements_)},i.prototype.dequeue=function(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i},i.prototype.enqueue=function(e){(0,t.assert)(!(this.keyFunction_(e)in this.queuedElements_),31);const i=this.priorityFunction_(e);return i!=n&&(this.elements_.push(e),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},i.prototype.getCount=function(){return this.elements_.length},i.prototype.getLeftChildIndex_=function(t){return 2*t+1},i.prototype.getRightChildIndex_=function(t){return 2*t+2},i.prototype.getParentIndex_=function(t){return t-1>>1},i.prototype.heapify_=function(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},i.prototype.isEmpty=function(){return 0===this.elements_.length},i.prototype.isKeyQueued=function(t){return t in this.queuedElements_},i.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},i.prototype.siftUp_=function(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],o=i[t],r=t;for(;t<n>>1;){const s=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),r=o<n&&i[o]<i[s]?o:s;e[t]=e[r],i[t]=i[r],t=r}e[t]=s,i[t]=o,this.siftDown_(r,t)},i.prototype.siftDown_=function(t,e){const i=this.elements_,n=this.priorities_,s=i[e],o=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>o))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=s,n[e]=o},i.prototype.reprioritize=function(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let s=0;const o=e.length;let r,h,u;for(h=0;h<o;++h)(u=t(r=e[h]))==n?delete this.queuedElements_[this.keyFunction_(r)]:(i[s]=u,e[s++]=r);e.length=s,i.length=s,this.heapify_()},exports.default=i;
},{"../asserts.js":111,"../obj.js":96}],228:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./TileState.js"),i=o(t),n=require("./events.js"),s=require("./events/EventType.js"),l=o(s),a=require("./structs/PriorityQueue.js"),u=o(a);function o(e){return e&&e.__esModule?e:{default:e}}const r=function(e,t){u.default.call(this,function(t){return e.apply(null,t)},function(e){return e[0].getKey()}),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}};(0,e.inherits)(r,u.default),r.prototype.enqueue=function(e){const t=u.default.prototype.enqueue.call(this,e);if(t){const t=e[0];(0,n.listen)(t,l.default.CHANGE,this.handleTileChange,this)}return t},r.prototype.getTilesLoading=function(){return this.tilesLoading_},r.prototype.handleTileChange=function(e){const t=e.target,s=t.getState();if(s===i.default.LOADED||s===i.default.ERROR||s===i.default.EMPTY||s===i.default.ABORT){(0,n.unlisten)(t,l.default.CHANGE,this.handleTileChange,this);const e=t.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_()}},r.prototype.loadMoreTiles=function(e,t){let n,s,l,a=0,u=!1;for(;this.tilesLoading_<e&&a<t&&this.getCount()>0;)l=(s=this.dequeue()[0]).getKey(),(n=s.getState())===i.default.ABORT?u=!0:n!==i.default.IDLE||l in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++a,s.load());0===a&&u&&this.tileChangeCallback_()},exports.default=r;
},{"./index.js":94,"./TileState.js":147,"./events.js":153,"./events/EventType.js":155,"./structs/PriorityQueue.js":265}],175:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.DEFAULT_MAX_ZOOM=42,t=exports.DEFAULT_TILE_SIZE=256;
},{}],157:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cosh=void 0,exports.clamp=e,exports.roundUpToPowerOfTwo=o,exports.squaredSegmentDistance=n,exports.squaredDistance=s,exports.solveLinearSystem=c,exports.toDegrees=u,exports.toRadians=a,exports.modulo=i,exports.lerp=f;var t=require("./asserts.js");function e(t,e,r){return Math.min(Math.max(t,e),r)}const r=exports.cosh=function(){let t;return t="cosh"in Math?Math.cosh:function(t){const e=Math.exp(t);return(e+1/e)/2}}();function o(e){return(0,t.assert)(0<e,29),Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function n(t,e,r,o,n,c){const u=n-r,a=c-o;if(0!==u||0!==a){const s=((t-r)*u+(e-o)*a)/(u*u+a*a);s>1?(r=n,o=c):s>0&&(r+=u*s,o+=a*s)}return s(t,e,r,o)}function s(t,e,r,o){const n=r-t,s=o-e;return n*n+s*s}function c(t){const e=t.length;for(let r=0;r<e;r++){let o=r,n=Math.abs(t[r][r]);for(let s=r+1;s<e;s++){const e=Math.abs(t[s][r]);e>n&&(n=e,o=s)}if(0===n)return null;const s=t[o];t[o]=t[r],t[r]=s;for(let o=r+1;o<e;o++){const n=-t[o][r]/t[r][r];for(let s=r;s<e+1;s++)r==s?t[o][s]=0:t[o][s]+=n*t[r][s]}}const r=new Array(e);for(let o=e-1;o>=0;o--){r[o]=t[o][e]/t[o][o];for(let n=o-1;n>=0;n--)t[n][e]-=t[n][o]*r[o]}return r}function u(t){return 180*t/Math.PI}function a(t){return t*Math.PI/180}function i(t,e){const r=t%e;return r*e<0?r+e:r}function f(t,e,r){return t+r*(e-t)}
},{"./asserts.js":111}],286:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExtent=t,exports.none=r;var e=require("./math.js");function t(t){return function(r){return r?[(0,e.clamp)(r[0],t[0],t[2]),(0,e.clamp)(r[1],t[1],t[3])]:void 0}}function r(e){return e}
},{"./math.js":157}],287:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSnapToResolutions=r,exports.createSnapToPower=o;var t=require("./array.js"),e=require("./math.js");function r(r){return function(o,n,a){if(void 0!==o){let i=(0,t.linearFindNearest)(r,o,a);i=(0,e.clamp)(i+n,0,r.length-1);const u=Math.floor(i);if(i!=u&&u<r.length-1){const t=r[u]/r[u+1];return r[u]/Math.pow(t,i-u)}return r[u]}}}function o(t,e,r){return function(o,n,a){if(void 0!==o){const i=-a/2+.5,u=Math.floor(Math.log(e/o)/Math.log(t)+i);let s=Math.max(u+n,0);return void 0!==r&&(s=Math.min(s,r)),e/Math.pow(t,s)}}}
},{"./array.js":171,"./math.js":157}],185:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.disable=t,exports.none=e,exports.createSnapToN=r,exports.createSnapToZero=n;var o=require("./math.js");function t(o,t){return void 0!==o?0:void 0}function e(o,t){return void 0!==o?o+t:void 0}function r(o){const t=2*Math.PI/o;return function(o,e){return void 0!==o?o=Math.floor((o+e)/t+.5)*t:void 0}}function n(t){const e=t||(0,o.toRadians)(5);return function(o,t){return void 0!==o?Math.abs(o+t)<=e?0:o+t:void 0}}
},{"./math.js":157}],186:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ANIMATING:0,INTERACTING:1};
},{}],288:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};
},{}],221:[function(require,module,exports) {
"use strict";function e(e,t,r){const n=void 0!==r?e.toFixed(r):""+e;let o=n.indexOf(".");return(o=-1===o?n.length:o)>t?n:new Array(1+t-o).join("0")+n}function t(e,t){const r=(""+e).split("."),n=(""+t).split(".");for(let e=0;e<Math.max(r.length,n.length);e++){const t=parseInt(r[e]||"0",10),o=parseInt(n[e]||"0",10);if(t>o)return 1;if(o>t)return-1}return 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.padNumber=e,exports.compareVersions=t;
},{}],179:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=r,exports.closestOnCircle=n,exports.closestOnSegment=o,exports.createStringXY=s,exports.degreesToStringHDMS=u,exports.format=c,exports.equals=i,exports.rotate=a,exports.scale=f,exports.squaredDistance=p,exports.distance=l,exports.squaredDistanceToSegment=x,exports.toStringHDMS=d,exports.toStringXY=h;var t=require("./math.js"),e=require("./string.js");function r(t,e){return t[0]+=e[0],t[1]+=e[1],t}function n(t,e){const r=e.getRadius(),n=e.getCenter(),o=n[0],s=n[1];let u=t[0]-o;const c=t[1]-s;0===u&&0===c&&(u=1);const i=Math.sqrt(u*u+c*c);return[o+r*u/i,s+r*c/i]}function o(t,e){const r=t[0],n=t[1],o=e[0],s=e[1],u=o[0],c=o[1],i=s[0],a=s[1],f=i-u,p=a-c,l=0===f&&0===p?0:(f*(r-u)+p*(n-c))/(f*f+p*p||0);let x,d;return l<=0?(x=u,d=c):l>=1?(x=i,d=a):(x=u+l*f,d=c+l*p),[x,d]}function s(t){return function(e){return h(e,t)}}function u(r,n,o){const s=(0,t.modulo)(n+180,360)-180,u=Math.abs(3600*s),c=o||0,i=Math.pow(10,c);let a=Math.floor(u/3600),f=Math.floor((u-3600*a)/60),p=u-3600*a-60*f;return(p=Math.ceil(p*i)/i)>=60&&(p=0,f+=1),f>=60&&(f=0,a+=1),a+"° "+(0,e.padNumber)(f,2)+"′ "+(0,e.padNumber)(p,2,c)+"″"+(0==s?"":" "+r.charAt(s<0?1:0))}function c(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function i(t,e){let r=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function a(t,e){const r=Math.cos(e),n=Math.sin(e),o=t[0]*r-t[1]*n,s=t[1]*r+t[0]*n;return t[0]=o,t[1]=s,t}function f(t,e){return t[0]*=e,t[1]*=e,t}function p(t,e){const r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function l(t,e){return Math.sqrt(p(t,e))}function x(t,e){return p(t,o(t,e))}function d(t,e){return t?u("NS",t[1],e)+" "+u("EW",t[0],e):""}function h(t,e){return c(t,"{x}, {y}",e)}
},{"./math.js":157,"./string.js":221}],174:[function(require,module,exports) {
"use strict";function e(e){return Math.pow(e,3)}function t(t){return 1-e(1-t)}function n(e){return 3*e*e-2*e*e*e}function r(e){return e}function u(e){return e<.5?n(2*e):1-n(2*(e-.5))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.easeIn=e,exports.easeOut=t,exports.inAndOut=n,exports.linear=r,exports.upAndDown=u;
},{}],176:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};
},{}],292:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};
},{}],140:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.boundingExtent=a,exports.buffer=i,exports.clone=c,exports.closestSquaredDistanceXY=f,exports.containsCoordinate=l,exports.containsExtent=p,exports.containsXY=x,exports.coordinateRelationship=d,exports.createEmpty=h,exports.createOrUpdate=m,exports.createOrUpdateEmpty=g,exports.createOrUpdateFromCoordinate=T,exports.createOrUpdateFromCoordinates=E,exports.createOrUpdateFromFlatCoordinates=M,exports.createOrUpdateFromRings=O,exports.equals=C,exports.extend=R,exports.extendCoordinate=F,exports.extendCoordinates=I,exports.extendFlatCoordinates=N,exports.extendRings=B,exports.extendXY=L,exports.forEachCorner=y,exports.getArea=U,exports.getBottomLeft=G,exports.getBottomRight=_,exports.getCenter=A,exports.getCorner=S,exports.getEnlargedArea=H,exports.getForViewAndSize=W,exports.getHeight=q,exports.getIntersectionArea=j,exports.getIntersection=V,exports.getMargin=b,exports.getSize=P,exports.getTopLeft=X,exports.getTopRight=Y,exports.getWidth=v,exports.intersects=z,exports.isEmpty=K,exports.returnOrUpdate=w,exports.scaleFromCenter=D,exports.intersectsSegment=k,exports.applyTransform=J;var t=require("./asserts.js"),e=require("./extent/Corner.js"),n=u(e),r=require("./extent/Relationship.js"),o=u(r);function u(t){return t&&t.__esModule?t:{default:t}}function a(t){const e=h();for(let n=0,r=t.length;n<r;++n)F(e,t[n]);return e}function s(t,e,n){return m(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}function i(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function c(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function f(t,e,n){let r,o;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(o=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*o}function l(t,e){return x(t,e[0],e[1])}function p(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function x(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function d(t,e){const n=t[0],r=t[1],u=t[2],a=t[3],s=e[0],i=e[1];let c=o.default.UNKNOWN;return s<n?c|=o.default.LEFT:s>u&&(c|=o.default.RIGHT),i<r?c|=o.default.BELOW:i>a&&(c|=o.default.ABOVE),c===o.default.UNKNOWN&&(c=o.default.INTERSECTING),c}function h(){return[1/0,1/0,-1/0,-1/0]}function m(t,e,n,r,o){return o?(o[0]=t,o[1]=e,o[2]=n,o[3]=r,o):[t,e,n,r]}function g(t){return m(1/0,1/0,-1/0,-1/0,t)}function T(t,e){const n=t[0],r=t[1];return m(n,r,n,r,e)}function E(t,e){return I(g(e),t)}function M(t,e,n,r,o){return N(g(o),t,e,n,r)}function O(t,e){return B(g(e),t)}function C(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function R(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function F(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function I(t,e){for(let n=0,r=e.length;n<r;++n)F(t,e[n]);return t}function N(t,e,n,r,o){for(;n<r;n+=o)L(t,e[n],e[n+1]);return t}function B(t,e){for(let n=0,r=e.length;n<r;++n)I(t,e[n]);return t}function L(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function y(t,e,n){let r;return(r=e.call(n,G(t)))?r:(r=e.call(n,_(t)))?r:(r=e.call(n,Y(t)))?r:(r=e.call(n,X(t)))||!1}function U(t){let e=0;return K(t)||(e=v(t)*q(t)),e}function G(t){return[t[0],t[1]]}function _(t){return[t[2],t[1]]}function A(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function S(e,r){let o;return r===n.default.BOTTOM_LEFT?o=G(e):r===n.default.BOTTOM_RIGHT?o=_(e):r===n.default.TOP_LEFT?o=X(e):r===n.default.TOP_RIGHT?o=Y(e):(0,t.assert)(!1,13),o}function H(t,e){const n=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-n)*(Math.max(t[3],e[3])-r)}function W(t,e,n,r,o){const u=e*r[0]/2,a=e*r[1]/2,s=Math.cos(n),i=Math.sin(n),c=u*s,f=u*i,l=a*s,p=a*i,x=t[0],d=t[1],h=x-c+p,g=x-c-p,T=x+c-p,E=x+c+p,M=d-f-l,O=d-f+l,C=d+f+l,R=d+f-l;return m(Math.min(h,g,T,E),Math.min(M,O,C,R),Math.max(h,g,T,E),Math.max(M,O,C,R),o)}function q(t){return t[3]-t[1]}function j(t,e){return U(V(t,e))}function V(t,e,n){const r=n||h();return z(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):g(r),r}function b(t){return v(t)+q(t)}function P(t){return[t[2]-t[0],t[3]-t[1]]}function X(t){return[t[0],t[3]]}function Y(t){return[t[2],t[3]]}function v(t){return t[2]-t[0]}function z(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function K(t){return t[2]<t[0]||t[3]<t[1]}function w(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function D(t,e){const n=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r}function k(t,e,n){let r=!1;const u=d(t,e),a=d(t,n);if(u===o.default.INTERSECTING||a===o.default.INTERSECTING)r=!0;else{const s=t[0],i=t[1],c=t[2],f=t[3],l=e[0],p=e[1],x=n[0],d=n[1],h=(d-p)/(x-l);let m,g;a&o.default.ABOVE&&!(u&o.default.ABOVE)&&(r=(m=x-(d-f)/h)>=s&&m<=c),r||!(a&o.default.RIGHT)||u&o.default.RIGHT||(r=(g=d-(x-c)*h)>=i&&g<=f),r||!(a&o.default.BELOW)||u&o.default.BELOW||(r=(m=x-(d-i)/h)>=s&&m<=c),r||!(a&o.default.LEFT)||u&o.default.LEFT||(r=(g=d-(x-s)*h)>=i&&g<=f)}return r}function J(t,e,n){const r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(r,r,2),s([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],n)}
},{"./asserts.js":111,"./extent/Corner.js":176,"./extent/Relationship.js":292}],211:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};
},{}],235:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};
},{}],281:[function(require,module,exports) {
"use strict";function t(t,e,n,o,r,l){const s=l||[];let c=0;for(let l=e;l<n;l+=o){const e=t[l],n=t[l+1];s[c++]=r[0]*e+r[2]*n+r[4],s[c++]=r[1]*e+r[3]*n+r[5]}return l&&s.length!=c&&(s.length=c),s}function e(t,e,n,o,r,l,s){const c=s||[],f=Math.cos(r),u=Math.sin(r),h=l[0],a=l[1];let g=0;for(let r=e;r<n;r+=o){const e=t[r]-h,n=t[r+1]-a;c[g++]=h+e*f-n*u,c[g++]=a+e*u+n*f;for(let e=r+2;e<r+o;++e)c[g++]=t[e]}return s&&c.length!=g&&(c.length=g),c}function n(t,e,n,o,r,l,s,c){const f=c||[],u=s[0],h=s[1];let a=0;for(let s=e;s<n;s+=o){const e=t[s]-u,n=t[s+1]-h;f[a++]=u+r*e,f[a++]=h+l*n;for(let e=s+2;e<s+o;++e)f[a++]=t[e]}return c&&f.length!=a&&(f.length=a),f}function o(t,e,n,o,r,l,s){const c=s||[];let f=0;for(let s=e;s<n;s+=o){c[f++]=t[s]+r,c[f++]=t[s+1]+l;for(let e=s+2;e<s+o;++e)c[f++]=t[e]}return s&&c.length!=f&&(c.length=f),c}Object.defineProperty(exports,"__esModule",{value:!0}),exports.transform2D=t,exports.rotate=e,exports.scale=n,exports.translate=o;
},{}],156:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_RADIUS=void 0,exports.getDistance=n,exports.getLength=c,exports.getArea=u,exports.offset=h;var t=require("./math.js"),e=require("./geom/GeometryType.js"),a=s(e);function s(t){return t&&t.__esModule?t:{default:t}}const o=exports.DEFAULT_RADIUS=6371008.8;function n(e,a,s){const n=s||o,r=(0,t.toRadians)(e[1]),c=(0,t.toRadians)(a[1]),i=(c-r)/2,u=(0,t.toRadians)(a[0]-e[0])/2,h=Math.sin(i)*Math.sin(i)+Math.sin(u)*Math.sin(u)*Math.cos(r)*Math.cos(c);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function r(t,e){let a=0;for(let s=0,o=t.length;s<o-1;++s)a+=n(t[s],t[s+1],e);return a}function c(t,e){const s=e||{},n=s.radius||o,i=s.projection||"EPSG:3857",u=t.getType();u!==a.default.GEOMETRY_COLLECTION&&(t=t.clone().transform(i,"EPSG:4326"));let h,f,l,d,M,g,I=0;switch(u){case a.default.POINT:case a.default.MULTI_POINT:break;case a.default.LINE_STRING:case a.default.LINEAR_RING:I=r(h=t.getCoordinates(),n);break;case a.default.MULTI_LINE_STRING:case a.default.POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)I+=r(h[l],n);break;case a.default.MULTI_POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)for(M=0,g=(f=h[l]).length;M<g;++M)I+=r(f[M],n);break;case a.default.GEOMETRY_COLLECTION:{const a=t.getGeometries();for(l=0,d=a.length;l<d;++l)I+=c(a[l],e);break}default:throw new Error("Unsupported geometry type: "+u)}return I}function i(e,a){let s=0;const o=e.length;let n=e[o-1][0],r=e[o-1][1];for(let a=0;a<o;a++){const o=e[a][0],c=e[a][1];s+=(0,t.toRadians)(o-n)*(2+Math.sin((0,t.toRadians)(r))+Math.sin((0,t.toRadians)(c))),n=o,r=c}return s*a*a/2}function u(t,e){const s=e||{},n=s.radius||o,r=s.projection||"EPSG:3857",c=t.getType();c!==a.default.GEOMETRY_COLLECTION&&(t=t.clone().transform(r,"EPSG:4326"));let h,f,l,d,M,g,I=0;switch(c){case a.default.POINT:case a.default.MULTI_POINT:case a.default.LINE_STRING:case a.default.MULTI_LINE_STRING:case a.default.LINEAR_RING:break;case a.default.POLYGON:for(h=t.getCoordinates(),I=Math.abs(i(h[0],n)),l=1,d=h.length;l<d;++l)I-=Math.abs(i(h[l],n));break;case a.default.MULTI_POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)for(f=h[l],I+=Math.abs(i(f[0],n)),M=1,g=f.length;M<g;++M)I-=Math.abs(i(f[M],n));break;case a.default.GEOMETRY_COLLECTION:{const a=t.getGeometries();for(l=0,d=a.length;l<d;++l)I+=u(a[l],e);break}default:throw new Error("Unsupported geometry type: "+c)}return I}function h(e,a,s,n){const r=n||o,c=(0,t.toRadians)(e[1]),i=(0,t.toRadians)(e[0]),u=a/r,h=Math.asin(Math.sin(c)*Math.cos(u)+Math.cos(c)*Math.sin(u)*Math.cos(s)),f=i+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(c),Math.cos(u)-Math.sin(c)*Math.sin(h));return[(0,t.toDegrees)(f),(0,t.toDegrees)(h)]}
},{"./math.js":157,"./geom/GeometryType.js":211}],133:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const E={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},e=exports.METERS_PER_UNIT={};e[E.DEGREES]=2*Math.PI*6370997/360,e[E.FEET]=.3048,e[E.METERS]=1,e[E.USFEET]=1200/3937,exports.default=E;
},{}],53:[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../proj/Units.js");const n=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};n.prototype.canWrapX=function(){return this.canWrapX_},n.prototype.getCode=function(){return this.code_},n.prototype.getExtent=function(){return this.extent_},n.prototype.getUnits=function(){return this.units_},n.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||e.METERS_PER_UNIT[this.units_]},n.prototype.getWorldExtent=function(){return this.worldExtent_},n.prototype.getAxisOrientation=function(){return this.axisOrientation_},n.prototype.isGlobal=function(){return this.global_},n.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},n.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},n.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},n.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},n.prototype.setWorldExtent=function(t){this.worldExtent_=t},n.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},n.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},exports.default=n;
},{"../proj/Units.js":133}],161:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROJECTIONS=exports.WORLD_EXTENT=exports.EXTENT=exports.HALF_SIZE=exports.RADIUS=void 0,exports.fromEPSG4326=x,exports.toEPSG4326=P;var e=require("../index.js"),t=require("../math.js"),r=require("../proj/Projection.js"),o=i(r),n=require("../proj/Units.js"),s=i(n);function i(e){return e&&e.__esModule?e:{default:e}}const l=exports.RADIUS=6378137,u=exports.HALF_SIZE=Math.PI*l,E=exports.EXTENT=[-u,-u,u,u],c=exports.WORLD_EXTENT=[-180,-85,180,85];function a(e){o.default.call(this,{code:e,units:s.default.METERS,extent:E,global:!0,worldExtent:c,getPointResolution:function(e,r){return e/(0,t.cosh)(r[1]/l)}})}(0,e.inherits)(a,o.default);const p=exports.PROJECTIONS=[new a("EPSG:3857"),new a("EPSG:102100"),new a("EPSG:102113"),new a("EPSG:900913"),new a("urn:ogc:def:crs:EPSG:6.18:3:3857"),new a("urn:ogc:def:crs:EPSG::3857"),new a("http://www.opengis.net/gml/srs/epsg.xml#3857")];function x(e,t,r){const o=e.length,n=r>1?r:2;let s=t;void 0===s&&(s=n>2?e.slice():new Array(o));const i=u;for(let t=0;t<o;t+=n){s[t]=i*e[t]/180;let r=l*Math.log(Math.tan(Math.PI*(e[t+1]+90)/360));r>i?r=i:r<-i&&(r=-i),s[t+1]=r}return s}function P(e,t,r){const o=e.length,n=r>1?r:2;let s=t;void 0===s&&(s=n>2?e.slice():new Array(o));for(let t=0;t<o;t+=n)s[t]=180*e[t]/u,s[t+1]=360*Math.atan(Math.exp(e[t+1]/l))/Math.PI-90;return s}
},{"../index.js":94,"../math.js":157,"../proj/Projection.js":53,"../proj/Units.js":133}],162:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROJECTIONS=exports.METERS_PER_UNIT=exports.EXTENT=exports.RADIUS=void 0;var e=require("../index.js"),r=require("../proj/Projection.js"),t=o(r),n=require("../proj/Units.js"),s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}const u=exports.RADIUS=6378137,i=exports.EXTENT=[-180,-90,180,90],E=exports.METERS_PER_UNIT=Math.PI*u/180;function c(e,r){t.default.call(this,{code:e,units:s.default.DEGREES,extent:i,axisOrientation:r,global:!0,metersPerUnit:E,worldExtent:i})}(0,e.inherits)(c,t.default);const d=exports.PROJECTIONS=[new c("CRS:84"),new c("EPSG:4326","neu"),new c("urn:ogc:def:crs:EPSG::4326","neu"),new c("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new c("urn:ogc:def:crs:OGC:1.3:CRS84"),new c("urn:ogc:def:crs:OGC:2:84"),new c("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new c("urn:x-ogc:def:crs:EPSG:4326","neu")];
},{"../index.js":94,"../proj/Projection.js":53,"../proj/Units.js":133}],163:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=t,exports.get=r,exports.add=n;let e={};function t(){e={}}function r(t){return e[t]||null}function n(t,r){e[t]=r}
},{}],164:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=o,exports.add=r,exports.remove=n,exports.get=s;var e=require("../obj.js");let t={};function o(){t={}}function r(e,o,r){const n=e.getCode(),s=o.getCode();n in t||(t[n]={}),t[n][s]=r}function n(o,r){const n=o.getCode(),s=r.getCode(),i=t[n][s];return delete t[n][s],(0,e.isEmpty)(t[n])&&delete t[n],i}function s(e,o){let r;return e in t&&o in t[e]&&(r=t[e][o]),r}
},{"../obj.js":96}],43:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.METERS_PER_UNIT=void 0,exports.cloneTransform=E,exports.identityTransform=P,exports.addProjection=g,exports.addProjections=j,exports.get=x,exports.getPointResolution=m,exports.addEquivalentProjections=T,exports.addEquivalentTransforms=S,exports.clearAllProjections=v,exports.createProjection=R,exports.createTransformFromCoordinateTransform=_,exports.addCoordinateTransforms=h,exports.fromLonLat=q,exports.toLonLat=C,exports.equivalent=O,exports.getTransformFromProjections=G,exports.getTransform=U,exports.transform=y,exports.transformExtent=I,exports.transformWithProjections=M,exports.addCommon=N;var t=require("./sphere.js"),e=require("./extent.js"),r=require("./math.js"),o=require("./proj/epsg3857.js"),n=require("./proj/epsg4326.js"),i=require("./proj/Projection.js"),s=p(i),u=require("./proj/Units.js"),f=p(u),c=require("./proj/projections.js"),a=l(c),d=require("./proj/transforms.js");function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function p(t){return t&&t.__esModule?t:{default:t}}function E(t,e,r){let o;if(void 0!==e){for(let r=0,o=t.length;r<o;++r)e[r]=t[r];o=e}else o=t.slice();return o}function P(t,e,r){if(void 0!==e&&t!==e){for(let r=0,o=t.length;r<o;++r)e[r]=t[r];t=e}return t}function g(t){a.add(t.getCode(),t),(0,d.add)(t,t,E)}function j(t){t.forEach(g)}function x(t){let e=null;if(t instanceof s.default)e=t;else if("string"==typeof t){const r=t;e=a.get(r)}return e}function m(e,r,o,n){let i;const s=(e=x(e)).getPointResolutionFunc();if(s)i=s(r,o);else{if(e.getUnits()==f.default.DEGREES&&!n||n==f.default.DEGREES)i=r;else{const s=G(e,x("EPSG:4326"));let f=[o[0]-r/2,o[1],o[0]+r/2,o[1],o[0],o[1]-r/2,o[0],o[1]+r/2];f=s(f,f,2),i=((0,t.getDistance)(f.slice(0,2),f.slice(2,4))+(0,t.getDistance)(f.slice(4,6),f.slice(6,8)))/2;const c=n?u.METERS_PER_UNIT[n]:e.getMetersPerUnit();void 0!==c&&(i/=c)}}return i}function T(t){j(t),t.forEach(function(e){t.forEach(function(t){e!==t&&(0,d.add)(e,t,E)})})}function S(t,e,r,o){t.forEach(function(t){e.forEach(function(e){(0,d.add)(t,e,r),(0,d.add)(e,t,o)})})}function v(){a.clear(),(0,d.clear)()}function R(t,e){return t?"string"==typeof t?x(t):t:x(e)}function _(t){return function(e,r,o){const n=e.length,i=void 0!==o?o:2,s=void 0!==r?r:new Array(n);let u,f,c;for(f=0;f<n;f+=i)for(u=t([e[f],e[f+1]]),s[f]=u[0],s[f+1]=u[1],c=i-1;c>=2;--c)s[f+c]=e[f+c];return s}}function h(t,e,r,o){const n=x(t),i=x(e);(0,d.add)(n,i,_(r)),(0,d.add)(i,n,_(o))}function q(t,e){return y(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function C(t,e){const o=y(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=o[0];return(n<-180||n>180)&&(o[0]=(0,r.modulo)(n+180,360)-180),o}function O(t,e){if(t===e)return!0;const r=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode())return r;return G(t,e)===E&&r}function G(t,e){const r=t.getCode(),o=e.getCode();let n=(0,d.get)(r,o);return n||(n=P),n}function U(t,e){return G(x(t),x(e))}function y(t,e,r){return U(e,r)(t,void 0,t.length)}function I(t,r,o){const n=U(r,o);return(0,e.applyTransform)(t,n)}function M(t,e,r){return G(e,r)(t)}function N(){T(o.PROJECTIONS),T(n.PROJECTIONS),S(n.PROJECTIONS,o.PROJECTIONS,o.fromEPSG4326,o.toEPSG4326)}exports.METERS_PER_UNIT=u.METERS_PER_UNIT,N();
},{"./sphere.js":156,"./extent.js":140,"./math.js":157,"./proj/epsg3857.js":161,"./proj/epsg4326.js":162,"./proj/Projection.js":53,"./proj/Units.js":133,"./proj/projections.js":163,"./proj/transforms.js":164}],214:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.reset=n,exports.multiply=o,exports.set=s,exports.setFromArray=u,exports.apply=c,exports.rotate=i,exports.scale=p,exports.translate=a,exports.compose=f,exports.invert=x,exports.determinant=l;var t=require("./asserts.js");const r=new Array(6);function e(){return[1,0,0,1,0,0]}function n(t){return s(t,1,0,0,1,0,0)}function o(t,r){const e=t[0],n=t[1],o=t[2],s=t[3],u=t[4],c=t[5],i=r[0],p=r[1],a=r[2],f=r[3],x=r[4],l=r[5];return t[0]=e*i+o*p,t[1]=n*i+s*p,t[2]=e*a+o*f,t[3]=n*a+s*f,t[4]=e*x+o*l+u,t[5]=n*x+s*l+c,t}function s(t,r,e,n,o,s,u){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t[4]=s,t[5]=u,t}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function c(t,r){const e=r[0],n=r[1];return r[0]=t[0]*e+t[2]*n+t[4],r[1]=t[1]*e+t[3]*n+t[5],r}function i(t,e){const n=Math.cos(e),u=Math.sin(e);return o(t,s(r,n,u,-u,n,0,0))}function p(t,e,n){return o(t,s(r,e,0,0,n,0,0))}function a(t,e,n){return o(t,s(r,1,0,0,1,e,n))}function f(t,r,e,n,o,s,u,c){const i=Math.sin(s),p=Math.cos(s);return t[0]=n*p,t[1]=o*i,t[2]=-n*i,t[3]=o*p,t[4]=u*n*p-c*n*i+r,t[5]=u*o*i+c*o*p+e,t}function x(r){const e=l(r);(0,t.assert)(0!==e,32);const n=r[0],o=r[1],s=r[2],u=r[3],c=r[4],i=r[5];return r[0]=u/e,r[1]=-o/e,r[2]=-s/e,r[3]=n/e,r[4]=(s*i-u*c)/e,r[5]=-(n*i-o*c)/e,r}function l(t){return t[0]*t[3]-t[1]*t[2]}
},{"./asserts.js":111}],239:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../Object.js"),o=f(e),n=require("../extent.js"),i=require("../functions.js"),r=require("../geom/flat/transform.js"),s=require("../proj.js"),p=require("../proj/Units.js"),u=f(p),c=require("../transform.js");function f(t){return t&&t.__esModule?t:{default:t}}const a=function(){o.default.call(this),this.extent_=(0,n.createEmpty)(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0};(0,t.inherits)(a,o.default);const l=(0,c.create)();a.prototype.clone=function(){},a.prototype.closestPointXY=function(t,e,o,n){},a.prototype.getClosestPoint=function(t,e){const o=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],o,1/0),o},a.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},a.prototype.computeExtent=function(t){},a.prototype.containsXY=i.FALSE,a.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),(0,n.returnOrUpdate)(this.extent_,t)},a.prototype.rotate=function(t,e){},a.prototype.scale=function(t,e,o){},a.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},a.prototype.getSimplifiedGeometry=function(t){},a.prototype.getType=function(){},a.prototype.applyTransform=function(t){},a.prototype.intersectsExtent=function(t){},a.prototype.translate=function(t,e){},a.prototype.transform=function(t,e){const o=(t=(0,s.get)(t)).getUnits()==u.default.TILE_PIXELS?function(o,i,p){const u=t.getExtent(),f=t.getWorldExtent(),a=(0,n.getHeight)(f)/(0,n.getHeight)(u);return(0,c.compose)(l,f[0],f[3],a,-a,0,0,0),(0,r.transform2D)(o,0,o.length,p,l,i),(0,s.getTransform)(t,e)(o,i,p)}:(0,s.getTransform)(t,e);return this.applyTransform(o),this},exports.default=a;
},{"../index.js":94,"../Object.js":145,"../extent.js":140,"../functions.js":144,"../geom/flat/transform.js":281,"../proj.js":43,"../proj/Units.js":133,"../transform.js":214}],236:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStrideForLayout=h,exports.transformGeom2D=p;var t=require("../index.js"),e=require("../functions.js"),i=require("../extent.js"),o=require("../geom/Geometry.js"),r=d(o),n=require("../geom/GeometryLayout.js"),s=d(n),a=require("../geom/flat/transform.js"),l=require("../obj.js");function d(t){return t&&t.__esModule?t:{default:t}}const u=function(){r.default.call(this),this.layout=s.default.XY,this.stride=2,this.flatCoordinates=null};function f(t){let e;return 2==t?e=s.default.XY:3==t?e=s.default.XYZ:4==t&&(e=s.default.XYZM),e}function h(t){let e;return t==s.default.XY?e=2:t==s.default.XYZ||t==s.default.XYM?e=3:t==s.default.XYZM&&(e=4),e}function p(t,e,i){const o=t.getFlatCoordinates();if(o){const r=t.getStride();return(0,a.transform2D)(o,0,o.length,r,e,i)}return null}(0,t.inherits)(u,r.default),u.prototype.containsXY=e.FALSE,u.prototype.computeExtent=function(t){return(0,i.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},u.prototype.getCoordinates=function(){},u.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},u.prototype.getFlatCoordinates=function(){return this.flatCoordinates},u.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},u.prototype.getLayout=function(){return this.layout},u.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&((0,l.clear)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];{const i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},u.prototype.getSimplifiedGeometryInternal=function(t){return this},u.prototype.getStride=function(){return this.stride},u.prototype.setFlatCoordinatesInternal=function(t,e){this.stride=h(t),this.layout=t,this.flatCoordinates=e},u.prototype.setCoordinates=function(t,e){},u.prototype.setLayout=function(t,e,i){let o;if(t)o=h(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout=s.default.XY,void(this.stride=2);e=e[0]}t=f(o=e.length)}this.layout=t,this.stride=o},u.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},u.prototype.rotate=function(t,e){const i=this.getFlatCoordinates();if(i){const o=this.getStride();(0,a.rotate)(i,0,i.length,o,t,e,i),this.changed()}},u.prototype.scale=function(t,e,o){let r=e;void 0===r&&(r=t);let n=o;n||(n=(0,i.getCenter)(this.getExtent()));const s=this.getFlatCoordinates();if(s){const e=this.getStride();(0,a.scale)(s,0,s.length,e,t,r,n,s),this.changed()}},u.prototype.translate=function(t,e){const i=this.getFlatCoordinates();if(i){const o=this.getStride();(0,a.translate)(i,0,i.length,o,t,e,i),this.changed()}},exports.default=u;
},{"../index.js":94,"../functions.js":144,"../extent.js":140,"../geom/Geometry.js":239,"../geom/GeometryLayout.js":235,"../geom/flat/transform.js":281,"../obj.js":96}],275:[function(require,module,exports) {
"use strict";function e(e,t,n,r){let o=0,l=e[n-r],s=e[n-r+1];for(;t<n;t+=r){const n=e[t],r=e[t+1];o+=s*n-l*r,l=n,s=r}return o/2}function t(t,n,r,o){let l=0;for(let s=0,i=r.length;s<i;++s){const i=r[s];l+=e(t,n,i,o),n=i}return l}function n(e,n,r,o){let l=0;for(let s=0,i=r.length;s<i;++s){const i=r[s];l+=t(e,n,i,o),n=i[i.length-1]}return l}Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRing=e,exports.linearRings=t,exports.linearRingss=n;
},{}],259:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.maxSquaredDelta=r,exports.arrayMaxSquaredDelta=n,exports.multiArrayMaxSquaredDelta=s,exports.assignClosestPoint=o,exports.assignClosestArrayPoint=a,exports.assignClosestMultiArrayPoint=l;var t=require("../../math.js");function e(e,r,n,s,o,a,l){const i=e[r],u=e[r+1],f=e[n]-i,c=e[n+1]-u;let h;if(0===f&&0===c)h=r;else{const g=((o-i)*f+(a-u)*c)/(f*f+c*c);if(g>1)h=n;else{if(g>0){for(let o=0;o<s;++o)l[o]=(0,t.lerp)(e[r+o],e[n+o],g);return void(l.length=s)}h=r}}for(let t=0;t<s;++t)l[t]=e[h+t];l.length=s}function r(e,r,n,s,o){let a=e[r],l=e[r+1];for(r+=s;r<n;r+=s){const n=e[r],s=e[r+1],i=(0,t.squaredDistance)(a,l,n,s);i>o&&(o=i),a=n,l=s}return o}function n(t,e,n,s,o){for(let a=0,l=n.length;a<l;++a){const l=n[a];o=r(t,e,l,s,o),e=l}return o}function s(t,e,r,s,o){for(let a=0,l=r.length;a<l;++a){const l=r[a];o=n(t,e,l,s,o),e=l[l.length-1]}return o}function o(r,n,s,o,a,l,i,u,f,c,h){if(n==s)return c;let g,N;if(0===a){if((N=(0,t.squaredDistance)(i,u,r[n],r[n+1]))<c){for(g=0;g<o;++g)f[g]=r[n+g];return f.length=o,N}return c}const x=h||[NaN,NaN];let d=n+o;for(;d<s;)if(e(r,d-o,d,o,i,u,x),(N=(0,t.squaredDistance)(i,u,x[0],x[1]))<c){for(c=N,g=0;g<o;++g)f[g]=x[g];f.length=o,d+=o}else d+=o*Math.max((Math.sqrt(N)-Math.sqrt(c))/a|0,1);if(l&&(e(r,s-o,n,o,i,u,x),(N=(0,t.squaredDistance)(i,u,x[0],x[1]))<c)){for(c=N,g=0;g<o;++g)f[g]=x[g];f.length=o}return c}function a(t,e,r,n,s,a,l,i,u,f,c){const h=c||[NaN,NaN];for(let c=0,g=r.length;c<g;++c){const g=r[c];f=o(t,e,g,n,s,a,l,i,u,f,h),e=g}return f}function l(t,e,r,n,s,o,l,i,u,f,c){const h=c||[NaN,NaN];for(let c=0,g=r.length;c<g;++c){const g=r[c];f=a(t,e,g,n,s,o,l,i,u,f,h),e=g[g.length-1]}return f}
},{"../../math.js":157}],240:[function(require,module,exports) {
"use strict";function t(t,e,n,o){for(let o=0,r=n.length;o<r;++o)t[e++]=n[o];return e}function e(t,e,n,o){for(let r=0,l=n.length;r<l;++r){const l=n[r];for(let n=0;n<o;++n)t[e++]=l[n]}return e}function n(t,n,o,r,l){const s=l||[];let f=0;for(let l=0,u=o.length;l<u;++l){const u=e(t,n,o[l],r);s[f++]=u,n=u}return s.length=f,s}function o(t,e,o,r,l){const s=l||[];let f=0;for(let l=0,u=o.length;l<u;++l){const u=n(t,e,o[l],r,s[f]);s[f++]=u,e=u[u.length-1]}return s.length=f,s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deflateCoordinate=t,exports.deflateCoordinates=e,exports.deflateCoordinatesArray=n,exports.deflateMultiCoordinatesArray=o;
},{}],254:[function(require,module,exports) {
"use strict";function t(t,e,n,o,r){const l=void 0!==r?r:[];let i=0;for(let r=e;r<n;r+=o)l[i++]=t.slice(r,r+o);return l.length=i,l}function e(e,n,o,r,l){const i=void 0!==l?l:[];let s=0;for(let l=0,c=o.length;l<c;++l){const c=o[l];i[s++]=t(e,n,c,r,i[s]),n=c}return i.length=s,i}function n(t,n,o,r,l){const i=void 0!==l?l:[];let s=0;for(let l=0,c=o.length;l<c;++l){const c=o[l];i[s++]=e(t,n,c,r,i[s]),n=c[c.length-1]}return i.length=s,i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateCoordinates=t,exports.inflateCoordinatesArray=e,exports.inflateMultiCoordinatesArray=n;
},{}],263:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.simplifyLineString=e,exports.douglasPeucker=r,exports.douglasPeuckerArray=n,exports.douglasPeuckerMultiArray=o,exports.radialDistance=u,exports.snap=s,exports.quantize=i,exports.quantizeArray=c,exports.quantizeMultiArray=l;var t=require("../../math.js");function e(t,e,n,o,s,i,c){const l=void 0!==c?c:[];return i||(n=u(t,e,n,o,s,l,0),t=l,e=0,o=2),l.length=r(t,e,n,o,s,l,0),l}function r(e,r,n,o,u,s,i){const c=(n-r)/o;if(c<3){for(;r<n;r+=o)s[i++]=e[r],s[i++]=e[r+1];return i}const l=new Array(c);l[0]=1,l[c-1]=1;const f=[r,n-o];let a=0;for(;f.length>0;){const n=f.pop(),s=f.pop();let i=0;const c=e[s],p=e[s+1],h=e[n],g=e[n+1];for(let r=s+o;r<n;r+=o){const n=e[r],o=e[r+1],u=(0,t.squaredSegmentDistance)(n,o,c,p,h,g);u>i&&(a=r,i=u)}i>u&&(l[(a-r)/o]=1,s+o<a&&f.push(s,a),a+o<n&&f.push(a,n))}for(let t=0;t<c;++t)l[t]&&(s[i++]=e[r+t*o],s[i++]=e[r+t*o+1]);return i}function n(t,e,n,o,u,s,i,c){for(let l=0,f=n.length;l<f;++l){const f=n[l];i=r(t,e,f,o,u,s,i),c.push(i),e=f}return i}function o(t,e,r,o,u,s,i,c){for(let l=0,f=r.length;l<f;++l){const f=r[l],a=[];i=n(t,e,f,o,u,s,i,a),c.push(a),e=f[f.length-1]}return i}function u(e,r,n,o,u,s,i){if(n<=r+o){for(;r<n;r+=o)s[i++]=e[r],s[i++]=e[r+1];return i}let c=e[r],l=e[r+1];s[i++]=c,s[i++]=l;let f=c,a=l;for(r+=o;r<n;r+=o)f=e[r],a=e[r+1],(0,t.squaredDistance)(c,l,f,a)>u&&(s[i++]=f,s[i++]=a,c=f,l=a);return f==c&&a==l||(s[i++]=f,s[i++]=a),i}function s(t,e){return e*Math.round(t/e)}function i(t,e,r,n,o,u,i){if(e==r)return i;let c,l,f=s(t[e],o),a=s(t[e+1],o);e+=n,u[i++]=f,u[i++]=a;do{if(c=s(t[e],o),l=s(t[e+1],o),(e+=n)==r)return u[i++]=c,u[i++]=l,i}while(c==f&&l==a);for(;e<r;){const r=s(t[e],o),p=s(t[e+1],o);if(e+=n,r==c&&p==l)continue;const h=c-f,g=l-a,d=r-f,x=p-a;h*x==g*d&&(h<0&&d<h||h==d||h>0&&d>h)&&(g<0&&x<g||g==x||g>0&&x>g)?(c=r,l=p):(u[i++]=c,u[i++]=l,f=c,a=l,c=r,l=p)}return u[i++]=c,u[i++]=l,i}function c(t,e,r,n,o,u,s,c){for(let l=0,f=r.length;l<f;++l){const f=r[l];s=i(t,e,f,n,o,u,s),c.push(s),e=f}return s}function l(t,e,r,n,o,u,s,i){for(let l=0,f=r.length;l<f;++l){const f=r[l],a=[];s=c(t,e,f,n,o,u,s,a),i.push(a),e=f[f.length-1]}return s}
},{"../../math.js":157}],280:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../extent.js"),i=require("../geom/GeometryLayout.js"),s=c(i),o=require("../geom/GeometryType.js"),n=c(o),a=require("../geom/SimpleGeometry.js"),r=c(a),l=require("../geom/flat/area.js"),d=require("../geom/flat/closest.js"),h=require("../geom/flat/deflate.js"),u=require("../geom/flat/inflate.js"),f=require("../geom/flat/simplify.js");function c(t){return t&&t.__esModule?t:{default:t}}const g=function(t,e){r.default.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(g,r.default),g.prototype.clone=function(){const t=new g(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},g.prototype.closestPointXY=function(t,i,s,o){return o<(0,e.closestSquaredDistanceXY)(this.getExtent(),t,i)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,d.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,d.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,s,o))},g.prototype.getArea=function(){return(0,l.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},g.prototype.getCoordinates=function(){return(0,u.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},g.prototype.getSimplifiedGeometryInternal=function(t){const e=[];e.length=(0,f.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);const i=new g(null);return i.setFlatCoordinates(s.default.XY,e),i},g.prototype.getType=function(){return n.default.LINEAR_RING},g.prototype.intersectsExtent=function(t){},g.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,h.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},g.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=g;
},{"../index.js":94,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/SimpleGeometry.js":236,"../geom/flat/area.js":275,"../geom/flat/closest.js":259,"../geom/flat/deflate.js":240,"../geom/flat/inflate.js":254,"../geom/flat/simplify.js":263}],189:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../extent.js"),o=require("../geom/GeometryLayout.js"),r=d(o),s=require("../geom/GeometryType.js"),i=d(s),n=require("../geom/SimpleGeometry.js"),a=d(n),l=require("../geom/flat/deflate.js"),u=require("../math.js");function d(t){return t&&t.__esModule?t:{default:t}}const f=function(t,e){a.default.call(this),this.setCoordinates(t,e)};(0,t.inherits)(f,a.default),f.prototype.clone=function(){const t=new f(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},f.prototype.closestPointXY=function(t,e,o,r){const s=this.flatCoordinates,i=(0,u.squaredDistance)(t,e,s[0],s[1]);if(i<r){const t=this.stride;for(let e=0;e<t;++e)o[e]=s[e];return o.length=t,i}return r},f.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},f.prototype.computeExtent=function(t){return(0,e.createOrUpdateFromCoordinate)(this.flatCoordinates,t)},f.prototype.getType=function(){return i.default.POINT},f.prototype.intersectsExtent=function(t){return(0,e.containsXY)(t,this.flatCoordinates[0],this.flatCoordinates[1])},f.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,l.deflateCoordinate)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(r.default.XY,null)},f.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=f;
},{"../index.js":94,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/SimpleGeometry.js":236,"../geom/flat/deflate.js":240,"../math.js":157}],277:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingContainsExtent=t,exports.linearRingContainsXY=e,exports.linearRingsContainsXY=r,exports.linearRingssContainsXY=i;var n=require("../../extent.js");function t(t,r,i,o,u){return!(0,n.forEachCorner)(u,function(n){return!e(t,r,i,o,n[0],n[1])})}function e(n,t,e,r,i,o){let u=0,s=n[e-r],f=n[e-r+1];for(;t<e;t+=r){const e=n[t],r=n[t+1];f<=o?r>o&&(e-s)*(o-f)-(i-s)*(r-f)>0&&u++:r<=o&&(e-s)*(o-f)-(i-s)*(r-f)<0&&u--,s=e,f=r}return 0!==u}function r(n,t,r,i,o,u){if(0===r.length)return!1;if(!e(n,t,r[0],i,o,u))return!1;for(let t=1,s=r.length;t<s;++t)if(e(n,r[t-1],r[t],i,o,u))return!1;return!0}function i(n,t,e,i,o,u){if(0===e.length)return!1;for(let s=0,f=e.length;s<f;++s){const f=e[s];if(r(n,t,f,i,o,u))return!0;t=f[f.length-1]}return!1}
},{"../../extent.js":140}],278:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getInteriorPointOfArray=r,exports.getInteriorPointsOfMultiArray=n;var t=require("../../array.js"),e=require("../flat/contains.js");function r(r,n,o,s,i,a,l){let u,f,c,g,h,p,y;const N=i[a+1],b=[];for(let t=0,e=o.length;t<e;++t){const e=o[t];for(g=r[e-s],p=r[e-s+1],u=n;u<e;u+=s)h=r[u],y=r[u+1],(N<=p&&y<=N||p<=N&&N<=y)&&(c=(N-p)/(y-p)*(h-g)+g,b.push(c)),g=h,p=y}let j=NaN,x=-1/0;for(b.sort(t.numberSafeCompareFunction),g=b[0],u=1,f=b.length;u<f;++u){h=b[u];const t=Math.abs(h-g);t>x&&(c=(g+h)/2,(0,e.linearRingsContainsXY)(r,n,o,s,c,N)&&(j=c,x=t)),g=h}return isNaN(j)&&(j=i[a]),l?(l.push(j,N,x),l):[j,N,x]}function n(t,e,n,o,s){let i=[];for(let a=0,l=n.length;a<l;++a){const l=n[a];i=r(t,e,l,o,s,2*a,i),e=l[l.length-1]}return i}
},{"../../array.js":171,"../flat/contains.js":277}],262:[function(require,module,exports) {
"use strict";function e(e,r,t,o,c,n){const s=[e[r],e[r+1]],u=[];let f;for(;r+o<t;r+=o){if(u[0]=e[r+o],u[1]=e[r+o+1],f=c.call(n,s,u))return f;s[0]=u[0],s[1]=u[1]}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.forEach=e;
},{}],260:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.intersectsLineString=r,exports.intersectsLineStringArray=i,exports.intersectsLinearRing=s,exports.intersectsLinearRingArray=o,exports.intersectsLinearRingMultiArray=a;var n=require("../../extent.js"),e=require("../flat/contains.js"),t=require("../flat/segments.js");function r(e,r,i,s,o){const a=(0,n.extendFlatCoordinates)((0,n.createEmpty)(),e,r,i,s);return!!(0,n.intersects)(o,a)&&(!!(0,n.containsExtent)(o,a)||(a[0]>=o[0]&&a[2]<=o[2]||(a[1]>=o[1]&&a[3]<=o[3]||(0,t.forEach)(e,r,i,s,function(e,t){return(0,n.intersectsSegment)(o,e,t)}))))}function i(n,e,t,i,s){for(let o=0,a=t.length;o<a;++o){if(r(n,e,t[o],i,s))return!0;e=t[o]}return!1}function s(n,t,i,s,o){return!!r(n,t,i,s,o)||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[0],o[1])||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[0],o[3])||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[2],o[1])||!!(0,e.linearRingContainsXY)(n,t,i,s,o[2],o[3]))))}function o(n,t,r,i,o){if(!s(n,t,r[0],i,o))return!1;if(1===r.length)return!0;for(let t=1,s=r.length;t<s;++t)if((0,e.linearRingContainsExtent)(n,r[t-1],r[t],i,o))return!1;return!0}function a(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const a=t[s];if(o(n,e,a,r,i))return!0;e=a[a.length-1]}return!1}
},{"../../extent.js":140,"../flat/contains.js":277,"../flat/segments.js":262}],302:[function(require,module,exports) {
"use strict";function e(e,o,t,r){for(;o<t-r;){for(let s=0;s<r;++s){const c=e[o+s];e[o+s]=e[t-r+s],e[t-r+s]=c}o+=r,t-=r}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.coordinates=e;
},{}],279:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingIsClockwise=r,exports.linearRingIsOriented=n,exports.linearRingsAreOriented=t,exports.orientLinearRings=i,exports.orientLinearRingsArray=o;var e=require("../flat/reverse.js");function r(e,r,n,t){let i=0,o=e[n-t],s=e[n-t+1];for(;r<n;r+=t){const n=e[r],t=e[r+1];i+=(n-o)*(t+s),o=n,s=t}return i>0}function n(e,n,t,i,o){const s=void 0!==o&&o;for(let o=0,l=t.length;o<l;++o){const l=t[o],u=r(e,n,l,i);if(0===o){if(s&&u||!s&&!u)return!1}else if(s&&!u||!s&&u)return!1;n=l}return!0}function t(e,r,t,i,o){for(let s=0,l=t.length;s<l;++s)if(!n(e,r,t[s],i,o))return!1;return!0}function i(n,t,i,o,s){const l=void 0!==s&&s;for(let s=0,u=i.length;s<u;++s){const u=i[s],f=r(n,t,u,o);(0===s?l&&f||!l&&!f:l&&!f||!l&&f)&&(0,e.coordinates)(n,t,u,o),t=u}return t}function o(e,r,n,t,o){for(let s=0,l=n.length;s<l;++s)r=i(e,r,n[s],t,o);return r}
},{"../flat/reverse.js":302}],197:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.circular=P,exports.fromExtent=I,exports.fromCircle=L,exports.makeRegular=O;var t=require("../index.js"),e=require("../array.js"),i=require("../extent.js"),n=require("../geom/GeometryLayout.js"),s=j(n),o=require("../geom/GeometryType.js"),r=j(o),a=require("../geom/LinearRing.js"),l=j(a),d=require("../geom/Point.js"),h=j(d),u=require("../geom/SimpleGeometry.js"),f=j(u),g=require("../sphere.js"),c=require("../geom/flat/area.js"),p=require("../geom/flat/closest.js"),C=require("../geom/flat/contains.js"),_=require("../geom/flat/deflate.js"),y=require("../geom/flat/inflate.js"),m=require("../geom/flat/interiorpoint.js"),F=require("../geom/flat/intersectsextent.js"),R=require("../geom/flat/orient.js"),q=require("../geom/flat/simplify.js"),x=require("../math.js");function j(t){return t&&t.__esModule?t:{default:t}}const v=function(t,e){f.default.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};function P(t,i,n,o){const r=n||32,a=[];for(let n=0;n<r;++n)(0,e.extend)(a,(0,g.offset)(t,i,2*Math.PI*n/r,o));a.push(a[0],a[1]);const l=new v(null);return l.setFlatCoordinates(s.default.XY,a,[a.length]),l}function I(t){const e=t[0],i=t[1],n=t[2],o=t[3],r=[e,i,e,o,n,o,n,i,e,i],a=new v(null);return a.setFlatCoordinates(s.default.XY,r,[r.length]),a}function L(t,e,i){const n=e||32,s=t.getStride(),o=t.getLayout(),r=new v(null,o),a=s*(n+1),l=new Array(a);for(let t=0;t<a;t++)l[t]=0;const d=[l.length];return r.setFlatCoordinates(o,l,d),O(r,t.getCenter(),t.getRadius(),i),r}function O(t,e,i,n){const s=t.getFlatCoordinates(),o=t.getLayout(),r=t.getStride(),a=t.getEnds(),l=s.length/r-1,d=n||0;for(let t=0;t<=l;++t){const n=t*r,o=d+2*(0,x.modulo)(t,l)*Math.PI/l;s[n]=e[0]+i*Math.cos(o),s[n+1]=e[1]+i*Math.sin(o)}t.setFlatCoordinates(o,s,a)}(0,t.inherits)(v,f.default),v.prototype.appendLinearRing=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},v.prototype.clone=function(){const t=new v(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},v.prototype.closestPointXY=function(t,e,n,s){return s<(0,i.closestSquaredDistanceXY)(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,p.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,p.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))},v.prototype.containsXY=function(t,e){return(0,C.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},v.prototype.getArea=function(){return(0,c.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},v.prototype.getCoordinates=function(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,R.orientLinearRings)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,(0,y.inflateCoordinatesArray)(e,0,this.ends_,this.stride)},v.prototype.getEnds=function(){return this.ends_},v.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=(0,i.getCenter)(this.getExtent());this.flatInteriorPoint_=(0,m.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},v.prototype.getInteriorPoint=function(){return new h.default(this.getFlatInteriorPoint(),s.default.XYM)},v.prototype.getLinearRingCount=function(){return this.ends_.length},v.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t)return null;const e=new l.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},v.prototype.getLinearRings=function(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,r=i.length;o<r;++o){const r=i[o],a=new l.default(null);a.setFlatCoordinates(t,e.slice(s,r)),n.push(a),s=r}return n},v.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,R.linearRingIsOriented)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,R.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},v.prototype.getSimplifiedGeometryInternal=function(t){const e=[],i=[];e.length=(0,q.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i);const n=new v(null);return n.setFlatCoordinates(s.default.XY,e,i),n},v.prototype.getType=function(){return r.default.POLYGON},v.prototype.intersectsExtent=function(t){return(0,F.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},v.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=(0,_.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}else this.setFlatCoordinates(s.default.XY,null,this.ends_)},v.prototype.setFlatCoordinates=function(t,e,i){this.setFlatCoordinatesInternal(t,e),this.ends_=i,this.changed()},exports.default=v;
},{"../index.js":94,"../array.js":171,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/LinearRing.js":280,"../geom/Point.js":189,"../geom/SimpleGeometry.js":236,"../sphere.js":156,"../geom/flat/area.js":275,"../geom/flat/closest.js":259,"../geom/flat/contains.js":277,"../geom/flat/deflate.js":240,"../geom/flat/inflate.js":254,"../geom/flat/interiorpoint.js":278,"../geom/flat/intersectsextent.js":260,"../geom/flat/orient.js":279,"../geom/flat/simplify.js":263,"../math.js":157}],49:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCenterConstraint=j,exports.createResolutionConstraint=O,exports.createRotationConstraint=F,exports.isNoopAnimation=S;var t=require("./tilegrid/common.js"),o=require("./index.js"),e=require("./functions.js"),i=require("./centerconstraint.js"),n=require("./Object.js"),s=N(n),r=require("./resolutionconstraint.js"),a=require("./rotationconstraint.js"),u=require("./ViewHint.js"),c=N(u),l=require("./ViewProperty.js"),h=N(l),p=require("./array.js"),m=require("./asserts.js"),g=require("./coordinate.js"),d=require("./easing.js"),R=require("./extent.js"),f=require("./geom/GeometryType.js"),_=N(f),y=require("./geom/Polygon.js"),M=require("./geom/SimpleGeometry.js"),v=N(M),C=require("./math.js"),x=require("./obj.js"),A=require("./proj.js"),E=require("./proj/Units.js"),T=N(E);function N(t){return t&&t.__esModule?t:{default:t}}const I=0,Z=function(t){s.default.call(this);const o=(0,x.assign)({},t);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=(0,A.createProjection)(o.projection,"EPSG:3857"),this.applyOptions_(o)};function j(t){return void 0!==t.extent?(0,i.createExtent)(t.extent):i.none}function O(o){let e,i,n;let s=void 0!==o.minZoom?o.minZoom:I,a=void 0!==o.maxZoom?o.maxZoom:28;const u=void 0!==o.zoomFactor?o.zoomFactor:2;if(void 0!==o.resolutions){const t=o.resolutions;i=t[s],n=void 0!==t[a]?t[a]:t[t.length-1],e=(0,r.createSnapToResolutions)(t)}else{const c=(0,A.createProjection)(o.projection,"EPSG:3857"),l=c.getExtent(),h=(l?Math.max((0,R.getWidth)(l),(0,R.getHeight)(l)):360*A.METERS_PER_UNIT[T.default.DEGREES]/c.getMetersPerUnit())/t.DEFAULT_TILE_SIZE/Math.pow(2,I),p=h/Math.pow(2,28-I);void 0!==(i=o.maxResolution)?s=0:i=h/Math.pow(u,s),void 0===(n=o.minResolution)&&(n=void 0!==o.maxZoom?void 0!==o.maxResolution?i/Math.pow(u,a):h/Math.pow(u,a):p),a=s+Math.floor(Math.log(i/n)/Math.log(u)),n=i/Math.pow(u,a-s),e=(0,r.createSnapToPower)(u,i,a-s)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:u}}function F(t){if(void 0===t.enableRotation||t.enableRotation){const o=t.constrainRotation;return void 0===o||!0===o?(0,a.createSnapToZero)():!1===o?a.none:"number"==typeof o?(0,a.createSnapToN)(o):a.none}return a.disable}function S(t){return!(t.sourceCenter&&t.targetCenter&&!(0,g.equals)(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}(0,o.inherits)(Z,s.default),Z.prototype.applyOptions_=function(t){const o={};o[h.default.CENTER]=void 0!==t.center?t.center:null;const e=O(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;const i=j(t),n=e.constraint,s=F(t);this.constraints_={center:i,resolution:n,rotation:s},void 0!==t.resolution?o[h.default.RESOLUTION]=t.resolution:void 0!==t.zoom&&(o[h.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(o[h.default.RESOLUTION]=(0,C.clamp)(Number(this.getResolution()||o[h.default.RESOLUTION]),this.minResolution_,this.maxResolution_))),o[h.default.ROTATION]=void 0!==t.rotation?t.rotation:0,this.setProperties(o),this.options_=t},Z.prototype.getUpdatedOptions_=function(t){const o=(0,x.assign)({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenter(),o.rotation=this.getRotation(),(0,x.assign)({},o,t)},Z.prototype.animate=function(t){let o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){const t=arguments[e-1];return t.center&&this.setCenter(t.center),void 0!==t.zoom&&this.setZoom(t.zoom),void 0!==t.rotation&&this.setRotation(t.rotation),void(o&&setTimeout(function(){o(!0)},0))}let i=Date.now(),n=this.getCenter().slice(),s=this.getResolution(),r=this.getRotation();const a=[];for(let t=0;t<e;++t){const e=arguments[t],u={start:i,complete:!1,anchor:e.anchor,duration:void 0!==e.duration?e.duration:1e3,easing:e.easing||d.inAndOut};if(e.center&&(u.sourceCenter=n,u.targetCenter=e.center,n=u.targetCenter),void 0!==e.zoom?(u.sourceResolution=s,u.targetResolution=this.constrainResolution(this.maxResolution_,e.zoom-this.minZoom_,0),s=u.targetResolution):e.resolution&&(u.sourceResolution=s,u.targetResolution=e.resolution,s=u.targetResolution),void 0!==e.rotation){u.sourceRotation=r;const t=(0,C.modulo)(e.rotation-r+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=r+t,r=u.targetRotation}u.callback=o,S(u)?u.complete=!0:i+=u.duration,a.push(u)}this.animations_.push(a),this.setHint(c.default.ANIMATING,1),this.updateAnimations_()},Z.prototype.getAnimating=function(){return this.hints_[c.default.ANIMATING]>0},Z.prototype.getInteracting=function(){return this.hints_[c.default.INTERACTING]>0},Z.prototype.cancelAnimations=function(){this.setHint(c.default.ANIMATING,-this.hints_[c.default.ANIMATING]);for(let t=0,o=this.animations_.length;t<o;++t){const o=this.animations_[t];o[0].callback&&o[0].callback(!1)}this.animations_.length=0},Z.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let o=!1;for(let e=this.animations_.length-1;e>=0;--e){const i=this.animations_[e];let n=!0;for(let e=0,s=i.length;e<s;++e){const s=i[e];if(s.complete)continue;const r=t-s.start;let a=s.duration>0?r/s.duration:1;a>=1?(s.complete=!0,a=1):n=!1;const u=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],o=s.sourceCenter[1],e=t+u*(s.targetCenter[0]-t),i=o+u*(s.targetCenter[1]-o);this.set(h.default.CENTER,[e,i])}if(s.sourceResolution&&s.targetResolution){const t=1===u?s.targetResolution:s.sourceResolution+u*(s.targetResolution-s.sourceResolution);s.anchor&&this.set(h.default.CENTER,this.calculateCenterZoom(t,s.anchor)),this.set(h.default.RESOLUTION,t)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===u?(0,C.modulo)(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+u*(s.targetRotation-s.sourceRotation);s.anchor&&this.set(h.default.CENTER,this.calculateCenterRotate(t,s.anchor)),this.set(h.default.ROTATION,t)}if(o=!0,!s.complete)break}if(n){this.animations_[e]=null,this.setHint(c.default.ANIMATING,-1);const t=i[0].callback;t&&setTimeout(function(){t(!0)},0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))},Z.prototype.calculateCenterRotate=function(t,o){let e;const i=this.getCenter();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],(0,g.rotate)(e,t-this.getRotation()),(0,g.add)(e,o)),e},Z.prototype.calculateCenterZoom=function(t,o){let e;const i=this.getCenter(),n=this.getResolution();if(void 0!==i&&void 0!==n){e=[o[0]-t*(o[0]-i[0])/n,o[1]-t*(o[1]-i[1])/n]}return e},Z.prototype.getSizeFromViewport_=function(){const t=[100,100],e='.ol-viewport[data-view="'+(0,o.getUid)(this)+'"]',i=document.querySelector(e);if(i){const o=getComputedStyle(i);t[0]=parseInt(o.width,10),t[1]=parseInt(o.height,10)}return t},Z.prototype.constrainCenter=function(t){return this.constraints_.center(t)},Z.prototype.constrainResolution=function(t,o,e){const i=o||0,n=e||0;return this.constraints_.resolution(t,i,n)},Z.prototype.constrainRotation=function(t,o){const e=o||0;return this.constraints_.rotation(t,e)},Z.prototype.getCenter=function(){return this.get(h.default.CENTER)},Z.prototype.getConstraints=function(){return this.constraints_},Z.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},Z.prototype.calculateExtent=function(t){const o=t||this.getSizeFromViewport_(),e=this.getCenter();(0,m.assert)(e,1);const i=this.getResolution();(0,m.assert)(void 0!==i,2);const n=this.getRotation();return(0,m.assert)(void 0!==n,3),(0,R.getForViewAndSize)(e,i,n,o)},Z.prototype.getMaxResolution=function(){return this.maxResolution_},Z.prototype.getMinResolution=function(){return this.minResolution_},Z.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},Z.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},Z.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},Z.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},Z.prototype.getProjection=function(){return this.projection_},Z.prototype.getResolution=function(){return this.get(h.default.RESOLUTION)},Z.prototype.getResolutions=function(){return this.resolutions_},Z.prototype.getResolutionForExtent=function(t,o){const e=o||this.getSizeFromViewport_(),i=(0,R.getWidth)(t)/e[0],n=(0,R.getHeight)(t)/e[1];return Math.max(i,n)},Z.prototype.getResolutionForValueFunction=function(t){const o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*n)}},Z.prototype.getRotation=function(){return this.get(h.default.ROTATION)},Z.prototype.getValueForResolutionFunction=function(t){const o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return Math.log(e/t)/Math.log(o)/n}},Z.prototype.getState=function(){const t=this.getCenter(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},Z.prototype.getZoom=function(){let t;const o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},Z.prototype.getZoomForResolution=function(t){let o,e,i=this.minZoom_||0;if(this.resolutions_){const n=(0,p.linearFindNearest)(this.resolutions_,t,1);i=n,o=this.resolutions_[n],e=n==this.resolutions_.length-1?2:o/this.resolutions_[n+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},Z.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},Z.prototype.fit=function(t,o){const i=o||{};let n,s=i.size;s||(s=this.getSizeFromViewport_()),t instanceof v.default?t.getType()===_.default.CIRCLE?(t=t.getExtent(),(n=(0,y.fromExtent)(t)).rotate(this.getRotation(),(0,R.getCenter)(t))):n=t:((0,m.assert)(Array.isArray(t),24),(0,m.assert)(!(0,R.isEmpty)(t),25),n=(0,y.fromExtent)(t));const r=void 0!==i.padding?i.padding:[0,0,0,0],a=void 0===i.constrainResolution||i.constrainResolution,u=void 0!==i.nearest&&i.nearest;let c;c=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.constrainResolution(this.maxResolution_,i.maxZoom-this.minZoom_,0):0;const l=n.getFlatCoordinates(),h=this.getRotation(),p=Math.cos(-h);let g=Math.sin(-h),d=1/0,f=1/0,M=-1/0,C=-1/0;const x=n.getStride();for(let t=0,o=l.length;t<o;t+=x){const o=l[t]*p-l[t+1]*g,e=l[t]*g+l[t+1]*p;d=Math.min(d,o),f=Math.min(f,e),M=Math.max(M,o),C=Math.max(C,e)}let A=this.getResolutionForExtent([d,f,M,C],[s[0]-r[1]-r[3],s[1]-r[0]-r[2]]);if(A=isNaN(A)?c:Math.max(A,c),a){let t=this.constrainResolution(A,0,0);!u&&t<A&&(t=this.constrainResolution(t,-1,0)),A=t}g=-g;let E=(d+M)/2,T=(f+C)/2;const N=[(E+=(r[1]-r[3])/2*A)*p-(T+=(r[0]-r[2])/2*A)*g,T*p+E*g],I=i.callback?i.callback:e.UNDEFINED;void 0!==i.duration?this.animate({resolution:A,center:N,duration:i.duration,easing:i.easing},I):(this.setResolution(A),this.setCenter(N),setTimeout(I.bind(void 0,!0),0))},Z.prototype.centerOn=function(t,o,e){const i=this.getRotation(),n=Math.cos(-i);let s=Math.sin(-i),r=t[0]*n-t[1]*s,a=t[1]*n+t[0]*s;const u=this.getResolution(),c=(r+=(o[0]/2-e[0])*u)*n-(a+=(e[1]-o[1]/2)*u)*(s=-s),l=a*n+r*s;this.setCenter([c,l])},Z.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},Z.prototype.rotate=function(t,o){if(void 0!==o){const e=this.calculateCenterRotate(t,o);this.setCenter(e)}this.setRotation(t)},Z.prototype.setCenter=function(t){this.set(h.default.CENTER,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},Z.prototype.setResolution=function(t){this.set(h.default.RESOLUTION,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setRotation=function(t){this.set(h.default.ROTATION,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},exports.default=Z;
},{"./tilegrid/common.js":175,"./index.js":94,"./functions.js":144,"./centerconstraint.js":286,"./Object.js":145,"./resolutionconstraint.js":287,"./rotationconstraint.js":185,"./ViewHint.js":186,"./ViewProperty.js":288,"./array.js":171,"./asserts.js":111,"./coordinate.js":179,"./easing.js":174,"./extent.js":140,"./geom/GeometryType.js":211,"./geom/Polygon.js":197,"./geom/SimpleGeometry.js":236,"./math.js":157,"./obj.js":96,"./proj.js":43,"./proj/Units.js":133}],148:[function(require,module,exports) {
"use strict";function e(e,t){const o=document.createElement("CANVAS");return e&&(o.width=e),t&&(o.height=t),o.getContext("2d")}function t(e){let t=e.offsetWidth;const o=getComputedStyle(e);return t+=parseInt(o.marginLeft,10)+parseInt(o.marginRight,10)}function o(e){let t=e.offsetHeight;const o=getComputedStyle(e);return t+=parseInt(o.marginTop,10)+parseInt(o.marginBottom,10)}function r(e,t){const o=t.parentNode;o&&o.replaceChild(e,t)}function n(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function i(e){for(;e.lastChild;)e.removeChild(e.lastChild)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCanvasContext2D=e,exports.outerWidth=t,exports.outerHeight=o,exports.replaceNode=r,exports.removeNode=n,exports.removeChildren=i;
},{}],169:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};
},{}],168:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../Object.js"),i=r(e),o=require("../layer/Property.js"),s=r(o),n=require("../math.js"),u=require("../obj.js");function r(t){return t&&t.__esModule?t:{default:t}}const a=function(t){i.default.call(this);const e=(0,u.assign)({},t);e[s.default.OPACITY]=void 0!==t.opacity?t.opacity:1,e[s.default.VISIBLE]=void 0===t.visible||t.visible,e[s.default.Z_INDEX]=void 0!==t.zIndex?t.zIndex:0,e[s.default.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,e[s.default.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,this.setProperties(e),this.state_={layer:this,managed:!0},this.type};(0,t.inherits)(a,i.default),a.prototype.getType=function(){return this.type},a.prototype.getLayerState=function(){return this.state_.opacity=(0,n.clamp)(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},a.prototype.getLayersArray=function(t){},a.prototype.getLayerStatesArray=function(t){},a.prototype.getExtent=function(){return this.get(s.default.EXTENT)},a.prototype.getMaxResolution=function(){return this.get(s.default.MAX_RESOLUTION)},a.prototype.getMinResolution=function(){return this.get(s.default.MIN_RESOLUTION)},a.prototype.getOpacity=function(){return this.get(s.default.OPACITY)},a.prototype.getSourceState=function(){},a.prototype.getVisible=function(){return this.get(s.default.VISIBLE)},a.prototype.getZIndex=function(){return this.get(s.default.Z_INDEX)},a.prototype.setExtent=function(t){this.set(s.default.EXTENT,t)},a.prototype.setMaxResolution=function(t){this.set(s.default.MAX_RESOLUTION,t)},a.prototype.setMinResolution=function(t){this.set(s.default.MIN_RESOLUTION,t)},a.prototype.setOpacity=function(t){this.set(s.default.OPACITY,t)},a.prototype.setVisible=function(t){this.set(s.default.VISIBLE,t)},a.prototype.setZIndex=function(t){this.set(s.default.Z_INDEX,t)},exports.default=a;
},{"../index.js":94,"../Object.js":145,"../layer/Property.js":169,"../math.js":157,"../obj.js":96}],154:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};
},{}],65:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Collection.js"),s=_(t),n=require("../CollectionEventType.js"),i=_(n),r=require("../Object.js"),a=require("../ObjectEventType.js"),o=_(a),l=require("../asserts.js"),h=require("../events.js"),y=require("../events/EventType.js"),u=_(y),c=require("../extent.js"),d=require("../layer/Base.js"),f=_(d),g=require("../obj.js"),L=require("../source/State.js"),p=_(L);function _(e){return e&&e.__esModule?e:{default:e}}const E={LAYERS:"layers"},A=function(e){const t=e||{},n=(0,g.assign)({},t);delete n.layers;let i=t.layers;f.default.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},(0,h.listen)(this,(0,r.getChangeEventType)(E.LAYERS),this.handleLayersChanged_,this),i?Array.isArray(i)?i=new s.default(i.slice(),{unique:!0}):((0,l.assert)(i instanceof s.default,43),i=i):i=new s.default(void 0,{unique:!0}),this.setLayers(i)};(0,e.inherits)(A,f.default),A.prototype.handleLayerChange_=function(){this.changed()},A.prototype.handleLayersChanged_=function(t){this.layersListenerKeys_.forEach(h.unlistenByKey),this.layersListenerKeys_.length=0;const s=this.getLayers();this.layersListenerKeys_.push((0,h.listen)(s,i.default.ADD,this.handleLayersAdd_,this),(0,h.listen)(s,i.default.REMOVE,this.handleLayersRemove_,this));for(const e in this.listenerKeys_)this.listenerKeys_[e].forEach(h.unlistenByKey);(0,g.clear)(this.listenerKeys_);const n=s.getArray();for(let t=0,s=n.length;t<s;t++){const s=n[t];this.listenerKeys_[(0,e.getUid)(s).toString()]=[(0,h.listen)(s,o.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,h.listen)(s,u.default.CHANGE,this.handleLayerChange_,this)]}this.changed()},A.prototype.handleLayersAdd_=function(t){const s=t.element,n=(0,e.getUid)(s).toString();this.listenerKeys_[n]=[(0,h.listen)(s,o.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,h.listen)(s,u.default.CHANGE,this.handleLayerChange_,this)],this.changed()},A.prototype.handleLayersRemove_=function(t){const s=t.element,n=(0,e.getUid)(s).toString();this.listenerKeys_[n].forEach(h.unlistenByKey),delete this.listenerKeys_[n],this.changed()},A.prototype.getLayers=function(){return this.get(E.LAYERS)},A.prototype.setLayers=function(e){this.set(E.LAYERS,e)},A.prototype.getLayersArray=function(e){const t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},A.prototype.getLayerStatesArray=function(e){const t=void 0!==e?e:[],s=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});const n=this.getLayerState();for(let e=s,i=t.length;e<i;e++){const s=t[e];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=(0,c.getIntersection)(s.extent,n.extent):s.extent=n.extent)}return t},A.prototype.getSourceState=function(){return p.default.READY},exports.default=A;
},{"../index.js":94,"../Collection.js":109,"../CollectionEventType.js":187,"../Object.js":145,"../ObjectEventType.js":188,"../asserts.js":111,"../events.js":153,"../events/EventType.js":155,"../extent.js":140,"../layer/Base.js":168,"../obj.js":96,"../source/State.js":154}],149:[function(require,module,exports) {
"use strict";function r(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]+2*e,t[1]=r[1]+2*e,t}function e(r){return r[0]>0&&r[1]>0}function t(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function o(r,e){return Array.isArray(r)?r:(void 0===e?e=[r,r]:e[0]=e[1]=r,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=r,exports.hasArea=e,exports.scale=t,exports.toSize=o;
},{}],95:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./Collection.js"),i=N(t),n=require("./CollectionEventType.js"),r=N(n),s=require("./MapBrowserEvent.js"),o=N(s),a=require("./MapBrowserEventHandler.js"),l=N(a),h=require("./MapBrowserEventType.js"),d=N(h),u=require("./MapEvent.js"),p=N(u),y=require("./MapEventType.js"),f=N(y),c=require("./MapProperty.js"),v=N(c),_=require("./Object.js"),E=N(_),g=require("./ObjectEventType.js"),m=N(g),T=require("./TileQueue.js"),w=N(T),C=require("./View.js"),R=N(C),S=require("./ViewHint.js"),x=N(S),I=require("./asserts.js"),L=require("./dom.js"),A=require("./events.js"),P=require("./events/Event.js"),O=require("./events/EventType.js"),F=N(O),K=require("./extent.js"),M=require("./functions.js"),D=require("./has.js"),G=require("./layer/Group.js"),q=N(G),H=require("./size.js"),j=require("./structs/PriorityQueue.js"),B=require("./transform.js");function N(e){return e&&e.__esModule?e:{default:e}}const W=function(e){E.default.call(this);const t=b(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:D.DEVICE_PIXEL_RATIO,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=(0,B.create)(),this.pixelToCoordinateTransform_=(0,B.create)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(D.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";const n=[F.default.CLICK,F.default.DBLCLICK,F.default.MOUSEDOWN,F.default.TOUCHSTART,F.default.MSPOINTERDOWN,d.default.POINTERDOWN,F.default.MOUSEWHEEL,F.default.WHEEL];for(let e=0,t=n.length;e<t;++e)(0,A.listen)(this.overlayContainerStopEvent_,n[e],P.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new l.default(this,e.moveTolerance);for(const e in d.default)(0,A.listen)(this.mapBrowserEventHandler_,d.default[e],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=t.keyboardEventTarget,this.keyHandlerKeys_=null,(0,A.listen)(this.viewport_,F.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,A.listen)(this.viewport_,F.default.WHEEL,this.handleBrowserEvent,this),(0,A.listen)(this.viewport_,F.default.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=t.controls||new i.default,this.interactions=t.interactions||new i.default,this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(this.viewport_,this),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new w.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},(0,A.listen)(this,(0,_.getChangeEventType)(v.default.LAYERGROUP),this.handleLayerGroupChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.VIEW),this.handleViewChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.SIZE),this.handleSizeChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.TARGET),this.handleTargetChanged_,this),this.setProperties(t.values),this.controls.forEach(function(e){e.setMap(this)}.bind(this)),(0,A.listen)(this.controls,r.default.ADD,function(e){e.element.setMap(this)},this),(0,A.listen)(this.controls,r.default.REMOVE,function(e){e.element.setMap(null)},this),this.interactions.forEach(function(e){e.setMap(this)}.bind(this)),(0,A.listen)(this.interactions,r.default.ADD,function(e){e.element.setMap(this)},this),(0,A.listen)(this.interactions,r.default.REMOVE,function(e){e.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),(0,A.listen)(this.overlays_,r.default.ADD,function(e){this.addOverlayInternal_(e.element)},this),(0,A.listen)(this.overlays_,r.default.REMOVE,function(e){const t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)},this)};function b(e){let t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);const n={},r=e.layers instanceof q.default?e.layers:new q.default({layers:e.layers});let s,o,a;return n[v.default.LAYERGROUP]=r,n[v.default.TARGET]=e.target,n[v.default.VIEW]=void 0!==e.view?e.view:new R.default,void 0!==e.controls&&(Array.isArray(e.controls)?s=new i.default(e.controls.slice()):((0,I.assert)(e.controls instanceof i.default,47),s=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?o=new i.default(e.interactions.slice()):((0,I.assert)(e.interactions instanceof i.default,48),o=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?a=new i.default(e.overlays.slice()):((0,I.assert)(e.overlays instanceof i.default,49),a=e.overlays):a=new i.default,{controls:s,interactions:o,keyboardEventTarget:t,overlays:a,values:n}}(0,e.inherits)(W,E.default),W.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},W.prototype.addControl=function(e){this.getControls().push(e)},W.prototype.addInteraction=function(e){this.getInteractions().push(e)},W.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},W.prototype.addOverlay=function(e){this.getOverlays().push(e)},W.prototype.addOverlayInternal_=function(e){const t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},W.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),(0,A.unlisten)(this.viewport_,F.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,A.unlisten)(this.viewport_,F.default.WHEEL,this.handleBrowserEvent,this),(0,A.unlisten)(this.viewport_,F.default.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(F.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),E.default.prototype.disposeInternal.call(this)},W.prototype.forEachFeatureAtPixel=function(e,t,i){if(!this.frameState_)return;const n=this.getCoordinateFromPixel(e),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,s=void 0!==i.layerFilter?i.layerFilter:M.TRUE;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,t,null,s,null)},W.prototype.getFeaturesAtPixel=function(e,t){let i=null;return this.forEachFeatureAtPixel(e,function(e){i||(i=[]),i.push(e)},t),i},W.prototype.forEachLayerAtPixel=function(e,t,i,n,r){if(!this.frameState_)return;const s=void 0!==i?i:null,o=void 0!==n?n:M.TRUE,a=void 0!==r?r:null;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,t,s,o,a)},W.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;const i=this.getCoordinateFromPixel(e),n=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:M.TRUE,r=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},W.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},W.prototype.getEventPixel=function(e){const t=this.viewport_.getBoundingClientRect(),i=e.changedTouches?e.changedTouches[0]:e;return[i.clientX-t.left,i.clientY-t.top]},W.prototype.getTarget=function(){return this.get(v.default.TARGET)},W.prototype.getTargetElement=function(){const e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},W.prototype.getCoordinateFromPixel=function(e){const t=this.frameState_;return t?(0,B.apply)(t.pixelToCoordinateTransform,e.slice()):null},W.prototype.getControls=function(){return this.controls},W.prototype.getOverlays=function(){return this.overlays_},W.prototype.getOverlayById=function(e){const t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},W.prototype.getInteractions=function(){return this.interactions},W.prototype.getLayerGroup=function(){return this.get(v.default.LAYERGROUP)},W.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},W.prototype.getPixelFromCoordinate=function(e){const t=this.frameState_;return t?(0,B.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null},W.prototype.getRenderer=function(){return this.renderer_},W.prototype.getSize=function(){return this.get(v.default.SIZE)},W.prototype.getView=function(){return this.get(v.default.VIEW)},W.prototype.getViewport=function(){return this.viewport_},W.prototype.getOverlayContainer=function(){return this.overlayContainer_},W.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},W.prototype.getTilePriority=function(e,t,i,n){const r=this.frameState_;if(!(r&&t in r.wantedTiles))return j.DROP;if(!r.wantedTiles[t][e.getKey()])return j.DROP;const s=i[0]-r.focus[0],o=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(s*s+o*o)/n},W.prototype.handleBrowserEvent=function(e,t){const i=t||e.type,n=new o.default(i,this,e);this.handleMapBrowserEvent(n)},W.prototype.handleMapBrowserEvent=function(e){if(!this.frameState_)return;this.focus_=e.coordinate,e.frameState=this.frameState_;const t=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(let i=t.length-1;i>=0;i--){const n=t[i];if(n.getActive()&&!n.handleEvent(e))break}},W.prototype.handlePostRender=function(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,n=i;if(e){const t=e.viewHints;t[x.default.ANIMATING]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),t[x.default.INTERACTING]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,n))}const i=this.postRenderFunctions_;for(let t=0,n=i.length;t<n;++t)i[t](this,e);i.length=0},W.prototype.handleSizeChanged_=function(){this.render()},W.prototype.handleTargetChanged_=function(){let e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(let e=0,t=this.keyHandlerKeys_.length;e<t;++e)(0,A.unlistenByKey)(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_);const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[(0,A.listen)(t,F.default.KEYDOWN,this.handleBrowserEvent,this),(0,A.listen)(t,F.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(F.default.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),(0,L.removeNode)(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(F.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},W.prototype.handleTileChange_=function(){this.render()},W.prototype.handleViewPropertyChanged_=function(){this.render()},W.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&((0,A.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,A.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.viewport_.setAttribute("data-view",(0,e.getUid)(t)),this.viewPropertyListenerKey_=(0,A.listen)(t,m.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,A.listen)(t,F.default.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},W.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(A.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[(0,A.listen)(e,m.default.PROPERTYCHANGE,this.render,this),(0,A.listen)(e,F.default.CHANGE,this.render,this)]),this.render()},W.prototype.isRendered=function(){return!!this.frameState_},W.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},W.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},W.prototype.removeControl=function(e){return this.getControls().remove(e)},W.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},W.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},W.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},W.prototype.renderFrame_=function(t){let i;const n=this.getSize(),r=this.getView(),s=(0,K.createEmpty)(),o=this.frameState_;let a=null;if(void 0!==n&&(0,H.hasArea)(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),h={};for(let t=0,i=l.length;t<i;++t)h[(0,e.getUid)(l[t].layer)]=l[t];i=r.getState();let d=this.focus_;if(!d){d=i.center;const e=i.resolution/this.pixelRatio_;d[0]=Math.round(d[0]/e)*e,d[1]=Math.round(d[1]/e)*e}a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:s,focus:d,index:this.frameIndex_++,layerStates:h,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:i,viewHints:o,wantedTiles:{}}}if(a&&(a.extent=(0,K.getForViewAndSize)(i.center,i.resolution,i.rotation,a.size,s)),this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),o){(!this.previousExtent_||!(0,K.isEmpty)(this.previousExtent_)&&!(0,K.equals)(a.extent,this.previousExtent_))&&(this.dispatchEvent(new p.default(f.default.MOVESTART,this,o)),this.previousExtent_=(0,K.createOrUpdateEmpty)(this.previousExtent_))}this.previousExtent_&&!a.viewHints[x.default.ANIMATING]&&!a.viewHints[x.default.INTERACTING]&&!(0,K.equals)(a.extent,this.previousExtent_)&&(this.dispatchEvent(new p.default(f.default.MOVEEND,this,a)),(0,K.clone)(a.extent,this.previousExtent_))}this.dispatchEvent(new p.default(f.default.POSTRENDER,this,a)),setTimeout(this.handlePostRender.bind(this),0)},W.prototype.setLayerGroup=function(e){this.set(v.default.LAYERGROUP,e)},W.prototype.setSize=function(e){this.set(v.default.SIZE,e)},W.prototype.setTarget=function(e){this.set(v.default.TARGET,e)},W.prototype.setView=function(e){this.set(v.default.VIEW,e)},W.prototype.skipFeature=function(t){const i=(0,e.getUid)(t).toString();this.skippedFeatureUids_[i]=!0,this.render()},W.prototype.updateSize=function(){const e=this.getTargetElement();if(e){const t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0)},W.prototype.unskipFeature=function(t){const i=(0,e.getUid)(t).toString();delete this.skippedFeatureUids_[i],this.render()},exports.default=W;
},{"./index.js":94,"./Collection.js":109,"./CollectionEventType.js":187,"./MapBrowserEvent.js":231,"./MapBrowserEventHandler.js":300,"./MapBrowserEventType.js":160,"./MapEvent.js":258,"./MapEventType.js":201,"./MapProperty.js":301,"./Object.js":145,"./ObjectEventType.js":188,"./TileQueue.js":228,"./View.js":49,"./ViewHint.js":186,"./asserts.js":111,"./dom.js":148,"./events.js":153,"./events/Event.js":183,"./events/EventType.js":155,"./extent.js":140,"./functions.js":144,"./has.js":225,"./layer/Group.js":65,"./size.js":149,"./structs/PriorityQueue.js":265,"./transform.js":214}],230:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../functions.js"),s=require("../MapEventType.js"),r=a(s),n=require("../Object.js"),i=a(n),l=require("../dom.js"),o=require("../events.js");function a(e){return e&&e.__esModule?e:{default:e}}const u=function(e){i.default.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:t.UNDEFINED,e.target&&this.setTarget(e.target)};(0,e.inherits)(u,i.default),u.prototype.disposeInternal=function(){(0,l.removeNode)(this.element),i.default.prototype.disposeInternal.call(this)},u.prototype.getMap=function(){return this.map_},u.prototype.setMap=function(e){this.map_&&(0,l.removeNode)(this.element);for(let e=0,t=this.listenerKeys.length;e<t;++e)(0,o.unlistenByKey)(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=e,this.map_){(this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==t.UNDEFINED&&this.listenerKeys.push((0,o.listen)(e,r.default.POSTRENDER,this.render,this)),e.render()}},u.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},exports.default=u;
},{"../index.js":94,"../functions.js":144,"../MapEventType.js":201,"../Object.js":145,"../dom.js":148,"../events.js":153}],203:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.CLASS_HIDDEN="ol-hidden",t=exports.CLASS_SELECTABLE="ol-selectable",o=exports.CLASS_UNSELECTABLE="ol-unselectable",l=exports.CLASS_UNSUPPORTED="ol-unsupported",n=exports.CLASS_CONTROL="ol-control",s=exports.CLASS_COLLAPSED="ol-collapsed",r=exports.getFontFamilies=function(){let e;const t={};return function(o){if(e||(e=document.createElement("div").style),!(o in t)){e.font=o;const l=e.fontFamily;if(e.font="",!l)return null;t[o]=l.split(/,\s?/)}return t[o]}}();
},{}],170:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"};
},{}],68:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.visibleAtResolution=f;var e=require("../events.js"),t=require("../events/EventType.js"),s=d(t),r=require("../index.js"),n=require("../Object.js"),o=require("../layer/Base.js"),i=d(o),u=require("../layer/Property.js"),a=d(u),h=require("../obj.js"),l=require("../render/EventType.js"),c=d(l),p=require("../source/State.js"),y=d(p);function d(e){return e&&e.__esModule?e:{default:e}}const g=function(t){const s=(0,h.assign)({},t);delete s.source,i.default.call(this,s),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,t.map&&this.setMap(t.map),(0,e.listen)(this,(0,n.getChangeEventType)(a.default.SOURCE),this.handleSourcePropertyChange_,this);const r=t.source?t.source:null;this.setSource(r)};function f(e,t){return e.visible&&t>=e.minResolution&&t<e.maxResolution}(0,r.inherits)(g,i.default),g.prototype.getLayersArray=function(e){const t=e||[];return t.push(this),t},g.prototype.getLayerStatesArray=function(e){const t=e||[];return t.push(this.getLayerState()),t},g.prototype.getSource=function(){return this.get(a.default.SOURCE)||null},g.prototype.getSourceState=function(){const e=this.getSource();return e?e.getState():y.default.UNDEFINED},g.prototype.handleSourceChange_=function(){this.changed()},g.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&((0,e.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null);const t=this.getSource();t&&(this.sourceChangeKey_=(0,e.listen)(t,s.default.CHANGE,this.handleSourceChange_,this)),this.changed()},g.prototype.setMap=function(t){this.mapPrecomposeKey_&&((0,e.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&((0,e.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=(0,e.listen)(t,c.default.PRECOMPOSE,function(e){const t=this.getLayerState();t.managed=!1,t.zIndex=1/0,e.frameState.layerStatesArray.push(t),e.frameState.layerStates[(0,r.getUid)(this)]=t},this),this.mapRenderKey_=(0,e.listen)(this,s.default.CHANGE,t.render,t),this.changed())},g.prototype.setSource=function(e){this.set(a.default.SOURCE,e)},exports.default=g;
},{"../events.js":153,"../events/EventType.js":155,"../index.js":94,"../Object.js":145,"../layer/Base.js":168,"../layer/Property.js":169,"../obj.js":96,"../render/EventType.js":170,"../source/State.js":154}],141:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=h;var e=require("../index.js"),t=require("../array.js"),l=require("../control/Control.js"),s=p(l),i=require("../css.js"),o=require("../dom.js"),n=require("../events.js"),a=require("../events/EventType.js"),r=p(a),c=require("../layer/Layer.js");function p(e){return e&&e.__esModule?e:{default:e}}const d=function(e){const t=e||{};this.ulElement_=document.createElement("UL"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const l=void 0!==t.className?t.className:"ol-attribution",o=void 0!==t.tipLabel?t.tipLabel:"Attributions",a=void 0!==t.collapseLabel?t.collapseLabel:"»";"string"==typeof a?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a):this.collapseLabel_=a;const c=void 0!==t.label?t.label:"i";"string"==typeof c?(this.label_=document.createElement("span"),this.label_.textContent=c):this.label_=c;const p=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,d=document.createElement("button");d.setAttribute("type","button"),d.title=o,d.appendChild(p),(0,n.listen)(d,r.default.CLICK,this.handleClick_,this);const u=l+" "+i.CLASS_UNSELECTABLE+" "+i.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+i.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),_=document.createElement("div");_.className=u,_.appendChild(this.ulElement_),_.appendChild(d),s.default.call(this,{element:_,render:t.render||h,target:t.target}),this.renderedAttributions_=[],this.renderedVisible_=!0};function h(e){this.updateElement_(e.frameState)}(0,e.inherits)(d,s.default),d.prototype.getSourceAttributions_=function(e){const t={},l=[],s=e.layerStatesArray,i=e.viewState.resolution;for(let o=0,n=s.length;o<n;++o){const n=s[o];if(!(0,c.visibleAtResolution)(n,i))continue;const a=n.layer.getSource();if(!a)continue;const r=a.getAttributions();if(!r)continue;const p=r(e);if(p)if(Array.isArray(p))for(let e=0,s=p.length;e<s;++e)p[e]in t||(l.push(p[e]),t[p[e]]=!0);else p in t||(l.push(p),t[p]=!0)}return l},d.prototype.updateElement_=function(e){if(!e)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const l=this.getSourceAttributions_(e),s=l.length>0;if(this.renderedVisible_!=s&&(this.element.style.display=s?"":"none",this.renderedVisible_=s),!(0,t.equals)(l,this.renderedAttributions_)){(0,o.removeChildren)(this.ulElement_);for(let e=0,t=l.length;e<t;++e){const t=document.createElement("LI");t.innerHTML=l[e],this.ulElement_.appendChild(t)}this.renderedAttributions_=l}},d.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},d.prototype.handleToggle_=function(){this.element.classList.toggle(i.CLASS_COLLAPSED),this.collapsed_?(0,o.replaceNode)(this.collapseLabel_,this.label_):(0,o.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},d.prototype.getCollapsible=function(){return this.collapsible_},d.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},d.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},d.prototype.getCollapsed=function(){return this.collapsed_},exports.default=d;
},{"../index.js":94,"../array.js":171,"../control/Control.js":230,"../css.js":203,"../dom.js":148,"../events.js":153,"../events/EventType.js":155,"../layer/Layer.js":68}],142:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=c;var t=require("../control/Control.js"),e=r(t),s=require("../css.js"),i=require("../easing.js"),a=require("../events.js"),o=require("../events/EventType.js"),l=r(o),n=require("../index.js");function r(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const i=t||{},o=void 0!==i.className?i.className:"ol-rotate",n=void 0!==i.label?i.label:"⇧";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=n):(this.label_=n,this.label_.classList.add("ol-compass"));const r=i.tipLabel?i.tipLabel:"Reset rotation",h=document.createElement("button");h.className=o+"-reset",h.setAttribute("type","button"),h.title=r,h.appendChild(this.label_),(0,a.listen)(h,l.default.CLICK,d.prototype.handleClick_,this);const u=o+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,_=document.createElement("div");_.className=u,_.appendChild(h),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,e.default.call(this,{element:_,render:i.render||c,target:i.target}),this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(s.CLASS_HIDDEN)};function c(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(s.CLASS_HIDDEN);t||0!==i?t&&0!==i&&this.element.classList.remove(s.CLASS_HIDDEN):this.element.classList.add(s.CLASS_HIDDEN)}this.label_.style.msTransform=t,this.label_.style.webkitTransform=t,this.label_.style.transform=t}this.rotation_=i}(0,n.inherits)(d,e.default),d.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},d.prototype.resetNorth_=function(){const t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:i.easeOut}):t.setRotation(0))},exports.default=d;
},{"../control/Control.js":230,"../css.js":203,"../easing.js":174,"../events.js":153,"../events/EventType.js":155,"../index.js":94}],143:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../events.js"),o=require("../events/EventType.js"),n=u(o),i=require("../control/Control.js"),a=u(i),s=require("../css.js"),l=require("../easing.js");function u(e){return e&&e.__esModule?e:{default:e}}const r=function(e){const o=e||{},i=void 0!==o.className?o.className:"ol-zoom",l=void 0!==o.delta?o.delta:1,u=void 0!==o.zoomInLabel?o.zoomInLabel:"+",d=void 0!==o.zoomOutLabel?o.zoomOutLabel:"−",c=void 0!==o.zoomInTipLabel?o.zoomInTipLabel:"Zoom in",m=void 0!==o.zoomOutTipLabel?o.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=i+"-in",p.setAttribute("type","button"),p.title=c,p.appendChild("string"==typeof u?document.createTextNode(u):u),(0,t.listen)(p,n.default.CLICK,r.prototype.handleClick_.bind(this,l));const b=document.createElement("button");b.className=i+"-out",b.setAttribute("type","button"),b.title=m,b.appendChild("string"==typeof d?document.createTextNode(d):d),(0,t.listen)(b,n.default.CLICK,r.prototype.handleClick_.bind(this,-l));const f=i+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,h=document.createElement("div");h.className=f,h.appendChild(p),h.appendChild(b),a.default.call(this,{element:h,target:o.target}),this.duration_=void 0!==o.duration?o.duration:250};(0,e.inherits)(r,a.default),r.prototype.handleClick_=function(e,t){t.preventDefault(),this.zoomByDelta_(e)},r.prototype.zoomByDelta_=function(e){const t=this.getMap().getView();if(!t)return;const o=t.getResolution();if(o){const n=t.constrainResolution(o,e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:n,duration:this.duration_,easing:l.easeOut})):t.setResolution(n)}},exports.default=r;
},{"../index.js":94,"../events.js":153,"../events/EventType.js":155,"../control/Control.js":230,"../css.js":203,"../easing.js":174}],97:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=d;var t=require("../Collection.js"),e=a(t),o=require("./Attribution.js"),r=a(o),u=require("./Rotate.js"),i=a(u),n=require("./Zoom.js"),s=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function d(t){const o=t||{},u=new e.default;return(void 0===o.zoom||o.zoom)&&u.push(new s.default(o.zoomOptions)),(void 0===o.rotate||o.rotate)&&u.push(new i.default(o.rotateOptions)),(void 0===o.attribution||o.attribution)&&u.push(new r.default(o.attributionOptions)),u}
},{"../Collection.js":109,"./Attribution.js":141,"./Rotate.js":142,"./Zoom.js":143}],110:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0};t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;let n=i-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const s=this.points_[i+2]-this.points_[n+2];if(s<1e3/60)return!1;const e=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,e),this.initialVelocity_=Math.sqrt(e*e+o*o)/s,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},exports.default=t;
},{}],212:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ACTIVE:"active"};
},{}],126:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pan=c,exports.rotate=l,exports.rotateWithoutConstraints=f,exports.zoom=p,exports.zoomByDelta=d,exports.zoomWithoutConstraints=g;var t=require("../index.js"),e=require("../Object.js"),n=a(e),o=require("../easing.js"),i=require("../interaction/Property.js"),s=a(i),r=require("../math.js");function a(t){return t&&t.__esModule?t:{default:t}}const u=function(t){n.default.call(this),this.map_=null,this.setActive(!0),this.handleEvent=t.handleEvent};function c(t,e,n){const i=t.getCenter();if(i){const s=t.constrainCenter([i[0]+e[0],i[1]+e[1]]);n?t.animate({duration:n,easing:o.linear,center:s}):t.setCenter(s)}}function l(t,e,n,o){f(t,e=t.constrainRotation(e,0),n,o)}function f(t,e,n,i){if(void 0!==e){const s=t.getRotation(),r=t.getCenter();void 0!==s&&r&&i>0?t.animate({rotation:e,anchor:n,duration:i,easing:o.easeOut}):t.rotate(e,n)}}function p(t,e,n,o,i){g(t,e=t.constrainResolution(e,0,i),n,o)}function d(t,e,n,o){const i=t.getResolution();let s=t.constrainResolution(i,e,0);if(void 0!==s){const e=t.getResolutions();s=(0,r.clamp)(s,t.getMinResolution()||e[e.length-1],t.getMaxResolution()||e[0])}if(n&&void 0!==s&&s!==i){const e=t.getCenter();let o=t.calculateCenterZoom(s,n);o=t.constrainCenter(o),n=[(s*e[0]-i*o[0])/(s-i),(s*e[1]-i*o[1])/(s-i)]}g(t,s,n,o)}function g(t,e,n,i){if(e){const s=t.getResolution(),r=t.getCenter();if(void 0!==s&&r&&e!==s&&i)t.animate({resolution:e,anchor:n,duration:i,easing:o.easeOut});else{if(n){const o=t.calculateCenterZoom(e,n);t.setCenter(o)}t.setResolution(e)}}}(0,t.inherits)(u,n.default),u.prototype.getActive=function(){return this.get(s.default.ACTIVE)},u.prototype.getMap=function(){return this.map_},u.prototype.setActive=function(t){this.set(s.default.ACTIVE,t)},u.prototype.setMap=function(t){this.map_=t},exports.default=u;
},{"../index.js":94,"../Object.js":145,"../easing.js":174,"../interaction/Property.js":212,"../math.js":157}],112:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../MapBrowserEventType.js"),i=a(e),n=require("../interaction/Interaction.js"),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}const o=function(t){const e=t||{};this.delta_=e.delta?e.delta:1,r.default.call(this,{handleEvent:s}),this.duration_=void 0!==e.duration?e.duration:250};function s(t){let e=!1;const r=t.originalEvent;if(t.type==i.default.DBLCLICK){const i=t.map,a=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_,s=i.getView();(0,n.zoomByDelta)(s,o,a,this.duration_),t.preventDefault(),e=!0}return!e}(0,t.inherits)(o,r.default),exports.default=o;
},{"../index.js":94,"../MapBrowserEventType.js":160,"../interaction/Interaction.js":126}],173:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.primaryAction=exports.mouseOnly=exports.targetNotEditable=exports.shiftKeyOnly=exports.platformModifierKeyOnly=exports.noModifierKeys=exports.doubleClick=exports.singleClick=exports.pointerMove=exports.never=exports.mouseActionButton=exports.click=exports.always=exports.focus=exports.altShiftKeysOnly=exports.altKeyOnly=void 0;var e=require("../MapBrowserEventType.js"),t=s(e),r=require("../asserts.js"),n=require("../functions.js"),o=require("../has.js");function s(e){return e&&e.__esModule?e:{default:e}}const i=exports.altKeyOnly=function(e){const t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},l=exports.altShiftKeysOnly=function(e){const t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},u=exports.focus=function(e){return e.target.getTargetElement()===document.activeElement},y=exports.always=n.TRUE,p=exports.click=function(e){return e.type==t.default.CLICK},a=exports.mouseActionButton=function(e){const t=e.originalEvent;return 0==t.button&&!(o.WEBKIT&&o.MAC&&t.ctrlKey)},c=exports.never=n.FALSE,f=exports.pointerMove=function(e){return"pointermove"==e.type},K=exports.singleClick=function(e){return e.type==t.default.SINGLECLICK},x=exports.doubleClick=function(e){return e.type==t.default.DBLCLICK},E=exports.noModifierKeys=function(e){const t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},m=exports.platformModifierKeyOnly=function(e){const t=e.originalEvent;return!t.altKey&&(o.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},v=exports.shiftKeyOnly=function(e){const t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},d=exports.targetNotEditable=function(e){const t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t},g=exports.mouseOnly=function(e){return(0,r.assert)(e.pointerEvent,56),"mouse"==e.pointerEvent.pointerType},C=exports.primaryAction=function(e){const t=e.pointerEvent;return t.isPrimary&&0===t.button};
},{"../MapBrowserEventType.js":160,"../asserts.js":111,"../functions.js":144,"../has.js":225}],128:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.centroid=f,exports.handleEvent=P;var e=require("../index.js"),t=require("../functions.js"),n=require("../MapBrowserEventType.js"),i=l(n),r=require("../MapBrowserPointerEvent.js"),s=l(r),o=require("../interaction/Interaction.js"),a=l(o),d=require("../obj.js");function l(e){return e&&e.__esModule?e:{default:e}}const h=t.UNDEFINED,u=t.FALSE,E=t.FALSE,c=t.UNDEFINED,p=function(e){const t=e||{};a.default.call(this,{handleEvent:t.handleEvent||P}),this.handleDownEvent_=t.handleDownEvent?t.handleDownEvent:E,this.handleDragEvent_=t.handleDragEvent?t.handleDragEvent:h,this.handleMoveEvent_=t.handleMoveEvent?t.handleMoveEvent:c,this.handleUpEvent_=t.handleUpEvent?t.handleUpEvent:u,this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]};function f(e){const t=e.length;let n=0,i=0;for(let r=0;r<t;r++)n+=e[r].clientX,i+=e[r].clientY;return[n/t,i/t]}function v(e){const t=e.type;return t===i.default.POINTERDOWN||t===i.default.POINTERDRAG||t===i.default.POINTERUP}function P(e){if(!(e instanceof s.default))return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==i.default.POINTERDRAG)this.handleDragEvent_(e);else if(e.type==i.default.POINTERUP){const t=this.handleUpEvent_(e);this.handlingDownUpSequence=t&&this.targetPointers.length>0}}else if(e.type==i.default.POINTERDOWN){const n=this.handleDownEvent_(e);this.handlingDownUpSequence=n,t=this.shouldStopEvent(n)}else e.type==i.default.POINTERMOVE&&this.handleMoveEvent_(e);return!t}(0,e.inherits)(p,a.default),p.prototype.updateTrackedPointers_=function(e){if(v(e)){const t=e.pointerEvent,n=t.pointerId.toString();e.type==i.default.POINTERUP?delete this.trackedPointers_[n]:e.type==i.default.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=(0,d.getValues)(this.trackedPointers_)}},p.prototype.shouldStopEvent=function(e){return e},exports.default=p;
},{"../index.js":94,"../functions.js":144,"../MapBrowserEventType.js":160,"../MapBrowserPointerEvent.js":207,"../interaction/Interaction.js":126,"../obj.js":96}],113:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../ViewHint.js"),i=h(e),n=require("../coordinate.js"),s=require("../easing.js"),o=require("../events/condition.js"),r=require("../functions.js"),a=require("../interaction/Pointer.js"),c=h(a);function h(t){return t&&t.__esModule?t:{default:t}}const l=function(t){c.default.call(this,{handleDownEvent:g,handleDragEvent:u,handleUpEvent:d});const e=t||{};this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=e.condition?e.condition:o.noModifierKeys,this.noKinetic_=!1};function u(t){const e=this.targetPointers,i=(0,a.centroid)(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=this.lastCentroid[0]-i[0],s=i[1]-this.lastCentroid[1],o=t.map.getView();let r=[e,s];(0,n.scale)(r,o.getResolution()),(0,n.rotate)(r,o.getRotation()),(0,n.add)(r,o.getCenter()),r=o.constrainCenter(r),o.setCenter(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length}function d(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenter(),r=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([r[0]-t*Math.cos(i),r[1]-t*Math.sin(i)]);n.animate({center:n.constrainCenter(a),duration:500,easing:s.easeOut})}return n.setHint(i.default.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function g(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(i.default.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}(0,t.inherits)(l,c.default),l.prototype.shouldStopEvent=r.FALSE,exports.default=l;
},{"../index.js":94,"../ViewHint.js":186,"../coordinate.js":179,"../easing.js":174,"../events/condition.js":173,"../functions.js":144,"../interaction/Pointer.js":128}],116:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),n=require("../rotationconstraint.js"),e=require("../ViewHint.js"),i=l(e),o=require("../events/condition.js"),r=require("../functions.js"),s=require("../interaction/Interaction.js"),a=require("../interaction/Pointer.js"),u=l(a);function l(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const n=t||{};u.default.call(this,{handleDownEvent:h,handleDragEvent:c,handleUpEvent:f}),this.condition_=n.condition?n.condition:o.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==n.duration?n.duration:250};function c(t){if(!(0,o.mouseOnly)(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===n.disable)return;const r=e.getSize(),a=t.pixel,u=Math.atan2(r[1]/2-a[1],a[0]-r[0]/2);if(void 0!==this.lastAngle_){const t=u-this.lastAngle_,n=i.getRotation();(0,s.rotateWithoutConstraints)(i,n-t)}this.lastAngle_=u}function f(t){if(!(0,o.mouseOnly)(t))return!0;const n=t.map.getView();n.setHint(i.default.INTERACTING,-1);const e=n.getRotation();return(0,s.rotate)(n,e,void 0,this.duration_),!1}function h(t){if(!(0,o.mouseOnly)(t))return!1;if((0,o.mouseActionButton)(t)&&this.condition_(t)){return t.map.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,!0}return!1}(0,t.inherits)(d,u.default),d.prototype.shouldStopEvent=r.FALSE,exports.default=d;
},{"../index.js":94,"../rotationconstraint.js":185,"../ViewHint.js":186,"../events/condition.js":173,"../functions.js":144,"../interaction/Interaction.js":126,"../interaction/Pointer.js":128}],204:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Disposable.js"),i=o(t),s=require("../geom/Polygon.js"),n=o(s);function o(e){return e&&e.__esModule?e:{default:e}}const r=function(e){this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null};(0,e.inherits)(r,i.default),r.prototype.disposeInternal=function(){this.setMap(null)},r.prototype.render_=function(){const e=this.startPixel_,t=this.endPixel_,i=this.element_.style;i.left=Math.min(e[0],t[0])+"px",i.top=Math.min(e[1],t[1])+"px",i.width=Math.abs(t[0]-e[0])+"px",i.height=Math.abs(t[1]-e[1])+"px"},r.prototype.setMap=function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},r.prototype.setPixels=function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()},r.prototype.createOrUpdateGeometry=function(){const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new n.default([i])},r.prototype.getGeometry=function(){return this.geometry_},exports.default=r;
},{"../index.js":94,"../Disposable.js":245,"../geom/Polygon.js":197}],121:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../events/Event.js"),e=l(t),n=require("../index.js"),i=require("../events/condition.js"),o=require("../functions.js"),s=require("../interaction/Pointer.js"),r=l(s),a=require("../render/Box.js"),d=l(a);function l(t){return t&&t.__esModule?t:{default:t}}const u={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},h=function(t,n,i){e.default.call(this,t),this.coordinate=n,this.mapBrowserEvent=i};(0,n.inherits)(h,e.default);const c=function(t){r.default.call(this,{handleDownEvent:E,handleDragEvent:_,handleUpEvent:p});const e=t||{};this.box_=new d.default(e.className||"ol-dragbox"),this.minArea_=void 0!==e.minArea?e.minArea:64,this.startPixel_=null,this.condition_=e.condition?e.condition:i.always,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:x};function x(t,e,n){const i=n[0]-e[0],o=n[1]-e[1];return i*i+o*o>=this.minArea_}function _(t){(0,i.mouseOnly)(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new h(u.BOXDRAG,t.coordinate,t)))}function p(t){return!(0,i.mouseOnly)(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new h(u.BOXEND,t.coordinate,t))),!1)}function E(t){return!!(0,i.mouseOnly)(t)&&(!(!(0,i.mouseActionButton)(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new h(u.BOXSTART,t.coordinate,t)),!0))}(0,n.inherits)(c,r.default),c.prototype.getGeometry=function(){return this.box_.getGeometry()},c.prototype.onBoxEnd=o.UNDEFINED,exports.default=c;
},{"../events/Event.js":183,"../index.js":94,"../events/condition.js":173,"../functions.js":144,"../interaction/Pointer.js":128,"../render/Box.js":204}],114:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../easing.js"),o=require("../events/condition.js"),n=require("../extent.js"),i=require("../interaction/DragBox.js"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}const a=function(t){const e=t||{},n=e.condition?e.condition:o.shiftKeyOnly;this.duration_=void 0!==e.duration?e.duration:200,this.out_=void 0!==e.out&&e.out,r.default.call(this,{condition:n,className:e.className||"ol-dragzoom"})};(0,t.inherits)(a,r.default),a.prototype.onBoxEnd=function(){const t=this.getMap(),o=t.getView(),i=t.getSize();let r=this.getGeometry().getExtent();if(this.out_){const e=o.calculateExtent(i),s=(0,n.createOrUpdateFromCoordinates)([t.getPixelFromCoordinate((0,n.getBottomLeft)(r)),t.getPixelFromCoordinate((0,n.getTopRight)(r))]),a=o.getResolutionForExtent(s,i);(0,n.scaleFromCenter)(e,1/a),r=e}const s=o.constrainResolution(o.getResolutionForExtent(r,i));let a=(0,n.getCenter)(r);a=o.constrainCenter(a),o.animate({resolution:s,center:a,duration:this.duration_,easing:e.easeOut})},exports.default=a;
},{"../index.js":94,"../easing.js":174,"../events/condition.js":173,"../extent.js":140,"../interaction/DragBox.js":121}],198:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LEFT:37,UP:38,RIGHT:39,DOWN:40};
},{}],115:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../coordinate.js"),i=require("../events/EventType.js"),n=l(i),o=require("../events/KeyCode.js"),d=l(o),a=require("../events/condition.js"),r=require("../interaction/Interaction.js"),u=l(r);function l(e){return e&&e.__esModule?e:{default:e}}const s=function(e){u.default.call(this,{handleEvent:f});const t=e||{};this.defaultCondition_=function(e){return(0,a.noModifierKeys)(e)&&(0,a.targetNotEditable)(e)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128};function f(e){let i=!1;if(e.type==n.default.KEYDOWN){const n=e.originalEvent.keyCode;if(this.condition_(e)&&(n==d.default.DOWN||n==d.default.LEFT||n==d.default.RIGHT||n==d.default.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let u=0,l=0;n==d.default.DOWN?l=-a:n==d.default.LEFT?u=-a:n==d.default.RIGHT?u=a:l=a;const s=[u,l];(0,t.rotate)(s,o.getRotation()),(0,r.pan)(o,s,this.duration_),e.preventDefault(),i=!0}}return!i}(0,e.inherits)(s,u.default),exports.default=s;
},{"../index.js":94,"../coordinate.js":179,"../events/EventType.js":155,"../events/KeyCode.js":198,"../events/condition.js":173,"../interaction/Interaction.js":126}],117:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../events/EventType.js"),i=r(e),n=require("../events/condition.js"),o=require("../interaction/Interaction.js"),d=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const a=function(t){d.default.call(this,{handleEvent:s});const e=t||{};this.condition_=e.condition?e.condition:n.targetNotEditable,this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:100};function s(t){let e=!1;if(t.type==i.default.KEYDOWN||t.type==i.default.KEYPRESS){const i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){const n=t.map,d=i=="+".charCodeAt(0)?this.delta_:-this.delta_,r=n.getView();(0,o.zoomByDelta)(r,d,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}(0,t.inherits)(a,d.default),exports.default=a;
},{"../index.js":94,"../events/EventType.js":155,"../events/condition.js":173,"../interaction/Interaction.js":126}],119:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mode=void 0;var t=require("../index.js"),e=require("../ViewHint.js"),i=c(e),o=require("../events/condition.js"),s=require("../easing.js"),n=require("../events/EventType.js"),a=c(n),r=require("../has.js"),h=require("../interaction/Interaction.js"),d=c(h),u=require("../math.js");function c(t){return t&&t.__esModule?t:{default:t}}const l=1,_=exports.Mode={TRACKPAD:"trackpad",WHEEL:"wheel"},m=function(t){d.default.call(this,{handleEvent:p});const e=t||{};this.delta_=0,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=e.constrainResolution||!1,this.condition_=e.condition?e.condition:o.always,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5};function p(t){if(!this.condition_(t))return!0;const e=t.type;if(e!==a.default.WHEEL&&e!==a.default.MOUSEWHEEL)return!0;t.preventDefault();const o=t.map,n=t.originalEvent;let h;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==a.default.WHEEL?(h=n.deltaY,r.FIREFOX&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(h/=r.DEVICE_PIXEL_RATIO),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(h*=40)):t.type==a.default.MOUSEWHEEL&&(h=-n.wheelDeltaY,r.SAFARI&&(h/=3)),0===h)return!1;const d=Date.now();if(void 0===this.startTime_&&(this.startTime_=d),(!this.mode_||d-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(h)<4?_.TRACKPAD:_.WHEEL),this.mode_===_.TRACKPAD){const t=o.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):t.setHint(i.default.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);let e=t.getResolution()*Math.pow(2,h/this.trackpadDeltaPerZoom_);const n=t.getMinResolution(),a=t.getMaxResolution();let r=0;if(e<n?(e=Math.max(e,n/this.trackpadZoomBuffer_),r=1):e>a&&(e=Math.min(e,a*this.trackpadZoomBuffer_),r=-1),this.lastAnchor_){const i=t.calculateCenterZoom(e,this.lastAnchor_);t.setCenter(t.constrainCenter(i))}return t.setResolution(e),0===r&&this.constrainResolution_&&t.animate({resolution:t.constrainResolution(e,h>0?-1:1),easing:s.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),r>0?t.animate({resolution:n,easing:s.easeOut,anchor:this.lastAnchor_,duration:500}):r<0&&t.animate({resolution:a,easing:s.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=d,!1}this.delta_+=h;const u=Math.max(this.timeout_-(d-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),u),!1}(0,t.inherits)(m,d.default),m.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(i.default.INTERACTING,-1)},m.prototype.handleWheelZoom_=function(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();const i=(0,u.clamp)(this.delta_,-1,1);(0,h.zoomByDelta)(e,-i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},m.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},exports.default=m;
},{"../index.js":94,"../ViewHint.js":186,"../events/condition.js":173,"../easing.js":174,"../events/EventType.js":155,"../has.js":225,"../interaction/Interaction.js":126,"../math.js":157}],118:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../ViewHint.js"),e=h(i),n=require("../functions.js"),o=require("../interaction/Interaction.js"),r=require("../interaction/Pointer.js"),s=h(r),a=require("../rotationconstraint.js");function h(t){return t&&t.__esModule?t:{default:t}}const l=function(t){s.default.call(this,{handleDownEvent:d,handleDragEvent:u,handleUpEvent:c});const i=t||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250};function u(t){let i=0;const e=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-e.clientY,n.clientX-e.clientX);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=t}this.lastAngle_=s;const h=t.map,l=h.getView();if(l.getConstraints().rotation===a.disable)return;const u=h.getViewport().getBoundingClientRect(),c=(0,r.centroid)(this.targetPointers);if(c[0]-=u.left,c[1]-=u.top,this.anchor_=h.getCoordinateFromPixel(c),this.rotating_){const t=l.getRotation();h.render(),(0,o.rotateWithoutConstraints)(l,t+i,this.anchor_)}}function c(t){if(this.targetPointers.length<2){const i=t.map.getView();if(i.setHint(e.default.INTERACTING,-1),this.rotating_){const t=i.getRotation();(0,o.rotate)(i,t,this.anchor_,this.duration_)}return!1}return!0}function d(t){if(this.targetPointers.length>=2){const i=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||i.getView().setHint(e.default.INTERACTING,1),!0}return!1}(0,t.inherits)(l,s.default),l.prototype.shouldStopEvent=n.FALSE,exports.default=l;
},{"../index.js":94,"../ViewHint.js":186,"../functions.js":144,"../interaction/Interaction.js":126,"../interaction/Pointer.js":128,"../rotationconstraint.js":185}],120:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../ViewHint.js"),n=r(e),i=require("../functions.js"),s=require("../interaction/Interaction.js"),o=require("../interaction/Pointer.js"),a=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const l=function(t){a.default.call(this,{handleDownEvent:h,handleDragEvent:c,handleUpEvent:u});const e=t||{};this.constrainResolution_=e.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1};function c(t){let e=1;const n=this.targetPointers[0],i=this.targetPointers[1],a=n.clientX-i.clientX,r=n.clientY-i.clientY,l=Math.sqrt(a*a+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/l),this.lastDistance_=l;const c=t.map,u=c.getView(),h=u.getResolution(),d=u.getMaxResolution(),g=u.getMinResolution();let _=h*e;_>d?(e=d/h,_=d):_<g&&(e=g/h,_=g),1!=e&&(this.lastScaleDelta_=e);const f=c.getViewport().getBoundingClientRect(),p=(0,o.centroid)(this.targetPointers);p[0]-=f.left,p[1]-=f.top,this.anchor_=c.getCoordinateFromPixel(p),c.render(),(0,s.zoomWithoutConstraints)(u,_,this.anchor_)}function u(t){if(this.targetPointers.length<2){const e=t.map.getView();e.setHint(n.default.INTERACTING,-1);const i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){const t=this.lastScaleDelta_-1;(0,s.zoom)(e,i,this.anchor_,this.duration_,t)}return!1}return!0}function h(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(n.default.INTERACTING,1),!0}return!1}(0,t.inherits)(l,a.default),l.prototype.shouldStopEvent=i.FALSE,exports.default=l;
},{"../index.js":94,"../ViewHint.js":186,"../functions.js":144,"../interaction/Interaction.js":126,"../interaction/Pointer.js":128}],122:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../functions.js"),s=require("../events.js"),r=require("../events/Event.js"),i=c(r),n=require("../events/EventType.js"),o=c(n),u=require("../interaction/Interaction.js"),a=c(u),l=require("../proj.js");function c(t){return t&&t.__esModule?t:{default:t}}const h={ADD_FEATURES:"addfeatures"},f=function(t,e,s,r){i.default.call(this,t),this.features=s,this.file=e,this.projection=r};(0,t.inherits)(f,i.default);const p=function(t){const s=t||{};a.default.call(this,{handleEvent:e.TRUE}),this.formatConstructors_=s.formatConstructors?s.formatConstructors:[],this.projection_=s.projection?(0,l.get)(s.projection):null,this.dropListenKeys_=null,this.source_=s.source||null,this.target=s.target?s.target:null};function d(t){const e=t.dataTransfer.files;for(let t=0,s=e.length;t<s;++t){const s=e.item(t),r=new FileReader;r.addEventListener(o.default.LOAD,this.handleResult_.bind(this,s)),r.readAsText(s)}}function _(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}(0,t.inherits)(p,a.default),p.prototype.handleResult_=function(t,e){const s=e.target.result,r=this.getMap();let i=this.projection_;if(!i){i=r.getView().getProjection()}const n=this.formatConstructors_;let o=[];for(let t=0,e=n.length;t<e;++t){const e=new(0,n[t]);if((o=this.tryReadFeatures_(e,s,{featureProjection:i}))&&o.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(o)),this.dispatchEvent(new f(h.ADD_FEATURES,t,o,i))},p.prototype.registerListeners_=function(){const t=this.getMap();if(t){const e=this.target?this.target:t.getViewport();this.dropListenKeys_=[(0,s.listen)(e,o.default.DROP,d,this),(0,s.listen)(e,o.default.DRAGENTER,_,this),(0,s.listen)(e,o.default.DRAGOVER,_,this),(0,s.listen)(e,o.default.DROP,_,this)]}},p.prototype.setActive=function(t){a.default.prototype.setActive.call(this,t),t?this.registerListeners_():this.unregisterListeners_()},p.prototype.setMap=function(t){this.unregisterListeners_(),a.default.prototype.setMap.call(this,t),this.getActive()&&this.registerListeners_()},p.prototype.tryReadFeatures_=function(t,e,s){try{return t.readFeatures(e,s)}catch(t){return null}},p.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(s.unlistenByKey),this.dropListenKeys_=null)},exports.default=p;
},{"../index.js":94,"../functions.js":144,"../events.js":153,"../events/Event.js":183,"../events/EventType.js":155,"../interaction/Interaction.js":126,"../proj.js":43}],123:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../rotationconstraint.js"),e=require("../ViewHint.js"),n=r(e),s=require("../events/condition.js"),o=require("../interaction/Interaction.js"),a=require("../interaction/Pointer.js"),l=r(a);function r(t){return t&&t.__esModule?t:{default:t}}const u=function(t){const i=t||{};l.default.call(this,{handleDownEvent:c,handleDragEvent:d,handleUpEvent:h}),this.condition_=i.condition?i.condition:s.shiftKeyOnly,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=void 0!==i.duration?i.duration:400};function d(t){if(!(0,s.mouseOnly)(t))return;const e=t.map,n=e.getSize(),a=t.pixel,l=a[0]-n[0]/2,r=n[1]/2-a[1],u=Math.atan2(r,l),d=Math.sqrt(l*l+r*r),h=e.getView();if(h.getConstraints().rotation!==i.disable&&void 0!==this.lastAngle_){const t=u-this.lastAngle_;(0,o.rotateWithoutConstraints)(h,h.getRotation()-t)}if(this.lastAngle_=u,void 0!==this.lastMagnitude_){const t=this.lastMagnitude_*(h.getResolution()/d);(0,o.zoomWithoutConstraints)(h,t)}void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/d),this.lastMagnitude_=d}function h(t){if(!(0,s.mouseOnly)(t))return!0;const i=t.map.getView();i.setHint(n.default.INTERACTING,-1);const e=this.lastScaleDelta_-1;return(0,o.rotate)(i,i.getRotation()),(0,o.zoom)(i,i.getResolution(),void 0,this.duration_,e),this.lastScaleDelta_=0,!1}function c(t){return!!(0,s.mouseOnly)(t)&&(!!this.condition_(t)&&(t.map.getView().setHint(n.default.INTERACTING,1),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))}(0,t.inherits)(u,l.default),exports.default=u;
},{"../index.js":94,"../rotationconstraint.js":185,"../ViewHint.js":186,"../events/condition.js":173,"../interaction/Interaction.js":126,"../interaction/Pointer.js":128}],135:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromString=void 0,exports.asString=s,exports.asArray=c,exports.normalize=l,exports.toString=a;var e=require("./asserts.js"),t=require("./math.js");const r=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,n=/^([a-z]*)$/i;function s(e){return"string"==typeof e?e:a(e)}function o(e){const t=document.createElement("div");if(t.style.color=e,""!==t.style.color){document.body.appendChild(t);const e=getComputedStyle(t).color;return document.body.removeChild(t),e}return""}const i=exports.fromString=function(){const e={};let t=0;return function(r){let n;if(e.hasOwnProperty(r))n=e[r];else{if(t>=1024){let r=0;for(const n in e)0==(3&r++)&&(delete e[n],--t)}n=u(r),e[r]=n,++t}return n}}();function c(e){return Array.isArray(e)?e:i(e)}function u(t){let s,i,c,u,a;if(n.exec(t)&&(t=o(t)),r.exec(t)){const e=t.length-1;let r;r=e<=4?1:2;const n=4===e||8===e;s=parseInt(t.substr(1+0*r,r),16),i=parseInt(t.substr(1+1*r,r),16),c=parseInt(t.substr(1+2*r,r),16),u=n?parseInt(t.substr(1+3*r,r),16):255,1==r&&(s=(s<<4)+s,i=(i<<4)+i,c=(c<<4)+c,n&&(u=(u<<4)+u)),a=[s,i,c,u/255]}else 0==t.indexOf("rgba(")?l(a=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((a=t.slice(4,-1).split(",").map(Number)).push(1),l(a)):(0,e.assert)(!1,14);return a}function l(e){return e[0]=(0,t.clamp)(e[0]+.5|0,0,255),e[1]=(0,t.clamp)(e[1]+.5|0,0,255),e[2]=(0,t.clamp)(e[2]+.5|0,0,255),e[3]=(0,t.clamp)(e[3],0,1),e}function a(e){let t=e[0];t!=(0|t)&&(t=t+.5|0);let r=e[1];r!=(0|r)&&(r=r+.5|0);let n=e[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+t+","+r+","+n+","+(void 0===e[3]?1:e[3])+")"}
},{"./asserts.js":111,"./math.js":157}],244:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asColorLike=r,exports.isColorLike=t;var e=require("./color.js");function r(r){return t(r)?r:(0,e.toString)(r)}function t(e){return"string"==typeof e||e instanceof CanvasPattern||e instanceof CanvasGradient}
},{"./color.js":135}],152:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3};
},{}],233:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../asserts.js"),s=require("../events/EventTarget.js"),n=i(s),r=require("../events/EventType.js"),o=i(r);function i(e){return e&&e.__esModule?e:{default:e}}const l=function(e){n.default.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null};(0,e.inherits)(l,n.default),l.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},l.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(o.default.CLEAR)},l.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},l.prototype.forEach=function(e,t){let s=this.oldest_;for(;s;)e.call(t,s.value_,s.key_,this),s=s.newer},l.prototype.get=function(e){const s=this.entries_[e];return(0,t.assert)(void 0!==s,15),s===this.newest_?s.value_:(s===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(s.newer.older=s.older,s.older.newer=s.newer),s.newer=null,s.older=this.newest_,this.newest_.newer=s,this.newest_=s,s.value_)},l.prototype.remove=function(e){const s=this.entries_[e];return(0,t.assert)(void 0!==s,15),s===this.newest_?(this.newest_=s.older,this.newest_&&(this.newest_.newer=null)):s===this.oldest_?(this.oldest_=s.newer,this.oldest_&&(this.oldest_.older=null)):(s.newer.older=s.older,s.older.newer=s.newer),delete this.entries_[e],--this.count_,s.value_},l.prototype.getCount=function(){return this.count_},l.prototype.getKeys=function(){const e=new Array(this.count_);let t,s=0;for(t=this.newest_;t;t=t.older)e[s++]=t.key_;return e},l.prototype.getValues=function(){const e=new Array(this.count_);let t,s=0;for(t=this.newest_;t;t=t.older)e[s++]=t.value_;return e},l.prototype.peekLast=function(){return this.oldest_.value_},l.prototype.peekLastKey=function(){return this.oldest_.key_},l.prototype.peekFirstKey=function(){return this.newest_.key_},l.prototype.pop=function(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},l.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},l.prototype.set=function(e,s){(0,t.assert)(!(e in this.entries_),16);const n={key_:e,newer:null,older:this.newest_,value_:s};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},l.prototype.setSize=function(e){this.highWaterMark=e},l.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},exports.default=l;
},{"../index.js":94,"../asserts.js":111,"../events/EventTarget.js":205,"../events/EventType.js":155}],218:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resetTransform=exports.measureTextHeight=exports.checkFont=exports.textHeights=exports.checkedFonts=exports.labelCache=exports.defaultLineWidth=exports.defaultPadding=exports.defaultTextBaseline=exports.defaultTextAlign=exports.defaultStrokeStyle=exports.defaultMiterLimit=exports.defaultLineJoin=exports.defaultLineDashOffset=exports.defaultLineDash=exports.defaultLineCap=exports.defaultFillStyle=exports.defaultFont=void 0,exports.measureTextWidth=w,exports.rotateAtOffset=k,exports.drawImage=M;var e=require("../css.js"),t=require("../dom.js"),o=require("../obj.js"),r=require("../structs/LRUCache.js"),s=a(r),n=require("../transform.js");function a(e){return e&&e.__esModule?e:{default:e}}const l=exports.defaultFont="10px sans-serif",i=exports.defaultFillStyle=[0,0,0,1],u=exports.defaultLineCap="round",f=exports.defaultLineDash=[],d=exports.defaultLineDashOffset=0,p=exports.defaultLineJoin="round",x=exports.defaultMiterLimit=10,c=exports.defaultStrokeStyle=[0,0,0,1],h=exports.defaultTextAlign="center",m=exports.defaultTextBaseline="middle",g=exports.defaultPadding=[0,0,0,0],y=exports.defaultLineWidth=1,T=exports.labelCache=new s.default,L=exports.checkedFonts={};let b=null;const v=exports.textHeights={},C=exports.checkFont=function(){const t=60,r=L,s="32px ",n=["monospace","serif"],a=n.length,l="wmytzilWMYTZIL@#/&?$%10";let i,u;function f(e){const t=F();let o=!0;for(let r=0;r<a;++r){const a=n[r];if(t.font=s+a,u=t.measureText(l).width,e!=a){t.font=s+e+","+a;const r=t.measureText(l).width;o=o&&r!=u}}return o}function d(){let e=!0;for(const s in r)r[s]<t&&(f(s)?(r[s]=t,(0,o.clear)(v),b=null,T.clear()):(++r[s],e=!1));e&&(clearInterval(i),i=void 0)}return function(o){const s=(0,e.getFontFamilies)(o);if(s)for(let e=0,o=s.length;e<o;++e){const o=s[e];o in r||(r[o]=t,f(o)||(r[o]=0,void 0===i&&(i=setInterval(d,32))))}}}();function F(){return b||(b=(0,t.createCanvasContext2D)(1,1)),b}const j=exports.measureTextHeight=function(){let e;const t=v;return function(o){let r=t[o];return void 0==r&&(e||((e=document.createElement("span")).textContent="M",e.style.margin=e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=o,document.body.appendChild(e),r=t[o]=e.offsetHeight,document.body.removeChild(e)),r}}();function w(e,t){const o=F();return e!=o.font&&(o.font=e),o.measureText(t).width}function k(e,t,o,r){0!==t&&(e.translate(o,r),e.rotate(t),e.translate(-o,-r))}const A=exports.resetTransform=(0,n.create)();function M(e,t,o,r,s,n,a,l,i,u,f){let d;1!=o&&(d=e.globalAlpha,e.globalAlpha=d*o),t&&e.setTransform.apply(e,t),e.drawImage(r,s,n,a,l,i,u,a*f,l*f),d&&(e.globalAlpha=d),t&&e.setTransform.apply(e,A)}
},{"../css.js":203,"../dom.js":148,"../obj.js":96,"../structs/LRUCache.js":233,"../transform.js":214}],60:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.snapToPixel_=t.snapToPixel};t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getSnapToPixel=function(){return this.snapToPixel_},t.prototype.getAnchor=function(){},t.prototype.getImage=function(t){},t.prototype.getHitDetectionImage=function(t){},t.prototype.getImageState=function(){},t.prototype.getImageSize=function(){},t.prototype.getHitDetectionImageSize=function(){},t.prototype.getOrigin=function(){},t.prototype.getSize=function(){},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.setSnapToPixel=function(t){this.snapToPixel_=t},t.prototype.listenImageChange=function(t,o){},t.prototype.load=function(){},t.prototype.unlistenImageChange=function(t,o){},exports.default=t;
},{}],61:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../colorlike.js"),e=require("../dom.js"),s=require("../has.js"),n=require("../ImageState.js"),o=l(n),a=require("../render/canvas.js"),h=require("../style/Image.js"),r=l(h);function l(t){return t&&t.__esModule?t:{default:t}}const u=function(t){this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=t.atlasManager,this.render_(this.atlasManager_);const i=void 0===t.snapToPixel||t.snapToPixel,e=void 0!==t.rotateWithView&&t.rotateWithView;r.default.call(this,{opacity:1,rotateWithView:e,rotation:void 0!==t.rotation?t.rotation:0,scale:1,snapToPixel:i})};(0,t.inherits)(u,r.default),u.prototype.clone=function(){const t=new u({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},u.prototype.getAnchor=function(){return this.anchor_},u.prototype.getAngle=function(){return this.angle_},u.prototype.getFill=function(){return this.fill_},u.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},u.prototype.getImage=function(t){return this.canvas_},u.prototype.getImageSize=function(){return this.imageSize_},u.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},u.prototype.getImageState=function(){return o.default.LOADED},u.prototype.getOrigin=function(){return this.origin_},u.prototype.getPoints=function(){return this.points_},u.prototype.getRadius=function(){return this.radius_},u.prototype.getRadius2=function(){return this.radius2_},u.prototype.getSize=function(){return this.size_},u.prototype.getStroke=function(){return this.stroke_},u.prototype.listenImageChange=function(t,i){},u.prototype.load=function(){},u.prototype.unlistenImageChange=function(t,i){},u.prototype.render_=function(t){let n,o,h="",r="",l=0,u=null,_=0,c=0;this.stroke_&&(null===(o=this.stroke_.getColor())&&(o=a.defaultStrokeStyle),o=(0,i.asColorLike)(o),void 0===(c=this.stroke_.getWidth())&&(c=a.defaultLineWidth),u=this.stroke_.getLineDash(),_=this.stroke_.getLineDashOffset(),s.CANVAS_LINE_DASH||(u=null,_=0),void 0===(r=this.stroke_.getLineJoin())&&(r=a.defaultLineJoin),void 0===(h=this.stroke_.getLineCap())&&(h=a.defaultLineCap),void 0===(l=this.stroke_.getMiterLimit())&&(l=a.defaultMiterLimit));let d=2*(this.radius_+c)+1;const g={strokeStyle:o,strokeWidth:c,size:d,lineCap:h,lineDash:u,lineDashOffset:_,lineJoin:r,miterLimit:l};if(void 0===t){const t=(0,e.createCanvasContext2D)(d,d);this.canvas_=t.canvas,n=d=this.canvas_.width,this.draw_(g,t,0,0),this.createHitDetectionCanvas_(g)}else{d=Math.round(d);const i=!this.fill_;let e;i&&(e=this.drawHitDetectionCanvas_.bind(this,g));const s=this.getChecksum(),o=t.add(s,d,d,this.draw_.bind(this,g),e);this.canvas_=o.image,this.origin_=[o.offsetX,o.offsetY],n=o.image.width,i?(this.hitDetectionCanvas_=o.hitImage,this.hitDetectionImageSize_=[o.hitImage.width,o.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[n,n])}this.anchor_=[d/2,d/2],this.size_=[d,d],this.imageSize_=[n,n]},u.prototype.draw_=function(t,e,s,n){let o,h,r;e.setTransform(1,0,0,1,0,0),e.translate(s,n),e.beginPath();let l=this.points_;if(l===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{const i=void 0!==this.radius2_?this.radius2_:this.radius_;for(i!==this.radius_&&(l*=2),o=0;o<=l;o++)h=2*o*Math.PI/l-Math.PI/2+this.angle_,r=o%2==0?this.radius_:i,e.lineTo(t.size/2+r*Math.cos(h),t.size/2+r*Math.sin(h))}if(this.fill_){let t=this.fill_.getColor();null===t&&(t=a.defaultFillStyle),e.fillStyle=(0,i.asColorLike)(t),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},u.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)return void(this.hitDetectionCanvas_=this.canvas_);const i=(0,e.createCanvasContext2D)(t.size,t.size);this.hitDetectionCanvas_=i.canvas,this.drawHitDetectionCanvas_(t,i,0,0)},u.prototype.drawHitDetectionCanvas_=function(t,i,e,s){i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();let n=this.points_;if(n===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{const e=void 0!==this.radius2_?this.radius2_:this.radius_;let s,o,a;for(e!==this.radius_&&(n*=2),s=0;s<=n;s++)a=2*s*Math.PI/n-Math.PI/2+this.angle_,o=s%2==0?this.radius_:e,i.lineTo(t.size/2+o*Math.cos(a),t.size/2+o*Math.sin(a))}i.fillStyle=a.defaultFillStyle,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},u.prototype.getChecksum=function(){const t=this.stroke_?this.stroke_.getChecksum():"-",i=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||i!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){const e="r"+t+i+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[e,t,i,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},exports.default=u;
},{"../index.js":94,"../colorlike.js":244,"../dom.js":148,"../has.js":225,"../ImageState.js":152,"../render/canvas.js":218,"../style/Image.js":60}],56:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../style/RegularShape.js"),s=i(t);function i(e){return e&&e.__esModule?e:{default:e}}const a=function(e){const t=e||{};s.default.call(this,{points:1/0,fill:t.fill,radius:t.radius,snapToPixel:t.snapToPixel,stroke:t.stroke,atlasManager:t.atlasManager})};(0,e.inherits)(a,s.default),a.prototype.clone=function(){const e=new a({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});return e.setOpacity(this.getOpacity()),e.setScale(this.getScale()),e},a.prototype.setRadius=function(e){this.radius_=e,this.render_(this.atlasManager_)},exports.default=a;
},{"../index.js":94,"../style/RegularShape.js":61}],57:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=require("../index.js"),t=require("../color.js");const e=function(o){const t=o||{};this.color_=void 0!==t.color?t.color:null,this.checksum_=void 0};e.prototype.clone=function(){const o=this.getColor();return new e({color:o&&o.slice?o.slice():o||void 0})},e.prototype.getColor=function(){return this.color_},e.prototype.setColor=function(o){this.color_=o,this.checksum_=void 0},e.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=(0,o.getUid)(this.color_).toString():this.checksum_="f"+(this.color_?(0,t.asString)(this.color_):"-")),this.checksum_},exports.default=e;
},{"../index.js":94,"../color.js":135}],62:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js");const i=function(t){const i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width,this.checksum_=void 0};i.prototype.clone=function(){const t=this.getColor();return new i({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},i.prototype.getColor=function(){return this.color_},i.prototype.getLineCap=function(){return this.lineCap_},i.prototype.getLineDash=function(){return this.lineDash_},i.prototype.getLineDashOffset=function(){return this.lineDashOffset_},i.prototype.getLineJoin=function(){return this.lineJoin_},i.prototype.getMiterLimit=function(){return this.miterLimit_},i.prototype.getWidth=function(){return this.width_},i.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},i.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},i.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},i.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},i.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},i.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},i.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},i.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=(0,t.getUid)(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_},exports.default=i;
},{"../index.js":94}],63:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toFunction=c,exports.createDefaultStyle=g,exports.createEditingStyle=y;var t=require("../asserts.js"),e=require("../geom/GeometryType.js"),o=f(e),n=require("../style/Circle.js"),r=f(n),i=require("../style/Fill.js"),l=f(i),u=require("../style/Stroke.js"),s=f(u);function f(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const e=t||{};this.geometry_=null,this.geometryFunction_=h,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};function c(e){let o;if("function"==typeof e)o=e;else{let n;Array.isArray(e)?n=e:((0,t.assert)(e instanceof d,41),n=[e]),o=function(){return n}}return o}d.prototype.clone=function(){let t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new d({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},d.prototype.getRenderer=function(){return this.renderer_},d.prototype.setRenderer=function(t){this.renderer_=t},d.prototype.getGeometry=function(){return this.geometry_},d.prototype.getGeometryFunction=function(){return this.geometryFunction_},d.prototype.getFill=function(){return this.fill_},d.prototype.setFill=function(t){this.fill_=t},d.prototype.getImage=function(){return this.image_},d.prototype.setImage=function(t){this.image_=t},d.prototype.getStroke=function(){return this.stroke_},d.prototype.setStroke=function(t){this.stroke_=t},d.prototype.getText=function(){return this.text_},d.prototype.setText=function(t){this.text_=t},d.prototype.getZIndex=function(){return this.zIndex_},d.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=h,this.geometry_=t},d.prototype.setZIndex=function(t){this.zIndex_=t};let a=null;function g(t,e){if(!a){const t=new l.default({color:"rgba(255,255,255,0.4)"}),e=new s.default({color:"#3399CC",width:1.25});a=[new d({image:new r.default({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return a}function y(){const t={},e=[255,255,255,1],n=[0,153,255,1];return t[o.default.POLYGON]=[new d({fill:new l.default({color:[255,255,255,.5]})})],t[o.default.MULTI_POLYGON]=t[o.default.POLYGON],t[o.default.LINE_STRING]=[new d({stroke:new s.default({color:e,width:5})}),new d({stroke:new s.default({color:n,width:3})})],t[o.default.MULTI_LINE_STRING]=t[o.default.LINE_STRING],t[o.default.CIRCLE]=t[o.default.POLYGON].concat(t[o.default.LINE_STRING]),t[o.default.POINT]=[new d({image:new r.default({radius:6,fill:new l.default({color:n}),stroke:new s.default({color:e,width:1.5})}),zIndex:1/0})],t[o.default.MULTI_POINT]=t[o.default.POINT],t[o.default.GEOMETRY_COLLECTION]=t[o.default.POLYGON].concat(t[o.default.LINE_STRING],t[o.default.POINT]),t}function h(t){return t.getGeometry()}exports.default=d;
},{"../asserts.js":111,"../geom/GeometryType.js":211,"../style/Circle.js":56,"../style/Fill.js":57,"../style/Stroke.js":62}],178:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStyleFunction=m;var e=require("./asserts.js"),t=require("./events.js"),n=require("./events/EventType.js"),s=g(n),o=require("./index.js"),i=require("./Object.js"),r=g(i),h=require("./geom/Geometry.js"),y=g(h),a=require("./style/Style.js"),u=g(a);function g(e){return e&&e.__esModule?e:{default:e}}const l=function(e){if(r.default.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,(0,t.listen)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),void 0!==e)if(e instanceof y.default||!e){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}};function m(t){if("function"==typeof t)return t;{let n;return Array.isArray(t)?n=t:((0,e.assert)(t instanceof u.default,41),n=[t]),function(){return n}}}(0,o.inherits)(l,r.default),l.prototype.clone=function(){const e=new l(this.getProperties());e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e},l.prototype.getGeometry=function(){return this.get(this.geometryName_)},l.prototype.getId=function(){return this.id_},l.prototype.getGeometryName=function(){return this.geometryName_},l.prototype.getStyle=function(){return this.style_},l.prototype.getStyleFunction=function(){return this.styleFunction_},l.prototype.handleGeometryChange_=function(){this.changed()},l.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&((0,t.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=(0,t.listen)(e,s.default.CHANGE,this.handleGeometryChange_,this)),this.changed()},l.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},l.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?m(e):void 0,this.changed()},l.prototype.setId=function(e){this.id_=e,this.changed()},l.prototype.setGeometryName=function(e){(0,t.unlisten)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=e,(0,t.listen)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},exports.default=l;
},{"./asserts.js":111,"./events.js":153,"./events/EventType.js":155,"./index.js":94,"./Object.js":145,"./geom/Geometry.js":239,"./style/Style.js":63}],295:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../extent.js"),s=require("../geom/GeometryLayout.js"),o=u(s),i=require("../geom/GeometryType.js"),r=u(i),n=require("../geom/SimpleGeometry.js"),a=u(n),d=require("../geom/flat/deflate.js");function u(t){return t&&t.__esModule?t:{default:t}}const l=function(t,e,s){a.default.call(this);const o=e||0;this.setCenterAndRadius(t,o,s)};(0,t.inherits)(l,a.default),l.prototype.clone=function(){const t=new l(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},l.prototype.closestPointXY=function(t,e,s,o){const i=this.flatCoordinates,r=t-i[0],n=e-i[1],a=r*r+n*n;if(a<o){if(0===a)for(let t=0;t<this.stride;++t)s[t]=i[t];else{const t=this.getRadius()/Math.sqrt(a);s[0]=i[0]+t*r,s[1]=i[1]+t*n;for(let t=2;t<this.stride;++t)s[t]=i[t]}return s.length=this.stride,a}return o},l.prototype.containsXY=function(t,e){const s=this.flatCoordinates,o=t-s[0],i=e-s[1];return o*o+i*i<=this.getRadiusSquared_()},l.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},l.prototype.computeExtent=function(t){const s=this.flatCoordinates,o=s[this.stride]-s[0];return(0,e.createOrUpdate)(s[0]-o,s[1]-o,s[0]+o,s[1]+o,t)},l.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},l.prototype.getRadiusSquared_=function(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},l.prototype.getType=function(){return r.default.CIRCLE},l.prototype.intersectsExtent=function(t){const s=this.getExtent();if((0,e.intersects)(t,s)){const s=this.getCenter();return t[0]<=s[0]&&t[2]>=s[0]||(t[1]<=s[1]&&t[3]>=s[1]||(0,e.forEachCorner)(t,this.intersectsCoordinate,this))}return!1},l.prototype.setCenter=function(t){const e=this.stride,s=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+s;for(let s=1;s<e;++s)o[e+s]=t[s];this.setFlatCoordinates(this.layout,o)},l.prototype.setCenterAndRadius=function(t,e,s){if(t){this.setLayout(s,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const o=this.flatCoordinates;let i=(0,d.deflateCoordinate)(o,0,t,this.stride);o[i++]=o[0]+e;for(let t=1,e=this.stride;t<e;++t)o[i++]=o[t];o.length=i,this.changed()}else this.setFlatCoordinates(o.default.XY,null)},l.prototype.getCoordinates=function(){},l.prototype.setCoordinates=function(t,e){},l.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},l.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},l.prototype.transform,exports.default=l;
},{"../index.js":94,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/SimpleGeometry.js":236,"../geom/flat/deflate.js":240}],264:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interpolatePoint=r,exports.lineStringCoordinateAtM=n,exports.lineStringsCoordinateAtM=l;var e=require("../../array.js"),t=require("../../math.js");function r(r,n,l,i,s,u){let o=NaN,f=NaN;const c=(l-n)/i;if(1===c)o=r[n],f=r[n+1];else if(2==c)o=(1-s)*r[n]+s*r[n+i],f=(1-s)*r[n+1]+s*r[n+i+1];else if(0!==c){let u=r[n],c=r[n+1],a=0;const p=[0];for(let e=n+i;e<l;e+=i){const t=r[e],n=r[e+1];a+=Math.sqrt((t-u)*(t-u)+(n-c)*(n-c)),p.push(a),u=t,c=n}const h=s*a,g=(0,e.binarySearch)(p,h);if(g<0){const e=(h-p[-g-2])/(p[-g-1]-p[-g-2]),l=n+(-g-2)*i;o=(0,t.lerp)(r[l],r[l+i],e),f=(0,t.lerp)(r[l+1],r[l+i+1],e)}else o=r[n+g*i],f=r[n+g*i+1]}return u?(u[0]=o,u[1]=f,u):[o,f]}function n(e,r,n,l,i,s){if(n==r)return null;let u;if(i<e[r+l-1])return s?((u=e.slice(r,r+l))[l-1]=i,u):null;if(e[n-1]<i)return s?((u=e.slice(n-l,n))[l-1]=i,u):null;if(i==e[r+l-1])return e.slice(r,r+l);let o=r/l,f=n/l;for(;o<f;){const t=o+f>>1;i<e[(t+1)*l-1]?f=t:o=t+1}const c=e[o*l-1];if(i==c)return e.slice((o-1)*l,(o-1)*l+l);const a=(i-c)/(e[(o+1)*l-1]-c);u=[];for(let r=0;r<l-1;++r)u.push((0,t.lerp)(e[(o-1)*l+r],e[o*l+r],a));return u.push(i),u}function l(e,t,r,l,i,s,u){if(u)return n(e,t,r[r.length-1],l,i,s);let o;if(i<e[l-1])return s?((o=e.slice(0,l))[l-1]=i,o):null;if(e[e.length-1]<i)return s?((o=e.slice(e.length-l))[l-1]=i,o):null;for(let s=0,u=r.length;s<u;++s){const u=r[s];if(t!=u){if(i<e[t+l-1])return null;if(i<=e[u-1])return n(e,t,u,l,i,!1);t=u}}return null}
},{"../../array.js":171,"../../math.js":157}],261:[function(require,module,exports) {
"use strict";function t(t,e,n,r){let o=t[e],s=t[e+1],i=0;for(let l=e+r;l<n;l+=r){const e=t[l],n=t[l+1];i+=Math.sqrt((e-o)*(e-o)+(n-s)*(n-s)),o=e,s=n}return i}function e(e,n,r,o){let s=t(e,n,r,o);const i=e[r-o]-e[n],l=e[r-o+1]-e[n+1];return s+=Math.sqrt(i*i+l*l)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineStringLength=t,exports.linearRingLength=e;
},{}],193:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),i=require("../extent.js"),o=require("../geom/GeometryLayout.js"),s=y(o),n=require("../geom/GeometryType.js"),r=y(n),a=require("../geom/SimpleGeometry.js"),l=y(a),h=require("../geom/flat/closest.js"),d=require("../geom/flat/deflate.js"),f=require("../geom/flat/inflate.js"),u=require("../geom/flat/interpolate.js"),g=require("../geom/flat/intersectsextent.js"),p=require("../geom/flat/length.js"),C=require("../geom/flat/segments.js"),c=require("../geom/flat/simplify.js");function y(t){return t&&t.__esModule?t:{default:t}}const m=function(t,e){l.default.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(m,l.default),m.prototype.appendCoordinate=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},m.prototype.clone=function(){const t=new m(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},m.prototype.closestPointXY=function(t,e,o,s){return s<(0,i.closestSquaredDistanceXY)(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,h.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,h.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,o,s))},m.prototype.forEachSegment=function(t){return(0,C.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},m.prototype.getCoordinateAtM=function(t,e){if(this.layout!=s.default.XYM&&this.layout!=s.default.XYZM)return null;const i=void 0!==e&&e;return(0,u.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},m.prototype.getCoordinates=function(){return(0,f.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getCoordinateAt=function(t,e){return(0,u.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},m.prototype.getLength=function(){return(0,p.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},m.prototype.getSimplifiedGeometryInternal=function(t){const e=[];e.length=(0,c.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);const i=new m(null);return i.setFlatCoordinates(s.default.XY,e),i},m.prototype.getType=function(){return r.default.LINE_STRING},m.prototype.intersectsExtent=function(t){return(0,g.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},m.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,d.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},m.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=m;
},{"../index.js":94,"../array.js":171,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/SimpleGeometry.js":236,"../geom/flat/closest.js":259,"../geom/flat/deflate.js":240,"../geom/flat/inflate.js":254,"../geom/flat/interpolate.js":264,"../geom/flat/intersectsextent.js":260,"../geom/flat/length.js":261,"../geom/flat/segments.js":262,"../geom/flat/simplify.js":263}],194:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),s=require("../extent.js"),i=require("../geom/GeometryLayout.js"),n=C(i),o=require("../geom/GeometryType.js"),r=C(o),a=require("../geom/LineString.js"),l=C(a),d=require("../geom/SimpleGeometry.js"),h=C(d),u=require("../geom/flat/closest.js"),f=require("../geom/flat/deflate.js"),c=require("../geom/flat/inflate.js"),g=require("../geom/flat/interpolate.js"),p=require("../geom/flat/intersectsextent.js"),y=require("../geom/flat/simplify.js");function C(t){return t&&t.__esModule?t:{default:t}}const _=function(t,e){h.default.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(_,h.default),_.prototype.appendLineString=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},_.prototype.clone=function(){const t=new _(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},_.prototype.closestPointXY=function(t,e,i,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,u.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,u.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},_.prototype.getCoordinateAtM=function(t,e,s){if(this.layout!=n.default.XYM&&this.layout!=n.default.XYZM||0===this.flatCoordinates.length)return null;const i=void 0!==e&&e,o=void 0!==s&&s;return(0,g.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,t,i,o)},_.prototype.getCoordinates=function(){return(0,c.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)},_.prototype.getEnds=function(){return this.ends_},_.prototype.getLineString=function(t){if(t<0||this.ends_.length<=t)return null;const e=new l.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},_.prototype.getLineStrings=function(){const t=this.flatCoordinates,e=this.ends_,s=this.layout,i=[];let n=0;for(let o=0,r=e.length;o<r;++o){const r=e[o],a=new l.default(null);a.setFlatCoordinates(s,t.slice(n,r)),i.push(a),n=r}return i},_.prototype.getFlatMidpoints=function(){const t=[],s=this.flatCoordinates;let i=0;const n=this.ends_,o=this.stride;for(let r=0,a=n.length;r<a;++r){const a=n[r],l=(0,g.interpolatePoint)(s,i,a,o,.5);(0,e.extend)(t,l),i=a}return t},_.prototype.getSimplifiedGeometryInternal=function(t){const e=[],s=[];e.length=(0,y.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,s);const i=new _(null);return i.setFlatCoordinates(n.default.XY,e,s),i},_.prototype.getType=function(){return r.default.MULTI_LINE_STRING},_.prototype.intersectsExtent=function(t){return(0,p.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,t)},_.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const s=(0,f.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===s.length?0:s[s.length-1],this.changed()}else this.setFlatCoordinates(n.default.XY,null,this.ends_)},_.prototype.setFlatCoordinates=function(t,e,s){this.setFlatCoordinatesInternal(t,e),this.ends_=s,this.changed()},_.prototype.setLineStrings=function(t){let s=this.getLayout();const i=[],n=[];for(let o=0,r=t.length;o<r;++o){const r=t[o];0===o&&(s=r.getLayout()),(0,e.extend)(i,r.getFlatCoordinates()),n.push(i.length)}this.setFlatCoordinates(s,i,n)},exports.default=_;
},{"../index.js":94,"../array.js":171,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/LineString.js":193,"../geom/SimpleGeometry.js":236,"../geom/flat/closest.js":259,"../geom/flat/deflate.js":240,"../geom/flat/inflate.js":254,"../geom/flat/interpolate.js":264,"../geom/flat/intersectsextent.js":260,"../geom/flat/simplify.js":263}],195:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),o=require("../extent.js"),s=require("../geom/GeometryLayout.js"),i=p(s),n=require("../geom/GeometryType.js"),r=p(n),a=require("../geom/Point.js"),l=p(a),d=require("../geom/SimpleGeometry.js"),u=p(d),f=require("../geom/flat/deflate.js"),h=require("../geom/flat/inflate.js"),c=require("../math.js");function p(t){return t&&t.__esModule?t:{default:t}}const C=function(t,e){u.default.call(this),this.setCoordinates(t,e)};(0,t.inherits)(C,u.default),C.prototype.appendPoint=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},C.prototype.clone=function(){const t=new C(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},C.prototype.closestPointXY=function(t,e,s,i){if(i<(0,o.closestSquaredDistanceXY)(this.getExtent(),t,e))return i;const n=this.flatCoordinates,r=this.stride;for(let o=0,a=n.length;o<a;o+=r){const a=(0,c.squaredDistance)(t,e,n[o],n[o+1]);if(a<i){i=a;for(let t=0;t<r;++t)s[t]=n[o+t];s.length=r}}return i},C.prototype.getCoordinates=function(){return(0,h.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},C.prototype.getPoint=function(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;if(t<0||e<=t)return null;const o=new l.default(null);return o.setFlatCoordinates(this.layout,this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride)),o},C.prototype.getPoints=function(){const t=this.flatCoordinates,e=this.layout,o=this.stride,s=[];for(let i=0,n=t.length;i<n;i+=o){const n=new l.default(null);n.setFlatCoordinates(e,t.slice(i,i+o)),s.push(n)}return s},C.prototype.getType=function(){return r.default.MULTI_POINT},C.prototype.intersectsExtent=function(t){const e=this.flatCoordinates,s=this.stride;for(let i=0,n=e.length;i<n;i+=s){const s=e[i],n=e[i+1];if((0,o.containsXY)(t,s,n))return!0}return!1},C.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,f.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(i.default.XY,null)},C.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=C;
},{"../index.js":94,"../array.js":171,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/Point.js":189,"../geom/SimpleGeometry.js":236,"../geom/flat/deflate.js":240,"../geom/flat/inflate.js":254,"../math.js":157}],276:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingss=t;var e=require("../../extent.js");function t(t,r,n,s){const o=[];let a=(0,e.createEmpty)();for(let l=0,c=n.length;l<c;++l){const c=n[l];a=(0,e.createOrUpdateFromFlatCoordinates)(t,r,c[0],s),o.push((a[0]+a[2])/2,(a[1]+a[3])/2),r=c[c.length-1]}return o}
},{"../../extent.js":140}],196:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),s=require("../extent.js"),i=require("../geom/GeometryLayout.js"),n=P(i),o=require("../geom/GeometryType.js"),r=P(o),a=require("../geom/MultiPoint.js"),l=P(a),h=require("../geom/Polygon.js"),d=P(h),u=require("../geom/SimpleGeometry.js"),f=P(u),g=require("../geom/flat/area.js"),c=require("../geom/flat/center.js"),p=require("../geom/flat/closest.js"),_=require("../geom/flat/contains.js"),y=require("../geom/flat/deflate.js"),C=require("../geom/flat/inflate.js"),m=require("../geom/flat/interiorpoint.js"),F=require("../geom/flat/intersectsextent.js"),q=require("../geom/flat/orient.js"),R=require("../geom/flat/simplify.js");function P(t){return t&&t.__esModule?t:{default:t}}const j=function(t,e){f.default.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};(0,t.inherits)(j,f.default),j.prototype.appendPolygon=function(t){let s;if(this.flatCoordinates){const i=this.flatCoordinates.length;(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates());for(let e=0,n=(s=t.getEnds().slice()).length;e<n;++e)s[e]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),s=t.getEnds().slice(),this.endss_.push();this.endss_.push(s),this.changed()},j.prototype.clone=function(){const t=new j(null),e=this.endss_.length,s=new Array(e);for(let t=0;t<e;++t)s[t]=this.endss_[t].slice();return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),s),t},j.prototype.closestPointXY=function(t,e,i,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,p.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,p.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},j.prototype.containsXY=function(t,e){return(0,_.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},j.prototype.getArea=function(){return(0,g.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},j.prototype.getCoordinates=function(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,q.orientLinearRingsArray)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,C.inflateMultiCoordinatesArray)(e,0,this.endss_,this.stride)},j.prototype.getEndss=function(){return this.endss_},j.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=(0,c.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,m.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},j.prototype.getInteriorPoints=function(){const t=new l.default(null);return t.setFlatCoordinates(n.default.XYM,this.getFlatInteriorPoints().slice()),t},j.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,q.linearRingsAreOriented)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,q.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},j.prototype.getSimplifiedGeometryInternal=function(t){const e=[],s=[];e.length=(0,R.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,s);const i=new j(null);return i.setFlatCoordinates(n.default.XY,e,s),i},j.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const s=this.endss_[t].slice(),i=s[s.length-1];if(0!==e)for(let t=0,i=s.length;t<i;++t)s[t]-=e;const n=new d.default(null);return n.setFlatCoordinates(this.layout,this.flatCoordinates.slice(e,i),s),n},j.prototype.getPolygons=function(){const t=this.layout,e=this.flatCoordinates,s=this.endss_,i=[];let n=0;for(let o=0,r=s.length;o<r;++o){const r=s[o].slice(),a=r[r.length-1];if(0!==n)for(let t=0,e=r.length;t<e;++t)r[t]-=n;const l=new d.default(null);l.setFlatCoordinates(t,e.slice(n,a),r),i.push(l),n=a}return i},j.prototype.getType=function(){return r.default.MULTI_POLYGON},j.prototype.intersectsExtent=function(t){return(0,F.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},j.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const s=(0,y.deflateMultiCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===s.length)this.flatCoordinates.length=0;else{const t=s[s.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}else this.setFlatCoordinates(n.default.XY,null,this.endss_)},j.prototype.setFlatCoordinates=function(t,e,s){this.setFlatCoordinatesInternal(t,e),this.endss_=s,this.changed()},j.prototype.setPolygons=function(t){let s=this.getLayout();const i=[],n=[];for(let o=0,r=t.length;o<r;++o){const r=t[o];0===o&&(s=r.getLayout());const a=i.length,l=r.getEnds();for(let t=0,e=l.length;t<e;++t)l[t]+=a;(0,e.extend)(i,r.getFlatCoordinates()),n.push(l)}this.setFlatCoordinates(s,i,n)},exports.default=j;
},{"../index.js":94,"../array.js":171,"../extent.js":140,"../geom/GeometryLayout.js":235,"../geom/GeometryType.js":211,"../geom/MultiPoint.js":195,"../geom/Polygon.js":197,"../geom/SimpleGeometry.js":236,"../geom/flat/area.js":275,"../geom/flat/center.js":276,"../geom/flat/closest.js":259,"../geom/flat/contains.js":277,"../geom/flat/deflate.js":240,"../geom/flat/inflate.js":254,"../geom/flat/interiorpoint.js":278,"../geom/flat/intersectsextent.js":260,"../geom/flat/orient.js":279,"../geom/flat/simplify.js":263}],105:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};
},{}],165:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"image",VECTOR:"vector"};
},{}],69:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderType=void 0;var e=require("../index.js"),t=require("../LayerType.js"),r=l(t),n=require("../layer/Layer.js"),i=l(n),u=require("../layer/VectorRenderType.js"),o=l(u),d=require("../obj.js"),s=require("../style/Style.js");function l(e){return e&&e.__esModule?e:{default:e}}const p=exports.RenderType={IMAGE:"image",VECTOR:"vector"},a={RENDER_ORDER:"renderOrder"},c=function(e){const t=e||{},n=(0,d.assign)({},t);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,i.default.call(this,n),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting,this.renderMode_=t.renderMode||o.default.VECTOR,this.type=r.default.VECTOR};(0,e.inherits)(c,i.default),c.prototype.getDeclutter=function(){return this.declutter_},c.prototype.setDeclutter=function(e){this.declutter_=e},c.prototype.getRenderBuffer=function(){return this.renderBuffer_},c.prototype.getRenderOrder=function(){return this.get(a.RENDER_ORDER)},c.prototype.getSource,c.prototype.getStyle=function(){return this.style_},c.prototype.getStyleFunction=function(){return this.styleFunction_},c.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},c.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},c.prototype.setRenderOrder=function(e){this.set(a.RENDER_ORDER,e)},c.prototype.setStyle=function(e){this.style_=void 0!==e?e:s.createDefaultStyle,this.styleFunction_=null===e?void 0:(0,s.toFunction)(this.style_),this.changed()},c.prototype.getRenderMode=function(){return this.renderMode_},exports.default=c;
},{"../index.js":94,"../LayerType.js":105,"../layer/Layer.js":68,"../layer/VectorRenderType.js":165,"../obj.js":96,"../style/Style.js":63}],242:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};
},{}],269:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFeaturesXhr=n,exports.xhr=o;var e=require("./functions.js"),t=require("./format/FormatType.js"),r=s(t);function s(e){return e&&e.__esModule?e:{default:e}}function n(e,t,s,n){return function(o,a,u){const i=new XMLHttpRequest;i.open("GET","function"==typeof e?e(o,a,u):e,!0),t.getType()==r.default.ARRAY_BUFFER&&(i.responseType="arraybuffer"),i.onload=function(e){if(!i.status||i.status>=200&&i.status<300){const e=t.getType();let o;e==r.default.JSON||e==r.default.TEXT?o=i.responseText:e==r.default.XML?(o=i.responseXML)||(o=(new DOMParser).parseFromString(i.responseText,"application/xml")):e==r.default.ARRAY_BUFFER&&(o=i.response),o?s.call(this,t.readFeatures(o,{featureProjection:u}),t.readProjection(o),t.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),i.onerror=function(){n.call(this)}.bind(this),i.send()}}function o(t,r){return n(t,r,function(e,t){this.addFeatures(e)},e.UNDEFINED)}
},{"./functions.js":144,"./format/FormatType.js":242}],270:[function(require,module,exports) {
"use strict";function e(e,t){return[[-1/0,-1/0,1/0,1/0]]}function t(e,t){return[e]}function n(e){return function(t,n){const o=e.getZForResolution(n),r=e.getTileRangeForExtentAndZ(t,o),u=[],i=[o,0,0];for(i[1]=r.minX;i[1]<=r.maxX;++i[1])for(i[2]=r.minY;i[2]<=r.maxY;++i[2])u.push(e.getTileCoordExtent(i));return u}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=e,exports.bbox=t,exports.tile=n;
},{}],81:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../functions.js"),r=require("../Object.js"),i=u(r),o=require("../proj.js"),n=require("../source/State.js"),s=u(n);function u(t){return t&&t.__esModule?t:{default:t}}const a=function(t){i.default.call(this),this.projection_=(0,o.get)(t.projection),this.attributions_=this.adaptAttributions_(t.attributions),this.state_=void 0!==t.state?t.state:s.default.READY,this.wrapX_=void 0!==t.wrapX&&t.wrapX};(0,t.inherits)(a,i.default),a.prototype.adaptAttributions_=function(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null},a.prototype.forEachFeatureAtCoordinate=e.UNDEFINED,a.prototype.getAttributions=function(){return this.attributions_},a.prototype.getProjection=function(){return this.projection_},a.prototype.getResolutions=function(){},a.prototype.getState=function(){return this.state_},a.prototype.getWrapX=function(){return this.wrapX_},a.prototype.refresh=function(){this.changed()},a.prototype.setAttributions=function(t){this.attributions_=this.adaptAttributions_(t),this.changed()},a.prototype.setState=function(t){this.state_=t,this.changed()},exports.default=a;
},{"../index.js":94,"../functions.js":144,"../Object.js":145,"../proj.js":43,"../source/State.js":154}],271:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};
},{}],299:[function(require,module,exports) {
var define;
var global = arguments[3];
var t,o=arguments[3];!function(o,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof t&&t.amd?t(n):o.quickselect=n()}(this,function(){"use strict";function t(t,o,n){var r=t[o];t[o]=t[n],t[n]=r}function o(t,o){return t<o?-1:t>o?1:0}return function(n,r,e,f,u){!function o(n,r,e,f,u){for(;f>e;){if(f-e>600){var a=f-e+1,i=r-e+1,c=Math.log(a),h=.5*Math.exp(2*c/3),s=.5*Math.sqrt(c*h*(a-h)/a)*(i-a/2<0?-1:1),l=Math.max(e,Math.floor(r-i*h/a+s)),M=Math.min(f,Math.floor(r+(a-i)*h/a+s));o(n,r,l,M,u)}var m=n[r],p=e,d=f;for(t(n,e,r),u(n[f],m)>0&&t(n,e,f);p<d;){for(t(n,p,d),p++,d--;u(n[p],m)<0;)p++;for(;u(n[d],m)>0;)d--}0===u(n[e],m)?t(n,e,d):t(n,++d,f),d<=r&&(e=d+1),r<=d&&(f=d-1)}}(n,r,e||0,f||n.length-1,u||o)}});
},{}],266:[function(require,module,exports) {
"use strict";module.exports=i,module.exports.default=i;var t=require("quickselect");function i(t,n){if(!(this instanceof i))return new i(t,n);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&this._initFormat(n),this.clear()}function n(t,i,n){if(!n)return i.indexOf(t);for(var a=0;a<i.length;a++)if(n(t,i[a]))return a;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,a,h){h||(h=x(null)),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(var r,o=i;o<n;o++)r=t.children[o],e(h,t.leaf?a(r):r);return h}function e(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function r(t,i){return t.minX-i.minX}function o(t,i){return t.minY-i.minY}function s(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function m(t,i){var n=Math.max(t.minX,i.minX),a=Math.max(t.minY,i.minY),h=Math.min(t.maxX,i.maxX),e=Math.min(t.maxY,i.maxY);return Math.max(0,h-n)*Math.max(0,e-a)}function c(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function f(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function x(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,a,h,e){for(var r,o=[n,a];o.length;)(a=o.pop())-(n=o.pop())<=h||(r=n+Math.ceil((a-n)/h/2)*h,t(i,r,n,a,e),o.push(n,r,r,a))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var i=this.data,n=[],a=this.toBBox;if(!f(t,i))return n;for(var h,e,r,o,s=[];i;){for(h=0,e=i.children.length;h<e;h++)r=i.children[h],f(t,o=i.leaf?a(r):r)&&(i.leaf?n.push(r):c(t,o)?this._all(r,n):s.push(r));i=s.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!f(t,i))return!1;for(var a,h,e,r,o=[];i;){for(a=0,h=i.children.length;a<h;a++)if(e=i.children[a],f(t,r=i.leaf?n(e):e)){if(i.leaf||c(t,r))return!0;o.push(e)}i=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var a=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===a.height)this._splitRoot(this.data,a);else{if(this.data.height<a.height){var h=this.data;this.data=a,a=h}this._insert(a,this.data.height-a.height-1,!0)}else this.data=a;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=x([]),this},remove:function(t,i){if(!t)return this;for(var a,h,e,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),h=l[l.length-1],a=u.pop(),r=!0),o.leaf&&-1!==(e=n(t,o.children,i)))return o.children.splice(e,1),l.push(o),this._condense(l),this;r||o.leaf||!c(o,s)?h?(a++,o=h.children[a],r=!1):o=null:(l.push(o),u.push(a),a=0,h=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:r,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},_build:function(t,i,n,h){var e,r=n-i+1,o=this._maxEntries;if(r<=o)return a(e=x(t.slice(i,n+1)),this.toBBox),e;h||(h=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,h-1))),(e=x([])).leaf=!1,e.height=h;var s,l,u,m,c=Math.ceil(r/o),f=c*Math.ceil(Math.sqrt(o));for(d(t,i,n,f,this.compareMinX),s=i;s<=n;s+=f)for(d(t,s,u=Math.min(s+f-1,n),c,this.compareMinY),l=s;l<=u;l+=c)m=Math.min(l+c-1,u),e.children.push(this._build(t,l,m,h-1));return a(e,this.toBBox),e},_chooseSubtree:function(t,i,n,a){for(var h,e,r,o,l,m,c,f;a.push(i),!i.leaf&&a.length-1!==n;){for(c=f=1/0,h=0,e=i.children.length;h<e;h++)l=s(r=i.children[h]),(m=u(t,r)-l)<f?(f=m,c=l<c?l:c,o=r):m===f&&l<c&&(c=l,o=r);i=o||i.children[0]}return i},_insert:function(t,i,n){var a=this.toBBox,h=n?t:a(t),r=[],o=this._chooseSubtree(h,this.data,i,r);for(o.children.push(t),e(o,h);i>=0&&r[i].children.length>this._maxEntries;)this._split(r,i),i--;this._adjustParentBBoxes(h,r,i)},_split:function(t,i){var n=t[i],h=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,h);var r=this._chooseSplitIndex(n,e,h),o=x(n.children.splice(r,n.children.length-r));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,i){this.data=x([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var a,e,r,o,l,u,c,f;for(u=c=1/0,a=i;a<=n-i;a++)o=m(e=h(t,0,a,this.toBBox),r=h(t,a,n,this.toBBox)),l=s(e)+s(r),o<u?(u=o,f=a,c=l<c?l:c):o===u&&l<c&&(c=l,f=a);return f},_chooseSplitAxis:function(t,i,n){var a=t.leaf?this.compareMinX:r,h=t.leaf?this.compareMinY:o;this._allDistMargin(t,i,n,a)<this._allDistMargin(t,i,n,h)&&t.children.sort(a)},_allDistMargin:function(t,i,n,a){t.children.sort(a);var r,o,s=this.toBBox,u=h(t,0,i,s),m=h(t,n-i,n,s),c=l(u)+l(m);for(r=i;r<n-i;r++)o=t.children[r],e(u,t.leaf?s(o):o),c+=l(u);for(r=n-i-1;r>=i;r--)o=t.children[r],e(m,t.leaf?s(o):o),c+=l(m);return c},_adjustParentBBoxes:function(t,i,n){for(var a=n;a>=0;a--)e(i[a],t)},_condense:function(t){for(var i,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children).splice(i.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};
},{"quickselect":299}],272:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("rbush"),n=o(e),r=require("../extent.js"),i=require("../obj.js");function o(t){return t&&t.__esModule?t:{default:t}}const s=function(t){this.rbush_=(0,n.default)(t,void 0),this.items_={}};s.prototype.insert=function(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[(0,t.getUid)(n)]=r},s.prototype.load=function(e,n){const r=new Array(n.length);for(let i=0,o=n.length;i<o;i++){const o=e[i],s=n[i],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};r[i]=u,this.items_[(0,t.getUid)(s)]=u}this.rbush_.load(r)},s.prototype.remove=function(e){const n=(0,t.getUid)(e),r=this.items_[n];return delete this.items_[n],null!==this.rbush_.remove(r)},s.prototype.update=function(e,n){const i=this.items_[(0,t.getUid)(n)],o=[i.minX,i.minY,i.maxX,i.maxY];(0,r.equals)(o,e)||(this.remove(n),this.insert(e,n))},s.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},s.prototype.getInExtent=function(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},s.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},s.prototype.forEachInExtent=function(t,e,n){return this.forEach_(this.getInExtent(t),e,n)},s.prototype.forEach_=function(t,e,n){let r;for(let i=0,o=t.length;i<o;i++)if(r=e.call(n,t[i]))return r;return r},s.prototype.isEmpty=function(){return(0,i.isEmpty)(this.items_)},s.prototype.clear=function(){this.rbush_.clear(),this.items_={}},s.prototype.getExtent=function(t){const e=this.rbush_.data;return(0,r.createOrUpdate)(e.minX,e.minY,e.maxX,e.maxY,t)},s.prototype.concat=function(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[0|e]=t.items_[0|e]},exports.default=s;
},{"../index.js":94,"rbush":266,"../extent.js":140,"../obj.js":96}],91:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VectorSourceEvent=void 0;var e=require("../index.js"),t=require("../Collection.js"),r=A(t),n=require("../CollectionEventType.js"),s=A(n),i=require("../ObjectEventType.js"),o=A(i),u=require("../array.js"),a=require("../asserts.js"),h=require("../events.js"),d=require("../events/Event.js"),l=A(d),f=require("../events/EventType.js"),c=A(f),_=require("../extent.js"),p=require("../featureloader.js"),E=require("../functions.js"),y=require("../loadingstrategy.js"),g=require("../obj.js"),I=require("../source/Source.js"),x=A(I),F=require("../source/State.js"),v=A(F),m=require("../source/VectorEventType.js"),R=A(m),C=require("../structs/RBush.js"),G=A(C);function A(e){return e&&e.__esModule?e:{default:e}}const j=exports.VectorSourceEvent=function(e,t){l.default.call(this,e),this.feature=t};(0,e.inherits)(j,l.default);const q=function(e){const t=e||{};x.default.call(this,{attributions:t.attributions,projection:void 0,state:v.default.READY,wrapX:void 0===t.wrapX||t.wrapX}),this.loader_=E.UNDEFINED,this.format_=t.format,this.overlaps_=void 0==t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&((0,a.assert)(this.format_,7),this.loader_=(0,p.xhr)(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:y.all;const n=void 0===t.useSpatialIndex||t.useSpatialIndex;let s,i;this.featuresRtree_=n?new G.default:null,this.loadedExtentsRtree_=new G.default,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,t.features instanceof r.default?i=(s=t.features).getArray():Array.isArray(t.features)&&(i=t.features),n||void 0!==s||(s=new r.default(i)),void 0!==i&&this.addFeaturesInternal(i),void 0!==s&&this.bindFeaturesCollection_(s)};(0,e.inherits)(q,x.default),q.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},q.prototype.addFeatureInternal=function(t){const r=(0,e.getUid)(t).toString();if(!this.addToIndex_(r,t))return;this.setupChangeEvents_(r,t);const n=t.getGeometry();if(n){const e=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[r]=t;this.dispatchEvent(new j(R.default.ADDFEATURE,t))},q.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[(0,h.listen)(t,c.default.CHANGE,this.handleFeatureChange_,this),(0,h.listen)(t,o.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]},q.prototype.addToIndex_=function(e,t){let r=!0;const n=t.getId();return void 0!==n?n.toString()in this.idIndex_?r=!1:this.idIndex_[n.toString()]=t:((0,a.assert)(!(e in this.undefIdIndex_),30),this.undefIdIndex_[e]=t),r},q.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},q.prototype.addFeaturesInternal=function(t){const r=[],n=[],s=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],i=(0,e.getUid)(s).toString();this.addToIndex_(i,s)&&n.push(s)}for(let t=0,i=n.length;t<i;t++){const i=n[t],o=(0,e.getUid)(i).toString();this.setupChangeEvents_(o,i);const u=i.getGeometry();if(u){const e=u.getExtent();r.push(e),s.push(i)}else this.nullGeometryFeatures_[o]=i}this.featuresRtree_&&this.featuresRtree_.load(r,s);for(let e=0,t=n.length;e<t;e++)this.dispatchEvent(new j(R.default.ADDFEATURE,n[e]))},q.prototype.bindFeaturesCollection_=function(e){let t=!1;(0,h.listen)(this,R.default.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),(0,h.listen)(this,R.default.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),(0,h.listen)(e,s.default.ADD,function(e){t||(t=!0,this.addFeature(e.element),t=!1)},this),(0,h.listen)(e,s.default.REMOVE,function(e){t||(t=!0,this.removeFeature(e.element),t=!1)},this),this.featuresCollection_=e},q.prototype.clear=function(e){if(e){for(const e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(h.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(const e in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[e])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};const t=new j(R.default.CLEAR);this.dispatchEvent(t),this.changed()},q.prototype.forEachFeature=function(e){return this.featuresRtree_?this.featuresRtree_.forEach(e):this.featuresCollection_?this.featuresCollection_.forEach(e):void 0},q.prototype.forEachFeatureAtCoordinateDirect=function(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){return r.getGeometry().intersectsCoordinate(e)?t(r):void 0})},q.prototype.forEachFeatureInExtent=function(e,t){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(e,t):this.featuresCollection_?this.featuresCollection_.forEach(t):void 0},q.prototype.forEachFeatureIntersectingExtent=function(e,t){return this.forEachFeatureInExtent(e,function(r){if(r.getGeometry().intersectsExtent(e)){const e=t(r);if(e)return e}})},q.prototype.getFeaturesCollection=function(){return this.featuresCollection_},q.prototype.getFeatures=function(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,g.isEmpty)(this.nullGeometryFeatures_)||(0,u.extend)(e,(0,g.getValues)(this.nullGeometryFeatures_))),e},q.prototype.getFeaturesAtCoordinate=function(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t},q.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_.getInExtent(e)},q.prototype.getClosestFeatureToCoordinate=function(e,t){const r=e[0],n=e[1];let s=null;const i=[NaN,NaN];let o=1/0;const u=[-1/0,-1/0,1/0,1/0],a=t||E.TRUE;return this.featuresRtree_.forEachInExtent(u,function(e){if(a(e)){const t=e.getGeometry(),a=o;if((o=t.closestPointXY(r,n,i,o))<a){s=e;const t=Math.sqrt(o);u[0]=r-t,u[1]=n-t,u[2]=r+t,u[3]=n+t}}}),s},q.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},q.prototype.getFeatureById=function(e){const t=this.idIndex_[e.toString()];return void 0!==t?t:null},q.prototype.getFormat=function(){return this.format_},q.prototype.getOverlaps=function(){return this.overlaps_},q.prototype.getResolutions=function(){},q.prototype.getUrl=function(){return this.url_},q.prototype.handleFeatureChange_=function(t){const r=t.target,n=(0,e.getUid)(r).toString(),s=r.getGeometry();if(s){const e=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(e,r)):this.featuresRtree_&&this.featuresRtree_.update(e,r)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(r),this.nullGeometryFeatures_[n]=r);const i=r.getId();if(void 0!==i){const e=i.toString();n in this.undefIdIndex_?(delete this.undefIdIndex_[n],this.idIndex_[e]=r):this.idIndex_[e]!==r&&(this.removeFromIdIndex_(r),this.idIndex_[e]=r)}else n in this.undefIdIndex_||(this.removeFromIdIndex_(r),this.undefIdIndex_[n]=r);this.changed(),this.dispatchEvent(new j(R.default.CHANGEFEATURE,r))},q.prototype.hasFeature=function(t){const r=t.getId();if(void 0!==r)return r in this.idIndex_;return(0,e.getUid)(t).toString()in this.undefIdIndex_},q.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&(0,g.isEmpty)(this.nullGeometryFeatures_)},q.prototype.loadFeatures=function(e,t,r){const n=this.loadedExtentsRtree_,s=this.strategy_(e,t);for(let e=0,i=s.length;e<i;++e){const i=s[e];n.forEachInExtent(i,function(e){return(0,_.containsExtent)(e.extent,i)})||(this.loader_.call(this,i,t,r),n.insert(i,{extent:i.slice()}))}},q.prototype.removeLoadedExtent=function(e){const t=this.loadedExtentsRtree_;let r;t.forEachInExtent(e,function(t){if((0,_.equals)(t.extent,e))return r=t,!0}),r&&t.remove(r)},q.prototype.removeFeature=function(t){const r=(0,e.getUid)(t).toString();r in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[r]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},q.prototype.removeFeatureInternal=function(t){const r=(0,e.getUid)(t).toString();this.featureChangeKeys_[r].forEach(h.unlistenByKey),delete this.featureChangeKeys_[r];const n=t.getId();void 0!==n?delete this.idIndex_[n.toString()]:delete this.undefIdIndex_[r],this.dispatchEvent(new j(R.default.REMOVEFEATURE,t))},q.prototype.removeFromIdIndex_=function(e){let t=!1;for(const r in this.idIndex_)if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}return t},q.prototype.setLoader=function(e){this.loader_=e},exports.default=q;
},{"../index.js":94,"../Collection.js":109,"../CollectionEventType.js":187,"../ObjectEventType.js":188,"../array.js":171,"../asserts.js":111,"../events.js":153,"../events/Event.js":183,"../events/EventType.js":155,"../extent.js":140,"../featureloader.js":269,"../functions.js":144,"../loadingstrategy.js":270,"../obj.js":96,"../source/Source.js":81,"../source/State.js":154,"../source/VectorEventType.js":271,"../structs/RBush.js":272}],124:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=z,exports.createRegularPolygon=Z,exports.createBox=$;var t=require("../index.js"),e=require("../events/EventType.js"),i=b(e),s=require("../Feature.js"),o=b(s),n=require("../MapBrowserEventType.js"),h=b(n),r=require("../MapBrowserPointerEvent.js"),a=b(r),d=require("../Object.js"),u=require("../coordinate.js"),_=require("../events.js"),l=require("../events/Event.js"),c=b(l),f=require("../events/condition.js"),p=require("../extent.js"),g=require("../functions.js"),m=require("../geom/Circle.js"),y=b(m),C=require("../geom/GeometryType.js"),k=b(C),T=require("../geom/LineString.js"),P=b(T),N=require("../geom/MultiLineString.js"),L=b(N),w=require("../geom/MultiPoint.js"),O=b(w),E=require("../geom/MultiPolygon.js"),I=b(E),D=require("../pointer/MouseSource.js"),G=require("../geom/Point.js"),F=b(G),R=require("../geom/Polygon.js"),v=b(R),S=require("../interaction/Pointer.js"),q=b(S),x=require("../interaction/Property.js"),M=b(x),j=require("../layer/Vector.js"),Y=b(j),A=require("../source/Vector.js"),U=b(A),V=require("../style/Style.js");function b(t){return t&&t.__esModule?t:{default:t}}const H={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},B={DRAWSTART:"drawstart",DRAWEND:"drawend"},W=function(t,e){c.default.call(this,t),this.feature=e};(0,t.inherits)(W,c.default);const X=function(t){q.default.call(this,{handleDownEvent:J,handleEvent:z,handleUpEvent:Q}),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=tt(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_===H.POLYGON?3:2,this.maxPoints_=t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:g.TRUE;let e=t.geometryFunction;if(!e)if(this.type_===k.default.CIRCLE)e=function(t,e){const i=e||new y.default([NaN,NaN]),s=(0,u.squaredDistance)(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(s)),i};else{let t;const i=this.mode_;i===H.POINT?t=F.default:i===H.LINE_STRING?t=P.default:i===H.POLYGON&&(t=v.default),e=function(e,s){let o=s;return o?i===H.POLYGON?e[0].length?o.setCoordinates([e[0].concat([e[0][0]])]):o.setCoordinates([]):o.setCoordinates(e):o=new t(e),o}}this.geometryFunction_=e,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Y.default({source:new U.default({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:K(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:f.noModifierKeys,this.freehandCondition_,t.freehand?this.freehandCondition_=f.always:this.freehandCondition_=t.freehandCondition?t.freehandCondition:f.shiftKeyOnly,(0,_.listen)(this,(0,d.getChangeEventType)(M.default.ACTIVE),this.updateState_,this)};function K(){const t=(0,V.createEditingStyle)();return function(e,i){return t[e.getGeometry().getType()]}}function z(t){t.originalEvent.type===i.default.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==H.POINT&&this.freehandCondition_(t);let e=t.type===h.default.POINTERMOVE,s=!0;if(this.lastDragTime_&&t.type===h.default.POINTERDRAG){Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&t.type===h.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),s=!1):this.freehand_&&t.type===h.default.POINTERDOWN?s=!1:e?(s=t.type===h.default.POINTERMOVE)&&this.freehand_?s=this.handlePointerMove_(t):(t.pointerEvent.pointerType==D.POINTER_TYPE||t.type===h.default.POINTERDRAG&&!this.downTimeout_)&&this.handlePointerMove_(t):t.type===h.default.DBLCLICK&&(s=!1),S.handleEvent.call(this,t)&&s}function J(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new a.default(h.default.POINTERMOVE,t.map,t.pointerEvent,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)}function Q(t){let e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.mode_===H.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===H.POINT&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e}function Z(t,e){return function(i,s){const o=i[0],n=i[1],h=Math.sqrt((0,u.squaredDistance)(o,n)),r=s||(0,R.fromCircle)(new y.default(o),t),a=e||Math.atan((n[1]-o[1])/(n[0]-o[0]));return(0,R.makeRegular)(r,o,h,a),r}}function $(){return function(t,e){const i=(0,p.boundingExtent)(t),s=e||new v.default(null);return s.setCoordinates([[(0,p.getBottomLeft)(i),(0,p.getBottomRight)(i),(0,p.getTopRight)(i),(0,p.getTopLeft)(i),(0,p.getBottomLeft)(i)]]),s}}function tt(t){let e;return t===k.default.POINT||t===k.default.MULTI_POINT?e=H.POINT:t===k.default.LINE_STRING||t===k.default.MULTI_LINE_STRING?e=H.LINE_STRING:t===k.default.POLYGON||t===k.default.MULTI_POLYGON?e=H.POLYGON:t===k.default.CIRCLE&&(e=H.CIRCLE),e}(0,t.inherits)(X,q.default),X.prototype.setMap=function(t){q.default.prototype.setMap.call(this,t),this.updateState_()},X.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,s=e[0]-i[0],o=e[1]-i[1],n=s*s+o*o;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},X.prototype.atFinish_=function(t){let e=!1;if(this.sketchFeature_){let i=!1,s=[this.finishCoordinate_];if(this.mode_===H.LINE_STRING?i=this.sketchCoords_.length>this.minPoints_:this.mode_===H.POLYGON&&(i=this.sketchCoords_[0].length>this.minPoints_,s=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]),i){const i=t.map;for(let o=0,n=s.length;o<n;o++){const n=s[o],h=i.getPixelFromCoordinate(n),r=t.pixel,a=r[0]-h[0],d=r[1]-h[1],u=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(a*a+d*d)<=u){this.finishCoordinate_=n;break}}}}return e},X.prototype.createOrUpdateSketchPoint_=function(t){const e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(e)}else this.sketchPoint_=new o.default(new F.default(e)),this.updateSketchFeatures_()},X.prototype.startDrawing_=function(t){const e=t.coordinate;this.finishCoordinate_=e,this.mode_===H.POINT?this.sketchCoords_=e.slice():this.mode_===H.POLYGON?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new o.default(new P.default(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new o.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new W(B.DRAWSTART,this.sketchFeature_))},X.prototype.modifyDrawing_=function(t){let e=t.coordinate;const i=this.sketchFeature_.getGeometry();let s,n,h;if(this.mode_===H.POINT?n=this.sketchCoords_:this.mode_===H.POLYGON?(n=(s=this.sketchCoords_[0])[s.length-1],this.atFinish_(t)&&(e=this.finishCoordinate_.slice())):n=(s=this.sketchCoords_)[s.length-1],n[0]=e[0],n[1]=e[1],this.geometryFunction_(this.sketchCoords_,i),this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(e)}if(i instanceof v.default&&this.mode_!==H.POLYGON){this.sketchLine_||(this.sketchLine_=new o.default(new P.default(null)));const t=i.getLinearRing(0);(h=this.sketchLine_.getGeometry()).setFlatCoordinates(t.getLayout(),t.getFlatCoordinates())}else this.sketchLineCoords_&&(h=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},X.prototype.addToDrawing_=function(t){const e=t.coordinate,i=this.sketchFeature_.getGeometry();let s,o;this.mode_===H.LINE_STRING?(this.finishCoordinate_=e.slice(),(o=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?o.pop():s=!0),o.push(e.slice()),this.geometryFunction_(o,i)):this.mode_===H.POLYGON&&((o=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?o.pop():s=!0),o.push(e.slice()),s&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,i)),this.updateSketchFeatures_(),s&&this.finishDrawing()},X.prototype.removeLastPoint=function(){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry();let e,i;this.mode_===H.LINE_STRING?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===H.POLYGON&&((e=this.sketchCoords_[0]).splice(-2,1),(i=this.sketchLine_.getGeometry()).setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t)),0===e.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()},X.prototype.finishDrawing=function(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const i=t.getGeometry();this.mode_===H.LINE_STRING?(e.pop(),this.geometryFunction_(e,i)):this.mode_===H.POLYGON&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===k.default.MULTI_POINT?t.setGeometry(new O.default([e])):this.type_===k.default.MULTI_LINE_STRING?t.setGeometry(new L.default([e])):this.type_===k.default.MULTI_POLYGON&&t.setGeometry(new I.default([e])),this.dispatchEvent(new W(B.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)},X.prototype.abortDrawing_=function(){this.finishCoordinate_=null;const t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},X.prototype.extend=function(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new W(B.DRAWSTART,this.sketchFeature_))},X.prototype.shouldStopEvent=g.FALSE,X.prototype.updateSketchFeatures_=function(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},X.prototype.updateState_=function(){const t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},exports.default=X;
},{"../index.js":94,"../events/EventType.js":155,"../Feature.js":178,"../MapBrowserEventType.js":160,"../MapBrowserPointerEvent.js":207,"../Object.js":145,"../coordinate.js":179,"../events.js":153,"../events/Event.js":183,"../events/condition.js":173,"../extent.js":140,"../functions.js":144,"../geom/Circle.js":295,"../geom/GeometryType.js":211,"../geom/LineString.js":193,"../geom/MultiLineString.js":194,"../geom/MultiPoint.js":195,"../geom/MultiPolygon.js":196,"../pointer/MouseSource.js":296,"../geom/Point.js":189,"../geom/Polygon.js":197,"../interaction/Pointer.js":128,"../interaction/Property.js":212,"../layer/Vector.js":69,"../source/Vector.js":91,"../style/Style.js":63}],125:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Feature.js"),n=q(t),r=require("../MapBrowserEventType.js"),i=q(r),o=require("../MapBrowserPointerEvent.js"),u=q(o),a=require("../coordinate.js"),l=require("../events/Event.js"),s=q(l),c=require("../extent.js"),d=require("../geom/GeometryType.js"),p=q(d),h=require("../geom/Point.js"),x=q(h),f=require("../geom/Polygon.js"),_=require("../interaction/Pointer.js"),E=q(_),y=require("../layer/Vector.js"),g=q(y),v=require("../source/Vector.js"),m=q(v),T=require("../style/Style.js");function q(e){return e&&e.__esModule?e:{default:e}}const F={EXTENTCHANGED:"extentchanged"},P=function(e){s.default.call(this,F.EXTENTCHANGED),this.extent=e};(0,e.inherits)(P,s.default);const O=function(e){const t=e||{};this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),E.default.call(this,{handleDownEvent:j,handleDragEvent:S,handleEvent:w,handleUpEvent:M}),this.extentOverlay_=new g.default({source:new m.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:H(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new g.default({source:new m.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:C(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)};function w(e){return!(e instanceof u.default)||(e.type!=i.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),_.handleEvent.call(this,e),!1)}function j(e){const t=e.pixel,n=e.map,r=this.getExtent();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=D(o(i)):null!==e?this.pointerHandler_=V(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=V(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixel(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=D(i);return!0}function S(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0}function M(e){this.pointerHandler_=null;const t=this.getExtent();return t&&0!==(0,c.getArea)(t)||this.setExtent(null),!1}function H(){const e=(0,T.createEditingStyle)();return function(t,n){return e[p.default.POLYGON]}}function C(){const e=(0,T.createEditingStyle)();return function(t,n){return e[p.default.POINT]}}function D(e){return function(t){return(0,c.boundingExtent)([e,t])}}function V(e,t){return e[0]==t[0]?function(n){return(0,c.boundingExtent)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,c.boundingExtent)([e,[t[0],n[1]]])}:null}function G(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(0,e.inherits)(O,E.default),O.prototype.snapToVertex_=function(e,t){const n=t.getCoordinateFromPixel(e),r=function(e,t){return(0,a.squaredDistanceToSegment)(n,e)-(0,a.squaredDistanceToSegment)(n,t)},i=this.getExtent();if(i){const o=G(i);o.sort(r);const u=o[0];let l=(0,a.closestOnSegment)(n,u);const s=t.getPixelFromCoordinate(l);if((0,a.distance)(e,s)<=this.pixelTolerance_){const e=t.getPixelFromCoordinate(u[0]),n=t.getPixelFromCoordinate(u[1]),r=(0,a.squaredDistance)(s,e),i=(0,a.squaredDistance)(s,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(l=r>i?u[1]:u[0]),l}}return null},O.prototype.handlePointerMove_=function(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixel(t)),this.createOrUpdatePointerFeature_(r)},O.prototype.createOrUpdateExtentFeature_=function(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,f.fromExtent)(e)):t.setGeometry(void 0):(t=e?new n.default((0,f.fromExtent)(e)):new n.default({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},O.prototype.createOrUpdatePointerFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new n.default(new x.default(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t},O.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),E.default.prototype.setMap.call(this,e)},O.prototype.getExtent=function(){return this.extent_},O.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new P(this.extent_))},exports.default=O;
},{"../index.js":94,"../Feature.js":178,"../MapBrowserEventType.js":160,"../MapBrowserPointerEvent.js":207,"../coordinate.js":179,"../events/Event.js":183,"../extent.js":140,"../geom/GeometryType.js":211,"../geom/Point.js":189,"../geom/Polygon.js":197,"../interaction/Pointer.js":128,"../layer/Vector.js":69,"../source/Vector.js":91,"../style/Style.js":63}],127:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModifyEvent=void 0;var e=require("../index.js"),t=require("../Collection.js"),i=O(t),n=require("../CollectionEventType.js"),r=O(n),s=require("../Feature.js"),o=O(s),a=require("../MapBrowserEventType.js"),u=O(a),h=require("../MapBrowserPointerEvent.js"),l=O(h),d=require("../array.js"),g=require("../coordinate.js"),c=require("../events.js"),_=require("../events/Event.js"),f=O(_),p=require("../events/EventType.js"),m=O(p),y=require("../events/condition.js"),x=require("../extent.js"),v=require("../geom/GeometryType.js"),E=O(v),C=require("../geom/Point.js"),S=O(C),F=require("../interaction/Pointer.js"),T=O(F),I=require("../layer/Vector.js"),P=O(I),G=require("../source/Vector.js"),M=O(G),w=require("../source/VectorEventType.js"),N=O(w),L=require("../structs/RBush.js"),R=O(L),q=require("../style/Style.js");function O(e){return e&&e.__esModule?e:{default:e}}const j={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},A=exports.ModifyEvent=function(e,t,i){f.default.call(this,e),this.features=t,this.mapBrowserEvent=i};(0,e.inherits)(A,f.default);const B=function(e){let t;if(T.default.call(this,{handleDownEvent:b,handleDragEvent:k,handleEvent:W,handleUpEvent:Y}),this.condition_=e.condition?e.condition:y.primaryAction,this.defaultDeleteCondition_=function(e){return(0,y.altKeyOnly)(e)&&(0,y.singleClick)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:y.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new R.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new P.default({source:new M.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:X(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new i.default(this.source_.getFeatures()),(0,c.listen)(this.source_,N.default.ADDFEATURE,this.handleSourceAdd_,this),(0,c.listen)(this.source_,N.default.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),(0,c.listen)(this.features_,r.default.ADD,this.handleFeatureAdd_,this),(0,c.listen)(this.features_,r.default.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};(0,e.inherits)(B,T.default);const D=0,U=1;function V(e,t){return e.index-t.index}function b(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);const i=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;const n=this.vertexFeature_;if(n){const r=[],s=n.getGeometry().getCoordinates(),o=(0,x.boundingExtent)([s]),a=this.rBush_.getInExtent(o),u={};a.sort(V);for(let n=0,o=a.length;n<o;++n){const o=a[n],h=o.segment;let l=(0,e.getUid)(o.feature);const d=o.depth;if(d&&(l+="-"+d.join("-")),u[l]||(u[l]=new Array(2)),o.geometry.getType()===E.default.CIRCLE&&o.index===U){const e=H(i,o);(0,g.equals)(e,s)&&!u[l][0]&&(this.dragSegments_.push([o,0]),u[l][0]=o)}else if((0,g.equals)(h[0],s)&&!u[l][0])this.dragSegments_.push([o,0]),u[l][0]=o;else if((0,g.equals)(h[1],s)&&!u[l][1]){if((o.geometry.getType()===E.default.LINE_STRING||o.geometry.getType()===E.default.MULTI_LINE_STRING)&&u[l][0]&&0===u[l][0].index)continue;this.dragSegments_.push([o,1]),u[l][1]=o}else this.insertVertexCondition_(t)&&(0,e.getUid)(h)in this.vertexSegments_&&!u[l][0]&&!u[l][1]&&r.push([o,s])}r.length&&this.willModifyFeatures_(t);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_}function k(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,s=n.geometry;let o;const a=n.segment,u=i[1];for(;t.length<s.getStride();)t.push(a[u][t.length]);switch(s.getType()){case E.default.POINT:o=t,a[0]=a[1]=t;break;case E.default.MULTI_POINT:(o=s.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case E.default.LINE_STRING:(o=s.getCoordinates())[n.index+u]=t,a[u]=t;break;case E.default.MULTI_LINE_STRING:case E.default.POLYGON:(o=s.getCoordinates())[r[0]][n.index+u]=t,a[u]=t;break;case E.default.MULTI_POLYGON:(o=s.getCoordinates())[r[1]][r[0]][n.index+u]=t,a[u]=t;break;case E.default.CIRCLE:a[0]=a[1]=t,n.index===D?(this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,s.setRadius((0,g.distance)(s.getCenter(),t)),this.changingFeature_=!1)}o&&this.setGeometryCoordinates_(s,o)}this.createOrUpdateVertexFeature_(t)}function Y(e){for(let e=this.dragSegments_.length-1;e>=0;--e){const t=this.dragSegments_[e][0],i=t.geometry;if(i.getType()===E.default.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update((0,x.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update((0,x.boundingExtent)(t.segment),t)}return this.modified_&&(this.dispatchEvent(new A(j.MODIFYEND,this.features_,e)),this.modified_=!1),!1}function W(e){if(!(e instanceof l.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=u.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=u.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==u.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),F.handleEvent.call(this,e)&&!t}function K(e,t){const i=t.geometry;if(i.getType()===E.default.CIRCLE){const n=i;if(t.index===U){const t=(0,g.squaredDistance)(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return(0,g.squaredDistanceToSegment)(e,t.segment)}function H(e,t){const i=t.geometry;return i.getType()===E.default.CIRCLE&&t.index===U?i.getClosestPoint(e):(0,g.closestOnSegment)(e,t.segment)}function X(){const e=(0,q.createEditingStyle)();return function(t,i){return e[E.default.POINT]}}B.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),(0,c.listen)(e,m.default.CHANGE,this.handleFeatureChange_,this)},B.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new A(j.MODIFYSTART,this.features_,e)))},B.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,c.unlisten)(e,m.default.CHANGE,this.handleFeatureChange_,this)},B.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},B.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),T.default.prototype.setActive.call(this,e)},B.prototype.setMap=function(e){this.overlay_.setMap(e),T.default.prototype.setMap.call(this,e)},B.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},B.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},B.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},B.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},B.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},B.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},B.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n],s={feature:e,geometry:t,depth:[n],index:n,segment:[r,r]};this.rBush_.insert(t.getExtent(),s)}},B.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length-1;n<r;++n){const r=i.slice(n,n+2),s={feature:e,geometry:t,index:n,segment:r};this.rBush_.insert((0,x.boundingExtent)(r),s)}},B.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length-1;i<s;++i){const s=r.slice(i,i+2),o={feature:e,geometry:t,depth:[n],index:i,segment:s};this.rBush_.insert((0,x.boundingExtent)(s),o)}}},B.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length-1;i<s;++i){const s=r.slice(i,i+2),o={feature:e,geometry:t,depth:[n],index:i,segment:s};this.rBush_.insert((0,x.boundingExtent)(s),o)}}},B.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length;i<s;++i){const s=r[i];for(let r=0,o=s.length-1;r<o;++r){const o=s.slice(r,r+2),a={feature:e,geometry:t,depth:[i,n],index:r,segment:o};this.rBush_.insert((0,x.boundingExtent)(o),a)}}}},B.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:D,segment:[i,i]},r={feature:e,geometry:t,index:U,segment:[i,i]},s=[n,r];n.featureSegments=r.featureSegments=s,this.rBush_.insert((0,x.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},B.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},B.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new o.default(new S.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t);return t},B.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},B.prototype.handlePointerAtPixel_=function(t,i){const n=i.getCoordinateFromPixel(t),r=function(e,t){return K(n,e)-K(n,t)},s=(0,x.buffer)((0,x.createOrUpdateFromCoordinate)(n),i.getView().getResolution()*this.pixelTolerance_),o=this.rBush_.getInExtent(s);if(o.length>0){o.sort(r);const s=o[0],a=s.segment;let u=H(n,s);const h=i.getPixelFromCoordinate(u);let l=(0,g.distance)(t,h);if(l<=this.pixelTolerance_){const t={};if(s.geometry.getType()===E.default.CIRCLE&&s.index===U)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const n=i.getPixelFromCoordinate(a[0]),r=i.getPixelFromCoordinate(a[1]),s=(0,g.squaredDistance)(h,n),d=(0,g.squaredDistance)(h,r);l=Math.sqrt(Math.min(s,d)),this.snappedToVertex_=l<=this.pixelTolerance_,this.snappedToVertex_&&(u=s>d?a[1]:a[0]),this.createOrUpdateVertexFeature_(u);for(let i=1,n=o.length;i<n;++i){const n=o[i].segment;if(!((0,g.equals)(a[0],n[0])&&(0,g.equals)(a[1],n[1])||(0,g.equals)(a[0],n[1])&&(0,g.equals)(a[1],n[0])))break;t[(0,e.getUid)(n)]=!0}}return t[(0,e.getUid)(a)]=!0,void(this.vertexSegments_=t)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},B.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,s=e.depth,o=e.index;let a;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case E.default.MULTI_LINE_STRING:case E.default.POLYGON:(a=r.getCoordinates())[s[0]].splice(o+1,0,t);break;case E.default.MULTI_POLYGON:(a=r.getCoordinates())[s[1]][s[0]].splice(o+1,0,t);break;case E.default.LINE_STRING:(a=r.getCoordinates()).splice(o+1,0,t);break;default:return}this.setGeometryCoordinates_(r,a);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,o,s,1);const h={segment:[i[0],t],feature:n,geometry:r,depth:s,index:o};u.insert((0,x.boundingExtent)(h.segment),h),this.dragSegments_.push([h,1]);const l={segment:[t,i[1]],feature:n,geometry:r,depth:s,index:o+1};u.insert((0,x.boundingExtent)(l.segment),l),this.dragSegments_.push([l,0]),this.ignoreNextSingleClick_=!0},B.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=u.default.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new A(j.MODIFYEND,this.features_,e)),this.modified_=!1,!0}return!1},B.prototype.removeVertex_=function(){const t=this.dragSegments_,i={};let n,r,s,o,a,u,h,l,d,g,c,_=!1;for(a=t.length-1;a>=0;--a)g=(s=t[a])[0],c=(0,e.getUid)(g.feature),g.depth&&(c+="-"+g.depth.join("-")),c in i||(i[c]={}),0===s[1]?(i[c].right=g,i[c].index=g.index):1==s[1]&&(i[c].left=g,i[c].index=g.index+1);for(c in i){switch(d=i[c].right,h=i[c].left,l=(u=i[c].index)-1,g=void 0!==h?h:d,l<0&&(l=0),n=r=(o=g.geometry).getCoordinates(),_=!1,o.getType()){case E.default.MULTI_LINE_STRING:r[g.depth[0]].length>2&&(r[g.depth[0]].splice(u,1),_=!0);break;case E.default.LINE_STRING:r.length>2&&(r.splice(u,1),_=!0);break;case E.default.MULTI_POLYGON:n=n[g.depth[1]];case E.default.POLYGON:(n=n[g.depth[0]]).length>4&&(u==n.length-1&&(u=0),n.splice(u,1),_=!0,0===u&&(n.pop(),n.push(n[0]),l=n.length-1))}if(_){this.setGeometryCoordinates_(o,r);const e=[];if(void 0!==h&&(this.rBush_.remove(h),e.push(h.segment[0])),void 0!==d&&(this.rBush_.remove(d),e.push(d.segment[1])),void 0!==h&&void 0!==d){const t={depth:g.depth,feature:g.feature,geometry:g.geometry,index:l,segment:e};this.rBush_.insert((0,x.boundingExtent)(t.segment),t)}this.updateSegmentIndices_(o,u,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return _},B.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},B.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||(0,d.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},exports.default=B;
},{"../index.js":94,"../Collection.js":109,"../CollectionEventType.js":187,"../Feature.js":178,"../MapBrowserEventType.js":160,"../MapBrowserPointerEvent.js":207,"../array.js":171,"../coordinate.js":179,"../events.js":153,"../events/Event.js":183,"../events/EventType.js":155,"../events/condition.js":173,"../extent.js":140,"../geom/GeometryType.js":211,"../geom/Point.js":189,"../interaction/Pointer.js":128,"../layer/Vector.js":69,"../source/Vector.js":91,"../source/VectorEventType.js":271,"../structs/RBush.js":272,"../style/Style.js":63}],129:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../CollectionEventType.js"),i=m(t),r=require("../array.js"),n=require("../events.js"),o=require("../events/Event.js"),s=m(o),a=require("../events/condition.js"),l=require("../functions.js"),u=require("../geom/GeometryType.js"),c=m(u),h=require("../interaction/Interaction.js"),d=m(h),f=require("../layer/Vector.js"),y=m(f),p=require("../obj.js"),_=require("../source/Vector.js"),g=m(_),v=require("../style/Style.js");function m(e){return e&&e.__esModule?e:{default:e}}const F={SELECT:"select"},E=function(e,t,i,r){s.default.call(this,e),this.selected=t,this.deselected=i,this.mapBrowserEvent=r};(0,e.inherits)(E,s.default);const C=function(e){d.default.call(this,{handleEvent:T});const t=e||{};this.condition_=t.condition?t.condition:a.singleClick,this.addCondition_=t.addCondition?t.addCondition:a.never,this.removeCondition_=t.removeCondition?t.removeCondition:a.never,this.toggleCondition_=t.toggleCondition?t.toggleCondition:a.shiftKeyOnly,this.multi_=!!t.multi&&t.multi,this.filter_=t.filter?t.filter:l.TRUE,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0;const o=new y.default({source:new g.default({useSpatialIndex:!1,features:t.features,wrapX:t.wrapX}),style:t.style?t.style:L(),updateWhileAnimating:!0,updateWhileInteracting:!0});let s;if(this.featureOverlay_=o,t.layers)if("function"==typeof t.layers)s=t.layers;else{const e=t.layers;s=function(t){return(0,r.includes)(e,t)}}else s=l.TRUE;this.layerFilter_=s,this.featureLayerAssociation_={};const u=this.featureOverlay_.getSource().getFeaturesCollection();(0,n.listen)(u,i.default.ADD,this.addFeature_,this),(0,n.listen)(u,i.default.REMOVE,this.removeFeature_,this)};function T(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),n=this.toggleCondition_(e),o=!t&&!i&&!n,s=e.map,l=this.featureOverlay_.getSource().getFeaturesCollection(),u=[],c=[];if(o){(0,p.clear)(this.featureLayerAssociation_),s.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return c.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=l.getLength()-1;e>=0;--e){const t=l.item(e),i=c.indexOf(t);i>-1?c.splice(i,1):(l.remove(t),u.push(t))}0!==c.length&&l.extend(c)}else{s.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!n||(0,r.includes)(l.getArray(),e)?(i||n)&&(0,r.includes)(l.getArray(),e)&&(u.push(e),this.removeFeatureLayerAssociation_(e)):(c.push(e),this.addFeatureLayerAssociation_(e,o)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=u.length-1;e>=0;--e)l.remove(u[e]);l.extend(c)}return(c.length>0||u.length>0)&&this.dispatchEvent(new E(F.SELECT,c,u,e)),(0,a.pointerMove)(e)}function L(){const e=(0,v.createEditingStyle)();return(0,r.extend)(e[c.default.POLYGON],e[c.default.LINE_STRING]),(0,r.extend)(e[c.default.GEOMETRY_COLLECTION],e[c.default.LINE_STRING]),function(t,i){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(0,e.inherits)(C,d.default),C.prototype.addFeatureLayerAssociation_=function(t,i){const r=(0,e.getUid)(t);this.featureLayerAssociation_[r]=i},C.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},C.prototype.getHitTolerance=function(){return this.hitTolerance_},C.prototype.getLayer=function(t){const i=(0,e.getUid)(t);return this.featureLayerAssociation_[i]},C.prototype.setHitTolerance=function(e){this.hitTolerance_=e},C.prototype.setMap=function(e){const t=this.getMap(),i=this.featureOverlay_.getSource().getFeaturesCollection();t&&i.forEach(t.unskipFeature.bind(t)),d.default.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&i.forEach(e.skipFeature.bind(e))},C.prototype.addFeature_=function(e){const t=this.getMap();t&&t.skipFeature(e.element)},C.prototype.removeFeature_=function(e){const t=this.getMap();t&&t.unskipFeature(e.element)},C.prototype.removeFeatureLayerAssociation_=function(t){const i=(0,e.getUid)(t);delete this.featureLayerAssociation_[i]},exports.default=C;
},{"../index.js":94,"../CollectionEventType.js":187,"../array.js":171,"../events.js":153,"../events/Event.js":183,"../events/condition.js":173,"../functions.js":144,"../geom/GeometryType.js":211,"../interaction/Interaction.js":126,"../layer/Vector.js":69,"../obj.js":96,"../source/Vector.js":91,"../style/Style.js":63}],130:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=v;var e=require("../index.js"),t=require("../Collection.js"),n=require("../CollectionEventType.js"),i=F(n),r=require("../coordinate.js"),o=require("../events.js"),s=require("../events/EventType.js"),u=F(s),a=require("../extent.js"),l=require("../functions.js"),h=require("../geom/GeometryType.js"),c=F(h),d=require("../geom/Polygon.js"),g=require("../interaction/Pointer.js"),_=F(g),f=require("../obj.js"),p=require("../source/Vector.js"),y=require("../source/VectorEventType.js"),m=F(y),x=require("../structs/RBush.js"),E=F(x);function F(e){return e&&e.__esModule?e:{default:e}}const C=function(e){_.default.call(this,{handleEvent:v,handleDownEvent:l.TRUE,handleUpEvent:T});const t=e||{};this.source_=t.source?t.source:null,this.vertex_=void 0===t.vertex||t.vertex,this.edge_=void 0===t.edge||t.edge,this.features_=t.features?t.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.sortByDistance_=G.bind(this),this.rBush_=new E.default,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}};function v(e){const t=this.snapTo(e.pixel,e.coordinate,e.map);return t.snapped&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),g.handleEvent.call(this,e)}function T(e){const t=(0,f.getValues)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}function G(e,t){return(0,r.squaredDistanceToSegment)(this.pixelCoordinate_,e.segment)-(0,r.squaredDistanceToSegment)(this.pixelCoordinate_,t.segment)}(0,e.inherits)(C,_.default),C.prototype.addFeature=function(t,n){const i=void 0===n||n,r=(0,e.getUid)(t),s=t.getGeometry();if(s){const e=this.SEGMENT_WRITERS_[s.getType()];e&&(this.indexedFeaturesExtents_[r]=s.getExtent((0,a.createEmpty)()),e.call(this,t,s))}i&&(this.featureChangeListenerKeys_[r]=(0,o.listen)(t,u.default.CHANGE,this.handleFeatureChange_,this))},C.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},C.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},C.prototype.getFeatures_=function(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},C.prototype.handleFeatureAdd_=function(e){let n;e instanceof p.VectorSourceEvent?n=e.feature:e instanceof t.CollectionEvent&&(n=e.element),this.addFeature(n)},C.prototype.handleFeatureRemove_=function(e){let n;e instanceof p.VectorSourceEvent?n=e.feature:e instanceof t.CollectionEvent&&(n=e.element),this.removeFeature(n)},C.prototype.handleFeatureChange_=function(t){const n=t.target;if(this.handlingDownUpSequence){const t=(0,e.getUid)(n);t in this.pendingFeatures_||(this.pendingFeatures_[t]=n)}else this.updateFeature_(n)},C.prototype.removeFeature=function(t,n){const i=void 0===n||n,r=(0,e.getUid)(t),s=this.indexedFeaturesExtents_[r];if(s){const e=this.rBush_,n=[];e.forEachInExtent(s,function(e){t===e.feature&&n.push(e)});for(let t=n.length-1;t>=0;--t)e.remove(n[t])}i&&((0,o.unlistenByKey)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])},C.prototype.setMap=function(e){const t=this.getMap(),n=this.featuresListenerKeys_,r=this.getFeatures_();t&&(n.forEach(o.unlistenByKey),n.length=0,r.forEach(this.forEachFeatureRemove_.bind(this))),_.default.prototype.setMap.call(this,e),e&&(this.features_?n.push((0,o.listen)(this.features_,i.default.ADD,this.handleFeatureAdd_,this),(0,o.listen)(this.features_,i.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&n.push((0,o.listen)(this.source_,m.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,o.listen)(this.source_,m.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(this.forEachFeatureAdd_.bind(this)))},C.prototype.shouldStopEvent=l.FALSE,C.prototype.snapTo=function(e,t,n){const i=n.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=n.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),s=(0,a.boundingExtent)([i,o]);let u=this.rBush_.getInExtent(s);this.vertex_&&!this.edge_&&(u=u.filter(function(e){return e.feature.getGeometry().getType()!==c.default.CIRCLE}));let l,h,d,g,_,f=!1,p=!1,y=null,m=null;if(u.length>0){this.pixelCoordinate_=t,u.sort(this.sortByDistance_);const i=u[0].segment,o=u[0].feature.getGeometry().getType()===c.default.CIRCLE;this.vertex_&&!this.edge_?(h=n.getPixelFromCoordinate(i[0]),d=n.getPixelFromCoordinate(i[1]),g=(0,r.squaredDistance)(e,h),_=(0,r.squaredDistance)(e,d),(f=(l=Math.sqrt(Math.min(g,_)))<=this.pixelTolerance_)&&(p=!0,y=g>_?i[1]:i[0],m=n.getPixelFromCoordinate(y))):this.edge_&&(y=o?(0,r.closestOnCircle)(t,u[0].feature.getGeometry()):(0,r.closestOnSegment)(t,i),m=n.getPixelFromCoordinate(y),(0,r.distance)(e,m)<=this.pixelTolerance_&&(p=!0,this.vertex_&&!o&&(h=n.getPixelFromCoordinate(i[0]),d=n.getPixelFromCoordinate(i[1]),g=(0,r.squaredDistance)(m,h),_=(0,r.squaredDistance)(m,d),(f=(l=Math.sqrt(Math.min(g,_)))<=this.pixelTolerance_)&&(y=g>_?i[1]:i[0],m=n.getPixelFromCoordinate(y))))),p&&(m=[Math.round(m[0]),Math.round(m[1])])}return{snapped:p,vertex:y,vertexPixel:m}},C.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},C.prototype.writeCircleGeometry_=function(e,t){const n=(0,d.fromCircle)(t).getCoordinates()[0];for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}},C.prototype.writeGeometryCollectionGeometry_=function(e,t){const n=t.getGeometriesArray();for(let t=0;t<n.length;++t){const i=this.SEGMENT_WRITERS_[n[t].getType()];i&&i.call(this,e,n[t])}},C.prototype.writeLineStringGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}},C.prototype.writeMultiLineStringGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}}},C.prototype.writeMultiPointGeometry_=function(e,t){const n=t.getCoordinates();for(let i=0,r=n.length;i<r;++i){const r=n[i],o={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),o)}},C.prototype.writeMultiPolygonGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length;t<n;++t){const n=i[t];for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}}}},C.prototype.writePointGeometry_=function(e,t){const n=t.getCoordinates(),i={feature:e,segment:[n,n]};this.rBush_.insert(t.getExtent(),i)},C.prototype.writePolygonGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}}},exports.default=C;
},{"../index.js":94,"../Collection.js":109,"../CollectionEventType.js":187,"../coordinate.js":179,"../events.js":153,"../events/EventType.js":155,"../extent.js":140,"../functions.js":144,"../geom/GeometryType.js":211,"../geom/Polygon.js":197,"../interaction/Pointer.js":128,"../obj.js":96,"../source/Vector.js":91,"../source/VectorEventType.js":271,"../structs/RBush.js":272}],131:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TranslateEvent=void 0;var t=require("../index.js"),e=require("../Collection.js"),i=f(e),s=require("../Object.js"),a=require("../events.js"),n=require("../events/Event.js"),r=f(n),o=require("../functions.js"),l=require("../array.js"),u=require("../interaction/Pointer.js"),h=f(u),c=require("../interaction/Property.js"),d=f(c);function f(t){return t&&t.__esModule?t:{default:t}}const _={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},p=exports.TranslateEvent=function(t,e,i){r.default.call(this,t),this.features=e,this.coordinate=i};(0,t.inherits)(p,r.default);const T=function(t){h.default.call(this,{handleDownEvent:g,handleDragEvent:A,handleMoveEvent:y,handleUpEvent:v});const e=t||{};let i;if(this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,e.layers)if("function"==typeof e.layers)i=e.layers;else{const t=e.layers;i=function(e){return(0,l.includes)(t,e)}}else i=o.TRUE;this.layerFilter_=i,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.lastFeature_=null,(0,a.listen)(this,(0,s.getChangeEventType)(d.default.ACTIVE),this.handleActiveChanged_,this)};function g(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,y.call(this,t);const e=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new p(_.TRANSLATESTART,e,t.coordinate)),!0}return!1}function v(t){if(this.lastCoordinate_){this.lastCoordinate_=null,y.call(this,t);const e=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new p(_.TRANSLATEEND,e,t.coordinate)),!0}return!1}function A(t){if(this.lastCoordinate_){const e=t.coordinate,s=e[0]-this.lastCoordinate_[0],a=e[1]-this.lastCoordinate_[1],n=this.features_||new i.default([this.lastFeature_]);n.forEach(function(t){const e=t.getGeometry();e.translate(s,a),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new p(_.TRANSLATING,n,e))}}function y(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}(0,t.inherits)(T,h.default),T.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||(0,l.includes)(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},T.prototype.getHitTolerance=function(){return this.hitTolerance_},T.prototype.setHitTolerance=function(t){this.hitTolerance_=t},T.prototype.setMap=function(t){const e=this.getMap();h.default.prototype.setMap.call(this,t),this.updateState_(e)},T.prototype.handleActiveChanged_=function(){this.updateState_(null)},T.prototype.updateState_=function(t){let e=this.getMap();const i=this.getActive();if((!e||!i)&&(e=e||t)){e.getViewport().classList.remove("ol-grab","ol-grabbing")}},exports.default=T;
},{"../index.js":94,"../Collection.js":109,"../Object.js":145,"../events.js":153,"../events/Event.js":183,"../functions.js":144,"../array.js":171,"../interaction/Pointer.js":128,"../interaction/Property.js":212}],42:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Translate=exports.Snap=exports.Select=exports.Pointer=exports.PinchZoom=exports.PinchRotate=exports.MouseWheelZoom=exports.Modify=exports.KeyboardZoom=exports.KeyboardPan=exports.Interaction=exports.Extent=exports.Draw=exports.DragZoom=exports.DragRotateAndZoom=exports.DragRotate=exports.DragPan=exports.DragBox=exports.DragAndDrop=exports.DoubleClickZoom=void 0;var e=require("./interaction/DoubleClickZoom.js");Object.defineProperty(exports,"DoubleClickZoom",{enumerable:!0,get:function(){return K(e).default}});var t=require("./interaction/DragAndDrop.js");Object.defineProperty(exports,"DragAndDrop",{enumerable:!0,get:function(){return K(t).default}});var r=require("./interaction/DragBox.js");Object.defineProperty(exports,"DragBox",{enumerable:!0,get:function(){return K(r).default}});var o=require("./interaction/DragPan.js");Object.defineProperty(exports,"DragPan",{enumerable:!0,get:function(){return K(o).default}});var n=require("./interaction/DragRotate.js");Object.defineProperty(exports,"DragRotate",{enumerable:!0,get:function(){return K(n).default}});var a=require("./interaction/DragRotateAndZoom.js");Object.defineProperty(exports,"DragRotateAndZoom",{enumerable:!0,get:function(){return K(a).default}});var i=require("./interaction/DragZoom.js");Object.defineProperty(exports,"DragZoom",{enumerable:!0,get:function(){return K(i).default}});var u=require("./interaction/Draw.js");Object.defineProperty(exports,"Draw",{enumerable:!0,get:function(){return K(u).default}});var s=require("./interaction/Extent.js");Object.defineProperty(exports,"Extent",{enumerable:!0,get:function(){return K(s).default}});var c=require("./interaction/Interaction.js");Object.defineProperty(exports,"Interaction",{enumerable:!0,get:function(){return K(c).default}});var d=require("./interaction/KeyboardPan.js");Object.defineProperty(exports,"KeyboardPan",{enumerable:!0,get:function(){return K(d).default}});var l=require("./interaction/KeyboardZoom.js");Object.defineProperty(exports,"KeyboardZoom",{enumerable:!0,get:function(){return K(l).default}});var f=require("./interaction/Modify.js");Object.defineProperty(exports,"Modify",{enumerable:!0,get:function(){return K(f).default}});var p=require("./interaction/MouseWheelZoom.js");Object.defineProperty(exports,"MouseWheelZoom",{enumerable:!0,get:function(){return K(p).default}});var m=require("./interaction/PinchRotate.js");Object.defineProperty(exports,"PinchRotate",{enumerable:!0,get:function(){return K(m).default}});var b=require("./interaction/PinchZoom.js");Object.defineProperty(exports,"PinchZoom",{enumerable:!0,get:function(){return K(b).default}});var x=require("./interaction/Pointer.js");Object.defineProperty(exports,"Pointer",{enumerable:!0,get:function(){return K(x).default}});var g=require("./interaction/Select.js");Object.defineProperty(exports,"Select",{enumerable:!0,get:function(){return K(g).default}});var j=require("./interaction/Snap.js");Object.defineProperty(exports,"Snap",{enumerable:!0,get:function(){return K(j).default}});var D=require("./interaction/Translate.js");Object.defineProperty(exports,"Translate",{enumerable:!0,get:function(){return K(D).default}}),exports.defaults=A;var P=require("./Collection.js"),y=K(P),v=require("./Kinetic.js"),h=K(v),Z=K(e),q=K(o),O=K(n),R=K(i),w=K(d),k=K(l),M=K(p),S=K(m),z=K(b);function K(e){return e&&e.__esModule?e:{default:e}}function A(e){const t=e||{},r=new y.default,o=new h.default(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&r.push(new O.default),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&r.push(new Z.default({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&r.push(new q.default({kinetic:o})),(void 0===t.pinchRotate||t.pinchRotate)&&r.push(new S.default),(void 0===t.pinchZoom||t.pinchZoom)&&r.push(new z.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(r.push(new w.default),r.push(new k.default({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&r.push(new M.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&r.push(new R.default({duration:t.zoomDuration})),r}
},{"./Collection.js":109,"./Kinetic.js":110,"./interaction/DoubleClickZoom.js":112,"./interaction/DragPan.js":113,"./interaction/DragRotate.js":116,"./interaction/DragZoom.js":114,"./interaction/KeyboardPan.js":115,"./interaction/KeyboardZoom.js":117,"./interaction/MouseWheelZoom.js":119,"./interaction/PinchRotate.js":118,"./interaction/PinchZoom.js":120,"./interaction/DragAndDrop.js":122,"./interaction/DragBox.js":121,"./interaction/DragRotateAndZoom.js":123,"./interaction/Draw.js":124,"./interaction/Extent.js":125,"./interaction/Interaction.js":126,"./interaction/Modify.js":127,"./interaction/Pointer.js":128,"./interaction/Select.js":129,"./interaction/Snap.js":130,"./interaction/Translate.js":131}],182:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.ERROR_THRESHOLD=.5,t=exports.ENABLE_RASTER_REPROJECTION=!0;
},{}],213:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./events/EventTarget.js"),n=r(e),o=require("./events/EventType.js"),i=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const s=function(t,e,o,i){n.default.call(this),this.extent=t,this.pixelRatio_=o,this.resolution=e,this.state=i};(0,t.inherits)(s,n.default),s.prototype.changed=function(){this.dispatchEvent(i.default.CHANGE)},s.prototype.getExtent=function(){return this.extent},s.prototype.getImage=function(){},s.prototype.getPixelRatio=function(){return this.pixelRatio_},s.prototype.getResolution=function(){return this.resolution},s.prototype.getState=function(){return this.state},s.prototype.load=function(){},exports.default=s;
},{"./index.js":94,"./events/EventTarget.js":205,"./events/EventType.js":155}],139:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./ImageBase.js"),r=i(e),a=require("./ImageState.js"),s=i(a);function i(t){return t&&t.__esModule?t:{default:t}}const o=function(t,e,a,i,o){this.loader_=void 0!==o?o:null;const n=void 0!==o?s.default.IDLE:s.default.LOADED;r.default.call(this,t,e,a,n),this.canvas_=i,this.error_=null};(0,t.inherits)(o,r.default),o.prototype.getError=function(){return this.error_},o.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=s.default.ERROR):this.state=s.default.LOADED,this.changed()},o.prototype.load=function(){this.state==s.default.IDLE&&(this.state=s.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},o.prototype.getImage=function(){return this.canvas_},exports.default=o;
},{"./index.js":94,"./ImageBase.js":213,"./ImageState.js":152}],217:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../events/Event.js"),s=r(t);function r(e){return e&&e.__esModule?e:{default:e}}const i=function(e,t,r,i,n){s.default.call(this,e),this.vectorContext=t,this.frameState=r,this.context=i,this.glContext=n};(0,e.inherits)(i,s.default),exports.default=i;
},{"../index.js":94,"../events/Event.js":183}],312:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(){};t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},exports.default=t;
},{}],222:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../../array.js"),i=require("../../colorlike.js"),s=require("../../extent.js"),o=require("../../geom/GeometryType.js"),n=S(o),a=require("../../geom/SimpleGeometry.js"),l=require("../../geom/flat/transform.js"),h=require("../../has.js"),r=require("../VectorContext.js"),_=S(r),f=require("../canvas.js"),g=require("../../transform.js");function S(t){return t&&t.__esModule?t:{default:t}}const x=function(t,e,i,s,o){_.default.call(this),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=s,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageSnapToPixel_=!1,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,g.create)()};(0,t.inherits)(x,_.default),x.prototype.drawImages_=function(t,e,i,s){if(!this.image_)return;const o=(0,l.transform2D)(t,e,i,2,this.transform_,this.pixelCoordinates_),n=this.context_,a=this.tmpLocalTransform_,h=n.globalAlpha;1!=this.imageOpacity_&&(n.globalAlpha=h*this.imageOpacity_);let r=this.imageRotation_;this.imageRotateWithView_&&(r+=this.viewRotation_);for(let t=0,e=o.length;t<e;t+=2){let e=o[t]-this.imageAnchorX_,i=o[t+1]-this.imageAnchorY_;if(this.imageSnapToPixel_&&(e=Math.round(e),i=Math.round(i)),0!==r||1!=this.imageScale_){const t=e+this.imageAnchorX_,s=i+this.imageAnchorY_;(0,g.compose)(a,t,s,this.imageScale_,this.imageScale_,r,-t,-s),n.setTransform.apply(n,a)}n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}0===r&&1==this.imageScale_||n.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(n.globalAlpha=h)},x.prototype.drawText_=function(t,e,i,s){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const o=(0,l.transform2D)(t,e,i,s,this.transform_,this.pixelCoordinates_),n=this.context_;let a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=s){const t=o[e]+this.textOffsetX_,i=o[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){const e=(0,g.compose)(this.tmpLocalTransform_,t,i,this.textScale_,this.textScale_,a,-t,-i);n.setTransform.apply(n,e)}this.textStrokeState_&&n.strokeText(this.text_,t,i),this.textFillState_&&n.fillText(this.text_,t,i)}0===a&&1==this.textScale_||n.setTransform(1,0,0,1,0,0)},x.prototype.moveToLineTo_=function(t,e,i,s,o){const n=this.context_,a=(0,l.transform2D)(t,e,i,s,this.transform_,this.pixelCoordinates_);n.moveTo(a[0],a[1]);let h=a.length;o&&(h-=2);for(let t=2;t<h;t+=2)n.lineTo(a[t],a[t+1]);return o&&n.closePath(),i},x.prototype.drawRings_=function(t,e,i,s){for(let o=0,n=i.length;o<n;++o)e=this.moveToLineTo_(t,e,i[o],s,!0);return e},x.prototype.drawCircle=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=(0,a.transformGeom2D)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],s=e[3]-e[1],o=Math.sqrt(i*i+s*s),n=this.context_;n.beginPath(),n.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},x.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},x.prototype.drawGeometry=function(t){switch(t.getType()){case n.default.POINT:this.drawPoint(t);break;case n.default.LINE_STRING:this.drawLineString(t);break;case n.default.POLYGON:this.drawPolygon(t);break;case n.default.MULTI_POINT:this.drawMultiPoint(t);break;case n.default.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case n.default.MULTI_POLYGON:this.drawMultiPolygon(t);break;case n.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case n.default.CIRCLE:this.drawCircle(t)}},x.prototype.drawFeature=function(t,e){const i=e.getGeometryFunction()(t);i&&(0,s.intersects)(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},x.prototype.drawGeometryCollection=function(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])},x.prototype.drawPoint=function(t){const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},x.prototype.drawMultiPoint=function(t){const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},x.prototype.drawLineString=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}},x.prototype.drawMultiLineString=function(t){const e=t.getExtent();if((0,s.intersects)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let s=0;const o=t.getEnds(),n=t.getStride();e.beginPath();for(let t=0,e=o.length;t<e;++t)s=this.moveToLineTo_(i,s,o[t],n,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}},x.prototype.drawPolygon=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}},x.prototype.drawMultiPolygon=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const o=t.getEndss(),n=t.getStride();e.beginPath();for(let t=0,e=o.length;t<e;++t){const e=o[t];s=this.drawRings_(i,s,e,n)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}},x.prototype.setContextFillState_=function(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},x.prototype.setContextStrokeState_=function(t){const i=this.context_,s=this.contextStrokeState_;s?(s.lineCap!=t.lineCap&&(s.lineCap=i.lineCap=t.lineCap),h.CANVAS_LINE_DASH&&((0,e.equals)(s.lineDash,t.lineDash)||i.setLineDash(s.lineDash=t.lineDash),s.lineDashOffset!=t.lineDashOffset&&(s.lineDashOffset=i.lineDashOffset=t.lineDashOffset)),s.lineJoin!=t.lineJoin&&(s.lineJoin=i.lineJoin=t.lineJoin),s.lineWidth!=t.lineWidth&&(s.lineWidth=i.lineWidth=t.lineWidth),s.miterLimit!=t.miterLimit&&(s.miterLimit=i.miterLimit=t.miterLimit),s.strokeStyle!=t.strokeStyle&&(s.strokeStyle=i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,h.CANVAS_LINE_DASH&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},x.prototype.setContextTextState_=function(t){const e=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:f.defaultTextAlign;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=s&&(i.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})},x.prototype.setFillStrokeStyle=function(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:(0,i.asColorLike)(e||f.defaultFillStyle)}}else this.fillState_=null;if(e){const t=e.getColor(),s=e.getLineCap(),o=e.getLineDash(),n=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==s?s:f.defaultLineCap,lineDash:o||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==a?a:f.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==l?l:f.defaultLineWidth),miterLimit:void 0!==h?h:f.defaultMiterLimit,strokeStyle:(0,i.asColorLike)(t||f.defaultStrokeStyle)}}else this.strokeState_=null},x.prototype.setImageStyle=function(t){if(t){const e=t.getAnchor(),i=t.getImage(1),s=t.getOrigin(),o=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=o[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageSnapToPixel_=t.getSnapToPixel(),this.imageWidth_=o[0]}else this.image_=null},x.prototype.setTextStyle=function(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:(0,i.asColorLike)(t||f.defaultFillStyle)}}else this.textFillState_=null;const s=t.getStroke();if(s){const t=s.getColor(),e=s.getLineCap(),o=s.getLineDash(),n=s.getLineDashOffset(),a=s.getLineJoin(),l=s.getWidth(),h=s.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:f.defaultLineCap,lineDash:o||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==a?a:f.defaultLineJoin,lineWidth:void 0!==l?l:f.defaultLineWidth,miterLimit:void 0!==h?h:f.defaultMiterLimit,strokeStyle:(0,i.asColorLike)(t||f.defaultStrokeStyle)}}else this.textStrokeState_=null;const o=t.getFont(),n=t.getOffsetX(),a=t.getOffsetY(),l=t.getRotateWithView(),h=t.getRotation(),r=t.getScale(),_=t.getText(),g=t.getTextAlign(),S=t.getTextBaseline();this.textState_={font:void 0!==o?o:f.defaultFont,textAlign:void 0!==g?g:f.defaultTextAlign,textBaseline:void 0!==S?S:f.defaultTextBaseline},this.text_=void 0!==_?_:"",this.textOffsetX_=void 0!==n?this.pixelRatio_*n:0,this.textOffsetY_=void 0!==a?this.pixelRatio_*a:0,this.textRotateWithView_=void 0!==l&&l,this.textRotation_=void 0!==h?h:0,this.textScale_=this.pixelRatio_*(void 0!==r?r:1)}else this.text_=""},exports.default=x;
},{"../../index.js":94,"../../array.js":171,"../../colorlike.js":244,"../../extent.js":140,"../../geom/GeometryType.js":211,"../../geom/SimpleGeometry.js":236,"../../geom/flat/transform.js":281,"../../has.js":225,"../VectorContext.js":312,"../canvas.js":218,"../../transform.js":214}],294:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../ImageState.js"),i=g(t),n=require("../Observable.js"),o=g(n),r=require("../TileState.js"),a=g(r),u=require("../events.js"),s=require("../events/EventType.js"),d=g(s),l=require("../functions.js"),c=require("../source/State.js"),f=g(c);function g(e){return e&&e.__esModule?e:{default:e}}const p=function(e){o.default.call(this),this.layer_=e};(0,e.inherits)(p,o.default),p.prototype.forEachFeatureAtCoordinate=l.UNDEFINED,p.prototype.hasFeatureAtCoordinate=l.FALSE,p.prototype.createLoadedTileFinder=function(e,t,i){return function(n,o){return e.forEachLoadedTile(t,n,o,function(e){i[n]||(i[n]={}),i[n][e.tileCoord.toString()]=e})}},p.prototype.getLayer=function(){return this.layer_},p.prototype.handleImageChange_=function(e){e.target.getState()===i.default.LOADED&&this.renderIfReadyAndVisible()},p.prototype.loadImage=function(e){let t=e.getState();return t!=i.default.LOADED&&t!=i.default.ERROR&&(0,u.listen)(e,d.default.CHANGE,this.handleImageChange_,this),t==i.default.IDLE&&(e.load(),t=e.getState()),t==i.default.LOADED},p.prototype.renderIfReadyAndVisible=function(){const e=this.getLayer();e.getVisible()&&e.getSourceState()==f.default.READY&&this.changed()},p.prototype.scheduleExpireCache=function(t,i){if(i.canExpireCache()){const n=function(t,i,n){const o=(0,e.getUid)(t).toString();o in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[o])}.bind(null,i);t.postRenderFunctions.push(n)}},p.prototype.updateUsedTiles=function(t,i,n,o){const r=(0,e.getUid)(i).toString(),a=n.toString();r in t?a in t[r]?t[r][a].extend(o):t[r][a]=o:(t[r]={},t[r][a]=o)},p.prototype.manageTilePyramid=function(t,i,n,o,r,u,s,d,l,c){const f=(0,e.getUid)(i).toString();f in t.wantedTiles||(t.wantedTiles[f]={});const g=t.wantedTiles[f],p=t.tileQueue;let h,y,E,S,T,C;for(C=n.getMinZoom();C<=s;++C)for(y=n.getTileRangeForExtentAndZ(u,C,y),E=n.getResolution(C),S=y.minX;S<=y.maxX;++S)for(T=y.minY;T<=y.maxY;++T)s-C<=d?((h=i.getTile(C,S,T,o,r)).getState()==a.default.IDLE&&(g[h.getKey()]=!0,p.isKeyQueued(h.getKey())||p.enqueue([h,f,n.getTileCoordCenter(h.tileCoord),E])),void 0!==l&&l.call(c,h)):i.useTile(C,S,T,r)},exports.default=p;
},{"../index.js":94,"../ImageState.js":152,"../Observable.js":226,"../TileState.js":147,"../events.js":153,"../events/EventType.js":155,"../functions.js":144,"../source/State.js":154}],256:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../extent.js"),o=require("../../functions.js"),r=require("../../render/Event.js"),i=d(r),n=require("../../render/EventType.js"),s=d(n),a=require("../../render/canvas.js"),p=require("../../render/canvas/Immediate.js"),f=d(p),c=require("../Layer.js"),u=d(c),l=require("../../transform.js");function d(e){return e&&e.__esModule?e:{default:e}}const h=function(e){u.default.call(this,e),this.renderedResolution,this.transform_=(0,l.create)()};(0,e.inherits)(h,u.default),h.prototype.clip=function(e,o,r){const i=o.pixelRatio,n=o.size[0]*i,s=o.size[1]*i,p=o.viewState.rotation,f=(0,t.getTopLeft)(r),c=(0,t.getTopRight)(r),u=(0,t.getBottomRight)(r),d=(0,t.getBottomLeft)(r);(0,l.apply)(o.coordinateToPixelTransform,f),(0,l.apply)(o.coordinateToPixelTransform,c),(0,l.apply)(o.coordinateToPixelTransform,u),(0,l.apply)(o.coordinateToPixelTransform,d),e.save(),(0,a.rotateAtOffset)(e,-p,n/2,s/2),e.beginPath(),e.moveTo(f[0]*i,f[1]*i),e.lineTo(c[0]*i,c[1]*i),e.lineTo(u[0]*i,u[1]*i),e.lineTo(d[0]*i,d[1]*i),e.clip(),(0,a.rotateAtOffset)(e,p,n/2,s/2)},h.prototype.dispatchComposeEvent_=function(e,t,o,r){const n=this.getLayer();if(n.hasListener(e)){const s=o.size[0]*o.pixelRatio,p=o.size[1]*o.pixelRatio,c=o.viewState.rotation;(0,a.rotateAtOffset)(t,-c,s/2,p/2);const u=void 0!==r?r:this.getTransform(o,0),l=new f.default(t,o.pixelRatio,o.extent,u,o.viewState.rotation),d=new i.default(e,l,o,t,null);n.dispatchEvent(d),(0,a.rotateAtOffset)(t,c,s/2,p/2)}},h.prototype.forEachLayerAtCoordinate=function(e,t,r,i){return this.forEachFeatureAtCoordinate(e,t,0,o.TRUE,this)?r.call(i,this.getLayer(),null):void 0},h.prototype.postCompose=function(e,t,o,r){this.dispatchComposeEvent_(s.default.POSTCOMPOSE,e,t,r)},h.prototype.preCompose=function(e,t,o){this.dispatchComposeEvent_(s.default.PRECOMPOSE,e,t,o)},h.prototype.dispatchRenderEvent=function(e,t,o){this.dispatchComposeEvent_(s.default.RENDER,e,t,o)},h.prototype.getTransform=function(e,t){const o=e.viewState,r=e.pixelRatio,i=r*e.size[0]/2,n=r*e.size[1]/2,s=r/o.resolution,a=-s,p=-o.rotation,f=-o.center[0]+t,c=-o.center[1];return(0,l.compose)(this.transform_,i,n,s,a,p,f,c)},h.prototype.composeFrame=function(e,t,o){},h.prototype.prepareFrame=function(e,t){},exports.default=h;
},{"../../index.js":94,"../../extent.js":140,"../../functions.js":144,"../../render/Event.js":217,"../../render/EventType.js":170,"../../render/canvas.js":218,"../../render/canvas/Immediate.js":222,"../Layer.js":294,"../../transform.js":214}],227:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../../coordinate.js"),o=require("../../dom.js"),a=require("../../extent.js"),r=require("../../functions.js"),n=require("../canvas/Layer.js"),i=h(n),s=require("../../transform.js");function h(t){return t&&t.__esModule?t:{default:t}}const c=function(t){i.default.call(this,t),this.coordinateToCanvasPixelTransform=(0,s.create)(),this.hitCanvasContext_=null};(0,t.inherits)(c,i.default),c.prototype.composeFrame=function(t,e,o){this.preCompose(o,t);const r=this.getImage();if(r){const n=e.extent,i=void 0!==n&&!(0,a.containsExtent)(n,t.extent)&&(0,a.intersects)(n,t.extent);i&&this.clip(o,t,n);const s=this.getImageTransform(),h=o.globalAlpha;o.globalAlpha=e.opacity;const c=s[4],u=s[5],l=r.width*s[0],d=r.height*s[3];o.drawImage(r,0,0,+r.width,+r.height,Math.round(c),Math.round(u),Math.round(l),Math.round(d)),o.globalAlpha=h,i&&o.restore()}this.postCompose(o,t,e)},c.prototype.getImage=function(){},c.prototype.getImageTransform=function(){},c.prototype.forEachFeatureAtCoordinate=function(t,e,o,a,r){const n=this.getLayer(),i=n.getSource(),s=e.viewState.resolution,h=e.viewState.rotation,c=e.skippedFeatureUids;return i.forEachFeatureAtCoordinate(t,s,h,o,c,function(t){return a.call(r,t,n)})},c.prototype.forEachLayerAtCoordinate=function(t,a,n,h){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==r.UNDEFINED)return i.default.prototype.forEachLayerAtCoordinate.apply(this,arguments);{const r=(0,s.apply)(this.coordinateToCanvasPixelTransform,t.slice());(0,e.scale)(r,a.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=(0,o.createCanvasContext2D)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),r[0],r[1],1,1,0,0,1,1);const i=this.hitCanvasContext_.getImageData(0,0,1,1).data;return i[3]>0?n.call(h,this.getLayer(),i):void 0}}},exports.default=c;
},{"../../index.js":94,"../../coordinate.js":179,"../../dom.js":148,"../../extent.js":140,"../../functions.js":144,"../canvas/Layer.js":256,"../../transform.js":214}],100:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../reproj/common.js"),t=require("../../index.js"),r=require("../../ImageCanvas.js"),i=m(r),s=require("../../LayerType.js"),o=m(s),n=require("../../ViewHint.js"),a=m(n),u=require("../../array.js"),c=require("../../extent.js"),d=require("../../layer/VectorRenderType.js"),p=m(d),l=require("../../obj.js"),h=require("../canvas/IntermediateCanvas.js"),f=m(h),g=require("../../transform.js");function m(e){return e&&e.__esModule?e:{default:e}}const _=function(e){f.default.call(this,e),this.image_=null,this.imageTransform_=(0,g.create)(),this.skippedFeatures_=[],this.vectorRenderer_=null};(0,t.inherits)(_,f.default),_.handles=function(e){return e.getType()===o.default.IMAGE||e.getType()===o.default.VECTOR&&e.getRenderMode()===p.default.IMAGE},_.create=function(e,t){const r=new _(t);if(t.getType()===o.default.VECTOR){const i=e.getLayerRendererConstructors();for(let s=0,o=i.length;s<o;++s){const o=i[s];if(o!==_&&o.handles(t)){r.setVectorRenderer(o.create(e,t));break}}}return r},_.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),f.default.prototype.disposeInternal.call(this)},_.prototype.getImage=function(){return this.image_?this.image_.getImage():null},_.prototype.getImageTransform=function(){return this.imageTransform_},_.prototype.prepareFrame=function(t,r){const s=t.pixelRatio,o=t.size,n=t.viewState,d=n.center,p=n.resolution;let h;const f=this.getLayer().getSource(),m=t.viewHints;let _=t.extent;if(void 0!==r.extent&&(_=(0,c.getIntersection)(_,r.extent)),!m[a.default.ANIMATING]&&!m[a.default.INTERACTING]&&!(0,c.isEmpty)(_)){let o=n.projection;if(!e.ENABLE_RASTER_REPROJECTION){const e=f.getProjection();e&&(o=e)}const a=this.vectorRenderer_;if(a){const e=a.context,o=(0,l.assign)({},t,{size:[(0,c.getWidth)(_)/p,(0,c.getHeight)(_)/p],viewState:(0,l.assign)({},t.viewState,{rotation:0})}),n=Object.keys(o.skippedFeatureUids).sort();!a.prepareFrame(o,r)||!a.replayGroupChanged&&(0,u.equals)(n,this.skippedFeatures_)||(e.canvas.width=o.size[0]*s,e.canvas.height=o.size[1]*s,a.composeFrame(o,r,e),this.image_=new i.default(_,p,s,e.canvas),this.skippedFeatures_=n)}else if(h=f.getImage(_,p,s,o)){this.loadImage(h)&&(this.image_=h)}}if(this.image_){const e=(h=this.image_).getExtent(),t=h.getResolution(),r=h.getPixelRatio(),i=s*t/(p*r),n=(0,g.compose)(this.imageTransform_,s*o[0]/2,s*o[1]/2,i,i,0,r*(e[0]-d[0])/t,r*(d[1]-e[3])/t);(0,g.compose)(this.coordinateToCanvasPixelTransform,s*o[0]/2-n[4],s*o[1]/2-n[5],s/p,-s/p,0,-d[0],-d[1]),this.renderedResolution=t*s/r}return!!this.image_},_.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,s){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,r,i,s):f.default.prototype.forEachFeatureAtCoordinate.call(this,e,t,r,i,s)},_.prototype.setVectorRenderer=function(e){this.vectorRenderer_&&this.vectorRenderer_.dispose(),this.vectorRenderer_=e},exports.default=_;
},{"../../reproj/common.js":182,"../../index.js":94,"../../ImageCanvas.js":139,"../../LayerType.js":105,"../../ViewHint.js":186,"../../array.js":171,"../../extent.js":140,"../../layer/VectorRenderType.js":165,"../../obj.js":96,"../canvas/IntermediateCanvas.js":227,"../../transform.js":214}],206:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shared=void 0;var e=require("../color.js");const t=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function c(t,c,i){return c+":"+t+":"+(i?(0,e.asString)(i):"null")}t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){let e=0;for(const t in this.cache_){const c=this.cache_[t];0!=(3&e++)||c.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}},t.prototype.get=function(e,t,i){const s=c(e,t,i);return s in this.cache_?this.cache_[s]:null},t.prototype.set=function(e,t,i,s){const h=c(e,t,i);this.cache_[h]=s,++this.cacheSize_},t.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},exports.default=t;const i=exports.shared=new t;
},{"../color.js":135}],219:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sortByZIndex=h;var e=require("../index.js"),r=require("../Disposable.js"),t=c(r),n=require("../events.js"),o=require("../events/EventType.js"),s=c(o),i=require("../extent.js"),a=require("../functions.js"),u=require("../layer/Layer.js"),d=require("../style/IconImageCache.js"),y=require("../transform.js");function c(e){return e&&e.__esModule?e:{default:e}}const l=function(e){t.default.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]};function p(e,r){d.shared.expire()}function h(e,r){return e.zIndex-r.zIndex}(0,e.inherits)(l,t.default),l.prototype.registerLayerRenderers=function(e){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,e)},l.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},l.prototype.calculateMatrices2D=function(e){const r=e.viewState,t=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;(0,y.compose)(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),(0,y.invert)((0,y.setFromArray)(n,t))},l.prototype.removeLayerRenderers=function(){for(const e in this.layerRenderers_)this.removeLayerRendererByKey_(e).dispose()},l.prototype.forEachFeatureAtCoordinate=function(r,t,n,o,s,a,d){let y;const c=t.viewState,l=c.resolution;function p(r,n){const i=(0,e.getUid)(r).toString(),a=t.layerStates[(0,e.getUid)(n)].managed;if(!(i in t.skippedFeatureUids)||a)return o.call(s,r,a?n:null)}const h=c.projection;let f=r;if(h.canWrapX()){const e=h.getExtent(),t=(0,i.getWidth)(e),n=r[0];if(n<e[0]||n>e[2]){f=[n+t*Math.ceil((e[0]-n)/t),r[1]]}}const R=t.layerStatesArray;let _;for(_=R.length-1;_>=0;--_){const e=R[_],o=e.layer;if((0,u.visibleAtResolution)(e,l)&&a.call(d,o)){const e=this.getLayerRenderer(o);if(o.getSource()&&(y=e.forEachFeatureAtCoordinate(o.getSource().getWrapX()?f:r,t,n,p,s)),y)return y}}},l.prototype.forEachLayerAtPixel=function(e,r,t,n,o,s){},l.prototype.hasFeatureAtCoordinate=function(e,r,t,n,o){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,a.TRUE,this,n,o)},l.prototype.getLayerRenderer=function(r){const t=(0,e.getUid)(r).toString();if(t in this.layerRenderers_)return this.layerRenderers_[t];{let e;for(let t=0,n=this.layerRendererConstructors_.length;t<n;++t){const n=this.layerRendererConstructors_[t];if(n.handles(r)){e=n.create(this,r);break}}if(!e)throw new Error("Unable to create renderer for layer: "+r.getType());return this.layerRenderers_[t]=e,this.layerRendererListeners_[t]=(0,n.listen)(e,s.default.CHANGE,this.handleLayerRendererChange_,this),e}},l.prototype.getLayerRendererByKey=function(e){return this.layerRenderers_[e]},l.prototype.getLayerRenderers=function(){return this.layerRenderers_},l.prototype.getMap=function(){return this.map_},l.prototype.handleLayerRendererChange_=function(){this.map_.render()},l.prototype.removeLayerRendererByKey_=function(e){const r=this.layerRenderers_[e];return delete this.layerRenderers_[e],(0,n.unlistenByKey)(this.layerRendererListeners_[e]),delete this.layerRendererListeners_[e],r},l.prototype.renderFrame=a.UNDEFINED,l.prototype.removeUnusedLayerRenderers_=function(e,r){for(const e in this.layerRenderers_)r&&e in r.layerStates||this.removeLayerRendererByKey_(e).dispose()},l.prototype.scheduleExpireIconCache=function(e){e.postRenderFunctions.push(p)},l.prototype.scheduleRemoveUnusedLayerRenderers=function(e){for(const r in this.layerRenderers_)if(!(r in e.layerStates))return void e.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},exports.default=l;
},{"../index.js":94,"../Disposable.js":245,"../events.js":153,"../events/EventType.js":155,"../extent.js":140,"../functions.js":144,"../layer/Layer.js":68,"../style/IconImageCache.js":206,"../transform.js":214}],101:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../transform.js"),t=require("../../index.js"),s=require("../../array.js"),r=require("../../css.js"),i=require("../../dom.js"),a=require("../../layer/Layer.js"),n=require("../../render/Event.js"),o=y(n),c=require("../../render/EventType.js"),l=y(c),h=require("../../render/canvas.js"),d=require("../../render/canvas/Immediate.js"),u=y(d),p=require("../Map.js"),v=y(p),f=require("../../source/State.js"),_=y(f);function y(e){return e&&e.__esModule?e:{default:e}}const m=function(t){v.default.call(this,t);const s=t.getViewport();this.context_=(0,i.createCanvasContext2D)(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=r.CLASS_UNSELECTABLE,s.insertBefore(this.canvas_,s.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=(0,e.create)()};(0,t.inherits)(m,v.default),m.prototype.dispatchComposeEvent_=function(e,t){const s=this.getMap(),r=this.context_;if(s.hasListener(e)){const i=t.extent,a=t.pixelRatio,n=t.viewState.rotation,c=this.getTransform(t),l=new u.default(r,a,i,c,n),h=new o.default(e,l,t,r,null);s.dispatchEvent(h)}},m.prototype.getTransform=function(t){const s=t.viewState,r=this.canvas_.width/2,i=this.canvas_.height/2,a=t.pixelRatio/s.resolution,n=-a,o=-s.rotation,c=-s.center[0],l=-s.center[1];return(0,e.compose)(this.transform_,r,i,a,n,o,c,l)},m.prototype.renderFrame=function(e){if(!e)return void(this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1));const t=this.context_,r=e.pixelRatio,i=Math.round(e.size[0]*r),n=Math.round(e.size[1]*r);this.canvas_.width!=i||this.canvas_.height!=n?(this.canvas_.width=i,this.canvas_.height=n):t.clearRect(0,0,i,n);const o=e.viewState.rotation;this.calculateMatrices2D(e),this.dispatchComposeEvent_(l.default.PRECOMPOSE,e);const c=e.layerStatesArray;(0,s.stableSort)(c,p.sortByZIndex),o&&(t.save(),(0,h.rotateAtOffset)(t,o,i/2,n/2));const d=e.viewState.resolution;let u,v,f,y,m;for(u=0,v=c.length;u<v;++u)f=(m=c[u]).layer,y=this.getLayerRenderer(f),(0,a.visibleAtResolution)(m,d)&&m.sourceState==_.default.READY&&y.prepareFrame(e,m)&&y.composeFrame(e,m,t);o&&t.restore(),this.dispatchComposeEvent_(l.default.POSTCOMPOSE,e),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(e),this.scheduleExpireIconCache(e)},m.prototype.forEachLayerAtPixel=function(t,s,r,i,n,o){let c;const l=s.viewState.resolution,h=s.layerStatesArray,d=h.length,u=(0,e.apply)(s.pixelToCoordinateTransform,t.slice());let p;for(p=d-1;p>=0;--p){const e=h[p],t=e.layer;if((0,a.visibleAtResolution)(e,l)&&n.call(o,t)){if(c=this.getLayerRenderer(t).forEachLayerAtCoordinate(u,s,r,i))return c}}},exports.default=m;
},{"../../transform.js":214,"../../index.js":94,"../../array.js":171,"../../css.js":203,"../../dom.js":148,"../../layer/Layer.js":68,"../../render/Event.js":217,"../../render/EventType.js":170,"../../render/canvas.js":218,"../../render/canvas/Immediate.js":222,"../Map.js":219,"../../source/State.js":154}],251:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=i;const t=function(t,i,n,m){this.minX=t,this.maxX=i,this.minY=n,this.maxY=m};function i(i,n,m,e,s){return void 0!==s?(s.minX=i,s.maxX=n,s.minY=m,s.maxY=e,s):new t(i,n,m,e)}t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},exports.default=t;
},{}],102:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../LayerType.js"),i=T(t),n=require("../../TileRange.js"),r=T(n),s=require("../../TileState.js"),o=T(s),a=require("../../ViewHint.js"),l=T(a),d=require("../../dom.js"),h=require("../../extent.js"),u=require("../canvas/IntermediateCanvas.js"),g=T(u),c=require("../../transform.js");function T(e){return e&&e.__esModule?e:{default:e}}const m=function(e){g.default.call(this,e),this.context=null===this.context?null:(0,d.createCanvasContext2D)(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.tmpExtent=(0,h.createEmpty)(),this.tmpTileRange_=new r.default(0,0,0,0),this.imageTransform_=(0,c.create)(),this.zDirection=0};(0,e.inherits)(m,g.default),m.handles=function(e){return e.getType()===i.default.TILE},m.create=function(e,t){return new m(t)},m.prototype.isDrawableTile_=function(e){const t=e.getState(),i=this.getLayer().getUseInterimTilesOnError();return t==o.default.LOADED||t==o.default.EMPTY||t==o.default.ERROR&&!i},m.prototype.prepareFrame=function(t,i){const n=t.pixelRatio,r=t.size,s=t.viewState,a=s.projection,d=s.resolution,u=s.center,g=this.getLayer(),T=g.getSource(),m=T.getRevision(),f=T.getTileGridForProjection(a),p=f.getZForResolution(d,this.zDirection),x=f.getResolution(p);let R=Math.round(d/x)||1,E=t.extent;if(void 0!==i.extent&&(E=(0,h.getIntersection)(E,i.extent)),(0,h.isEmpty)(E))return!1;const _=f.getTileRangeForExtentAndZ(E,p),v=f.getTileRangeExtent(p,_),y=T.getTilePixelRatio(n),w={};w[p]={};const I=this.createLoadedTileFinder(T,a,w),j=this.tmpExtent,C=this.tmpTileRange_;let D,S,q,A=!1;for(S=_.minX;S<=_.maxX;++S)for(q=_.minY;q<=_.maxY;++q){if((D=T.getTile(p,S,q,n,a)).getState()==o.default.ERROR&&(g.getUseInterimTilesOnError()?g.getPreload()>0&&(A=!0):D.setState(o.default.LOADED)),this.isDrawableTile_(D)||(D=D.getInterimTile()),this.isDrawableTile_(D)){const i=(0,e.getUid)(this);if(D.getState()==o.default.LOADED){w[p][D.tileCoord.toString()]=D;const e=D.inTransition(i);A||!e&&-1!==this.renderedTiles.indexOf(D)||(A=!0)}if(1===D.getAlpha(i,t.time))continue}const i=f.getTileCoordChildTileRange(D.tileCoord,C,j);let r=!1;i&&(r=I(p+1,i)),r||f.forEachTileCoordParentTileRange(D.tileCoord,I,null,C,j)}const L=x*n/y*R,O=t.viewHints,P=O[l.default.ANIMATING]||O[l.default.INTERACTING];if(!(this.renderedResolution&&Date.now()-t.time>16&&P)&&(A||!this.renderedExtent_||!(0,h.containsExtent)(this.renderedExtent_,E)||this.renderedRevision!=m||R!=this.oversampling_||!P&&L!=this.renderedResolution)){const e=this.context;if(e){const t=T.getTilePixelSize(p,n,a),i=Math.round(_.getWidth()*t[0]/R),r=Math.round(_.getHeight()*t[1]/R),s=e.canvas;s.width!=i||s.height!=r?(this.oversampling_=R,s.width=i,s.height=r):(this.renderedExtent_&&!(0,h.equals)(v,this.renderedExtent_)&&e.clearRect(0,0,i,r),R=this.oversampling_)}this.renderedTiles.length=0;const r=Object.keys(w).map(Number);let s,o,l,d,u,g,c,E,I,C,A;for(r.sort(function(e,t){return e===p?1:t===p?-1:e>t?1:e<t?-1:0}),u=0,g=r.length;u<g;++u){d=r[u],l=T.getTilePixelSize(d,n,a),o=(s=f.getResolution(d))/x,E=y*T.getGutter(a),I=w[d];for(const e in I)D=I[e],S=((c=f.getTileCoordExtent(D.getTileCoord(),j))[0]-v[0])/x*y/R,q=(v[3]-c[3])/x*y/R,C=l[0]*o/R,A=l[1]*o/R,this.drawTileImage(D,t,i,S,q,C,A,E,p===d),this.renderedTiles.push(D)}this.renderedRevision=m,this.renderedResolution=x*n/y*R,this.renderedExtent_=v}const b=this.renderedResolution/d,M=(0,c.compose)(this.imageTransform_,n*r[0]/2,n*r[1]/2,b,b,0,(this.renderedExtent_[0]-u[0])/this.renderedResolution*n,(u[1]-this.renderedExtent_[3])/this.renderedResolution*n);return(0,c.compose)(this.coordinateToCanvasPixelTransform,n*r[0]/2-M[4],n*r[1]/2-M[5],n/d,-n/d,0,-u[0],-u[1]),this.updateUsedTiles(t.usedTiles,T,p,_),this.manageTilePyramid(t,T,f,n,a,E,p,g.getPreload()),this.scheduleExpireCache(t,T),this.renderedTiles.length>0},m.prototype.drawTileImage=function(t,i,n,r,s,o,a,l,d){const h=t.getImage(this.getLayer());if(!h)return;const u=(0,e.getUid)(this),g=d?t.getAlpha(u,i.time):1;1!==g||this.getLayer().getSource().getOpaque(i.viewState.projection)||this.context.clearRect(r,s,o,a);const c=g!==this.context.globalAlpha;c&&(this.context.save(),this.context.globalAlpha=g),this.context.drawImage(h,l,l,h.width-2*l,h.height-2*l,r,s,o,a),c&&this.context.restore(),1!==g?i.animate=!0:d&&t.endTransition(u)},m.prototype.getImage=function(){const e=this.context;return e?e.canvas:null},m.prototype.getLayer,m.prototype.getImageTransform=function(){return this.imageTransform_},exports.default=m;
},{"../../index.js":94,"../../LayerType.js":105,"../../TileRange.js":251,"../../TileState.js":147,"../../ViewHint.js":186,"../../dom.js":148,"../../extent.js":140,"../canvas/IntermediateCanvas.js":227,"../../transform.js":214}],305:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(){};t.prototype.getReplay=function(t,e){},t.prototype.isEmpty=function(){},exports.default=t;
},{}],282:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};
},{}],333:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawTextOnPath=a;var t=require("../../math.js");function a(a,e,h,r,o,s,n,M){const l=[],p=a[e]>a[h-r],u=o.length;let c,i,P,f=a[e],I=a[e+1],w=a[e+=r],d=a[e+1],q=0,v=Math.sqrt(Math.pow(w-f,2)+Math.pow(d-I,2)),x="",b=0;for(let j=0;j<u;++j){i=p?u-j-1:j;const O=o.charAt(i),_=s(x=p?O+x:x+O)-b;b+=_;const g=n+_/2;for(;e<h-r&&q+v<g;)f=w,I=d,w=a[e+=r],d=a[e+1],q+=v,v=Math.sqrt(Math.pow(w-f,2)+Math.pow(d-I,2));const m=g-q;let y=Math.atan2(d-I,w-f);if(p&&(y+=y>0?-Math.PI:Math.PI),void 0!==P){let t=y-P;if(t+=t>Math.PI?-2*Math.PI:t<-Math.PI?2*Math.PI:0,Math.abs(t)>M)return null}const A=m/v,T=(0,t.lerp)(f,w,A),k=(0,t.lerp)(I,d,A);P==y?(p&&(c[0]=T,c[1]=k,c[2]=_/2),c[4]=x):(b=_,c=[T,k,_/2,y,x=O],p?l.unshift(c):l.push(c),P=y),n+=_}return l}
},{"../../math.js":157}],324:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},E=exports.fillInstruction=[t.FILL],e=exports.strokeInstruction=[t.STROKE],_=exports.beginPathInstruction=[t.BEGIN_PATH],s=exports.closePathInstruction=[t.CLOSE_PATH];exports.default=t;
},{}],283:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEXT_ALIGN=exports.ORDER=void 0;var e=require("../render/ReplayType.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}const d=exports.ORDER=[t.default.POLYGON,t.default.CIRCLE,t.default.LINE_STRING,t.default.IMAGE,t.default.TEXT,t.default.DEFAULT],a=exports.TEXT_ALIGN={};a.left=0,a.end=0,a.center=.5,a.right=1,a.start=1,a.top=0,a.middle=.5,a.hanging=.2,a.alphabetic=.8,a.ideographic=.8,a.bottom=1;
},{"../render/ReplayType.js":282}],306:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../../functions.js"),i=require("../../array.js"),n=require("../../colorlike.js"),s=require("../../extent.js"),o=require("../../extent/Relationship.js"),r=S(o),l=require("../../geom/GeometryType.js"),a=S(l),h=require("../../geom/flat/inflate.js"),u=require("../../geom/flat/length.js"),c=require("../../geom/flat/textpath.js"),d=require("../../geom/flat/transform.js"),f=require("../../has.js"),p=require("../../obj.js"),y=require("../VectorContext.js"),g=S(y),_=require("../canvas.js"),m=require("../canvas/Instruction.js"),E=S(m),x=require("../replay.js"),L=require("../../transform.js");function S(t){return t&&t.__esModule?t:{default:t}}const T=function(t,e,i,n,s,o){g.default.call(this),this.declutterTree=o,this.tolerance=t,this.maxExtent=e,this.overlaps=s,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.fillOrigin_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=(0,L.create)(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0};(0,t.inherits)(T,g.default);const C=(0,s.createEmpty)(),I=(0,L.create)();T.prototype.replayTextBackground_=function(t,e,i,n,s,o,r){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.fillOrigin_=o[2],this.fill_(t)),r&&(this.setStrokeStyle_(t,r),t.stroke())},T.prototype.replayImage_=function(t,e,i,n,o,r,l,a,h,u,c,d,f,p,y,g,m,E){const x=m||E;e-=o*=f,i-=r*=f;const S=y+u>n.width?n.width-u:y,T=a+c>n.height?n.height-c:a,O=g[3]+S*f+g[1],k=g[0]+T*f+g[2],D=e-g[3],b=i-g[0];let v,G,M,R;(x||0!==d)&&(v=[D,b],G=[D+O,b],M=[D+O,b+k],R=[D,b+k]);let N=null;if(0!==d){const t=e+o,n=i+r;N=(0,L.compose)(I,t,n,1,1,d,-t,-n),(0,s.createOrUpdateEmpty)(C),(0,s.extendCoordinate)(C,(0,L.apply)(I,v)),(0,s.extendCoordinate)(C,(0,L.apply)(I,G)),(0,s.extendCoordinate)(C,(0,L.apply)(I,M)),(0,s.extendCoordinate)(C,(0,L.apply)(I,R))}else(0,s.createOrUpdate)(D,b,D+O,b+k,C);const q=t.canvas,j=E?E[2]*f/2:0,F=C[0]-j<=q.width&&C[2]+j>=0&&C[1]-j<=q.height&&C[3]+j>=0;if(p&&(e=Math.round(e),i=Math.round(i)),l){if(!F&&1==l[4])return;(0,s.extend)(l,C);const o=F?[t,N?N.slice(0):null,h,n,u,c,S,T,e,i,f]:null;o&&x&&o.push(m,E,v,G,M,R),l.push(o)}else F&&(x&&this.replayTextBackground_(t,v,G,M,R,m,E),(0,_.drawImage)(t,N,h,n,u,c,S,T,e,i,f))},T.prototype.applyPixelRatio=function(t){const e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},T.prototype.appendFlatCoordinates=function(t,e,i,n,o,l){let a=this.coordinates.length;const h=this.getBufferedMaxExtent();l&&(e+=n);const u=[t[e],t[e+1]],c=[NaN,NaN];let d,f,p,y=!0;for(d=e+n;d<i;d+=n)c[0]=t[d],c[1]=t[d+1],(p=(0,s.coordinateRelationship)(h,c))!==f?(y&&(this.coordinates[a++]=u[0],this.coordinates[a++]=u[1]),this.coordinates[a++]=c[0],this.coordinates[a++]=c[1],y=!1):p===r.default.INTERSECTING?(this.coordinates[a++]=c[0],this.coordinates[a++]=c[1],y=!1):y=!0,u[0]=c[0],u[1]=c[1],f=p;return(o&&y||d===e+n)&&(this.coordinates[a++]=u[0],this.coordinates[a++]=u[1]),a},T.prototype.drawCustomCoordinates_=function(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o],l=this.appendFlatCoordinates(t,e,r,n,!1,!1);s.push(l),e=r}return e},T.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);const n=t.getType(),s=t.getStride(),o=this.coordinates.length;let r,l,u,c,d;if(n==a.default.MULTI_POLYGON){r=(t=t).getOrientedFlatCoordinates(),c=[];const e=t.getEndss();d=0;for(let t=0,i=e.length;t<i;++t){const i=[];d=this.drawCustomCoordinates_(r,d,e[t],s,i),c.push(i)}this.instructions.push([E.default.CUSTOM,o,c,t,i,h.inflateMultiCoordinatesArray])}else n==a.default.POLYGON||n==a.default.MULTI_LINE_STRING?(u=[],r=n==a.default.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(r,0,t.getEnds(),s,u),this.instructions.push([E.default.CUSTOM,o,u,t,i,h.inflateCoordinatesArray])):n==a.default.LINE_STRING||n==a.default.MULTI_POINT?(r=t.getFlatCoordinates(),l=this.appendFlatCoordinates(r,0,r.length,s,!1,!1),this.instructions.push([E.default.CUSTOM,o,l,t,i,h.inflateCoordinates])):n==a.default.POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),l=this.coordinates.length,this.instructions.push([E.default.CUSTOM,o,l,t,i]));this.endGeometry(t,e)},T.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[E.default.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[E.default.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},T.prototype.fill_=function(t){if(this.fillOrigin_){const e=(0,L.apply)(this.renderedTransform_,this.fillOrigin_.slice());t.translate(e[0],e[1]),t.rotate(this.viewRotation_)}t.fill(),this.fillOrigin_&&t.setTransform.apply(t,_.resetTransform)},T.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],f.CANVAS_LINE_DASH&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},T.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){const i=t[4];if(1==i||i==t.length-5){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(i)){this.declutterTree.insert(i);for(let e=5,i=t.length;e<i;++e){const i=t[e];i&&(i.length>11&&this.replayTextBackground_(i[0],i[13],i[14],i[15],i[16],i[11],i[12]),_.drawImage.apply(void 0,i))}}t.length=5,(0,s.createOrUpdateEmpty)(t)}}},T.prototype.replay_=function(e,n,o,r,l,a){let h;this.pixelCoordinates_&&(0,i.equals)(n,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=(0,d.transform2D)(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),(0,L.setFromArray)(this.renderedTransform_,n));const f=!(0,p.isEmpty)(o);let y=0;const g=r.length;let m,S,T,C,I,O,k,D,b,v=0,G=0,M=0,R=null,N=null;const q=this.coordinateCache_,j=this.viewRotation_,F={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:j},w=this.instructions!=r||this.overlaps?0:200;let P,W,Y;for(;y<g;){const i=r[y];switch(i[0]){case E.default.BEGIN_GEOMETRY:P=i[1],f&&o[(0,t.getUid)(P).toString()]||!P.getGeometry()?y=i[2]:void 0===a||(0,s.intersects)(a,P.getGeometry().getExtent())?++y:y=i[2]+1;break;case E.default.BEGIN_PATH:G>w&&(this.fill_(e),G=0),M>w&&(e.stroke(),M=0),G||M||(e.beginPath(),C=I=NaN),++y;break;case E.default.CIRCLE:const n=h[v=i[1]],r=h[v+1],d=h[v+2]-n,p=h[v+3]-r,g=Math.sqrt(d*d+p*p);e.moveTo(n+g,r),e.arc(n,r,g,0,2*Math.PI,!0),++y;break;case E.default.CLOSE_PATH:e.closePath(),++y;break;case E.default.CUSTOM:v=i[1],m=i[2];const L=i[3],A=i[4],U=6==i.length?i[5]:void 0;F.geometry=L,F.feature=P,y in q||(q[y]=[]);const B=q[y];U?U(h,v,m,2,B):(B[0]=h[v],B[1]=h[v+1],B.length=2),A(B,F),++y;break;case E.default.DRAW_IMAGE:v=i[1],m=i[2],b=i[3],S=i[4],T=i[5],D=l?null:i[6];const J=i[7],H=i[8],K=i[9],V=i[10],X=i[11];let z=i[12];const Q=i[13],Z=i[14],$=i[15];let tt,et,it;for(i.length>16?(tt=i[16],et=i[17],it=i[18]):(tt=_.defaultPadding,et=it=!1),X&&(z+=j);v<m;v+=2)this.replayImage_(e,h[v],h[v+1],b,S,T,D,J,H,K,V,z,Q,Z,$,tt,et?R:null,it?N:null);this.renderDeclutter_(D,P),++y;break;case E.default.DRAW_CHARS:const nt=i[1],st=i[2],ot=i[3];D=l?null:i[4];const rt=i[5],lt=i[6],at=i[7],ht=i[8],ut=i[9],ct=i[10],dt=i[11],ft=i[12],pt=i[13],yt=i[14],gt=(0,u.lineStringLength)(h,nt,st,2),_t=ht(ft);if(rt||_t<=gt){const t=this.textStates[pt].textAlign,i=(gt-_t)*x.TEXT_ALIGN[t],n=(0,c.drawTextOnPath)(h,nt,st,2,ft,ht,i,at);if(n){let t,i,s,o,r;if(ct)for(t=0,i=n.length;t<i;++t)s=(r=n[t])[4],o=this.getImage(s,pt,"",ct),S=r[2]+dt,T=ot*o.height+2*(.5-ot)*dt-ut,this.replayImage_(e,r[0],r[1],o,S,T,D,o.height,1,0,0,r[3],yt,!1,o.width,_.defaultPadding,null,null);if(lt)for(t=0,i=n.length;t<i;++t)s=(r=n[t])[4],o=this.getImage(s,pt,lt,""),S=r[2],T=ot*o.height-ut,this.replayImage_(e,r[0],r[1],o,S,T,D,o.height,1,0,0,r[3],yt,!1,o.width,_.defaultPadding,null,null)}}this.renderDeclutter_(D,P),++y;break;case E.default.END_GEOMETRY:if(void 0!==l){const t=l(P=i[1]);if(t)return t}++y;break;case E.default.FILL:w?G++:this.fill_(e),++y;break;case E.default.MOVE_TO_LINE_TO:for(v=i[1],m=i[2],W=h[v],k=(Y=h[v+1])+.5|0,(O=W+.5|0)===C&&k===I||(e.moveTo(W,Y),C=O,I=k),v+=2;v<m;v+=2)O=(W=h[v])+.5|0,k=(Y=h[v+1])+.5|0,v!=m-2&&O===C&&k===I||(e.lineTo(W,Y),C=O,I=k);++y;break;case E.default.SET_FILL_STYLE:R=i,this.fillOrigin_=i[2],G&&(this.fill_(e),G=0,M&&(e.stroke(),M=0)),e.fillStyle=i[1],++y;break;case E.default.SET_STROKE_STYLE:N=i,M&&(e.stroke(),M=0),this.setStrokeStyle_(e,i),++y;break;case E.default.STROKE:w?M++:e.stroke(),++y;break;default:++y}}G&&this.fill_(e),M&&e.stroke()},T.prototype.replay=function(t,e,i,n){this.viewRotation_=i,this.replay_(t,e,n,this.instructions,void 0,void 0)},T.prototype.replayHitDetection=function(t,e,i,n,s,o){return this.viewRotation_=i,this.replay_(t,e,n,this.hitDetectionInstructions,s,o)},T.prototype.reverseHitDetectionInstructions=function(){const t=this.hitDetectionInstructions;let e;t.reverse();const n=t.length;let s,o,r=-1;for(e=0;e<n;++e)(o=(s=t[e])[0])==E.default.END_GEOMETRY?r=e:o==E.default.BEGIN_GEOMETRY&&(s[2]=e,(0,i.reverseSubArray)(this.hitDetectionInstructions,r,e),r=-1)},T.prototype.setFillStrokeStyle=function(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=(0,n.asColorLike)(e||_.defaultFillStyle)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=(0,n.asColorLike)(t||_.defaultStrokeStyle);const s=e.getLineCap();i.lineCap=void 0!==s?s:_.defaultLineCap;const o=e.getLineDash();i.lineDash=o?o.slice():_.defaultLineDash;const r=e.getLineDashOffset();i.lineDashOffset=r||_.defaultLineDashOffset;const l=e.getLineJoin();i.lineJoin=void 0!==l?l:_.defaultLineJoin;const a=e.getWidth();i.lineWidth=void 0!==a?a:_.defaultLineWidth;const h=e.getMiterLimit();i.miterLimit=void 0!==h?h:_.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},T.prototype.createFill=function(t,e){const i=t.fillStyle,n=[E.default.SET_FILL_STYLE,i];if("string"!=typeof i){const t=e.getExtent();n.push([t[0],t[3]])}return n},T.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},T.prototype.createStroke=function(t){return[E.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},T.prototype.updateFillStyle=function(t,e,i){const n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=n)},T.prototype.updateStrokeStyle=function(t,e){const n=t.strokeStyle,s=t.lineCap,o=t.lineDash,r=t.lineDashOffset,l=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=s||o!=t.currentLineDash&&!(0,i.equals)(t.currentLineDash,o)||t.currentLineDashOffset!=r||t.currentLineJoin!=l||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=s,t.currentLineDash=o,t.currentLineDashOffset=r,t.currentLineJoin=l,t.currentLineWidth=a,t.currentMiterLimit=h)},T.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const i=[E.default.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},T.prototype.finish=e.UNDEFINED,T.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,s.clone)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,s.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},exports.default=T;
},{"../../index.js":94,"../../functions.js":144,"../../array.js":171,"../../colorlike.js":244,"../../extent.js":140,"../../extent/Relationship.js":292,"../../geom/GeometryType.js":211,"../../geom/flat/inflate.js":254,"../../geom/flat/length.js":261,"../../geom/flat/textpath.js":333,"../../geom/flat/transform.js":281,"../../has.js":225,"../../obj.js":96,"../VectorContext.js":312,"../canvas.js":218,"../canvas/Instruction.js":324,"../replay.js":283,"../../transform.js":214}],307:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),i=require("../canvas/Instruction.js"),h=o(i),e=require("../canvas/Replay.js"),s=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const n=function(t,i,h,e,o,n){s.default.call(this,t,i,h,e,o,n),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.snapToPixel_=void 0,this.width_=void 0};(0,t.inherits)(n,s.default),n.prototype.drawCoordinates_=function(t,i,h,e){return this.appendFlatCoordinates(t,i,h,e,!1,!1)},n.prototype.drawPoint=function(t,i){if(!this.image_)return;this.beginGeometry(t,i);const e=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(e,0,e.length,s);this.instructions.push([h.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([h.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)},n.prototype.drawMultiPoint=function(t,i){if(!this.image_)return;this.beginGeometry(t,i);const e=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(e,0,e.length,s);this.instructions.push([h.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([h.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)},n.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.snapToPixel_=void 0,this.width_=void 0},n.prototype.setImageStyle=function(t,i){const h=t.getAnchor(),e=t.getSize(),s=t.getHitDetectionImage(1),o=t.getImage(1),n=t.getOrigin();this.anchorX_=h[0],this.anchorY_=h[1],this.declutterGroup_=i,this.hitDetectionImage_=s,this.image_=o,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.snapToPixel_=t.getSnapToPixel(),this.width_=e[0]},exports.default=n;
},{"../../index.js":94,"../canvas/Instruction.js":324,"../canvas/Replay.js":306}],308:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../canvas/Instruction.js"),i=o(e),s=require("../canvas/Replay.js"),n=o(s);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t,e,i,s,o,r){n.default.call(this,t,e,i,s,o,r)};(0,t.inherits)(r,n.default),r.prototype.drawFlatCoordinates_=function(t,e,s,n){const o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,s,n,!1,!1),a=[i.default.MOVE_TO_LINE_TO,o,r];return this.instructions.push(a),this.hitDetectionInstructions.push(a),s},r.prototype.drawLineString=function(t,s){const n=this.state,o=n.strokeStyle,r=n.lineWidth;if(void 0===o||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,s),this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],e.beginPathInstruction);const a=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(a,0,a.length,h),this.hitDetectionInstructions.push(e.strokeInstruction),this.endGeometry(t,s)},r.prototype.drawMultiLineString=function(t,s){const n=this.state,o=n.strokeStyle,r=n.lineWidth;if(void 0===o||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,s),this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],e.beginPathInstruction);const a=t.getEnds(),h=t.getFlatCoordinates(),l=t.getStride();let u=0;for(let t=0,e=a.length;t<e;++t)u=this.drawFlatCoordinates_(h,u,a[t],l);this.hitDetectionInstructions.push(e.strokeInstruction),this.endGeometry(t,s)},r.prototype.finish=function(){const t=this.state;void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(e.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null},r.prototype.applyStroke=function(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(e.strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,n.default.prototype.applyStroke.call(this,t),this.instructions.push(e.beginPathInstruction)},exports.default=r;
},{"../../index.js":94,"../canvas/Instruction.js":324,"../canvas/Replay.js":306}],309:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),i=require("../../color.js"),e=require("../../geom/flat/simplify.js"),s=require("../canvas.js"),n=require("../canvas/Instruction.js"),o=h(n),r=require("../canvas/Replay.js"),l=h(r);function h(t){return t&&t.__esModule?t:{default:t}}const u=function(t,i,e,s,n,o){l.default.call(this,t,i,e,s,n,o)};(0,t.inherits)(u,l.default),u.prototype.drawFlatCoordinatess_=function(t,i,e,s){const r=this.state,l=void 0!==r.fillStyle,h=void 0!=r.strokeStyle,u=e.length;this.instructions.push(n.beginPathInstruction),this.hitDetectionInstructions.push(n.beginPathInstruction);for(let r=0;r<u;++r){const l=e[r],u=this.coordinates.length,c=this.appendFlatCoordinates(t,i,l,s,!0,!h),a=[o.default.MOVE_TO_LINE_TO,u,c];this.instructions.push(a),this.hitDetectionInstructions.push(a),h&&(this.instructions.push(n.closePathInstruction),this.hitDetectionInstructions.push(n.closePathInstruction)),i=l}return this.hitDetectionInstructions.push(n.fillInstruction),l&&this.instructions.push(n.fillInstruction),h&&(this.instructions.push(n.strokeInstruction),this.hitDetectionInstructions.push(n.strokeInstruction)),i},u.prototype.drawCircle=function(t,e){const r=this.state,l=r.fillStyle,h=r.strokeStyle;if(void 0===l&&void 0===h)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);const u=t.getFlatCoordinates(),c=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(u,0,u.length,c,!1,!1);const d=[o.default.CIRCLE,a];this.instructions.push(n.beginPathInstruction,d),this.hitDetectionInstructions.push(n.beginPathInstruction,d),this.hitDetectionInstructions.push(n.fillInstruction),void 0!==r.fillStyle&&this.instructions.push(n.fillInstruction),void 0!==r.strokeStyle&&(this.instructions.push(n.strokeInstruction),this.hitDetectionInstructions.push(n.strokeInstruction)),this.endGeometry(t,e)},u.prototype.drawPolygon=function(t,e){const n=this.state;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const r=t.getEnds(),l=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(l,0,r,h),this.endGeometry(t,e)},u.prototype.drawMultiPolygon=function(t,e){const n=this.state,r=n.fillStyle,l=n.strokeStyle;if(void 0===r&&void 0===l)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const h=t.getEndss(),u=t.getOrientedFlatCoordinates(),c=t.getStride();let a=0;for(let t=0,i=h.length;t<i;++t)a=this.drawFlatCoordinatess_(u,a,h[t],c);this.endGeometry(t,e)},u.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const i=this.coordinates;for(let s=0,n=i.length;s<n;++s)i[s]=(0,e.snap)(i[s],t)}},u.prototype.setFillStrokeStyles_=function(t){const i=this.state;void 0!==i.fillStyle&&this.updateFillStyle(i,this.createFill,t),void 0!==i.strokeStyle&&this.updateStrokeStyle(i,this.applyStroke)},exports.default=u;
},{"../../index.js":94,"../../color.js":135,"../../geom/flat/simplify.js":263,"../canvas.js":218,"../canvas/Instruction.js":324,"../canvas/Replay.js":306}],332:[function(require,module,exports) {
"use strict";function t(t,e,o,r,s){let n,c,i,u,a,d,h,f,l,p,v=o,M=o,x=0,_=0,b=o;for(c=o;c<r;c+=s){const o=e[c],r=e[c+1];void 0!==a&&(l=o-a,p=r-d,u=Math.sqrt(l*l+p*p),void 0!==h&&(_+=i,(n=Math.acos((h*l+f*p)/(i*u)))>t&&(_>x&&(x=_,v=b,M=c),_=0,b=c-s)),i=u,h=l,f=p),a=o,d=r}return(_+=u)>x?[b,c]:[v,M]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.matchingChunk=t;
},{}],210:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINT:"point",LINE:"line"};
},{}],310:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.measureTextWidths=p;var t=require("../../index.js"),e=require("../../colorlike.js"),i=require("../../dom.js"),s=require("../../extent.js"),l=require("../../geom/flat/straightchunk.js"),n=require("../../geom/GeometryType.js"),a=_(n),o=require("../../has.js"),h=require("../canvas.js"),r=require("../canvas/Instruction.js"),f=_(r),d=require("../canvas/Replay.js"),u=_(d),c=require("../replay.js"),g=require("../../style/TextPlacement.js"),x=_(g);function _(t){return t&&t.__esModule?t:{default:t}}const S=function(t,e,i,s,l,n){u.default.call(this,t,e,i,s,l,n),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},h.labelCache.prune()};function p(t,e,i){const s=e.length;let l=0;for(let n=0;n<s;++n){const s=(0,h.measureTextWidth)(t,e[n]);l=Math.max(l,s),i.push(s)}return l}(0,t.inherits)(S,u.default),S.prototype.drawText=function(t,e){const i=this.textFillState_,n=this.textStrokeState_,o=this.textState_;if(""===this.text_||!o||!i&&!n)return;let h=this.coordinates.length;const r=t.getType();let f,d,u=null,c=2,g=2;if(o.placement===x.default.LINE){if(!(0,s.intersects)(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(u=t.getFlatCoordinates(),g=t.getStride(),r==a.default.LINE_STRING)i=[u.length];else if(r==a.default.MULTI_LINE_STRING)i=t.getEnds();else if(r==a.default.POLYGON)i=t.getEnds().slice(0,1);else if(r==a.default.MULTI_POLYGON){const e=t.getEndss();for(i=[],f=0,d=e.length;f<d;++f)i.push(e[f][0])}this.beginGeometry(t,e);const n=o.textAlign;let x,_=0;for(let t=0,e=i.length;t<e;++t){if(void 0==n){const e=(0,l.matchingChunk)(o.maxAngle,u,_,i[t],g);_=e[0],x=e[1]}else x=i[t];for(f=_;f<x;f+=g)this.coordinates.push(u[f],u[f+1]);c=this.coordinates.length,_=i[t],this.drawChars_(h,c,this.declutterGroup_),h=c}this.endGeometry(t,e)}else{const i=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),s=i.width/this.pixelRatio;switch(r){case a.default.POINT:case a.default.MULTI_POINT:c=(u=t.getFlatCoordinates()).length;break;case a.default.LINE_STRING:u=t.getFlatMidpoint();break;case a.default.CIRCLE:u=t.getCenter();break;case a.default.MULTI_LINE_STRING:c=(u=t.getFlatMidpoints()).length;break;case a.default.POLYGON:if(u=t.getFlatInteriorPoint(),!o.overflow&&u[2]/this.resolution<s)return;g=3;break;case a.default.MULTI_POLYGON:const e=t.getFlatInteriorPoints();for(u=[],f=0,d=e.length;f<d;f+=3)(o.overflow||e[f+2]/this.resolution>=s)&&u.push(e[f],e[f+1]);if(0==(c=u.length))return}c=this.appendFlatCoordinates(u,0,c,g,!1,!1),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(i,h,c),this.endGeometry(t,e)}},S.prototype.getImage=function(t,e,s,l){let n;const a=l+e+t+s+this.pixelRatio;if(!h.labelCache.containsKey(a)){const r=l?this.strokeStates[l]||this.textStrokeState_:null,f=s?this.fillStates[s]||this.textFillState_:null,d=this.textStates[e]||this.textState_,u=this.pixelRatio,g=d.scale*u,x=c.TEXT_ALIGN[d.textAlign||h.defaultTextAlign],_=l&&r.lineWidth?r.lineWidth:0,S=t.split("\n"),k=S.length,y=[],m=p(d.font,S,y),L=(0,h.measureTextHeight)(d.font),T=L*k,I=m+_,A=(0,i.createCanvasContext2D)(Math.ceil(I*g),Math.ceil((T+_)*g));n=A.canvas,h.labelCache.set(a,n),1!=g&&A.scale(g,g),A.font=d.font,l&&(A.strokeStyle=r.strokeStyle,A.lineWidth=_*(o.SAFARI?g:1),A.lineCap=r.lineCap,A.lineJoin=r.lineJoin,A.miterLimit=r.miterLimit,o.CANVAS_LINE_DASH&&r.lineDash.length&&(A.setLineDash(r.lineDash),A.lineDashOffset=r.lineDashOffset)),s&&(A.fillStyle=f.fillStyle),A.textBaseline="middle",A.textAlign="center";const F=.5-x,O=x*n.width/g+F*_;let C;if(l)for(C=0;C<k;++C)A.strokeText(S[C],O+F*y[C],.5*(_+L)+C*L);if(s)for(C=0;C<k;++C)A.fillText(S[C],O+F*y[C],.5*(_+L)+C*L)}return h.labelCache.get(a)},S.prototype.drawTextImage_=function(t,e,i){const s=this.textState_,l=this.textStrokeState_,n=this.pixelRatio,a=c.TEXT_ALIGN[s.textAlign||h.defaultTextAlign],o=c.TEXT_ALIGN[s.textBaseline],r=l&&l.lineWidth?l.lineWidth:0,d=a*t.width/n+2*(.5-a)*r,u=o*t.height/n+2*(.5-o)*r;this.instructions.push([f.default.DRAW_IMAGE,e,i,t,(d-this.textOffsetX_)*n,(u-this.textOffsetY_)*n,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,!0,t.width,s.padding==h.defaultPadding?h.defaultPadding:s.padding.map(function(t){return t*n}),!!s.backgroundFill,!!s.backgroundStroke]),this.hitDetectionInstructions.push([f.default.DRAW_IMAGE,e,i,t,(d-this.textOffsetX_)*n,(u-this.textOffsetY_)*n,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/n,!0,t.width,s.padding,!!s.backgroundFill,!!s.backgroundStroke])},S.prototype.drawChars_=function(t,e,i){const s=this.textStrokeState_,l=this.textState_,n=this.textFillState_,a=this.strokeKey_;s&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:s.strokeStyle,lineCap:s.lineCap,lineDashOffset:s.lineDashOffset,lineWidth:s.lineWidth,lineJoin:s.lineJoin,miterLimit:s.miterLimit,lineDash:s.lineDash}));const o=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:l.font,textAlign:l.textAlign||h.defaultTextAlign,scale:l.scale});const r=this.fillKey_;n&&(r in this.fillStates||(this.fillStates[r]={fillStyle:n.fillStyle}));const d=this.pixelRatio,u=c.TEXT_ALIGN[l.textBaseline],g=this.textOffsetY_*d,x=this.text_,_=l.font,S=l.scale,p=s?s.lineWidth*S/2:0;let k=this.widths_[_];k||(this.widths_[_]=k={}),this.instructions.push([f.default.DRAW_CHARS,t,e,u,i,l.overflow,r,l.maxAngle,function(t){let e=k[t];return e||(e=k[t]=(0,h.measureTextWidth)(_,t)),e*S*d},g,a,p*d,x,o,1]),this.hitDetectionInstructions.push([f.default.DRAW_CHARS,t,e,u,i,l.overflow,r,l.maxAngle,function(t){let e=k[t];return e||(e=k[t]=(0,h.measureTextWidth)(_,t)),e*S},g,a,p,x,o,1/d])},S.prototype.setTextStyle=function(i,s){let l,n,a;if(i){this.declutterGroup_=s;const o=i.getFill();o?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=(0,e.asColorLike)(o.getColor()||h.defaultFillStyle)):n=this.textFillState_=null;const r=i.getStroke();if(r){(a=this.textStrokeState_)||(a=this.textStrokeState_={});const t=r.getLineDash(),i=r.getLineDashOffset(),s=r.getWidth(),l=r.getMiterLimit();a.lineCap=r.getLineCap()||h.defaultLineCap,a.lineDash=t?t.slice():h.defaultLineDash,a.lineDashOffset=void 0===i?h.defaultLineDashOffset:i,a.lineJoin=r.getLineJoin()||h.defaultLineJoin,a.lineWidth=void 0===s?h.defaultLineWidth:s,a.miterLimit=void 0===l?h.defaultMiterLimit:l,a.strokeStyle=(0,e.asColorLike)(r.getColor()||h.defaultStrokeStyle)}else a=this.textStrokeState_=null;l=this.textState_;const f=i.getFont()||h.defaultFont;(0,h.checkFont)(f);const d=i.getScale();l.overflow=i.getOverflow(),l.font=f,l.maxAngle=i.getMaxAngle(),l.placement=i.getPlacement(),l.textAlign=i.getTextAlign(),l.textBaseline=i.getTextBaseline()||h.defaultTextBaseline,l.backgroundFill=i.getBackgroundFill(),l.backgroundStroke=i.getBackgroundStroke(),l.padding=i.getPadding()||h.defaultPadding,l.scale=void 0===d?1:d;const u=i.getOffsetX(),c=i.getOffsetY(),g=i.getRotateWithView(),x=i.getRotation();this.text_=i.getText()||"",this.textOffsetX_=void 0===u?0:u,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===x?0:x,this.strokeKey_=a?("string"==typeof a.strokeStyle?a.strokeStyle:(0,t.getUid)(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=l.font+l.scale+(l.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+(0,t.getUid)(n.fillStyle):""}else this.text_=""},exports.default=S;
},{"../../index.js":94,"../../colorlike.js":244,"../../dom.js":148,"../../extent.js":140,"../../geom/flat/straightchunk.js":332,"../../geom/GeometryType.js":211,"../../has.js":225,"../canvas.js":218,"../canvas/Instruction.js":324,"../canvas/Replay.js":306,"../replay.js":283,"../../style/TextPlacement.js":210}],255:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCircleArray=q,exports.replayDeclutter=C;var e=require("../../index.js"),t=require("../../array.js"),r=require("../../dom.js"),n=require("../../extent.js"),o=require("../../geom/flat/transform.js"),i=require("../../obj.js"),s=require("../ReplayGroup.js"),a=R(s),l=require("../ReplayType.js"),u=R(l),c=require("../canvas/Replay.js"),f=R(c),p=require("../canvas/ImageReplay.js"),h=R(p),y=require("../canvas/LineStringReplay.js"),d=R(y),_=require("../canvas/PolygonReplay.js"),x=R(_),m=require("../canvas/TextReplay.js"),g=R(m),v=require("../replay.js"),j=require("../../transform.js");function R(e){return e&&e.__esModule?e:{default:e}}const T={Circle:x.default,Default:f.default,Image:h.default,LineString:d.default,Polygon:x.default,Text:g.default},I=function(e,t,n,o,i,s,l){a.default.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=t,this.overlaps_=i,this.pixelRatio_=o,this.resolution_=n,this.renderBuffer_=l,this.replaysByZIndex_={},this.hitDetectionContext_=(0,r.createCanvasContext2D)(1,1),this.hitDetectionTransform_=(0,j.create)()};(0,e.inherits)(I,a.default);const E={0:[[!0]]};function B(e,t,r){let n;const o=Math.floor(e.length/2);if(t>=o)for(n=o;n<t;n++)e[n][r]=!0;else if(t<o)for(n=t+1;n<o;n++)e[n][r]=!0}function q(e){if(void 0!==E[e])return E[e];const t=2*e+1,r=new Array(t);for(let e=0;e<t;e++)r[e]=new Array(t);let n=e,o=0,i=0;for(;n>=o;)B(r,e+n,e+o),B(r,e+o,e+n),B(r,e-o,e+n),B(r,e-n,e+o),B(r,e-n,e-o),B(r,e-o,e-n),B(r,e+o,e-n),B(r,e+n,e-o),2*((i+=1+2*++o)-n)+1>0&&(i+=1-2*(n-=1));return E[e]=r,r}function C(e,r,n){const o=Object.keys(e).map(Number).sort(t.numberSafeCompareFunction),i={};for(let t=0,s=o.length;t<s;++t){const s=e[o[t].toString()];for(let e=0,t=s.length;e<t;){const t=s[e++],o=s[e++];t.replay(r,o,n,i)}}}I.prototype.addDeclutter=function(e){let t=null;return this.declutterTree_&&(e?(t=this.declutterGroup_)[4]++:(t=this.declutterGroup_=(0,n.createEmpty)()).push(1)),t},I.prototype.clip=function(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()},I.prototype.hasReplays=function(e){for(const t in this.replaysByZIndex_){const r=this.replaysByZIndex_[t];for(let t=0,n=e.length;t<n;++t)if(e[t]in r)return!0}return!1},I.prototype.finish=function(){for(const e in this.replaysByZIndex_){const t=this.replaysByZIndex_[e];for(const e in t)t[e].finish()}},I.prototype.forEachFeatureAtCoordinate=function(e,r,o,i,s,a,l){const c=2*(i=Math.round(i))+1,f=(0,j.compose)(this.hitDetectionTransform_,i+.5,i+.5,1/r,-1/r,-o,-e[0],-e[1]),p=this.hitDetectionContext_;let h;p.canvas.width!==c||p.canvas.height!==c?(p.canvas.width=c,p.canvas.height=c):p.clearRect(0,0,c,c),void 0!==this.renderBuffer_&&(h=(0,n.createEmpty)(),(0,n.extendCoordinate)(h,e),(0,n.buffer)(h,r*(this.renderBuffer_+i),h));const y=q(i);let d,_;function x(e){const t=p.getImageData(0,0,c,c).data;for(let r=0;r<c;r++)for(let n=0;n<c;n++)if(y[r][n]&&t[4*(n*c+r)+3]>0){let t;return(!d||_!=u.default.IMAGE&&_!=u.default.TEXT||-1!==d.indexOf(e))&&(t=a(e)),t||void p.clearRect(0,0,c,c)}}this.declutterTree_&&(d=this.declutterTree_.all().map(function(e){return e.value}));const m=Object.keys(this.replaysByZIndex_).map(Number);let g,R,T,I,E;for(m.sort(t.numberSafeCompareFunction),g=m.length-1;g>=0;--g){const e=m[g].toString();for(T=this.replaysByZIndex_[e],R=v.ORDER.length-1;R>=0;--R)if(void 0!==(I=T[_=v.ORDER[R]]))if(!l||_!=u.default.IMAGE&&_!=u.default.TEXT){if(E=I.replayHitDetection(p,f,o,s,x,h))return E}else{const t=l[e];t?t.push(I,f.slice(0)):l[e]=[I,f.slice(0)]}}},I.prototype.getClipCoords=function(e){const t=this.maxExtent_,r=t[0],n=t[1],i=t[2],s=t[3],a=[r,n,r,s,i,s,i,n];return(0,o.transform2D)(a,0,8,2,e,a),a},I.prototype.getReplay=function(e,t){const r=void 0!==e?e.toString():"0";let n=this.replaysByZIndex_[r];void 0===n&&(n={},this.replaysByZIndex_[r]=n);let o=n[t];if(void 0===o){o=new(0,T[t])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),n[t]=o}return o},I.prototype.getReplays=function(){return this.replaysByZIndex_},I.prototype.isEmpty=function(){return(0,i.isEmpty)(this.replaysByZIndex_)},I.prototype.replay=function(e,r,n,o,i,s){const a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(t.numberSafeCompareFunction),e.save(),this.clip(e,r);const l=i||v.ORDER;let c,f,p,h,y,d;for(c=0,f=a.length;c<f;++c){const t=a[c].toString();for(y=this.replaysByZIndex_[t],p=0,h=l.length;p<h;++p){const i=l[p];if(void 0!==(d=y[i]))if(!s||i!=u.default.IMAGE&&i!=u.default.TEXT)d.replay(e,r,n,o);else{const e=s[t];e?e.push(d,r.slice(0)):s[t]=[d,r.slice(0)]}}}e.restore()},exports.default=I;
},{"../../index.js":94,"../../array.js":171,"../../dom.js":148,"../../extent.js":140,"../../geom/flat/transform.js":281,"../../obj.js":96,"../ReplayGroup.js":305,"../ReplayType.js":282,"../canvas/Replay.js":306,"../canvas/ImageReplay.js":307,"../canvas/LineStringReplay.js":308,"../canvas/PolygonReplay.js":309,"../canvas/TextReplay.js":310,"../replay.js":283,"../../transform.js":214}],252:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOrder=u,exports.getSquaredTolerance=s,exports.getTolerance=c,exports.renderFeature=T;var e=require("../index.js"),t=require("../ImageState.js"),n=g(t),l=require("../geom/GeometryType.js"),r=g(l),o=require("../render/ReplayType.js"),a=g(o);function g(e){return e&&e.__esModule?e:{default:e}}const d=.5,i={Point:m,LineString:I,Polygon:D,MultiPoint:E,MultiLineString:p,MultiPolygon:R,GeometryCollection:S,Circle:f};function u(t,n){return(0,e.getUid)(t)-(0,e.getUid)(n)}function s(e,t){const n=c(e,t);return n*n}function c(e,t){return d*e/t}function f(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(r||o){const g=e.getReplay(n.getZIndex(),a.default.CIRCLE);g.setFillStrokeStyle(r,o),g.drawCircle(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}function T(e,t,l,r,o,a){let g=!1;const d=l.getImage();if(d){let e=d.getImageState();e==n.default.LOADED||e==n.default.ERROR?d.unlistenImageChange(o,a):(e==n.default.IDLE&&d.load(),e=d.getImageState(),d.listenImageChange(o,a),g=!0)}return y(e,t,l,r),g}function y(e,t,n,l){const r=n.getGeometryFunction()(t);if(!r)return;const o=r.getSimplifiedGeometry(l);if(n.getRenderer())x(e,o,n,t);else{(0,i[o.getType()])(e,o,n,t)}}function x(e,t,n,l){if(t.getType()==r.default.GEOMETRY_COLLECTION){const r=t.getGeometries();for(let t=0,o=r.length;t<o;++t)x(e,r[t],n,l);return}e.getReplay(n.getZIndex(),a.default.DEFAULT).drawCustom(t,l,n.getRenderer())}function S(e,t,n,l){const r=t.getGeometriesArray();let o,a;for(o=0,a=r.length;o<a;++o){(0,i[r[o].getType()])(e,r[o],n,l)}}function I(e,t,n,l){const r=n.getStroke();if(r){const o=e.getReplay(n.getZIndex(),a.default.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawLineString(t,l)}const o=n.getText();if(o){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(o,e.addDeclutter(!1)),r.drawText(t,l)}}function p(e,t,n,l){const r=n.getStroke();if(r){const o=e.getReplay(n.getZIndex(),a.default.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawMultiLineString(t,l)}const o=n.getText();if(o){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(o,e.addDeclutter(!1)),r.drawText(t,l)}}function R(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(o||r){const g=e.getReplay(n.getZIndex(),a.default.POLYGON);g.setFillStrokeStyle(r,o),g.drawMultiPolygon(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}function m(e,t,l,r){const o=l.getImage();if(o){if(o.getImageState()!=n.default.LOADED)return;const g=e.getReplay(l.getZIndex(),a.default.IMAGE);g.setImageStyle(o,e.addDeclutter(!1)),g.drawPoint(t,r)}const g=l.getText();if(g){const n=e.getReplay(l.getZIndex(),a.default.TEXT);n.setTextStyle(g,e.addDeclutter(!!o)),n.drawText(t,r)}}function E(e,t,l,r){const o=l.getImage();if(o){if(o.getImageState()!=n.default.LOADED)return;const g=e.getReplay(l.getZIndex(),a.default.IMAGE);g.setImageStyle(o,e.addDeclutter(!1)),g.drawMultiPoint(t,r)}const g=l.getText();if(g){const n=e.getReplay(l.getZIndex(),a.default.TEXT);n.setTextStyle(g,e.addDeclutter(!!o)),n.drawText(t,r)}}function D(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(r||o){const g=e.getReplay(n.getZIndex(),a.default.POLYGON);g.setFillStrokeStyle(r,o),g.drawPolygon(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}
},{"../index.js":94,"../ImageState.js":152,"../geom/GeometryType.js":211,"../render/ReplayType.js":282}],103:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../LayerType.js"),r=E(t),n=require("../../ViewHint.js"),i=E(n),a=require("../../dom.js"),s=require("../../events.js"),o=require("../../events/EventType.js"),l=E(o),d=require("rbush"),h=E(d),u=require("../../extent.js"),c=require("../../render/EventType.js"),p=E(c),f=require("../../render/canvas.js"),g=require("../../render/canvas/ReplayGroup.js"),y=E(g),_=require("../canvas/Layer.js"),v=E(_),x=require("../vector.js");function E(e){return e&&e.__esModule?e:{default:e}}const R=function(e){v.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,h.default)(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,u.createEmpty)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=(0,a.createCanvasContext2D)(),(0,s.listen)(f.labelCache,l.default.CLEAR,this.handleFontsChanged_,this)};(0,e.inherits)(R,v.default),R.handles=function(e){return e.getType()===r.default.VECTOR},R.create=function(e,t){return new R(t)},R.prototype.disposeInternal=function(){(0,s.unlisten)(f.labelCache,l.default.CLEAR,this.handleFontsChanged_,this),v.default.prototype.disposeInternal.call(this)},R.prototype.composeFrame=function(e,t,r){const n=e.extent,i=e.pixelRatio,a=t.managed?e.skippedFeatureUids:{},s=e.viewState,o=s.projection,l=s.rotation,d=o.getExtent(),h=this.getLayer().getSource();let c=this.getTransform(e,0);this.preCompose(r,e,c);const g=t.extent,y=void 0!==g;y&&this.clip(r,e,g);const _=this.replayGroup_;if(_&&!_.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();const s=this.getLayer();let g,y=0,v=0;const x=1!==t.opacity,E=s.hasListener(p.default.RENDER);if(x||E){let e=r.canvas.width,t=r.canvas.height;if(l){const r=Math.round(Math.sqrt(e*e+t*t));y=(r-e)/2,v=(r-t)/2,e=t=r}this.context.canvas.width=e,this.context.canvas.height=t,g=this.context}else g=r;const R=g.globalAlpha;x||(g.globalAlpha=t.opacity),g!=r&&g.translate(y,v);const C=e.size[0]*i,m=e.size[1]*i;if((0,f.rotateAtOffset)(g,-l,C/2,m/2),_.replay(g,c,l,a),h.getWrapX()&&o.canWrapX()&&!(0,u.containsExtent)(d,n)){let t=n[0];const r=(0,u.getWidth)(d);let i,s=0;for(;t<d[0];)i=r*--s,c=this.getTransform(e,i),_.replay(g,c,l,a),t+=r;for(s=0,t=n[2];t>d[2];)i=r*++s,c=this.getTransform(e,i),_.replay(g,c,l,a),t-=r;c=this.getTransform(e,0)}if((0,f.rotateAtOffset)(g,l,C/2,m/2),g!=r){if(E&&this.dispatchRenderEvent(g,e,c),x){const e=r.globalAlpha;r.globalAlpha=t.opacity,r.drawImage(g.canvas,-y,-v),r.globalAlpha=e}else r.drawImage(g.canvas,-y,-v);g.translate(-y,-v)}x||(g.globalAlpha=R)}y&&r.restore(),this.postCompose(r,e,t,c)},R.prototype.forEachFeatureAtCoordinate=function(t,r,n,i,a){if(this.replayGroup_){const s=r.viewState.resolution,o=r.viewState.rotation,l=this.getLayer(),d={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,o,n,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in d))return d[r]=!0,i.call(a,t,l)},null)}},R.prototype.handleFontsChanged_=function(e){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},R.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},R.prototype.prepareFrame=function(e,t){const r=this.getLayer(),n=r.getSource(),a=e.viewHints[i.default.ANIMATING],s=e.viewHints[i.default.INTERACTING],o=r.getUpdateWhileAnimating(),l=r.getUpdateWhileInteracting();if(!this.dirty_&&!o&&a||!l&&s)return!0;const d=e.extent,h=e.viewState,c=h.projection,p=h.resolution,f=e.pixelRatio,g=r.getRevision(),_=r.getRenderBuffer();let v=r.getRenderOrder();void 0===v&&(v=x.defaultOrder);const E=(0,u.buffer)(d,_*p),R=h.projection.getExtent();if(n.getWrapX()&&h.projection.canWrapX()&&!(0,u.containsExtent)(R,e.extent)){const e=(0,u.getWidth)(R),t=Math.max((0,u.getWidth)(E)/2,e);E[0]=R[0]-t,E[2]=R[2]+t}if(!this.dirty_&&this.renderedResolution_==p&&this.renderedRevision_==g&&this.renderedRenderOrder_==v&&(0,u.containsExtent)(this.renderedExtent_,E))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;const C=new y.default((0,x.getTolerance)(p,f),E,p,f,n.getOverlaps(),this.declutterTree_,r.getRenderBuffer());n.loadFeatures(E,p,c);const m=function(e){let t;const n=e.getStyleFunction()||r.getStyleFunction();if(n&&(t=n(e,p)),t){const r=this.renderFeature(e,p,f,t,C);this.dirty_=this.dirty_||r}}.bind(this);if(v){const e=[];n.forEachFeatureInExtent(E,function(t){e.push(t)},this),e.sort(v);for(let t=0,r=e.length;t<r;++t)m(e[t])}else n.forEachFeatureInExtent(E,m,this);return C.finish(),this.renderedResolution_=p,this.renderedRevision_=g,this.renderedRenderOrder_=v,this.renderedExtent_=E,this.replayGroup_=C,this.replayGroupChanged=!0,!0},R.prototype.renderFeature=function(e,t,r,n,i){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let s=0,o=n.length;s<o;++s)a=(0,x.renderFeature)(i,e,n[s],(0,x.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this)||a;else a=(0,x.renderFeature)(i,e,n,(0,x.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this);return a},exports.default=R;
},{"../../index.js":94,"../../LayerType.js":105,"../../ViewHint.js":186,"../../dom.js":148,"../../events.js":153,"../../events/EventType.js":155,"rbush":266,"../../extent.js":140,"../../render/EventType.js":170,"../../render/canvas.js":218,"../../render/canvas/ReplayGroup.js":255,"../canvas/Layer.js":256,"../vector.js":252}],132:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};
},{}],104:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../LayerType.js"),r=L(t),o=require("../../TileState.js"),i=L(o),n=require("../../dom.js"),l=require("../../events.js"),s=require("../../events/EventType.js"),a=L(s),d=require("rbush"),u=L(d),c=require("../../extent.js"),p=require("../../layer/VectorTileRenderType.js"),g=L(p),h=require("../../proj.js"),f=require("../../proj/Units.js"),y=L(f),T=require("../../render/ReplayType.js"),R=L(T),C=require("../../render/canvas.js"),E=require("../../render/canvas/ReplayGroup.js"),v=L(E),S=require("../../render/replay.js"),m=require("../canvas/TileLayer.js"),x=L(m),_=require("../vector.js"),j=require("../../transform.js");function L(e){return e&&e.__esModule?e:{default:e}}const O={image:[R.default.POLYGON,R.default.CIRCLE,R.default.LINE_STRING,R.default.IMAGE,R.default.TEXT],hybrid:[R.default.POLYGON,R.default.LINE_STRING]},q={image:[R.default.DEFAULT],hybrid:[R.default.IMAGE,R.default.TEXT,R.default.DEFAULT],vector:S.ORDER},G=function(e){this.context=null,x.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,u.default)(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=(0,j.create)(),this.zDirection=e.getRenderMode()==g.default.VECTOR?1:0,(0,l.listen)(C.labelCache,a.default.CLEAR,this.handleFontsChanged_,this)};(0,e.inherits)(G,x.default),G.handles=function(e){return e.getType()===r.default.VECTOR_TILE},G.create=function(e,t){return new G(t)},G.prototype.disposeInternal=function(){(0,l.unlisten)(C.labelCache,a.default.CLEAR,this.handleFontsChanged_,this),x.default.prototype.disposeInternal.call(this)},G.prototype.prepareFrame=function(e,t){const r=this.getLayer(),o=r.getRevision();if(this.renderedLayerRevision_!=o){this.renderedTiles.length=0;const e=r.getRenderMode();this.context||e==g.default.VECTOR||(this.context=(0,n.createCanvasContext2D)()),this.context&&e==g.default.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=o,x.default.prototype.prepareFrame.apply(this,arguments)},G.prototype.createReplayGroup_=function(e,t){const r=this.getLayer(),o=t.pixelRatio,n=t.viewState.projection,l=r.getRevision(),s=r.getRenderOrder()||null,a=e.getReplayState(r);if(!a.dirty&&a.renderedRevision==l&&a.renderedRenderOrder==s)return;const d=r.getSource(),u=d.getTileGrid(),p=d.getTileGridForProjection(n),g=p.getResolution(e.tileCoord[0]),f=p.getTileCoordExtent(e.wrappedTileCoord),T={};for(let t=0,l=e.tileKeys.length;t<l;++t){const l=e.getTile(e.tileKeys[t]);if(l.getState()!=i.default.LOADED)continue;const p=l.tileCoord,R=u.getTileCoordExtent(p),C=(0,c.getIntersection)(f,R),E=(0,c.equals)(R,C)?null:(0,c.buffer)(C,r.getRenderBuffer()*g,this.tmpExtent),S=l.getProjection();let m=!1;(0,h.equivalent)(n,S)||(m=!0,l.setProjection(n)),a.dirty=!1;const x=new v.default(0,C,g,o,d.getOverlaps(),this.declutterTree_,r.getRenderBuffer()),j=(0,_.getSquaredTolerance)(g,o),L=function(e){let t;const o=e.getStyleFunction()||r.getStyleFunction();if(o&&(t=o(e,g)),t){const r=this.renderFeature(e,j,t,x);this.dirty_=this.dirty_||r,a.dirty=a.dirty||r}},O=l.getFeatures();s&&s!==a.renderedRenderOrder&&O.sort(s);for(let e=0,t=O.length;e<t;++e){const t=O[e];m&&(S.getUnits()==y.default.TILE_PIXELS&&(S.setWorldExtent(R),S.setExtent(l.getExtent())),t.getGeometry().transform(S,n)),E&&!(0,c.intersects)(E,t.getGeometry().getExtent())||L.call(this,t)}x.finish();for(const e in x.getReplays())T[e]=!0;l.setReplayGroup(r,e.tileCoord.toString(),x)}a.renderedRevision=l,a.renderedRenderOrder=s},G.prototype.drawTileImage=function(e,t,r,o,i,n,l,s,a){const d=e;this.createReplayGroup_(d,t),this.context&&(this.renderTileImage_(d,t,r),x.default.prototype.drawTileImage.apply(this,arguments))},G.prototype.forEachFeatureAtCoordinate=function(t,r,o,n,l){const s=r.viewState.resolution,a=r.viewState.rotation;o=void 0==o?0:o;const d=this.getLayer(),u={},p=this.renderedTiles,g=d.getSource().getTileGridForProjection(r.viewState.projection);let h,f,y,T,R,C,E,v;for(y=0,T=p.length;y<T;++y)if(E=(C=p[y]).wrappedTileCoord,v=g.getTileCoordExtent(E,this.tmpExtent),h=(0,c.buffer)(v,o*s,h),(0,c.containsCoordinate)(h,t))for(let r=0,c=C.tileKeys.length;r<c;++r){const c=C.getTile(C.tileKeys[r]);c.getState()==i.default.LOADED&&(R=c.getReplayGroup(d,C.tileCoord.toString()),f=f||R.forEachFeatureAtCoordinate(t,s,a,o,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in u))return u[r]=!0,n.call(l,t,d)},null))}return f},G.prototype.getReplayTransform_=function(e,t){const r=this.getLayer().getSource().getTileGrid(),o=e.tileCoord,i=r.getResolution(o[0]),n=t.viewState,l=t.pixelRatio,s=n.resolution/l,a=r.getTileCoordExtent(o,this.tmpExtent),d=n.center,u=(0,c.getTopLeft)(a),p=t.size,g=Math.round(l*p[0]/2),h=Math.round(l*p[1]/2);return(0,j.compose)(this.tmpTransform_,g,h,i/s,i/s,n.rotation,(u[0]-d[0])/i,(d[1]-u[1])/i)},G.prototype.handleFontsChanged_=function(e){const t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},G.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},G.prototype.postCompose=function(e,t,r){const o=this.getLayer(),n=o.getDeclutter()?{}:null,l=o.getSource(),s=o.getRenderMode(),a=q[s],d=t.pixelRatio,u=t.viewState.rotation,c=t.size;let p,h;u&&(p=Math.round(d*c[0]/2),h=Math.round(d*c[1]/2),(0,C.rotateAtOffset)(e,-u,p,h)),n&&this.declutterTree_.clear();const f=this.renderedTiles,y=l.getTileGridForProjection(t.viewState.projection),T=[],R=[];for(let l=f.length-1;l>=0;--l){const d=f[l];if(d.getState()==i.default.ABORT)continue;const c=d.tileCoord,p=y.getTileCoordExtent(c,this.tmpExtent)[0]-y.getTileCoordExtent(d.wrappedTileCoord,this.tmpExtent)[0];let h=void 0;for(let l=0,f=d.tileKeys.length;l<f;++l){const f=d.getTile(d.tileKeys[l]);if(f.getState()!=i.default.LOADED)continue;const y=f.getReplayGroup(o,c.toString());if(s!=g.default.VECTOR&&!y.hasReplays(a))continue;h||(h=this.getTransform(t,p));const C=f.tileCoord[0],E=y.getClipCoords(h);e.save(),e.globalAlpha=r.opacity;for(let t=0,r=T.length;t<r;++t){const r=T[t];C<R[t]&&(e.beginPath(),e.moveTo(E[0],E[1]),e.lineTo(E[2],E[3]),e.lineTo(E[4],E[5]),e.lineTo(E[6],E[7]),e.moveTo(r[6],r[7]),e.lineTo(r[4],r[5]),e.lineTo(r[2],r[3]),e.lineTo(r[0],r[1]),e.clip())}y.replay(e,h,u,{},a,n),e.restore(),T.push(E),R.push(C)}}n&&(0,E.replayDeclutter)(n,e,u),u&&(0,C.rotateAtOffset)(e,u,p,h),x.default.prototype.postCompose.apply(this,arguments)},G.prototype.renderFeature=function(e,t,r,o){if(!r)return!1;let i=!1;if(Array.isArray(r))for(let n=0,l=r.length;n<l;++n)i=(0,_.renderFeature)(o,e,r[n],t,this.handleStyleImageChange_,this)||i;else i=(0,_.renderFeature)(o,e,r,t,this.handleStyleImageChange_,this);return i},G.prototype.renderTileImage_=function(e,t,r){const o=this.getLayer(),n=e.getReplayState(o),l=o.getRevision(),s=O[o.getRenderMode()];if(s&&n.renderedTileRevision!==l){n.renderedTileRevision=l;const r=e.wrappedTileCoord,a=r[0],d=t.pixelRatio,u=o.getSource(),c=u.getTileGridForProjection(t.viewState.projection),p=c.getResolution(a),g=e.getContext(o),h=u.getTilePixelSize(a,d,t.viewState.projection);g.canvas.width=h[0],g.canvas.height=h[1];const f=c.getTileCoordExtent(r,this.tmpExtent);for(let t=0,r=e.tileKeys.length;t<r;++t){const r=e.getTile(e.tileKeys[t]);if(r.getState()!=i.default.LOADED)continue;const n=d/p,l=(0,j.reset)(this.tmpTransform_);(0,j.scale)(l,n,-n),(0,j.translate)(l,-f[0],-f[3]),r.getReplayGroup(o,e.tileCoord.toString()).replay(g,l,0,{},s)}}},exports.default=G;
},{"../../index.js":94,"../../LayerType.js":105,"../../TileState.js":147,"../../dom.js":148,"../../events.js":153,"../../events/EventType.js":155,"rbush":266,"../../extent.js":140,"../../layer/VectorTileRenderType.js":132,"../../proj.js":43,"../../proj/Units.js":133,"../../render/ReplayType.js":282,"../../render/canvas.js":218,"../../render/canvas/ReplayGroup.js":255,"../../render/replay.js":283,"../canvas/TileLayer.js":102,"../vector.js":252,"../../transform.js":214}],48:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),r=require("./PluggableMap.js"),t=v(r),a=require("./control/util.js"),n=require("./interaction.js"),s=require("./obj.js"),u=require("./renderer/canvas/ImageLayer.js"),i=v(u),l=require("./renderer/canvas/Map.js"),o=v(l),c=require("./renderer/canvas/TileLayer.js"),d=v(c),f=require("./renderer/canvas/VectorLayer.js"),j=v(f),q=require("./renderer/canvas/VectorTileLayer.js"),p=v(q);function v(e){return e&&e.__esModule?e:{default:e}}const y=function(e){(e=(0,s.assign)({},e)).controls||(e.controls=(0,a.defaults)()),e.interactions||(e.interactions=(0,n.defaults)()),t.default.call(this,e)};(0,e.inherits)(y,t.default),y.prototype.createRenderer=function(){const e=new o.default(this);return e.registerLayerRenderers([i.default,d.default,j.default,p.default]),e},exports.default=y;
},{"./index.js":94,"./PluggableMap.js":95,"./control/util.js":97,"./interaction.js":42,"./obj.js":96,"./renderer/canvas/ImageLayer.js":100,"./renderer/canvas/Map.js":101,"./renderer/canvas/TileLayer.js":102,"./renderer/canvas/VectorLayer.js":103,"./renderer/canvas/VectorTileLayer.js":104}],108:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};
},{}],50:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../LayerType.js"),r=u(t),s=require("../layer/Layer.js"),i=u(s),o=require("../layer/TileProperty.js"),n=u(o),l=require("../obj.js");function u(e){return e&&e.__esModule?e:{default:e}}const a=function(e){const t=e||{},s=(0,l.assign)({},t);delete s.preload,delete s.useInterimTilesOnError,i.default.call(this,s),this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),this.type=r.default.TILE};(0,e.inherits)(a,i.default),a.prototype.getPreload=function(){return this.get(n.default.PRELOAD)},a.prototype.getSource,a.prototype.setPreload=function(e){this.set(n.default.PRELOAD,e)},a.prototype.getUseInterimTilesOnError=function(){return this.get(n.default.USE_INTERIM_TILES_ON_ERROR)},a.prototype.setUseInterimTilesOnError=function(e){this.set(n.default.USE_INTERIM_TILES_ON_ERROR,e)},exports.default=a;
},{"../index.js":94,"../LayerType.js":105,"../layer/Layer.js":68,"../layer/TileProperty.js":108,"../obj.js":96}],146:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),i=require("./TileState.js"),e=u(i),n=require("./easing.js"),r=require("./events/EventTarget.js"),s=u(r),o=require("./events/EventType.js"),a=u(o);function u(t){return t&&t.__esModule?t:{default:t}}const l=function(t,i,e){s.default.call(this);const n=e||{};this.tileCoord=t,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={}};(0,t.inherits)(l,s.default),l.prototype.changed=function(){this.dispatchEvent(a.default.CHANGE)},l.prototype.getKey=function(){return this.key+"/"+this.tileCoord},l.prototype.getInterimTile=function(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==e.default.LOADED)return t;t=t.interimTile}while(t);return this},l.prototype.refreshInterimChain=function(){if(!this.interimTile)return;let t=this.interimTile,i=this;do{if(t.getState()==e.default.LOADED){t.interimTile=null;break}t.getState()==e.default.LOADING?i=t:t.getState()==e.default.IDLE?i.interimTile=t.interimTile:i=t,t=i.interimTile}while(t)},l.prototype.getTileCoord=function(){return this.tileCoord},l.prototype.getState=function(){return this.state},l.prototype.setState=function(t){this.state=t,this.changed()},l.prototype.load=function(){},l.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;let e=this.transitionStarts_[t];if(e){if(-1===e)return 1}else e=i,this.transitionStarts_[t]=e;const r=i-e+1e3/60;return r>=this.transition_?1:(0,n.easeIn)(r/this.transition_)},l.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},l.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},exports.default=l;
},{"./index.js":94,"./TileState.js":147,"./easing.js":174,"./events/EventTarget.js":205,"./events/EventType.js":155}],200:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./Tile.js"),i=o(e),s=require("./TileState.js"),n=o(s),a=require("./dom.js"),r=require("./events.js"),h=require("./events/EventType.js"),l=o(h);function o(t){return t&&t.__esModule?t:{default:t}}const u=function(t,e,s,n,a,r){i.default.call(this,t,e,r),this.crossOrigin_=n,this.src_=s,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.imageListenerKeys_=null,this.tileLoadFunction_=a};function g(){const t=(0,a.createCanvasContext2D)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(0,t.inherits)(u,i.default),u.prototype.disposeInternal=function(){this.state==n.default.LOADING&&(this.unlistenImage_(),this.image_=g()),this.interimTile&&this.interimTile.dispose(),this.state=n.default.ABORT,this.changed(),i.default.prototype.disposeInternal.call(this)},u.prototype.getImage=function(){return this.image_},u.prototype.getKey=function(){return this.src_},u.prototype.handleImageError_=function(){this.state=n.default.ERROR,this.unlistenImage_(),this.image_=g(),this.changed()},u.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=n.default.LOADED:this.state=n.default.EMPTY,this.unlistenImage_(),this.changed()},u.prototype.load=function(){this.state==n.default.ERROR&&(this.state=n.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.default.IDLE&&(this.state=n.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,r.listenOnce)(this.image_,l.default.ERROR,this.handleImageError_,this),(0,r.listenOnce)(this.image_,l.default.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},u.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(r.unlistenByKey),this.imageListenerKeys_=null},exports.default=u;
},{"./index.js":94,"./Tile.js":146,"./TileState.js":147,"./dom.js":148,"./events.js":153,"./events/EventType.js":155}],150:[function(require,module,exports) {
"use strict";function t(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function e(t,e,n){return t+"/"+e+"/"+n}function n(t){return e(t[0],t[1],t[2])}function r(t){return t.split("/").map(Number)}function o(t){return(t[1]<<t[0])+t[2]}function u(t){const e=t[0],n=new Array(e);let r,o,u=1<<e-1;for(r=0;r<e;++r)o=48,t[1]&u&&(o+=1),t[2]&u&&(o+=2),n[r]=String.fromCharCode(o),u>>=1;return n.join("")}function i(t,e){const n=t[0],r=t[1],o=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const u=e.getExtent();let i;return!(i=u?e.getTileRangeForExtentAndZ(u,n):e.getFullTileRange(n))||i.containsXY(r,o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=t,exports.getKeyZXY=e,exports.getKey=n,exports.fromKey=r,exports.hash=o,exports.quadKey=u,exports.withinExtentAndZ=i;
},{}],199:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./structs/LRUCache.js"),i=r(t),o=require("./tilecoord.js");function r(e){return e&&e.__esModule?e:{default:e}}const s=function(e){i.default.call(this,e)};(0,e.inherits)(s,i.default),s.prototype.expireCache=function(e){for(;this.canExpireCache();){const t=this.peekLast(),i=t.tileCoord[0].toString();if(i in e&&e[i].contains(t.tileCoord))break;this.pop().dispose()}},s.prototype.pruneExceptNewestZ=function(){if(0===this.getCount())return;const e=this.peekFirstKey(),t=(0,o.fromKey)(e)[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove((0,o.getKey)(e.tileCoord)),e.dispose())},this)},exports.default=s;
},{"./index.js":94,"./structs/LRUCache.js":233,"./tilecoord.js":150}],220:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateSourceResolution=r,exports.render=a;var t=require("./dom.js"),e=require("./extent.js"),n=require("./math.js"),o=require("./proj.js");function r(t,n,r,s){const a=(0,o.transform)(r,n,t);let i=(0,o.getPointResolution)(n,s,r);const c=n.getMetersPerUnit();void 0!==c&&(i*=c);const u=t.getMetersPerUnit();void 0!==u&&(i/=u);const g=t.getExtent();if(!g||(0,e.containsCoordinate)(g,a)){const e=(0,o.getPointResolution)(t,i,a)/i;isFinite(e)&&e>0&&(i/=e)}return i}function s(t,e,n,o){const r=n-t,s=o-e,a=Math.sqrt(r*r+s*s);return[Math.round(n+r/a),Math.round(o+s/a)]}function a(o,r,a,i,c,u,g,l,h,d,f){const v=(0,t.createCanvasContext2D)(Math.round(a*o),Math.round(a*r));if(0===h.length)return v.canvas;v.scale(a,a);const m=(0,e.createEmpty)();h.forEach(function(t,n,o){(0,e.extend)(m,t.extent)});const x=(0,e.getWidth)(m),M=(0,e.getHeight)(m),T=(0,t.createCanvasContext2D)(Math.round(a*x/i),Math.round(a*M/i)),p=a/i;h.forEach(function(t,n,o){const r=t.extent[0]-m[0],s=-(t.extent[3]-m[3]),a=(0,e.getWidth)(t.extent),i=(0,e.getHeight)(t.extent);T.drawImage(t.image,d,d,t.image.width-2*d,t.image.height-2*d,r*p,s*p,a*p,i*p)});const P=(0,e.getTopLeft)(g);return l.getTriangles().forEach(function(t,e,o){const r=t.source,c=t.target;let g=r[0][0],l=r[0][1],h=r[1][0],d=r[1][1],f=r[2][0],x=r[2][1];const M=(c[0][0]-P[0])/u,p=-(c[0][1]-P[1])/u,j=(c[1][0]-P[0])/u,E=-(c[1][1]-P[1])/u,q=(c[2][0]-P[0])/u,C=-(c[2][1]-P[1])/u,b=g,y=l;g=0,l=0;const k=[[h-=b,d-=y,0,0,j-M],[f-=b,x-=y,0,0,q-M],[0,0,h,d,E-p],[0,0,f,x,C-p]],w=(0,n.solveLinearSystem)(k);if(!w)return;v.save(),v.beginPath();const R=(M+j+q)/3,S=(p+E+C)/3,W=s(R,S,M,p),D=s(R,S,j,E),H=s(R,S,q,C);v.moveTo(D[0],D[1]),v.lineTo(W[0],W[1]),v.lineTo(H[0],H[1]),v.clip(),v.transform(w[0],w[2],w[1],w[3],M,p),v.translate(m[0]-b,m[3]-y),v.scale(i/a,-i/a),v.drawImage(T.canvas,0,0),v.restore()}),f&&(v.save(),v.strokeStyle="black",v.lineWidth=1,l.getTriangles().forEach(function(t,e,n){const o=t.target,r=(o[0][0]-P[0])/u,s=-(o[0][1]-P[1])/u,a=(o[1][0]-P[0])/u,i=-(o[1][1]-P[1])/u,c=(o[2][0]-P[0])/u,g=-(o[2][1]-P[1])/u;v.beginPath(),v.moveTo(a,i),v.lineTo(r,s),v.lineTo(c,g),v.closePath(),v.stroke()}),v.restore()),v.canvas}
},{"./dom.js":148,"./extent.js":140,"./math.js":157,"./proj.js":43}],243:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../extent.js"),r=require("../math.js"),e=require("../proj.js");const s=10,i=.25,o=function(r,s,i,o,n){this.sourceProj_=r,this.targetProj_=s;let h={};const a=(0,e.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const r=t[0]+"/"+t[1];return h[r]||(h[r]=a(t)),h[r]},this.maxSourceExtent_=o,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&(0,t.getWidth)(o)==(0,t.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,t.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,t.getWidth)(this.targetProj_.getExtent()):null;const u=(0,t.getTopLeft)(i),c=(0,t.getTopRight)(i),d=(0,t.getBottomRight)(i),_=(0,t.getBottomLeft)(i),l=this.transformInv_(u),f=this.transformInv_(c),g=this.transformInv_(d),W=this.transformInv_(_);if(this.addQuad_(u,c,d,_,l,f,g,W,10),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach(function(r,e,s){t=Math.min(t,r.source[0][0],r.source[1][0],r.source[2][0])}),this.triangles_.forEach(function(r){if(Math.max(r.source[0][0],r.source[1][0],r.source[2][0])-t>this.sourceWorldWidth_/2){const e=[[r.source[0][0],r.source[0][1]],[r.source[1][0],r.source[1][1]],[r.source[2][0],r.source[2][1]]];e[0][0]-t>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-t>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-t>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);const s=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-s<this.sourceWorldWidth_/2&&(r.source=e)}}.bind(this))}h={}};o.prototype.addTriangle_=function(t,r,e,s,i,o){this.triangles_.push({source:[s,i,o],target:[t,r,e]})},o.prototype.addQuad_=function(e,s,i,o,n,h,a,u,c){const d=(0,t.boundingExtent)([n,h,a,u]),_=this.sourceWorldWidth_?(0,t.getWidth)(d)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&_>.5&&_<1;let g=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,t.boundingExtent)([e,s,i,o]);g|=(0,t.getWidth)(r)/this.targetWorldWidth_>.25}!f&&this.sourceProj_.isGlobal()&&_&&(g|=_>.25)}if(g||!this.maxSourceExtent_||(0,t.intersects)(d,this.maxSourceExtent_)){if(!(g||isFinite(n[0])&&isFinite(n[1])&&isFinite(h[0])&&isFinite(h[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(u[0])&&isFinite(u[1]))){if(!(c>0))return;g=!0}if(c>0){if(!g){const t=[(e[0]+i[0])/2,(e[1]+i[1])/2],s=this.transformInv_(t);let o;if(f){o=((0,r.modulo)(n[0],l)+(0,r.modulo)(a[0],l))/2-(0,r.modulo)(s[0],l)}else o=(n[0]+a[0])/2-s[0];const h=(n[1]+a[1])/2-s[1];g=o*o+h*h>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const t=[(s[0]+i[0])/2,(s[1]+i[1])/2],r=this.transformInv_(t),d=[(o[0]+e[0])/2,(o[1]+e[1])/2],_=this.transformInv_(d);this.addQuad_(e,s,t,d,n,h,r,_,c-1),this.addQuad_(d,t,i,o,_,r,a,u,c-1)}else{const t=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=this.transformInv_(t),d=[(i[0]+o[0])/2,(i[1]+o[1])/2],_=this.transformInv_(d);this.addQuad_(e,t,d,o,n,r,_,u,c-1),this.addQuad_(t,s,i,d,r,h,a,_,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(e,i,o,n,a,u),this.addTriangle_(e,s,i,n,h,a)}},o.prototype.calculateSourceExtent=function(){const r=(0,t.createEmpty)();return this.triangles_.forEach(function(e,s,i){const o=e.source;(0,t.extendCoordinate)(r,o[0]),(0,t.extendCoordinate)(r,o[1]),(0,t.extendCoordinate)(r,o[2])}),r},o.prototype.getTriangles=function(){return this.triangles_},exports.default=o;
},{"../extent.js":140,"../math.js":157,"../proj.js":43}],232:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../index.js"),i=require("../Tile.js"),s=f(i),r=require("../TileState.js"),o=f(r),n=require("../events.js"),u=require("../events/EventType.js"),l=f(u),a=require("../extent.js"),h=require("../math.js"),c=require("../reproj.js"),d=require("../reproj/Triangulation.js"),_=f(d);function f(t){return t&&t.__esModule?t:{default:t}}const g=function(e,i,r,n,u,l,d,f,g,p,T){s.default.call(this,u,o.default.IDLE),this.renderEdges_=void 0!==T&&T,this.pixelRatio_=d,this.gutter_=f,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=n,this.wrappedTileCoord_=l||u,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const E=n.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const R=y?(0,a.getIntersection)(E,y):E;if(0===(0,a.getArea)(R))return void(this.state=o.default.EMPTY);const j=e.getExtent();j&&(x=x?(0,a.getIntersection)(x,j):j);const L=n.getResolution(this.wrappedTileCoord_[0]),m=(0,a.getCenter)(R),D=(0,c.calculateSourceResolution)(e,r,m,L);if(!isFinite(D)||D<=0)return void(this.state=o.default.EMPTY);const G=void 0!==p?p:t.ERROR_THRESHOLD;if(this.triangulation_=new _.default(e,r,R,x,D*G),0===this.triangulation_.getTriangles().length)return void(this.state=o.default.EMPTY);this.sourceZ_=i.getZForResolution(D);let I=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(I[1]=(0,h.clamp)(I[1],x[1],x[3]),I[3]=(0,h.clamp)(I[3],x[1],x[3])):I=(0,a.getIntersection)(I,x)),(0,a.getArea)(I)){const t=i.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=g(this.sourceZ_,e,i,d);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=o.default.EMPTY)}else this.state=o.default.EMPTY};(0,e.inherits)(g,s.default),g.prototype.disposeInternal=function(){this.state==o.default.LOADING&&this.unlistenSources_(),s.default.prototype.disposeInternal.call(this)},g.prototype.getImage=function(){return this.canvas_},g.prototype.reproject_=function(){const t=[];if(this.sourceTiles_.forEach(function(e,i,s){e&&e.getState()==o.default.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=o.default.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],n=this.targetTileGrid_.getResolution(e),u=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,c.render)(s,r,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),n,l,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=o.default.LOADED}this.changed()},g.prototype.load=function(){if(this.state==o.default.IDLE){this.state=o.default.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,s){const r=e.getState();if(r==o.default.IDLE||r==o.default.LOADING){t++;const i=(0,n.listen)(e,l.default.CHANGE,function(s){const r=e.getState();r!=o.default.LOADED&&r!=o.default.ERROR&&r!=o.default.EMPTY||((0,n.unlistenByKey)(i),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(i)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==o.default.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},g.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(n.unlistenByKey),this.sourcesListenerKeys_=null},exports.default=g;
},{"./common.js":182,"../index.js":94,"../Tile.js":146,"../TileState.js":147,"../events.js":153,"../events/EventType.js":155,"../extent.js":140,"../math.js":157,"../reproj.js":220,"../reproj/Triangulation.js":243}],166:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromTemplate=n,exports.createFromTemplates=o,exports.createFromTileUrlFunctions=c,exports.nullTileUrlFunction=u,exports.expandUrl=s;var e=require("./asserts.js"),t=require("./math.js"),r=require("./tilecoord.js");function n(t,r){const n=/\{z\}/g,o=/\{x\}/g,c=/\{y\}/g,u=/\{-y\}/g;return function(s,i,l){return s?t.replace(n,s[0].toString()).replace(o,s[1].toString()).replace(c,function(){return(-s[2]-1).toString()}).replace(u,function(){const t=s[0],n=r.getFullTileRange(t);return(0,e.assert)(n,55),(n.getHeight()+s[2]).toString()}):void 0}}function o(e,t){const r=e.length,o=new Array(r);for(let c=0;c<r;++c)o[c]=n(e[c],t);return c(o)}function c(e){return 1===e.length?e[0]:function(n,o,c){if(n){const u=(0,r.hash)(n),s=(0,t.modulo)(u,e.length);return e[s](n,o,c)}}}function u(e,t,r){}function s(e){const t=[];let r=/\{([a-z])-([a-z])\}/.exec(e);if(r){const n=r[1].charCodeAt(0),o=r[2].charCodeAt(0);let c;for(c=n;c<=o;++c)t.push(e.replace(r[0],String.fromCharCode(c)));return t}if(r=r=/\{(\d+)-(\d+)\}/.exec(e)){const n=parseInt(r[2],10);for(let o=parseInt(r[1],10);o<=n;o++)t.push(e.replace(r[0],o.toString()));return t}return t.push(e),t}
},{"./asserts.js":111,"./math.js":157,"./tilecoord.js":150}],177:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../asserts.js"),i=require("../TileRange.js"),o=u(i),n=require("../array.js"),r=require("../extent.js"),s=require("../math.js"),l=require("../size.js"),h=require("../tilecoord.js");function u(t){return t&&t.__esModule?t:{default:t}}const g=function(i){let s;if(this.minZoom=void 0!==i.minZoom?i.minZoom:0,this.resolutions_=i.resolutions,(0,e.assert)((0,n.isSorted)(this.resolutions_,function(t,e){return e-t},!0),17),!i.origins)for(let t=0,e=this.resolutions_.length-1;t<e;++t)if(s){if(this.resolutions_[t]/this.resolutions_[t+1]!==s){s=void 0;break}}else s=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=s,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==i.origin?i.origin:null,this.origins_=null,void 0!==i.origins&&(this.origins_=i.origins,(0,e.assert)(this.origins_.length==this.resolutions_.length,20));const l=i.extent;void 0===l||this.origin_||this.origins_||(this.origin_=(0,r.getTopLeft)(l)),(0,e.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==i.tileSizes&&(this.tileSizes_=i.tileSizes,(0,e.assert)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==i.tileSize?i.tileSize:this.tileSizes_?null:t.DEFAULT_TILE_SIZE,(0,e.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==l?l:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==i.sizes?this.fullTileRanges_=i.sizes.map(function(t,e){return new o.default(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):l&&this.calculateTileRanges_(l)},a=[0,0,0];g.prototype.forEachTileCoord=function(t,e,i){const o=this.getTileRangeForExtentAndZ(t,e);for(let t=o.minX,n=o.maxX;t<=n;++t)for(let n=o.minY,r=o.maxY;n<=r;++n)i([e,t,n])},g.prototype.forEachTileCoordParentTileRange=function(t,e,o,n,r){let s,l,h,u=null,g=t[0]-1;for(2===this.zoomFactor_?(l=t[1],h=t[2]):u=this.getTileCoordExtent(t,r);g>=this.minZoom;){if(2===this.zoomFactor_?(l=Math.floor(l/2),h=Math.floor(h/2),s=(0,i.createOrUpdate)(l,l,h,h,n)):s=this.getTileRangeForExtentAndZ(u,g,n),e.call(o,g,s))return!0;--g}return!1},g.prototype.getExtent=function(){return this.extent_},g.prototype.getMaxZoom=function(){return this.maxZoom},g.prototype.getMinZoom=function(){return this.minZoom},g.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},g.prototype.getResolution=function(t){return this.resolutions_[t]},g.prototype.getResolutions=function(){return this.resolutions_},g.prototype.getTileCoordChildTileRange=function(t,e,o){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const o=2*t[1],n=2*t[2];return(0,i.createOrUpdate)(o,o+1,n,n+1,e)}const n=this.getTileCoordExtent(t,o);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null},g.prototype.getTileRangeExtent=function(t,e,i){const o=this.getOrigin(t),n=this.getResolution(t),s=(0,l.toSize)(this.getTileSize(t),this.tmpSize_),h=o[0]+e.minX*s[0]*n,u=o[0]+(e.maxX+1)*s[0]*n,g=o[1]+e.minY*s[1]*n,a=o[1]+(e.maxY+1)*s[1]*n;return(0,r.createOrUpdate)(h,g,u,a,i)},g.prototype.getTileRangeForExtentAndZ=function(t,e,o){const n=a;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);const r=n[1],s=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),(0,i.createOrUpdate)(r,n[1],s,n[2],o)},g.prototype.getTileCoordCenter=function(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),o=(0,l.toSize)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*o[0]*i,e[1]+(t[2]+.5)*o[1]*i]},g.prototype.getTileCoordExtent=function(t,e){const i=this.getOrigin(t[0]),o=this.getResolution(t[0]),n=(0,l.toSize)(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*n[0]*o,h=i[1]+t[2]*n[1]*o,u=s+n[0]*o,g=h+n[1]*o;return(0,r.createOrUpdate)(s,h,u,g,e)},g.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},g.prototype.getTileCoordForXYAndResolution_=function(t,e,i,o,n){const r=this.getZForResolution(i),s=i/this.getResolution(r),u=this.getOrigin(r),g=(0,l.toSize)(this.getTileSize(r),this.tmpSize_),a=o?.5:0,_=o?0:.5,c=Math.floor((t-u[0])/i+a),p=Math.floor((e-u[1])/i+_);let f=s*c/g[0],d=s*p/g[1];return o?(f=Math.ceil(f)-1,d=Math.ceil(d)-1):(f=Math.floor(f),d=Math.floor(d)),(0,h.createOrUpdate)(r,f,d,n)},g.prototype.getTileCoordForXYAndZ_=function(t,e,i,o,n){const r=this.getOrigin(i),s=this.getResolution(i),u=(0,l.toSize)(this.getTileSize(i),this.tmpSize_),g=o?.5:0,a=o?0:.5,_=Math.floor((t-r[0])/s+g),c=Math.floor((e-r[1])/s+a);let p=_/u[0],f=c/u[1];return o?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),(0,h.createOrUpdate)(i,p,f,n)},g.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},g.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},g.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},g.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},g.prototype.getZForResolution=function(t,e){const i=(0,n.linearFindNearest)(this.resolutions_,t,e||0);return(0,s.clamp)(i,this.minZoom,this.maxZoom)},g.prototype.calculateTileRanges_=function(t){const e=this.resolutions_.length,i=new Array(e);for(let o=this.minZoom;o<e;++o)i[o]=this.getTileRangeForExtentAndZ(t,o);this.fullTileRanges_=i},exports.default=g;
},{"./common.js":175,"../asserts.js":111,"../TileRange.js":251,"../array.js":171,"../extent.js":140,"../math.js":157,"../size.js":149,"../tilecoord.js":150}],99:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getForProjection=x,exports.wrapX=f,exports.createForExtent=g,exports.createXYZ=j,exports.createForProjection=p,exports.extentFromProjection=T;var e=require("./tilegrid/common.js"),t=require("./size.js"),r=require("./extent.js"),o=require("./extent/Corner.js"),n=a(o),i=require("./obj.js"),u=require("./proj.js"),s=require("./proj/Units.js"),d=a(s),c=require("./tilegrid/TileGrid.js"),l=a(c);function a(e){return e&&e.__esModule?e:{default:e}}function x(e){let t=e.getDefaultTileGrid();return t||(t=p(e),e.setDefaultTileGrid(t)),t}function f(e,t,o){const n=t[0],i=e.getTileCoordCenter(t),u=T(o);if((0,r.containsCoordinate)(u,i))return t;{const t=(0,r.getWidth)(u),o=Math.ceil((u[0]-i[0])/t);return i[0]+=t*o,e.getTileCoordForCoordAndZ(i,n)}}function g(e,t,o,i){const u=void 0!==i?i:n.default.TOP_LEFT,s=E(e,t,o);return new l.default({extent:e,origin:(0,r.getCorner)(e,u),resolutions:s,tileSize:o})}function j(e){const t={};return(0,i.assign)(t,void 0!==e?e:{}),void 0===t.extent&&(t.extent=(0,u.get)("EPSG:3857").getExtent()),t.resolutions=E(t.extent,t.maxZoom,t.tileSize),delete t.maxZoom,new l.default(t)}function E(o,n,i){const u=void 0!==n?n:e.DEFAULT_MAX_ZOOM,s=(0,r.getHeight)(o),d=(0,r.getWidth)(o),c=(0,t.toSize)(void 0!==i?i:e.DEFAULT_TILE_SIZE),l=Math.max(d/c[0],s/c[1]),a=u+1,x=new Array(a);for(let e=0;e<a;++e)x[e]=l/Math.pow(2,e);return x}function p(e,t,r,o){return g(T(e),t,r,o)}function T(e){let t=(e=(0,u.get)(e)).getExtent();if(!t){const o=180*u.METERS_PER_UNIT[d.default.DEGREES]/e.getMetersPerUnit();t=(0,r.createOrUpdate)(-o,-o,o,o)}return t}
},{"./tilegrid/common.js":175,"./size.js":149,"./extent.js":140,"./extent/Corner.js":176,"./obj.js":96,"./proj.js":43,"./proj/Units.js":133,"./tilegrid/TileGrid.js":177}],83:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileSourceEvent=void 0;var e=require("../index.js"),t=require("../functions.js"),i=require("../TileCache.js"),o=f(i),r=require("../TileState.js"),n=f(r),s=require("../events/Event.js"),l=f(s),u=require("../proj.js"),c=require("../size.js"),a=require("../source/Source.js"),p=f(a),h=require("../tilecoord.js"),d=require("../tilegrid.js");function f(e){return e&&e.__esModule?e:{default:e}}const g=function(e){p.default.call(this,{attributions:e.attributions,extent:e.extent,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new o.default(e.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:e.transition}};(0,e.inherits)(g,p.default),g.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},g.prototype.expireCache=function(e,t){const i=this.getTileCacheForProjection(e);i&&i.expireCache(t)},g.prototype.forEachLoadedTile=function(e,t,i,o){const r=this.getTileCacheForProjection(e);if(!r)return!1;let s,l,u,c=!0;for(let e=i.minX;e<=i.maxX;++e)for(let a=i.minY;a<=i.maxY;++a)l=(0,h.getKeyZXY)(t,e,a),u=!1,r.containsKey(l)&&(u=(s=r.get(l)).getState()===n.default.LOADED)&&(u=!1!==o(s)),u||(c=!1);return c},g.prototype.getGutter=function(e){return 0},g.prototype.getKey=function(){return this.key_},g.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},g.prototype.getOpaque=function(e){return this.opaque_},g.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},g.prototype.getTile=function(e,t,i,o,r){},g.prototype.getTileGrid=function(){return this.tileGrid},g.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:(0,d.getForProjection)(e)},g.prototype.getTileCacheForProjection=function(e){const t=this.getProjection();return t&&!(0,u.equivalent)(t,e)?null:this.tileCache},g.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_},g.prototype.getTilePixelSize=function(e,t,i){const o=this.getTileGridForProjection(i),r=this.getTilePixelRatio(t),n=(0,c.toSize)(o.getTileSize(e),this.tmpSize);return 1==r?n:(0,c.scale)(n,r,this.tmpSize)},g.prototype.getTileCoordForTileUrlFunction=function(e,t){const i=void 0!==t?t:this.getProjection(),o=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=(0,d.wrapX)(o,e,i)),(0,h.withinExtentAndZ)(e,o)?e:null},g.prototype.refresh=function(){this.tileCache.clear(),this.changed()},g.prototype.useTile=t.UNDEFINED;const y=exports.TileSourceEvent=function(e,t){l.default.call(this,e),this.tile=t};(0,e.inherits)(y,l.default),exports.default=g;
},{"../index.js":94,"../functions.js":144,"../TileCache.js":199,"../TileState.js":147,"../events/Event.js":183,"../proj.js":43,"../size.js":149,"../source/Source.js":81,"../tilecoord.js":150,"../tilegrid.js":99}],181:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};
},{}],90:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../TileState.js"),i=c(e),n=require("../tileurlfunction.js"),l=require("../source/Tile.js"),o=c(l),s=require("../source/TileEventType.js"),r=c(s),u=require("../tilecoord.js");function c(t){return t&&t.__esModule?t:{default:t}}const a=function(t){o.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,extent:t.extent,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition}),this.tileLoadFunction=t.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):n.nullTileUrlFunction,this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),t.tileUrlFunction&&this.setTileUrlFunction(t.tileUrlFunction),this.tileLoadingKeys_={}};(0,t.inherits)(a,o.default),a.prototype.fixedTileUrlFunction,a.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},a.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},a.prototype.getUrls=function(){return this.urls},a.prototype.handleTileChange=function(e){const n=e.target,o=(0,t.getUid)(n),s=n.getState();let u;s==i.default.LOADING?(this.tileLoadingKeys_[o]=!0,u=r.default.TILELOADSTART):o in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[o],u=s==i.default.ERROR?r.default.TILELOADERROR:s==i.default.LOADED||s==i.default.ABORT?r.default.TILELOADEND:void 0),void 0!=u&&this.dispatchEvent(new l.TileSourceEvent(u,n))},a.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},a.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},a.prototype.setUrl=function(t){const e=this.urls=(0,n.expandUrl)(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,n.createFromTemplates)(e,this.tileGrid),t)},a.prototype.setUrls=function(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,n.createFromTemplates)(t,this.tileGrid),e)},a.prototype.useTile=function(t,e,i){const n=(0,u.getKeyZXY)(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},exports.default=a;
},{"../index.js":94,"../TileState.js":147,"../tileurlfunction.js":166,"../source/Tile.js":83,"../source/TileEventType.js":181,"../tilecoord.js":150}],86:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../reproj/common.js"),t=require("../index.js"),i=require("../ImageTile.js"),r=f(i),o=require("../TileCache.js"),n=f(o),s=require("../TileState.js"),c=f(s),l=require("../events.js"),h=require("../events/EventType.js"),a=f(h),u=require("../proj.js"),d=require("../reproj/Tile.js"),p=f(d),E=require("../source/UrlTile.js"),g=f(E),j=require("../tilecoord.js"),T=require("../tilegrid.js");function f(e){return e&&e.__esModule?e:{default:e}}const C=function(e){g.default.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:P,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:r.default,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1};function P(e,t){e.getImage().src=t}(0,t.inherits)(C,g.default),C.prototype.canExpireCache=function(){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},C.prototype.expireCache=function(t,i){if(!e.ENABLE_RASTER_REPROJECTION)return void g.default.prototype.expireCache.call(this,t,i);const r=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==r?i:{});for(const e in this.tileCacheForProjection){const t=this.tileCacheForProjection[e];t.expireCache(t==r?i:{})}},C.prototype.getGutter=function(t){return e.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,u.equivalent)(this.getProjection(),t)?0:this.getGutterInternal()},C.prototype.getGutterInternal=function(){return 0},C.prototype.getOpaque=function(t){return!(e.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,u.equivalent)(this.getProjection(),t))&&g.default.prototype.getOpaque.call(this,t)},C.prototype.getTileGridForProjection=function(i){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.getTileGridForProjection.call(this,i);const r=this.getProjection();if(!this.tileGrid||r&&!(0,u.equivalent)(r,i)){const e=(0,t.getUid)(i).toString();return e in this.tileGridForProjection||(this.tileGridForProjection[e]=(0,T.getForProjection)(i)),this.tileGridForProjection[e]}return this.tileGrid},C.prototype.getTileCacheForProjection=function(i){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.getTileCacheForProjection.call(this,i);const r=this.getProjection();if(!r||(0,u.equivalent)(r,i))return this.tileCache;{const e=(0,t.getUid)(i).toString();return e in this.tileCacheForProjection||(this.tileCacheForProjection[e]=new n.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[e]}},C.prototype.createTile_=function(e,t,i,r,o,n){const s=[e,t,i],h=this.getTileCoordForTileUrlFunction(s,o),u=h?this.tileUrlFunction(h,r,o):void 0,d=new this.tileClass(s,void 0!==u?c.default.IDLE:c.default.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=n,(0,l.listen)(d,a.default.CHANGE,this.handleTileChange,this),d},C.prototype.getTile=function(t,i,r,o,n){const s=this.getProjection();if(e.ENABLE_RASTER_REPROJECTION&&s&&n&&!(0,u.equivalent)(s,n)){const e=this.getTileCacheForProjection(n),c=[t,i,r];let l;const h=(0,j.getKey)(c);e.containsKey(h)&&(l=e.get(h));const a=this.getKey();if(l&&l.key==a)return l;{const t=this.getTileGridForProjection(s),i=this.getTileGridForProjection(n),r=this.getTileCoordForTileUrlFunction(c,n),u=new p.default(s,t,n,i,c,r,this.getTilePixelRatio(o),this.getGutterInternal(),function(e,t,i,r){return this.getTileInternal(e,t,i,r,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return u.key=a,l?(u.interimTile=l,u.refreshInterimChain(),e.replace(h,u)):e.set(h,u),u}}return this.getTileInternal(t,i,r,o,s||n)},C.prototype.getTileInternal=function(e,t,i,r,o){let n=null;const s=(0,j.getKeyZXY)(e,t,i),l=this.getKey();if(this.tileCache.containsKey(s)){if((n=this.tileCache.get(s)).key!=l){const h=n;n=this.createTile_(e,t,i,r,o,l),h.getState()==c.default.IDLE?n.interimTile=h.interimTile:n.interimTile=h,n.refreshInterimChain(),this.tileCache.replace(s,n)}}else n=this.createTile_(e,t,i,r,o,l),this.tileCache.set(s,n);return n},C.prototype.setRenderReprojectionEdges=function(t){if(e.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},C.prototype.setTileGridForProjection=function(i,r){if(e.ENABLE_RASTER_REPROJECTION){const e=(0,u.get)(i);if(e){const i=(0,t.getUid)(e).toString();i in this.tileGridForProjection||(this.tileGridForProjection[i]=r)}}},exports.default=C;
},{"../reproj/common.js":182,"../index.js":94,"../ImageTile.js":200,"../TileCache.js":199,"../TileState.js":147,"../events.js":153,"../events/EventType.js":155,"../proj.js":43,"../reproj/Tile.js":232,"../source/UrlTile.js":90,"../tilecoord.js":150,"../tilegrid.js":99}],51:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),i=require("../source/TileImage.js"),t=o(i),r=require("../tilegrid.js");function o(e){return e&&e.__esModule?e:{default:e}}const n=function(e){const i=e||{},o=void 0!==i.projection?i.projection:"EPSG:3857",n=void 0!==i.tileGrid?i.tileGrid:(0,r.createXYZ)({extent:(0,r.extentFromProjection)(o),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});t.default.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:o,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})};(0,e.inherits)(n,t.default),exports.default=n;
},{"../index.js":94,"../source/TileImage.js":86,"../tilegrid.js":99}],24:[function(require,module,exports) {
"use strict";require("ol/ol.css");var e=require("ol/Map"),r=l(e),t=require("ol/View"),n=l(t),a=require("ol/layer/Tile"),o=l(a),i=require("ol/source/XYZ"),c=l(i),u=require("ol/proj");function l(e){return e&&e.__esModule?e:{default:e}}var y={center:[-93.265,44.9778],year:2005},m={center:[6.6323,46.5197],year:2006},d={center:[-123.3656,48.4284],year:2007},f={center:[18.4241,-33.9249],year:2008},s={center:[151.2093,-33.8688],year:2009},p={center:[2.1734,41.3851],year:2010},v={center:[-104.9903,39.7392],year:2011},w={center:[-1.1581,52.9548],year:2013},g={center:[-122.6765,45.5231],year:2014},q={center:[126.978,37.5665],year:2015},T={center:[7.0982,50.7374],year:2016},z={center:[-71.0589,42.3601],year:2017},h={center:[39.2083,-6.7924],year:2018},j=3500,x=4,L=10,M=[y,m,d,f,s,p,v,w,g,q,T,z,h].map(function(e){return{center:(0,u.fromLonLat)(e.center),year:e.year}}),V=new r.default({target:"map-container",loadTilesWhileAnimating:!0,layers:[new o.default({source:new c.default({url:"http://tile.stamen.com/terrain/{z}/{x}/{y}.jpg"})})],view:new n.default({center:[0,0],zoom:2})}),_=document.getElementById("output"),k=void 0;V.on("click",function(){if(k)return clearTimeout(k),void(k=null);var e=V.getView(),r=0;!function t(){var n=0;function a(){2==++n&&(++r,_.innerText=M[r-1].year,r<M.length&&(k=setTimeout(t,1200)))}e.animate({center:M[r].center,duration:j},a),e.animate({zoom:x,duration:j/2},{zoom:L,duration:j/2},a)}()});
},{"ol/ol.css":36,"ol/Map":48,"ol/View":49,"ol/layer/Tile":50,"ol/source/XYZ":51,"ol/proj":43}]},{},[24], null)
//# sourceMappingURL=view-animation.55d7f45f.map