parcelRequire=function(e,r,n,t){function i(n,t){function o(e){return i(o.resolve(e))}function c(r){return e[n][1][r]||r}if(!r[n]){if(!e[n]){var l="function"==typeof parcelRequire&&parcelRequire;if(!t&&l)return l(n,!0);if(u)return u(n,!0);if(f&&"string"==typeof n)return f(n);var p=new Error("Cannot find module '"+n+"'");throw p.code="MODULE_NOT_FOUND",p}o.resolve=c;var a=r[n]=new i.Module(n);e[n][0].call(a.exports,o,a,a.exports,this)}return r[n].exports}function o(e){this.id=e,this.bundle=i,this.exports={}}var u="function"==typeof parcelRequire&&parcelRequire,f="function"==typeof require&&require;i.isParcelRequire=!0,i.Module=o,i.modules=e,i.cache=r,i.parent=u;for(var c=0;c<n.length;c++)i(n[c]);if(n.length){var l=i(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):t&&(this[t]=l)}return i}({51:[function(require,module,exports) {

},{}],213:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getContext=w;const e=exports.ONE=1,t=exports.SRC_ALPHA=770,E=exports.COLOR_ATTACHMENT0=36064,o=exports.COLOR_BUFFER_BIT=16384,r=exports.TRIANGLES=4,T=exports.TRIANGLE_STRIP=5,s=exports.ONE_MINUS_SRC_ALPHA=771,x=exports.ARRAY_BUFFER=34962,p=exports.ELEMENT_ARRAY_BUFFER=34963,R=exports.STREAM_DRAW=35040,_=exports.STATIC_DRAW=35044,A=exports.DYNAMIC_DRAW=35048,S=exports.CULL_FACE=2884,N=exports.BLEND=3042,I=exports.STENCIL_TEST=2960,L=exports.DEPTH_TEST=2929,U=exports.SCISSOR_TEST=3089,C=exports.UNSIGNED_BYTE=5121,F=exports.UNSIGNED_SHORT=5123,n=exports.UNSIGNED_INT=5125,D=exports.FLOAT=5126,M=exports.RGBA=6408,O=exports.FRAGMENT_SHADER=35632,l=exports.VERTEX_SHADER=35633,G=exports.LINK_STATUS=35714,P=exports.LINEAR=9729,c=exports.TEXTURE_MAG_FILTER=10240,B=exports.TEXTURE_MIN_FILTER=10241,u=exports.TEXTURE_WRAP_S=10242,H=exports.TEXTURE_WRAP_T=10243,X=exports.TEXTURE_2D=3553,g=exports.TEXTURE0=33984,i=exports.CLAMP_TO_EDGE=33071,b=exports.COMPILE_STATUS=35713,W=exports.FRAMEBUFFER=36160,f=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function w(e,t){const E=f.length;for(let o=0;o<E;++o)try{const E=e.getContext(f[o],t);if(E)return E}catch(e){}return null}
},{}],80:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=exports.WEBGL_EXTENSIONS=exports.WEBGL_MAX_TEXTURE_SIZE=exports.HAS_WEBGL=exports.DEBUG_WEBGL=void 0,exports.inherits=p,exports.getUid=_;var e=require("./webgl.js");const t=exports.DEBUG_WEBGL=!0;let o,r,E=!1;if("undefined"!=typeof window&&"WebGLRenderingContext"in window)try{const t=document.createElement("CANVAS"),s=(0,e.getContext)(t,{failIfMajorPerformanceCaveat:!0});s&&(exports.HAS_WEBGL=E=!0,exports.WEBGL_MAX_TEXTURE_SIZE=o=s.getParameter(s.MAX_TEXTURE_SIZE),exports.WEBGL_EXTENSIONS=r=s.getSupportedExtensions())}catch(e){}exports.HAS_WEBGL=E,exports.WEBGL_MAX_TEXTURE_SIZE=o,exports.WEBGL_EXTENSIONS=r;const s=exports.VERSION="v4.6.4";function p(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}let n=0;function _(e){return e.ol_uid||(e.ol_uid=++n)}
},{"./webgl.js":213}],267:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js");const s=function(s){const r=e.VERSION?e.VERSION.split("-")[0]:"latest";this.message="Assertion failed. See https://openlayers.org/en/"+r+"/doc/errors/#"+s+" for details.",this.code=s,this.name="AssertionError"};(0,e.inherits)(s,Error),exports.default=s;
},{"./index.js":80}],228:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ADD:"add",REMOVE:"remove"};
},{}],229:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PROPERTYCHANGE:"propertychange"};
},{}],82:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=n,exports.getValues=e,exports.isEmpty=o;const t=exports.assign="function"==typeof Object.assign?Object.assign:function(t,n){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");const e=Object(t);for(let t=1,n=arguments.length;t<n;++t){const n=arguments[t];if(void 0!==n&&null!==n)for(const t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}return e};function n(t){for(const n in t)delete t[n]}function e(t){const n=[];for(const e in t)n.push(t[e]);return n}function o(t){let n;for(n in t)return!1;return!n}
},{}],193:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindListener=t,exports.findListener=n,exports.getListeners=r,exports.listen=i,exports.listenOnce=s,exports.unlisten=c,exports.unlistenByKey=u,exports.unlistenAll=d;var e=require("./obj.js");function t(e){const t=function(t){const n=e.listener,r=e.bindTo||e.target;return e.callOnce&&u(e),n.call(r,t)};return e.boundListener=t,t}function n(e,t,n,r){let o;for(let l=0,i=e.length;l<i;++l)if((o=e[l]).listener===t&&o.bindTo===n)return r&&(o.deleteIndex=l),o}function r(e,t){const n=e.ol_lm;return n?n[t]:void 0}function o(e){let t=e.ol_lm;return t||(t=e.ol_lm={}),t}function l(t,n){const o=r(t,n);if(o){for(let r=0,l=o.length;r<l;++r)t.removeEventListener(n,o[r].boundListener),(0,e.clear)(o[r]);o.length=0;const r=t.ol_lm;r&&(delete r[n],0===Object.keys(r).length&&delete t.ol_lm)}}function i(e,r,l,i,s){const c=o(e);let u=c[r];u||(u=c[r]=[]);let d=n(u,l,i,!1);return d?s||(d.callOnce=!1):(d={bindTo:i,callOnce:!!s,listener:l,target:e,type:r},e.addEventListener(r,t(d)),u.push(d)),d}function s(e,t,n,r){return i(e,t,n,r,!0)}function c(e,t,o,l){const i=r(e,t);if(i){const e=n(i,o,l,!0);e&&u(e)}}function u(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);const n=r(t.target,t.type);if(n){const e="deleteIndex"in t?t.deleteIndex:n.indexOf(t);-1!==e&&n.splice(e,1),0===n.length&&l(t.target,t.type)}(0,e.clear)(t)}}function d(e){const t=o(e);for(const n in t)l(e,n)}
},{"./obj.js":82}],195:[function(require,module,exports) {
"use strict";function e(){return!0}function t(){return!1}function r(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TRUE=e,exports.FALSE=t,exports.UNDEFINED=r;
},{}],312:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./functions.js");const s=function(){};s.prototype.disposed_=!1,s.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},s.prototype.disposeInternal=e.UNDEFINED,exports.default=s;
},{"./functions.js":195}],211:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stopPropagation=o,exports.preventDefault=e;const t=function(t){this.propagationStopped,this.type=t,this.target=null};function o(t){t.stopPropagation()}function e(t){t.preventDefault()}t.prototype.preventDefault=t.prototype.stopPropagation=function(){this.propagationStopped=!0},exports.default=t;
},{}],235:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Disposable.js"),i=l(t),s=require("../events.js"),n=require("../functions.js"),r=require("../events/Event.js"),o=l(r);function l(e){return e&&e.__esModule?e:{default:e}}const h=function(){i.default.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}};(0,e.inherits)(h,i.default),h.prototype.addEventListener=function(e,t){let i=this.listeners_[e];i||(i=this.listeners_[e]=[]),-1===i.indexOf(t)&&i.push(t)},h.prototype.dispatchEvent=function(e){const t="string"==typeof e?new o.default(e):e,i=t.type;t.target=this;const s=this.listeners_[i];let r;if(s){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(let e=0,i=s.length;e<i;++e)if(!1===s[e].call(this,t)||t.propagationStopped){r=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){let e=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];e--;)this.removeEventListener(i,n.UNDEFINED);delete this.dispatching_[i]}return r}},h.prototype.disposeInternal=function(){(0,s.unlistenAll)(this)},h.prototype.getListeners=function(e){return this.listeners_[e]},h.prototype.hasListener=function(e){return e?e in this.listeners_:Object.keys(this.listeners_).length>0},h.prototype.removeEventListener=function(e,t){const i=this.listeners_[e];if(i){const s=i.indexOf(t);e in this.pendingRemovals_?(i[s]=n.UNDEFINED,++this.pendingRemovals_[e]):(i.splice(s,1),0===i.length&&delete this.listeners_[e])}},exports.default=h;
},{"../index.js":80,"../Disposable.js":312,"../events.js":193,"../functions.js":195,"../events/Event.js":211}],194:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};
},{}],181:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unByKey=l;var e=require("./index.js"),t=require("./events.js"),n=require("./events/EventTarget.js"),r=o(n),i=require("./events/EventType.js"),s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}const u=function(){r.default.call(this),this.revision_=0};function l(e){if(Array.isArray(e))for(let n=0,r=e.length;n<r;++n)(0,t.unlistenByKey)(e[n]);else(0,t.unlistenByKey)(e)}(0,e.inherits)(u,r.default),u.prototype.changed=function(){++this.revision_,this.dispatchEvent(s.default.CHANGE)},u.prototype.dispatchEvent,u.prototype.getRevision=function(){return this.revision_},u.prototype.on=function(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=(0,t.listen)(this,e[s],n);return i}return(0,t.listen)(this,e,n)},u.prototype.once=function(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=(0,t.listenOnce)(this,e[s],n);return i}return(0,t.listenOnce)(this,e,n)},u.prototype.un=function(e,n){if(Array.isArray(e))for(let r=0,i=e.length;r<i;++r)(0,t.unlisten)(this,e[r],n);else(0,t.unlisten)(this,e,n)},exports.default=u;
},{"./index.js":80,"./events.js":193,"./events/EventTarget.js":235,"./events/EventType.js":194}],196:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getChangeEventType=c;var t=require("./index.js"),e=require("./ObjectEventType.js"),s=l(e),i=require("./Observable.js"),n=l(i),o=require("./events/Event.js"),r=l(o),u=require("./obj.js");function l(t){return t&&t.__esModule?t:{default:t}}const a=function(t,e,s){r.default.call(this,t),this.key=e,this.oldValue=s};(0,t.inherits)(a,r.default);const h=function(e){n.default.call(this),(0,t.getUid)(this),this.values_={},void 0!==e&&this.setProperties(e)};(0,t.inherits)(h,n.default);const p={};function c(t){return p.hasOwnProperty(t)?p[t]:p[t]="change:"+t}h.prototype.get=function(t){let e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},h.prototype.getKeys=function(){return Object.keys(this.values_)},h.prototype.getProperties=function(){return(0,u.assign)({},this.values_)},h.prototype.notify=function(t,e){let i;i=c(t),this.dispatchEvent(new a(i,t,e)),i=s.default.PROPERTYCHANGE,this.dispatchEvent(new a(i,t,e))},h.prototype.set=function(t,e,s){if(s)this.values_[t]=e;else{const s=this.values_[t];this.values_[t]=e,s!==e&&this.notify(t,s)}},h.prototype.setProperties=function(t,e){for(const s in t)this.set(s,t[s],e)},h.prototype.unset=function(t,e){if(t in this.values_){const s=this.values_[t];delete this.values_[t],e||this.notify(t,s)}},exports.default=h;
},{"./index.js":80,"./ObjectEventType.js":229,"./Observable.js":181,"./events/Event.js":211,"./obj.js":82}],135:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectionEvent=void 0;var t=require("./index.js"),e=require("./AssertionError.js"),r=a(e),i=require("./CollectionEventType.js"),n=a(i),s=require("./Object.js"),o=a(s),h=require("./events/Event.js"),u=a(h);function a(t){return t&&t.__esModule?t:{default:t}}const p={LENGTH:"length"},c=exports.CollectionEvent=function(t,e){u.default.call(this,t),this.element=e};(0,t.inherits)(c,u.default);const l=function(t,e){o.default.call(this);const r=e||{};if(this.unique_=!!r.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()};(0,t.inherits)(l,o.default),l.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},l.prototype.extend=function(t){let e,r;for(e=0,r=t.length;e<r;++e)this.push(t[e]);return this},l.prototype.forEach=function(t){const e=this.array_;for(let r=0,i=e.length;r<i;++r)t(e[r],r,e)},l.prototype.getArray=function(){return this.array_},l.prototype.item=function(t){return this.array_[t]},l.prototype.getLength=function(){return this.get(p.LENGTH)},l.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new c(n.default.ADD,e))},l.prototype.pop=function(){return this.removeAt(this.getLength()-1)},l.prototype.push=function(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()},l.prototype.remove=function(t){const e=this.array_;let r,i;for(r=0,i=e.length;r<i;++r)if(e[r]===t)return this.removeAt(r)},l.prototype.removeAt=function(t){const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new c(n.default.REMOVE,e)),e},l.prototype.setAt=function(t,e){const r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new c(n.default.REMOVE,r)),this.dispatchEvent(new c(n.default.ADD,e))}else{let i;for(i=r;i<t;++i)this.insertAt(i,void 0);this.insertAt(t,e)}},l.prototype.updateLength_=function(){this.set(p.LENGTH,this.array_.length)},l.prototype.assertUnique_=function(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new r.default(58)},exports.default=l;
},{"./index.js":80,"./AssertionError.js":267,"./CollectionEventType.js":228,"./Object.js":196,"./events/Event.js":211}],254:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./events/Event.js"),r=s(t);function s(e){return e&&e.__esModule?e:{default:e}}const u=function(e,t,s){r.default.call(this,e),this.map=t,this.frameState=void 0!==s?s:null};(0,e.inherits)(u,r.default),exports.default=u;
},{"./index.js":80,"./events/Event.js":211}],251:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./MapEvent.js"),i=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const n=function(t,e,o,n,r){i.default.call(this,t,e,r),this.originalEvent=o,this.pixel=e.getEventPixel(o),this.coordinate=e.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==n&&n};(0,t.inherits)(n,i.default),n.prototype.preventDefault=function(){i.default.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},n.prototype.stopPropagation=function(){i.default.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},exports.default=n;
},{"./index.js":80,"./MapEvent.js":254}],256:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WEBGL=exports.MSPOINTER=exports.POINTER=exports.TOUCH=exports.GEOLOCATION=exports.CANVAS_LINE_DASH=exports.DEVICE_PIXEL_RATIO=exports.MAC=exports.WEBKIT=exports.SAFARI=exports.FIREFOX=void 0;var e=require("./index.js");const t="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",o=exports.FIREFOX=-1!==t.indexOf("firefox"),r=exports.SAFARI=-1!==t.indexOf("safari")&&-1==t.indexOf("chrom"),n=exports.WEBKIT=-1!==t.indexOf("webkit")&&-1==t.indexOf("edge"),s=exports.MAC=-1!==t.indexOf("macintosh"),i=exports.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,x=exports.CANVAS_LINE_DASH=function(){let e=!1;try{e=!!document.createElement("CANVAS").getContext("2d").setLineDash}catch(e){}return e}(),p=exports.GEOLOCATION="geolocation"in navigator,E=exports.TOUCH="ontouchstart"in window,O=exports.POINTER="PointerEvent"in window,a=exports.MSPOINTER=!!navigator.msPointerEnabled,d=exports.WEBGL=e.HAS_WEBGL;
},{"./index.js":80}],253:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./events/EventType.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}exports.default={SINGLECLICK:"singleclick",CLICK:t.default.CLICK,DBLCLICK:t.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};
},{"./events/EventType.js":194}],265:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./MapBrowserEvent.js"),r=i(t);function i(e){return e&&e.__esModule?e:{default:e}}const n=function(e,t,i,n,s){r.default.call(this,e,t,i.originalEvent,n,s),this.pointerEvent=i};(0,e.inherits)(n,r.default),exports.default=n;
},{"./index.js":80,"./MapBrowserEvent.js":251}],317:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};
},{}],320:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t,e){this.dispatcher=t,this.mapping_=e};t.prototype.getEvents=function(){return Object.keys(this.mapping_)},t.prototype.getHandlerForEvent=function(t){return this.mapping_[t]},exports.default=t;
},{}],271:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.POINTER_TYPE=exports.POINTER_ID=void 0;var t=require("../index.js"),e=require("../pointer/EventSource.js"),o=s(e);function s(t){return t&&t.__esModule?t:{default:t}}const i=function(t){const e={mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout};o.default.call(this,t,e),this.pointerMap=t.pointerMap,this.lastTouches=[]};(0,t.inherits)(i,o.default);const n=exports.POINTER_ID=1,u=exports.POINTER_TYPE="mouse",r=25;function c(t,e){const o=e.cloneEvent(t,t),s=o.preventDefault;return o.preventDefault=function(){t.preventDefault(),s()},o.pointerId=n,o.isPrimary=!0,o.pointerType=u,o}i.prototype.isEventSimulatedFromTouch_=function(t){const e=this.lastTouches,o=t.clientX,s=t.clientY;for(let t,i=0,n=e.length;i<n&&(t=e[i]);i++){const e=Math.abs(o-t[0]),i=Math.abs(s-t[1]);if(e<=25&&i<=25)return!0}return!1},i.prototype.mousedown=function(t){if(!this.isEventSimulatedFromTouch_(t)){n.toString()in this.pointerMap&&this.cancel(t);const e=c(t,this.dispatcher);this.pointerMap[n.toString()]=t,this.dispatcher.down(e,t)}},i.prototype.mousemove=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.move(e,t)}},i.prototype.mouseup=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=this.pointerMap[n.toString()];if(e&&e.button===t.button){const e=c(t,this.dispatcher);this.dispatcher.up(e,t),this.cleanupMouse()}}},i.prototype.mouseover=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.enterOver(e,t)}},i.prototype.mouseout=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}},i.prototype.cancel=function(t){const e=c(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},i.prototype.cleanupMouse=function(){delete this.pointerMap[n.toString()]},exports.default=i;
},{"../index.js":80,"../pointer/EventSource.js":320}],343:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../pointer/EventSource.js"),n=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t){const e={MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture};n.default.call(this,t,e),this.pointerMap=t.pointerMap};(0,t.inherits)(r,n.default);const i=["","unavailable","touch","pen","mouse"];r.prototype.prepareEvent_=function(t){let e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=i[t.pointerType]),e},r.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},r.prototype.msPointerDown=function(t){this.pointerMap[t.pointerId.toString()]=t;const e=this.prepareEvent_(t);this.dispatcher.down(e,t)},r.prototype.msPointerMove=function(t){const e=this.prepareEvent_(t);this.dispatcher.move(e,t)},r.prototype.msPointerUp=function(t){const e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)},r.prototype.msPointerOut=function(t){const e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)},r.prototype.msPointerOver=function(t){const e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)},r.prototype.msPointerCancel=function(t){const e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)},r.prototype.msLostPointerCapture=function(t){const e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)},r.prototype.msGotPointerCapture=function(t){const e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)},exports.default=r;
},{"../index.js":80,"../pointer/EventSource.js":320}],344:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../pointer/EventSource.js"),i=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t){const e={pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture};i.default.call(this,t,e)};(0,t.inherits)(r,i.default),r.prototype.pointerDown=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerMove=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerUp=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerOut=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerOver=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerCancel=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.lostPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.gotPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},exports.default=r;
},{"../index.js":80,"../pointer/EventSource.js":320}],345:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../events/Event.js"),i=n(e);function n(t){return t&&t.__esModule?t:{default:t}}const s=function(t,e,n){i.default.call(this,t),this.originalEvent=e;const s=n||{};this.buttons=this.getButtons_(s),this.pressure=this.getPressure_(s,this.buttons),this.bubbles="bubbles"in s&&s.bubbles,this.cancelable="cancelable"in s&&s.cancelable,this.view="view"in s?s.view:null,this.detail="detail"in s?s.detail:null,this.screenX="screenX"in s?s.screenX:0,this.screenY="screenY"in s?s.screenY:0,this.clientX="clientX"in s?s.clientX:0,this.clientY="clientY"in s?s.clientY:0,this.ctrlKey="ctrlKey"in s&&s.ctrlKey,this.altKey="altKey"in s&&s.altKey,this.shiftKey="shiftKey"in s&&s.shiftKey,this.metaKey="metaKey"in s&&s.metaKey,this.button="button"in s?s.button:0,this.relatedTarget="relatedTarget"in s?s.relatedTarget:null,this.pointerId="pointerId"in s?s.pointerId:0,this.width="width"in s?s.width:0,this.height="height"in s?s.height:0,this.tiltX="tiltX"in s?s.tiltX:0,this.tiltY="tiltY"in s?s.tiltY:0,this.pointerType="pointerType"in s?s.pointerType:"",this.hwTimestamp="hwTimestamp"in s?s.hwTimestamp:0,this.isPrimary="isPrimary"in s&&s.isPrimary,e.preventDefault&&(this.preventDefault=function(){e.preventDefault()})};(0,t.inherits)(s,i.default);let r=!1;s.prototype.getButtons_=function(t){let e;if(t.buttons||r)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},s.prototype.getPressure_=function(t,e){let i=0;return i=t.pressure?t.pressure:e?.5:0},function(){try{const t=new MouseEvent("click",{buttons:1});r=1===t.buttons}catch(t){}}(),exports.default=s;
},{"../index.js":80,"../events/Event.js":211}],209:[function(require,module,exports) {
"use strict";function e(e,n,t){let o,u;const i=t||r;let f=0,s=e.length,l=!1;for(;f<s;)(u=+i(e[o=f+(s-f>>1)],n))<0?f=o+1:(s=o,l=!u);return l?f:~f}function r(e,r){return e>r?1:e<r?-1:0}function n(e,r){return e.indexOf(r)>=0}function t(e,r,n){const t=e.length;if(e[0]<=r)return 0;if(r<=e[t-1])return t-1;{let o;if(n>0){for(o=1;o<t;++o)if(e[o]<r)return o-1}else if(n<0){for(o=1;o<t;++o)if(e[o]<=r)return o}else for(o=1;o<t;++o){if(e[o]==r)return o;if(e[o]<r)return e[o-1]-r<r-e[o]?o-1:o}return t-1}}function o(e,r,n){for(;r<n;){const t=e[r];e[r]=e[n],e[n]=t,++r,--n}}function u(e,r){const n=Array.isArray(r)?r:[r],t=n.length;for(let r=0;r<t;r++)e[e.length]=n[r]}function i(e,r){const n=e.indexOf(r),t=n>-1;return t&&e.splice(n,1),t}function f(e,r){const n=e.length>>>0;let t;for(let o=0;o<n;o++)if(r(t=e[o],o,e))return t;return null}function s(e,r){const n=e.length;if(n!==r.length)return!1;for(let t=0;t<n;t++)if(e[t]!==r[t])return!1;return!0}function l(e,r){const n=e.length,t=Array(e.length);let o;for(o=0;o<n;o++)t[o]={index:o,value:e[o]};for(t.sort(function(e,n){return r(e.value,n.value)||e.index-n.index}),o=0;o<e.length;o++)e[o]=t[o].value}function c(e,r){let n;return!e.every(function(t,o){return n=o,!r(t,o,e)})?n:-1}function x(e,n,t){const o=n||r;return e.every(function(r,n){if(0===n)return!0;const u=o(e[n-1],r);return!(u>0||t&&0===u)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.binarySearch=e,exports.numberSafeCompareFunction=r,exports.includes=n,exports.linearFindNearest=t,exports.reverseSubArray=o,exports.extend=u,exports.remove=i,exports.find=f,exports.equals=s,exports.stableSort=l,exports.findIndex=c,exports.isSorted=x;
},{}],346:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),o=require("../pointer/EventSource.js"),i=s(o),r=require("../pointer/MouseSource.js");function s(t){return t&&t.__esModule?t:{default:t}}const n=function(t,e){const o={touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel};i.default.call(this,t,o),this.pointerMap=t.pointerMap,this.mouseSource=e,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500};(0,t.inherits)(n,i.default);const c=200,u="touch";n.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},n.prototype.setPrimaryTouch_=function(t){const e=Object.keys(this.pointerMap).length;(0===e||1===e&&r.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},n.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},n.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},n.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},n.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},n.prototype.touchToPointer_=function(t,e){const o=this.dispatcher.cloneEvent(t,e);return o.pointerId=e.identifier+2,o.bubbles=!0,o.cancelable=!0,o.detail=this.clickCount_,o.button=0,o.buttons=1,o.width=e.webkitRadiusX||e.radiusX||0,o.height=e.webkitRadiusY||e.radiusY||0,o.pressure=e.webkitForce||e.force||.5,o.isPrimary=this.isPrimaryTouch_(e),o.pointerType="touch",o.clientX=e.clientX,o.clientY=e.clientY,o.screenX=e.screenX,o.screenY=e.screenY,o},n.prototype.processTouches_=function(t,e){const o=Array.prototype.slice.call(t.changedTouches),i=o.length;function r(){t.preventDefault()}let s,n;for(s=0;s<i;++s)(n=this.touchToPointer_(t,o[s])).preventDefault=r,e.call(this,t,n)},n.prototype.findTouch_=function(t,e){const o=t.length;let i;for(let r=0;r<o;r++)if((i=t[r]).identifier===e)return!0;return!1},n.prototype.vacuumTouches_=function(t){const e=t.touches,o=Object.keys(this.pointerMap),i=o.length;if(i>=e.length){const s=[];let n,c,u;for(n=0;n<i;++n)c=o[n],u=this.pointerMap[c],c==r.POINTER_ID||this.findTouch_(e,c-2)||s.push(u.out);for(n=0;n<s.length;++n)this.cancelOut_(t,s[n])}},n.prototype.touchstart=function(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)},n.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},n.prototype.touchmove=function(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)},n.prototype.moveOverOut_=function(t,e){const o=e,i=this.pointerMap[o.pointerId];if(!i)return;const r=i.out,s=i.outTarget;this.dispatcher.move(o,t),r&&s!==o.target&&(r.relatedTarget=o.target,o.relatedTarget=s,r.target=s,o.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(o,t)):(o.target=s,o.relatedTarget=null,this.cancelOut_(t,o))),i.out=o,i.outTarget=o.target},n.prototype.touchend=function(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)},n.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},n.prototype.touchcancel=function(t){this.processTouches_(t,this.cancelOut_)},n.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},n.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},n.prototype.dedupSynthMouse_=function(t){const o=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){const t=[i.clientX,i.clientY];o.push(t),setTimeout(function(){(0,e.remove)(o,t)},this.dedupTimeout_)}},exports.default=n;
},{"../index.js":80,"../array.js":209,"../pointer/EventSource.js":320,"../pointer/MouseSource.js":271}],318:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../events.js"),n=require("../events/EventTarget.js"),i=y(n),r=require("../has.js"),o=require("../pointer/EventType.js"),s=y(o),u=require("../pointer/MouseSource.js"),c=y(u),p=require("../pointer/MsSource.js"),l=y(p),a=require("../pointer/NativeSource.js"),h=y(a),f=require("../pointer/PointerEvent.js"),v=y(f),E=require("../pointer/TouchSource.js"),d=y(E);function y(t){return t&&t.__esModule?t:{default:t}}const _=function(t){i.default.call(this),this.element_=t,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()};(0,t.inherits)(_,i.default);const g=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];_.prototype.registerSources=function(){if(r.POINTER)this.registerSource("native",new h.default(this));else if(r.MSPOINTER)this.registerSource("ms",new l.default(this));else{const t=new c.default(this);this.registerSource("mouse",t),r.TOUCH&&this.registerSource("touch",new d.default(this,t))}this.register_()},_.prototype.registerSource=function(t,e){const n=e,i=n.getEvents();i&&(i.forEach(function(t){const e=n.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(n))}.bind(this)),this.eventSourceList_.push(n))},_.prototype.register_=function(){const t=this.eventSourceList_.length;let e;for(let n=0;n<t;n++)e=this.eventSourceList_[n],this.addEvents_(e.getEvents())},_.prototype.unregister_=function(){const t=this.eventSourceList_.length;let e;for(let n=0;n<t;n++)e=this.eventSourceList_[n],this.removeEvents_(e.getEvents())},_.prototype.eventHandler_=function(t){const e=t.type,n=this.eventMap_[e];n&&n(t)},_.prototype.addEvents_=function(t){t.forEach(function(t){(0,e.listen)(this.element_,t,this.eventHandler_,this)}.bind(this))},_.prototype.removeEvents_=function(t){t.forEach(function(t){(0,e.unlisten)(this.element_,t,this.eventHandler_,this)}.bind(this))},_.prototype.cloneEvent=function(t,e){const n={};for(let i=0,r=g.length;i<r;i++){const r=g[i][0];n[r]=t[r]||e[r]||g[i][1]}return n},_.prototype.down=function(t,e){this.fireEvent(s.default.POINTERDOWN,t,e)},_.prototype.move=function(t,e){this.fireEvent(s.default.POINTERMOVE,t,e)},_.prototype.up=function(t,e){this.fireEvent(s.default.POINTERUP,t,e)},_.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(s.default.POINTERENTER,t,e)},_.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(s.default.POINTERLEAVE,t,e)},_.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(s.default.POINTEROVER,t,e)},_.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(s.default.POINTEROUT,t,e)},_.prototype.cancel=function(t,e){this.fireEvent(s.default.POINTERCANCEL,t,e)},_.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},_.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},_.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},_.prototype.makeEvent=function(t,e,n){return new v.default(t,n,e)},_.prototype.fireEvent=function(t,e,n){const i=this.makeEvent(t,e,n);this.dispatchEvent(i)},_.prototype.fireNativeEvent=function(t){const e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},_.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,c.default.prepareEvent(e,this),e)},_.prototype.disposeInternal=function(){this.unregister_(),i.default.prototype.disposeInternal.call(this)},exports.default=_;
},{"../index.js":80,"../events.js":193,"../events/EventTarget.js":235,"../has.js":256,"../pointer/EventType.js":317,"../pointer/MouseSource.js":271,"../pointer/MsSource.js":343,"../pointer/NativeSource.js":344,"../pointer/PointerEvent.js":345,"../pointer/TouchSource.js":346}],252:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./has.js"),i=require("./MapBrowserEventType.js"),n=c(i),s=require("./MapBrowserPointerEvent.js"),o=c(s),r=require("./events.js"),d=require("./events/EventTarget.js"),h=c(d),a=require("./pointer/EventType.js"),l=c(a),u=require("./pointer/PointerEventHandler.js"),_=c(u);function c(t){return t&&t.__esModule?t:{default:t}}const p=function(t,i){h.default.call(this),this.map_=t,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*e.DEVICE_PIXEL_RATIO:e.DEVICE_PIXEL_RATIO,this.down_=null;const n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new _.default(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=(0,r.listen)(this.pointerEventHandler_,l.default.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=(0,r.listen)(this.pointerEventHandler_,l.default.POINTERMOVE,this.relayEvent_,this)};(0,t.inherits)(p,h.default),p.prototype.emulateClick_=function(t){let e=new o.default(n.default.CLICK,this.map_,t);this.dispatchEvent(e),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,e=new o.default(n.default.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;const e=new o.default(n.default.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},p.prototype.updateActivePointers_=function(t){const e=t;e.type==n.default.POINTERUP||e.type==n.default.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==n.default.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},p.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);const e=new o.default(n.default.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(r.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},p.prototype.isMouseActionButton_=function(t){return 0===t.button},p.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);const e=new o.default(n.default.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new _.default(document),this.dragListenerKeys_.push((0,r.listen)(this.documentPointerEventHandler_,n.default.POINTERMOVE,this.handlePointerMove_,this),(0,r.listen)(this.documentPointerEventHandler_,n.default.POINTERUP,this.handlePointerUp_,this),(0,r.listen)(this.pointerEventHandler_,n.default.POINTERCANCEL,this.handlePointerUp_,this)))},p.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;const e=new o.default(n.default.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},p.prototype.relayEvent_=function(t){const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new o.default(t.type,this.map_,t,e))},p.prototype.isMoving_=function(t){return Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},p.prototype.disposeInternal=function(){this.relayedListenerKey_&&((0,r.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&((0,r.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(r.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),h.default.prototype.disposeInternal.call(this)},exports.default=p;
},{"./index.js":80,"./has.js":256,"./MapBrowserEventType.js":253,"./MapBrowserPointerEvent.js":265,"./events.js":193,"./events/EventTarget.js":235,"./pointer/EventType.js":317,"./pointer/PointerEventHandler.js":318}],206:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};
},{}],255:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};
},{}],199:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};
},{}],165:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=s;var e=require("./AssertionError.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new r.default(t)}
},{"./AssertionError.js":267}],257:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DROP=void 0;var t=require("../asserts.js"),e=require("../obj.js");const i=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}},n=exports.DROP=1/0;i.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,(0,e.clear)(this.queuedElements_)},i.prototype.dequeue=function(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i},i.prototype.enqueue=function(e){(0,t.assert)(!(this.keyFunction_(e)in this.queuedElements_),31);const i=this.priorityFunction_(e);return i!=n&&(this.elements_.push(e),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},i.prototype.getCount=function(){return this.elements_.length},i.prototype.getLeftChildIndex_=function(t){return 2*t+1},i.prototype.getRightChildIndex_=function(t){return 2*t+2},i.prototype.getParentIndex_=function(t){return t-1>>1},i.prototype.heapify_=function(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},i.prototype.isEmpty=function(){return 0===this.elements_.length},i.prototype.isKeyQueued=function(t){return t in this.queuedElements_},i.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},i.prototype.siftUp_=function(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],o=i[t],r=t;for(;t<n>>1;){const s=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),r=o<n&&i[o]<i[s]?o:s;e[t]=e[r],i[t]=i[r],t=r}e[t]=s,i[t]=o,this.siftDown_(r,t)},i.prototype.siftDown_=function(t,e){const i=this.elements_,n=this.priorities_,s=i[e],o=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>o))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=s,n[e]=o},i.prototype.reprioritize=function(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let s=0;const o=e.length;let r,h,u;for(h=0;h<o;++h)(u=t(r=e[h]))==n?delete this.queuedElements_[this.keyFunction_(r)]:(i[s]=u,e[s++]=r);e.length=s,i.length=s,this.heapify_()},exports.default=i;
},{"../asserts.js":165,"../obj.js":82}],247:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./TileState.js"),i=o(t),n=require("./events.js"),s=require("./events/EventType.js"),l=o(s),a=require("./structs/PriorityQueue.js"),u=o(a);function o(e){return e&&e.__esModule?e:{default:e}}const r=function(e,t){u.default.call(this,function(t){return e.apply(null,t)},function(e){return e[0].getKey()}),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}};(0,e.inherits)(r,u.default),r.prototype.enqueue=function(e){const t=u.default.prototype.enqueue.call(this,e);if(t){const t=e[0];(0,n.listen)(t,l.default.CHANGE,this.handleTileChange,this)}return t},r.prototype.getTilesLoading=function(){return this.tilesLoading_},r.prototype.handleTileChange=function(e){const t=e.target,s=t.getState();if(s===i.default.LOADED||s===i.default.ERROR||s===i.default.EMPTY||s===i.default.ABORT){(0,n.unlisten)(t,l.default.CHANGE,this.handleTileChange,this);const e=t.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_()}},r.prototype.loadMoreTiles=function(e,t){let n,s,l,a=0,u=!1;for(;this.tilesLoading_<e&&a<t&&this.getCount()>0;)l=(s=this.dequeue()[0]).getKey(),(n=s.getState())===i.default.ABORT?u=!0:n!==i.default.IDLE||l in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++a,s.load());0===a&&u&&this.tileChangeCallback_()},exports.default=r;
},{"./index.js":80,"./TileState.js":199,"./events.js":193,"./events/EventType.js":194,"./structs/PriorityQueue.js":257}],225:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.DEFAULT_MAX_ZOOM=42,t=exports.DEFAULT_TILE_SIZE=256;
},{}],160:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cosh=void 0,exports.clamp=e,exports.roundUpToPowerOfTwo=o,exports.squaredSegmentDistance=n,exports.squaredDistance=s,exports.solveLinearSystem=c,exports.toDegrees=u,exports.toRadians=a,exports.modulo=i,exports.lerp=f;var t=require("./asserts.js");function e(t,e,r){return Math.min(Math.max(t,e),r)}const r=exports.cosh=function(){let t;return t="cosh"in Math?Math.cosh:function(t){const e=Math.exp(t);return(e+1/e)/2}}();function o(e){return(0,t.assert)(0<e,29),Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function n(t,e,r,o,n,c){const u=n-r,a=c-o;if(0!==u||0!==a){const s=((t-r)*u+(e-o)*a)/(u*u+a*a);s>1?(r=n,o=c):s>0&&(r+=u*s,o+=a*s)}return s(t,e,r,o)}function s(t,e,r,o){const n=r-t,s=o-e;return n*n+s*s}function c(t){const e=t.length;for(let r=0;r<e;r++){let o=r,n=Math.abs(t[r][r]);for(let s=r+1;s<e;s++){const e=Math.abs(t[s][r]);e>n&&(n=e,o=s)}if(0===n)return null;const s=t[o];t[o]=t[r],t[r]=s;for(let o=r+1;o<e;o++){const n=-t[o][r]/t[r][r];for(let s=r;s<e+1;s++)r==s?t[o][s]=0:t[o][s]+=n*t[r][s]}}const r=new Array(e);for(let o=e-1;o>=0;o--){r[o]=t[o][e]/t[o][o];for(let n=o-1;n>=0;n--)t[n][e]-=t[n][o]*r[o]}return r}function u(t){return 180*t/Math.PI}function a(t){return t*Math.PI/180}function i(t,e){const r=t%e;return r*e<0?r+e:r}function f(t,e,r){return t+r*(e-t)}
},{"./asserts.js":165}],219:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExtent=t,exports.none=r;var e=require("./math.js");function t(t){return function(r){return r?[(0,e.clamp)(r[0],t[0],t[2]),(0,e.clamp)(r[1],t[1],t[3])]:void 0}}function r(e){return e}
},{"./math.js":160}],220:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSnapToResolutions=r,exports.createSnapToPower=o;var t=require("./array.js"),e=require("./math.js");function r(r){return function(o,n,a){if(void 0!==o){let i=(0,t.linearFindNearest)(r,o,a);i=(0,e.clamp)(i+n,0,r.length-1);const u=Math.floor(i);if(i!=u&&u<r.length-1){const t=r[u]/r[u+1];return r[u]/Math.pow(t,i-u)}return r[u]}}}function o(t,e,r){return function(o,n,a){if(void 0!==o){const i=-a/2+.5,u=Math.floor(Math.log(e/o)/Math.log(t)+i);let s=Math.max(u+n,0);return void 0!==r&&(s=Math.min(s,r)),e/Math.pow(t,s)}}}
},{"./array.js":209,"./math.js":160}],221:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.disable=t,exports.none=e,exports.createSnapToN=r,exports.createSnapToZero=n;var o=require("./math.js");function t(o,t){return void 0!==o?0:void 0}function e(o,t){return void 0!==o?o+t:void 0}function r(o){const t=2*Math.PI/o;return function(o,e){return void 0!==o?o=Math.floor((o+e)/t+.5)*t:void 0}}function n(t){const e=t||(0,o.toRadians)(5);return function(o,t){return void 0!==o?Math.abs(o+t)<=e?0:o+t:void 0}}
},{"./math.js":160}],222:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ANIMATING:0,INTERACTING:1};
},{}],223:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};
},{}],261:[function(require,module,exports) {
"use strict";function e(e,t,r){const n=void 0!==r?e.toFixed(r):""+e;let o=n.indexOf(".");return(o=-1===o?n.length:o)>t?n:new Array(1+t-o).join("0")+n}function t(e,t){const r=(""+e).split("."),n=(""+t).split(".");for(let e=0;e<Math.max(r.length,n.length);e++){const t=parseInt(r[e]||"0",10),o=parseInt(n[e]||"0",10);if(t>o)return 1;if(o>t)return-1}return 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.padNumber=e,exports.compareVersions=t;
},{}],217:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=r,exports.closestOnCircle=n,exports.closestOnSegment=o,exports.createStringXY=s,exports.degreesToStringHDMS=u,exports.format=c,exports.equals=i,exports.rotate=a,exports.scale=f,exports.squaredDistance=p,exports.distance=l,exports.squaredDistanceToSegment=x,exports.toStringHDMS=d,exports.toStringXY=h;var t=require("./math.js"),e=require("./string.js");function r(t,e){return t[0]+=e[0],t[1]+=e[1],t}function n(t,e){const r=e.getRadius(),n=e.getCenter(),o=n[0],s=n[1];let u=t[0]-o;const c=t[1]-s;0===u&&0===c&&(u=1);const i=Math.sqrt(u*u+c*c);return[o+r*u/i,s+r*c/i]}function o(t,e){const r=t[0],n=t[1],o=e[0],s=e[1],u=o[0],c=o[1],i=s[0],a=s[1],f=i-u,p=a-c,l=0===f&&0===p?0:(f*(r-u)+p*(n-c))/(f*f+p*p||0);let x,d;return l<=0?(x=u,d=c):l>=1?(x=i,d=a):(x=u+l*f,d=c+l*p),[x,d]}function s(t){return function(e){return h(e,t)}}function u(r,n,o){const s=(0,t.modulo)(n+180,360)-180,u=Math.abs(3600*s),c=o||0,i=Math.pow(10,c);let a=Math.floor(u/3600),f=Math.floor((u-3600*a)/60),p=u-3600*a-60*f;return(p=Math.ceil(p*i)/i)>=60&&(p=0,f+=1),f>=60&&(f=0,a+=1),a+"° "+(0,e.padNumber)(f,2)+"′ "+(0,e.padNumber)(p,2,c)+"″"+(0==s?"":" "+r.charAt(s<0?1:0))}function c(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function i(t,e){let r=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function a(t,e){const r=Math.cos(e),n=Math.sin(e),o=t[0]*r-t[1]*n,s=t[1]*r+t[0]*n;return t[0]=o,t[1]=s,t}function f(t,e){return t[0]*=e,t[1]*=e,t}function p(t,e){const r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function l(t,e){return Math.sqrt(p(t,e))}function x(t,e){return p(t,o(t,e))}function d(t,e){return t?u("NS",t[1],e)+" "+u("EW",t[0],e):""}function h(t,e){return c(t,"{x}, {y}",e)}
},{"./math.js":160,"./string.js":261}],224:[function(require,module,exports) {
"use strict";function e(e){return Math.pow(e,3)}function t(t){return 1-e(1-t)}function n(e){return 3*e*e-2*e*e*e}function r(e){return e}function u(e){return e<.5?n(2*e):1-n(2*(e-.5))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.easeIn=e,exports.easeOut=t,exports.inAndOut=n,exports.linear=r,exports.upAndDown=u;
},{}],246:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};
},{}],274:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};
},{}],159:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.boundingExtent=a,exports.buffer=i,exports.clone=c,exports.closestSquaredDistanceXY=f,exports.containsCoordinate=l,exports.containsExtent=p,exports.containsXY=x,exports.coordinateRelationship=d,exports.createEmpty=h,exports.createOrUpdate=m,exports.createOrUpdateEmpty=g,exports.createOrUpdateFromCoordinate=T,exports.createOrUpdateFromCoordinates=E,exports.createOrUpdateFromFlatCoordinates=M,exports.createOrUpdateFromRings=O,exports.equals=C,exports.extend=R,exports.extendCoordinate=F,exports.extendCoordinates=I,exports.extendFlatCoordinates=N,exports.extendRings=B,exports.extendXY=L,exports.forEachCorner=y,exports.getArea=U,exports.getBottomLeft=G,exports.getBottomRight=_,exports.getCenter=A,exports.getCorner=S,exports.getEnlargedArea=H,exports.getForViewAndSize=W,exports.getHeight=q,exports.getIntersectionArea=j,exports.getIntersection=V,exports.getMargin=b,exports.getSize=P,exports.getTopLeft=X,exports.getTopRight=Y,exports.getWidth=v,exports.intersects=z,exports.isEmpty=K,exports.returnOrUpdate=w,exports.scaleFromCenter=D,exports.intersectsSegment=k,exports.applyTransform=J;var t=require("./asserts.js"),e=require("./extent/Corner.js"),n=u(e),r=require("./extent/Relationship.js"),o=u(r);function u(t){return t&&t.__esModule?t:{default:t}}function a(t){const e=h();for(let n=0,r=t.length;n<r;++n)F(e,t[n]);return e}function s(t,e,n){return m(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}function i(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function c(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function f(t,e,n){let r,o;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(o=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*o}function l(t,e){return x(t,e[0],e[1])}function p(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function x(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function d(t,e){const n=t[0],r=t[1],u=t[2],a=t[3],s=e[0],i=e[1];let c=o.default.UNKNOWN;return s<n?c|=o.default.LEFT:s>u&&(c|=o.default.RIGHT),i<r?c|=o.default.BELOW:i>a&&(c|=o.default.ABOVE),c===o.default.UNKNOWN&&(c=o.default.INTERSECTING),c}function h(){return[1/0,1/0,-1/0,-1/0]}function m(t,e,n,r,o){return o?(o[0]=t,o[1]=e,o[2]=n,o[3]=r,o):[t,e,n,r]}function g(t){return m(1/0,1/0,-1/0,-1/0,t)}function T(t,e){const n=t[0],r=t[1];return m(n,r,n,r,e)}function E(t,e){return I(g(e),t)}function M(t,e,n,r,o){return N(g(o),t,e,n,r)}function O(t,e){return B(g(e),t)}function C(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function R(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function F(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function I(t,e){for(let n=0,r=e.length;n<r;++n)F(t,e[n]);return t}function N(t,e,n,r,o){for(;n<r;n+=o)L(t,e[n],e[n+1]);return t}function B(t,e){for(let n=0,r=e.length;n<r;++n)I(t,e[n]);return t}function L(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function y(t,e,n){let r;return(r=e.call(n,G(t)))?r:(r=e.call(n,_(t)))?r:(r=e.call(n,Y(t)))?r:(r=e.call(n,X(t)))||!1}function U(t){let e=0;return K(t)||(e=v(t)*q(t)),e}function G(t){return[t[0],t[1]]}function _(t){return[t[2],t[1]]}function A(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function S(e,r){let o;return r===n.default.BOTTOM_LEFT?o=G(e):r===n.default.BOTTOM_RIGHT?o=_(e):r===n.default.TOP_LEFT?o=X(e):r===n.default.TOP_RIGHT?o=Y(e):(0,t.assert)(!1,13),o}function H(t,e){const n=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-n)*(Math.max(t[3],e[3])-r)}function W(t,e,n,r,o){const u=e*r[0]/2,a=e*r[1]/2,s=Math.cos(n),i=Math.sin(n),c=u*s,f=u*i,l=a*s,p=a*i,x=t[0],d=t[1],h=x-c+p,g=x-c-p,T=x+c-p,E=x+c+p,M=d-f-l,O=d-f+l,C=d+f+l,R=d+f-l;return m(Math.min(h,g,T,E),Math.min(M,O,C,R),Math.max(h,g,T,E),Math.max(M,O,C,R),o)}function q(t){return t[3]-t[1]}function j(t,e){return U(V(t,e))}function V(t,e,n){const r=n||h();return z(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):g(r),r}function b(t){return v(t)+q(t)}function P(t){return[t[2]-t[0],t[3]-t[1]]}function X(t){return[t[0],t[3]]}function Y(t){return[t[2],t[3]]}function v(t){return t[2]-t[0]}function z(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function K(t){return t[2]<t[0]||t[3]<t[1]}function w(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function D(t,e){const n=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r}function k(t,e,n){let r=!1;const u=d(t,e),a=d(t,n);if(u===o.default.INTERSECTING||a===o.default.INTERSECTING)r=!0;else{const s=t[0],i=t[1],c=t[2],f=t[3],l=e[0],p=e[1],x=n[0],d=n[1],h=(d-p)/(x-l);let m,g;a&o.default.ABOVE&&!(u&o.default.ABOVE)&&(r=(m=x-(d-f)/h)>=s&&m<=c),r||!(a&o.default.RIGHT)||u&o.default.RIGHT||(r=(g=d-(x-c)*h)>=i&&g<=f),r||!(a&o.default.BELOW)||u&o.default.BELOW||(r=(m=x-(d-i)/h)>=s&&m<=c),r||!(a&o.default.LEFT)||u&o.default.LEFT||(r=(g=d-(x-s)*h)>=i&&g<=f)}return r}function J(t,e,n){const r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(r,r,2),s([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],n)}
},{"./asserts.js":165,"./extent/Corner.js":246,"./extent/Relationship.js":274}],226:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};
},{}],277:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};
},{}],311:[function(require,module,exports) {
"use strict";function t(t,e,n,o,r,l){const s=l||[];let c=0;for(let l=e;l<n;l+=o){const e=t[l],n=t[l+1];s[c++]=r[0]*e+r[2]*n+r[4],s[c++]=r[1]*e+r[3]*n+r[5]}return l&&s.length!=c&&(s.length=c),s}function e(t,e,n,o,r,l,s){const c=s||[],f=Math.cos(r),u=Math.sin(r),h=l[0],a=l[1];let g=0;for(let r=e;r<n;r+=o){const e=t[r]-h,n=t[r+1]-a;c[g++]=h+e*f-n*u,c[g++]=a+e*u+n*f;for(let e=r+2;e<r+o;++e)c[g++]=t[e]}return s&&c.length!=g&&(c.length=g),c}function n(t,e,n,o,r,l,s,c){const f=c||[],u=s[0],h=s[1];let a=0;for(let s=e;s<n;s+=o){const e=t[s]-u,n=t[s+1]-h;f[a++]=u+r*e,f[a++]=h+l*n;for(let e=s+2;e<s+o;++e)f[a++]=t[e]}return c&&f.length!=a&&(f.length=a),f}function o(t,e,n,o,r,l,s){const c=s||[];let f=0;for(let s=e;s<n;s+=o){c[f++]=t[s]+r,c[f++]=t[s+1]+l;for(let e=s+2;e<s+o;++e)c[f++]=t[e]}return s&&c.length!=f&&(c.length=f),c}Object.defineProperty(exports,"__esModule",{value:!0}),exports.transform2D=t,exports.rotate=e,exports.scale=n,exports.translate=o;
},{}],158:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_RADIUS=void 0,exports.getDistance=n,exports.getLength=c,exports.getArea=u,exports.offset=h;var t=require("./math.js"),e=require("./geom/GeometryType.js"),a=s(e);function s(t){return t&&t.__esModule?t:{default:t}}const o=exports.DEFAULT_RADIUS=6371008.8;function n(e,a,s){const n=s||o,r=(0,t.toRadians)(e[1]),c=(0,t.toRadians)(a[1]),i=(c-r)/2,u=(0,t.toRadians)(a[0]-e[0])/2,h=Math.sin(i)*Math.sin(i)+Math.sin(u)*Math.sin(u)*Math.cos(r)*Math.cos(c);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function r(t,e){let a=0;for(let s=0,o=t.length;s<o-1;++s)a+=n(t[s],t[s+1],e);return a}function c(t,e){const s=e||{},n=s.radius||o,i=s.projection||"EPSG:3857",u=t.getType();u!==a.default.GEOMETRY_COLLECTION&&(t=t.clone().transform(i,"EPSG:4326"));let h,f,l,d,M,g,I=0;switch(u){case a.default.POINT:case a.default.MULTI_POINT:break;case a.default.LINE_STRING:case a.default.LINEAR_RING:I=r(h=t.getCoordinates(),n);break;case a.default.MULTI_LINE_STRING:case a.default.POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)I+=r(h[l],n);break;case a.default.MULTI_POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)for(M=0,g=(f=h[l]).length;M<g;++M)I+=r(f[M],n);break;case a.default.GEOMETRY_COLLECTION:{const a=t.getGeometries();for(l=0,d=a.length;l<d;++l)I+=c(a[l],e);break}default:throw new Error("Unsupported geometry type: "+u)}return I}function i(e,a){let s=0;const o=e.length;let n=e[o-1][0],r=e[o-1][1];for(let a=0;a<o;a++){const o=e[a][0],c=e[a][1];s+=(0,t.toRadians)(o-n)*(2+Math.sin((0,t.toRadians)(r))+Math.sin((0,t.toRadians)(c))),n=o,r=c}return s*a*a/2}function u(t,e){const s=e||{},n=s.radius||o,r=s.projection||"EPSG:3857",c=t.getType();c!==a.default.GEOMETRY_COLLECTION&&(t=t.clone().transform(r,"EPSG:4326"));let h,f,l,d,M,g,I=0;switch(c){case a.default.POINT:case a.default.MULTI_POINT:case a.default.LINE_STRING:case a.default.MULTI_LINE_STRING:case a.default.LINEAR_RING:break;case a.default.POLYGON:for(h=t.getCoordinates(),I=Math.abs(i(h[0],n)),l=1,d=h.length;l<d;++l)I-=Math.abs(i(h[l],n));break;case a.default.MULTI_POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)for(f=h[l],I+=Math.abs(i(f[0],n)),M=1,g=f.length;M<g;++M)I-=Math.abs(i(f[M],n));break;case a.default.GEOMETRY_COLLECTION:{const a=t.getGeometries();for(l=0,d=a.length;l<d;++l)I+=u(a[l],e);break}default:throw new Error("Unsupported geometry type: "+c)}return I}function h(e,a,s,n){const r=n||o,c=(0,t.toRadians)(e[1]),i=(0,t.toRadians)(e[0]),u=a/r,h=Math.asin(Math.sin(c)*Math.cos(u)+Math.cos(c)*Math.sin(u)*Math.cos(s)),f=i+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(c),Math.cos(u)-Math.sin(c)*Math.sin(h));return[(0,t.toDegrees)(f),(0,t.toDegrees)(h)]}
},{"./math.js":160,"./geom/GeometryType.js":226}],132:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const E={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},e=exports.METERS_PER_UNIT={};e[E.DEGREES]=2*Math.PI*6370997/360,e[E.FEET]=.3048,e[E.METERS]=1,e[E.USFEET]=1200/3937,exports.default=E;
},{}],60:[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../proj/Units.js");const n=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};n.prototype.canWrapX=function(){return this.canWrapX_},n.prototype.getCode=function(){return this.code_},n.prototype.getExtent=function(){return this.extent_},n.prototype.getUnits=function(){return this.units_},n.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||e.METERS_PER_UNIT[this.units_]},n.prototype.getWorldExtent=function(){return this.worldExtent_},n.prototype.getAxisOrientation=function(){return this.axisOrientation_},n.prototype.isGlobal=function(){return this.global_},n.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},n.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},n.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},n.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},n.prototype.setWorldExtent=function(t){this.worldExtent_=t},n.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},n.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},exports.default=n;
},{"../proj/Units.js":132}],161:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROJECTIONS=exports.WORLD_EXTENT=exports.EXTENT=exports.HALF_SIZE=exports.RADIUS=void 0,exports.fromEPSG4326=x,exports.toEPSG4326=P;var e=require("../index.js"),t=require("../math.js"),r=require("../proj/Projection.js"),o=i(r),n=require("../proj/Units.js"),s=i(n);function i(e){return e&&e.__esModule?e:{default:e}}const l=exports.RADIUS=6378137,u=exports.HALF_SIZE=Math.PI*l,E=exports.EXTENT=[-u,-u,u,u],c=exports.WORLD_EXTENT=[-180,-85,180,85];function a(e){o.default.call(this,{code:e,units:s.default.METERS,extent:E,global:!0,worldExtent:c,getPointResolution:function(e,r){return e/(0,t.cosh)(r[1]/l)}})}(0,e.inherits)(a,o.default);const p=exports.PROJECTIONS=[new a("EPSG:3857"),new a("EPSG:102100"),new a("EPSG:102113"),new a("EPSG:900913"),new a("urn:ogc:def:crs:EPSG:6.18:3:3857"),new a("urn:ogc:def:crs:EPSG::3857"),new a("http://www.opengis.net/gml/srs/epsg.xml#3857")];function x(e,t,r){const o=e.length,n=r>1?r:2;let s=t;void 0===s&&(s=n>2?e.slice():new Array(o));const i=u;for(let t=0;t<o;t+=n){s[t]=i*e[t]/180;let r=l*Math.log(Math.tan(Math.PI*(e[t+1]+90)/360));r>i?r=i:r<-i&&(r=-i),s[t+1]=r}return s}function P(e,t,r){const o=e.length,n=r>1?r:2;let s=t;void 0===s&&(s=n>2?e.slice():new Array(o));for(let t=0;t<o;t+=n)s[t]=180*e[t]/u,s[t+1]=360*Math.atan(Math.exp(e[t+1]/l))/Math.PI-90;return s}
},{"../index.js":80,"../math.js":160,"../proj/Projection.js":60,"../proj/Units.js":132}],162:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROJECTIONS=exports.METERS_PER_UNIT=exports.EXTENT=exports.RADIUS=void 0;var e=require("../index.js"),r=require("../proj/Projection.js"),t=o(r),n=require("../proj/Units.js"),s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}const u=exports.RADIUS=6378137,i=exports.EXTENT=[-180,-90,180,90],E=exports.METERS_PER_UNIT=Math.PI*u/180;function c(e,r){t.default.call(this,{code:e,units:s.default.DEGREES,extent:i,axisOrientation:r,global:!0,metersPerUnit:E,worldExtent:i})}(0,e.inherits)(c,t.default);const d=exports.PROJECTIONS=[new c("CRS:84"),new c("EPSG:4326","neu"),new c("urn:ogc:def:crs:EPSG::4326","neu"),new c("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new c("urn:ogc:def:crs:OGC:1.3:CRS84"),new c("urn:ogc:def:crs:OGC:2:84"),new c("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new c("urn:x-ogc:def:crs:EPSG:4326","neu")];
},{"../index.js":80,"../proj/Projection.js":60,"../proj/Units.js":132}],163:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=t,exports.get=r,exports.add=n;let e={};function t(){e={}}function r(t){return e[t]||null}function n(t,r){e[t]=r}
},{}],164:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=o,exports.add=r,exports.remove=n,exports.get=s;var e=require("../obj.js");let t={};function o(){t={}}function r(e,o,r){const n=e.getCode(),s=o.getCode();n in t||(t[n]={}),t[n][s]=r}function n(o,r){const n=o.getCode(),s=r.getCode(),i=t[n][s];return delete t[n][s],(0,e.isEmpty)(t[n])&&delete t[n],i}function s(e,o){let r;return e in t&&o in t[e]&&(r=t[e][o]),r}
},{"../obj.js":82}],58:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.METERS_PER_UNIT=void 0,exports.cloneTransform=E,exports.identityTransform=P,exports.addProjection=g,exports.addProjections=j,exports.get=x,exports.getPointResolution=m,exports.addEquivalentProjections=T,exports.addEquivalentTransforms=S,exports.clearAllProjections=v,exports.createProjection=R,exports.createTransformFromCoordinateTransform=_,exports.addCoordinateTransforms=h,exports.fromLonLat=q,exports.toLonLat=C,exports.equivalent=O,exports.getTransformFromProjections=G,exports.getTransform=U,exports.transform=y,exports.transformExtent=I,exports.transformWithProjections=M,exports.addCommon=N;var t=require("./sphere.js"),e=require("./extent.js"),r=require("./math.js"),o=require("./proj/epsg3857.js"),n=require("./proj/epsg4326.js"),i=require("./proj/Projection.js"),s=p(i),u=require("./proj/Units.js"),f=p(u),c=require("./proj/projections.js"),a=l(c),d=require("./proj/transforms.js");function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function p(t){return t&&t.__esModule?t:{default:t}}function E(t,e,r){let o;if(void 0!==e){for(let r=0,o=t.length;r<o;++r)e[r]=t[r];o=e}else o=t.slice();return o}function P(t,e,r){if(void 0!==e&&t!==e){for(let r=0,o=t.length;r<o;++r)e[r]=t[r];t=e}return t}function g(t){a.add(t.getCode(),t),(0,d.add)(t,t,E)}function j(t){t.forEach(g)}function x(t){let e=null;if(t instanceof s.default)e=t;else if("string"==typeof t){const r=t;e=a.get(r)}return e}function m(e,r,o,n){let i;const s=(e=x(e)).getPointResolutionFunc();if(s)i=s(r,o);else{if(e.getUnits()==f.default.DEGREES&&!n||n==f.default.DEGREES)i=r;else{const s=G(e,x("EPSG:4326"));let f=[o[0]-r/2,o[1],o[0]+r/2,o[1],o[0],o[1]-r/2,o[0],o[1]+r/2];f=s(f,f,2),i=((0,t.getDistance)(f.slice(0,2),f.slice(2,4))+(0,t.getDistance)(f.slice(4,6),f.slice(6,8)))/2;const c=n?u.METERS_PER_UNIT[n]:e.getMetersPerUnit();void 0!==c&&(i/=c)}}return i}function T(t){j(t),t.forEach(function(e){t.forEach(function(t){e!==t&&(0,d.add)(e,t,E)})})}function S(t,e,r,o){t.forEach(function(t){e.forEach(function(e){(0,d.add)(t,e,r),(0,d.add)(e,t,o)})})}function v(){a.clear(),(0,d.clear)()}function R(t,e){return t?"string"==typeof t?x(t):t:x(e)}function _(t){return function(e,r,o){const n=e.length,i=void 0!==o?o:2,s=void 0!==r?r:new Array(n);let u,f,c;for(f=0;f<n;f+=i)for(u=t([e[f],e[f+1]]),s[f]=u[0],s[f+1]=u[1],c=i-1;c>=2;--c)s[f+c]=e[f+c];return s}}function h(t,e,r,o){const n=x(t),i=x(e);(0,d.add)(n,i,_(r)),(0,d.add)(i,n,_(o))}function q(t,e){return y(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function C(t,e){const o=y(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=o[0];return(n<-180||n>180)&&(o[0]=(0,r.modulo)(n+180,360)-180),o}function O(t,e){if(t===e)return!0;const r=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode())return r;return G(t,e)===E&&r}function G(t,e){const r=t.getCode(),o=e.getCode();let n=(0,d.get)(r,o);return n||(n=P),n}function U(t,e){return G(x(t),x(e))}function y(t,e,r){return U(e,r)(t,void 0,t.length)}function I(t,r,o){const n=U(r,o);return(0,e.applyTransform)(t,n)}function M(t,e,r){return G(e,r)(t)}function N(){T(o.PROJECTIONS),T(n.PROJECTIONS),S(n.PROJECTIONS,o.PROJECTIONS,o.fromEPSG4326,o.toEPSG4326)}exports.METERS_PER_UNIT=u.METERS_PER_UNIT,N();
},{"./sphere.js":158,"./extent.js":159,"./math.js":160,"./proj/epsg3857.js":161,"./proj/epsg4326.js":162,"./proj/Projection.js":60,"./proj/Units.js":132,"./proj/projections.js":163,"./proj/transforms.js":164}],237:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.reset=n,exports.multiply=o,exports.set=s,exports.setFromArray=u,exports.apply=c,exports.rotate=i,exports.scale=p,exports.translate=a,exports.compose=f,exports.invert=x,exports.determinant=l;var t=require("./asserts.js");const r=new Array(6);function e(){return[1,0,0,1,0,0]}function n(t){return s(t,1,0,0,1,0,0)}function o(t,r){const e=t[0],n=t[1],o=t[2],s=t[3],u=t[4],c=t[5],i=r[0],p=r[1],a=r[2],f=r[3],x=r[4],l=r[5];return t[0]=e*i+o*p,t[1]=n*i+s*p,t[2]=e*a+o*f,t[3]=n*a+s*f,t[4]=e*x+o*l+u,t[5]=n*x+s*l+c,t}function s(t,r,e,n,o,s,u){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t[4]=s,t[5]=u,t}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function c(t,r){const e=r[0],n=r[1];return r[0]=t[0]*e+t[2]*n+t[4],r[1]=t[1]*e+t[3]*n+t[5],r}function i(t,e){const n=Math.cos(e),u=Math.sin(e);return o(t,s(r,n,u,-u,n,0,0))}function p(t,e,n){return o(t,s(r,e,0,0,n,0,0))}function a(t,e,n){return o(t,s(r,1,0,0,1,e,n))}function f(t,r,e,n,o,s,u,c){const i=Math.sin(s),p=Math.cos(s);return t[0]=n*p,t[1]=o*i,t[2]=-n*i,t[3]=o*p,t[4]=u*n*p-c*n*i+r,t[5]=u*o*i+c*o*p+e,t}function x(r){const e=l(r);(0,t.assert)(0!==e,32);const n=r[0],o=r[1],s=r[2],u=r[3],c=r[4],i=r[5];return r[0]=u/e,r[1]=-o/e,r[2]=-s/e,r[3]=n/e,r[4]=(s*i-u*c)/e,r[5]=-(n*i-o*c)/e,r}function l(t){return t[0]*t[3]-t[1]*t[2]}
},{"./asserts.js":165}],279:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../Object.js"),o=f(e),n=require("../extent.js"),i=require("../functions.js"),r=require("../geom/flat/transform.js"),s=require("../proj.js"),p=require("../proj/Units.js"),u=f(p),c=require("../transform.js");function f(t){return t&&t.__esModule?t:{default:t}}const a=function(){o.default.call(this),this.extent_=(0,n.createEmpty)(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0};(0,t.inherits)(a,o.default);const l=(0,c.create)();a.prototype.clone=function(){},a.prototype.closestPointXY=function(t,e,o,n){},a.prototype.getClosestPoint=function(t,e){const o=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],o,1/0),o},a.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},a.prototype.computeExtent=function(t){},a.prototype.containsXY=i.FALSE,a.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),(0,n.returnOrUpdate)(this.extent_,t)},a.prototype.rotate=function(t,e){},a.prototype.scale=function(t,e,o){},a.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},a.prototype.getSimplifiedGeometry=function(t){},a.prototype.getType=function(){},a.prototype.applyTransform=function(t){},a.prototype.intersectsExtent=function(t){},a.prototype.translate=function(t,e){},a.prototype.transform=function(t,e){const o=(t=(0,s.get)(t)).getUnits()==u.default.TILE_PIXELS?function(o,i,p){const u=t.getExtent(),f=t.getWorldExtent(),a=(0,n.getHeight)(f)/(0,n.getHeight)(u);return(0,c.compose)(l,f[0],f[3],a,-a,0,0,0),(0,r.transform2D)(o,0,o.length,p,l,i),(0,s.getTransform)(t,e)(o,i,p)}:(0,s.getTransform)(t,e);return this.applyTransform(o),this},exports.default=a;
},{"../index.js":80,"../Object.js":196,"../extent.js":159,"../functions.js":195,"../geom/flat/transform.js":311,"../proj.js":58,"../proj/Units.js":132,"../transform.js":237}],227:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStrideForLayout=h,exports.transformGeom2D=p;var t=require("../index.js"),e=require("../functions.js"),i=require("../extent.js"),o=require("../geom/Geometry.js"),r=d(o),n=require("../geom/GeometryLayout.js"),s=d(n),a=require("../geom/flat/transform.js"),l=require("../obj.js");function d(t){return t&&t.__esModule?t:{default:t}}const u=function(){r.default.call(this),this.layout=s.default.XY,this.stride=2,this.flatCoordinates=null};function f(t){let e;return 2==t?e=s.default.XY:3==t?e=s.default.XYZ:4==t&&(e=s.default.XYZM),e}function h(t){let e;return t==s.default.XY?e=2:t==s.default.XYZ||t==s.default.XYM?e=3:t==s.default.XYZM&&(e=4),e}function p(t,e,i){const o=t.getFlatCoordinates();if(o){const r=t.getStride();return(0,a.transform2D)(o,0,o.length,r,e,i)}return null}(0,t.inherits)(u,r.default),u.prototype.containsXY=e.FALSE,u.prototype.computeExtent=function(t){return(0,i.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},u.prototype.getCoordinates=function(){},u.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},u.prototype.getFlatCoordinates=function(){return this.flatCoordinates},u.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},u.prototype.getLayout=function(){return this.layout},u.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&((0,l.clear)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];{const i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},u.prototype.getSimplifiedGeometryInternal=function(t){return this},u.prototype.getStride=function(){return this.stride},u.prototype.setFlatCoordinatesInternal=function(t,e){this.stride=h(t),this.layout=t,this.flatCoordinates=e},u.prototype.setCoordinates=function(t,e){},u.prototype.setLayout=function(t,e,i){let o;if(t)o=h(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout=s.default.XY,void(this.stride=2);e=e[0]}t=f(o=e.length)}this.layout=t,this.stride=o},u.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},u.prototype.rotate=function(t,e){const i=this.getFlatCoordinates();if(i){const o=this.getStride();(0,a.rotate)(i,0,i.length,o,t,e,i),this.changed()}},u.prototype.scale=function(t,e,o){let r=e;void 0===r&&(r=t);let n=o;n||(n=(0,i.getCenter)(this.getExtent()));const s=this.getFlatCoordinates();if(s){const e=this.getStride();(0,a.scale)(s,0,s.length,e,t,r,n,s),this.changed()}},u.prototype.translate=function(t,e){const i=this.getFlatCoordinates();if(i){const o=this.getStride();(0,a.translate)(i,0,i.length,o,t,e,i),this.changed()}},exports.default=u;
},{"../index.js":80,"../functions.js":195,"../extent.js":159,"../geom/Geometry.js":279,"../geom/GeometryLayout.js":277,"../geom/flat/transform.js":311,"../obj.js":82}],289:[function(require,module,exports) {
"use strict";function e(e,t,n,r){let o=0,l=e[n-r],s=e[n-r+1];for(;t<n;t+=r){const n=e[t],r=e[t+1];o+=s*n-l*r,l=n,s=r}return o/2}function t(t,n,r,o){let l=0;for(let s=0,i=r.length;s<i;++s){const i=r[s];l+=e(t,n,i,o),n=i}return l}function n(e,n,r,o){let l=0;for(let s=0,i=r.length;s<i;++s){const i=r[s];l+=t(e,n,i,o),n=i[i.length-1]}return l}Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRing=e,exports.linearRings=t,exports.linearRingss=n;
},{}],282:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.maxSquaredDelta=r,exports.arrayMaxSquaredDelta=n,exports.multiArrayMaxSquaredDelta=s,exports.assignClosestPoint=o,exports.assignClosestArrayPoint=a,exports.assignClosestMultiArrayPoint=l;var t=require("../../math.js");function e(e,r,n,s,o,a,l){const i=e[r],u=e[r+1],f=e[n]-i,c=e[n+1]-u;let h;if(0===f&&0===c)h=r;else{const g=((o-i)*f+(a-u)*c)/(f*f+c*c);if(g>1)h=n;else{if(g>0){for(let o=0;o<s;++o)l[o]=(0,t.lerp)(e[r+o],e[n+o],g);return void(l.length=s)}h=r}}for(let t=0;t<s;++t)l[t]=e[h+t];l.length=s}function r(e,r,n,s,o){let a=e[r],l=e[r+1];for(r+=s;r<n;r+=s){const n=e[r],s=e[r+1],i=(0,t.squaredDistance)(a,l,n,s);i>o&&(o=i),a=n,l=s}return o}function n(t,e,n,s,o){for(let a=0,l=n.length;a<l;++a){const l=n[a];o=r(t,e,l,s,o),e=l}return o}function s(t,e,r,s,o){for(let a=0,l=r.length;a<l;++a){const l=r[a];o=n(t,e,l,s,o),e=l[l.length-1]}return o}function o(r,n,s,o,a,l,i,u,f,c,h){if(n==s)return c;let g,N;if(0===a){if((N=(0,t.squaredDistance)(i,u,r[n],r[n+1]))<c){for(g=0;g<o;++g)f[g]=r[n+g];return f.length=o,N}return c}const x=h||[NaN,NaN];let d=n+o;for(;d<s;)if(e(r,d-o,d,o,i,u,x),(N=(0,t.squaredDistance)(i,u,x[0],x[1]))<c){for(c=N,g=0;g<o;++g)f[g]=x[g];f.length=o,d+=o}else d+=o*Math.max((Math.sqrt(N)-Math.sqrt(c))/a|0,1);if(l&&(e(r,s-o,n,o,i,u,x),(N=(0,t.squaredDistance)(i,u,x[0],x[1]))<c)){for(c=N,g=0;g<o;++g)f[g]=x[g];f.length=o}return c}function a(t,e,r,n,s,a,l,i,u,f,c){const h=c||[NaN,NaN];for(let c=0,g=r.length;c<g;++c){const g=r[c];f=o(t,e,g,n,s,a,l,i,u,f,h),e=g}return f}function l(t,e,r,n,s,o,l,i,u,f,c){const h=c||[NaN,NaN];for(let c=0,g=r.length;c<g;++c){const g=r[c];f=a(t,e,g,n,s,o,l,i,u,f,h),e=g[g.length-1]}return f}
},{"../../math.js":160}],278:[function(require,module,exports) {
"use strict";function t(t,e,n,o){for(let o=0,r=n.length;o<r;++o)t[e++]=n[o];return e}function e(t,e,n,o){for(let r=0,l=n.length;r<l;++r){const l=n[r];for(let n=0;n<o;++n)t[e++]=l[n]}return e}function n(t,n,o,r,l){const s=l||[];let f=0;for(let l=0,u=o.length;l<u;++l){const u=e(t,n,o[l],r);s[f++]=u,n=u}return s.length=f,s}function o(t,e,o,r,l){const s=l||[];let f=0;for(let l=0,u=o.length;l<u;++l){const u=n(t,e,o[l],r,s[f]);s[f++]=u,e=u[u.length-1]}return s.length=f,s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deflateCoordinate=t,exports.deflateCoordinates=e,exports.deflateCoordinatesArray=n,exports.deflateMultiCoordinatesArray=o;
},{}],281:[function(require,module,exports) {
"use strict";function t(t,e,n,o,r){const l=void 0!==r?r:[];let i=0;for(let r=e;r<n;r+=o)l[i++]=t.slice(r,r+o);return l.length=i,l}function e(e,n,o,r,l){const i=void 0!==l?l:[];let s=0;for(let l=0,c=o.length;l<c;++l){const c=o[l];i[s++]=t(e,n,c,r,i[s]),n=c}return i.length=s,i}function n(t,n,o,r,l){const i=void 0!==l?l:[];let s=0;for(let l=0,c=o.length;l<c;++l){const c=o[l];i[s++]=e(t,n,c,r,i[s]),n=c[c.length-1]}return i.length=s,i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateCoordinates=t,exports.inflateCoordinatesArray=e,exports.inflateMultiCoordinatesArray=n;
},{}],287:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.simplifyLineString=e,exports.douglasPeucker=r,exports.douglasPeuckerArray=n,exports.douglasPeuckerMultiArray=o,exports.radialDistance=u,exports.snap=s,exports.quantize=i,exports.quantizeArray=c,exports.quantizeMultiArray=l;var t=require("../../math.js");function e(t,e,n,o,s,i,c){const l=void 0!==c?c:[];return i||(n=u(t,e,n,o,s,l,0),t=l,e=0,o=2),l.length=r(t,e,n,o,s,l,0),l}function r(e,r,n,o,u,s,i){const c=(n-r)/o;if(c<3){for(;r<n;r+=o)s[i++]=e[r],s[i++]=e[r+1];return i}const l=new Array(c);l[0]=1,l[c-1]=1;const f=[r,n-o];let a=0;for(;f.length>0;){const n=f.pop(),s=f.pop();let i=0;const c=e[s],p=e[s+1],h=e[n],g=e[n+1];for(let r=s+o;r<n;r+=o){const n=e[r],o=e[r+1],u=(0,t.squaredSegmentDistance)(n,o,c,p,h,g);u>i&&(a=r,i=u)}i>u&&(l[(a-r)/o]=1,s+o<a&&f.push(s,a),a+o<n&&f.push(a,n))}for(let t=0;t<c;++t)l[t]&&(s[i++]=e[r+t*o],s[i++]=e[r+t*o+1]);return i}function n(t,e,n,o,u,s,i,c){for(let l=0,f=n.length;l<f;++l){const f=n[l];i=r(t,e,f,o,u,s,i),c.push(i),e=f}return i}function o(t,e,r,o,u,s,i,c){for(let l=0,f=r.length;l<f;++l){const f=r[l],a=[];i=n(t,e,f,o,u,s,i,a),c.push(a),e=f[f.length-1]}return i}function u(e,r,n,o,u,s,i){if(n<=r+o){for(;r<n;r+=o)s[i++]=e[r],s[i++]=e[r+1];return i}let c=e[r],l=e[r+1];s[i++]=c,s[i++]=l;let f=c,a=l;for(r+=o;r<n;r+=o)f=e[r],a=e[r+1],(0,t.squaredDistance)(c,l,f,a)>u&&(s[i++]=f,s[i++]=a,c=f,l=a);return f==c&&a==l||(s[i++]=f,s[i++]=a),i}function s(t,e){return e*Math.round(t/e)}function i(t,e,r,n,o,u,i){if(e==r)return i;let c,l,f=s(t[e],o),a=s(t[e+1],o);e+=n,u[i++]=f,u[i++]=a;do{if(c=s(t[e],o),l=s(t[e+1],o),(e+=n)==r)return u[i++]=c,u[i++]=l,i}while(c==f&&l==a);for(;e<r;){const r=s(t[e],o),p=s(t[e+1],o);if(e+=n,r==c&&p==l)continue;const h=c-f,g=l-a,d=r-f,x=p-a;h*x==g*d&&(h<0&&d<h||h==d||h>0&&d>h)&&(g<0&&x<g||g==x||g>0&&x>g)?(c=r,l=p):(u[i++]=c,u[i++]=l,f=c,a=l,c=r,l=p)}return u[i++]=c,u[i++]=l,i}function c(t,e,r,n,o,u,s,c){for(let l=0,f=r.length;l<f;++l){const f=r[l];s=i(t,e,f,n,o,u,s),c.push(s),e=f}return s}function l(t,e,r,n,o,u,s,i){for(let l=0,f=r.length;l<f;++l){const f=r[l],a=[];s=c(t,e,f,n,o,u,s,a),i.push(a),e=f[f.length-1]}return s}
},{"../../math.js":160}],294:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../extent.js"),i=require("../geom/GeometryLayout.js"),s=c(i),o=require("../geom/GeometryType.js"),n=c(o),a=require("../geom/SimpleGeometry.js"),r=c(a),l=require("../geom/flat/area.js"),d=require("../geom/flat/closest.js"),h=require("../geom/flat/deflate.js"),u=require("../geom/flat/inflate.js"),f=require("../geom/flat/simplify.js");function c(t){return t&&t.__esModule?t:{default:t}}const g=function(t,e){r.default.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(g,r.default),g.prototype.clone=function(){const t=new g(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},g.prototype.closestPointXY=function(t,i,s,o){return o<(0,e.closestSquaredDistanceXY)(this.getExtent(),t,i)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,d.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,d.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,s,o))},g.prototype.getArea=function(){return(0,l.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},g.prototype.getCoordinates=function(){return(0,u.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},g.prototype.getSimplifiedGeometryInternal=function(t){const e=[];e.length=(0,f.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);const i=new g(null);return i.setFlatCoordinates(s.default.XY,e),i},g.prototype.getType=function(){return n.default.LINEAR_RING},g.prototype.intersectsExtent=function(t){},g.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,h.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},g.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=g;
},{"../index.js":80,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/SimpleGeometry.js":227,"../geom/flat/area.js":289,"../geom/flat/closest.js":282,"../geom/flat/deflate.js":278,"../geom/flat/inflate.js":281,"../geom/flat/simplify.js":287}],174:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../extent.js"),o=require("../geom/GeometryLayout.js"),r=d(o),s=require("../geom/GeometryType.js"),i=d(s),n=require("../geom/SimpleGeometry.js"),a=d(n),l=require("../geom/flat/deflate.js"),u=require("../math.js");function d(t){return t&&t.__esModule?t:{default:t}}const f=function(t,e){a.default.call(this),this.setCoordinates(t,e)};(0,t.inherits)(f,a.default),f.prototype.clone=function(){const t=new f(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},f.prototype.closestPointXY=function(t,e,o,r){const s=this.flatCoordinates,i=(0,u.squaredDistance)(t,e,s[0],s[1]);if(i<r){const t=this.stride;for(let e=0;e<t;++e)o[e]=s[e];return o.length=t,i}return r},f.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},f.prototype.computeExtent=function(t){return(0,e.createOrUpdateFromCoordinate)(this.flatCoordinates,t)},f.prototype.getType=function(){return i.default.POINT},f.prototype.intersectsExtent=function(t){return(0,e.containsXY)(t,this.flatCoordinates[0],this.flatCoordinates[1])},f.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,l.deflateCoordinate)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(r.default.XY,null)},f.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=f;
},{"../index.js":80,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/SimpleGeometry.js":227,"../geom/flat/deflate.js":278,"../math.js":160}],291:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingContainsExtent=t,exports.linearRingContainsXY=e,exports.linearRingsContainsXY=r,exports.linearRingssContainsXY=i;var n=require("../../extent.js");function t(t,r,i,o,u){return!(0,n.forEachCorner)(u,function(n){return!e(t,r,i,o,n[0],n[1])})}function e(n,t,e,r,i,o){let u=0,s=n[e-r],f=n[e-r+1];for(;t<e;t+=r){const e=n[t],r=n[t+1];f<=o?r>o&&(e-s)*(o-f)-(i-s)*(r-f)>0&&u++:r<=o&&(e-s)*(o-f)-(i-s)*(r-f)<0&&u--,s=e,f=r}return 0!==u}function r(n,t,r,i,o,u){if(0===r.length)return!1;if(!e(n,t,r[0],i,o,u))return!1;for(let t=1,s=r.length;t<s;++t)if(e(n,r[t-1],r[t],i,o,u))return!1;return!0}function i(n,t,e,i,o,u){if(0===e.length)return!1;for(let s=0,f=e.length;s<f;++s){const f=e[s];if(r(n,t,f,i,o,u))return!0;t=f[f.length-1]}return!1}
},{"../../extent.js":159}],292:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getInteriorPointOfArray=r,exports.getInteriorPointsOfMultiArray=n;var t=require("../../array.js"),e=require("../flat/contains.js");function r(r,n,o,s,i,a,l){let u,f,c,g,h,p,y;const N=i[a+1],b=[];for(let t=0,e=o.length;t<e;++t){const e=o[t];for(g=r[e-s],p=r[e-s+1],u=n;u<e;u+=s)h=r[u],y=r[u+1],(N<=p&&y<=N||p<=N&&N<=y)&&(c=(N-p)/(y-p)*(h-g)+g,b.push(c)),g=h,p=y}let j=NaN,x=-1/0;for(b.sort(t.numberSafeCompareFunction),g=b[0],u=1,f=b.length;u<f;++u){h=b[u];const t=Math.abs(h-g);t>x&&(c=(g+h)/2,(0,e.linearRingsContainsXY)(r,n,o,s,c,N)&&(j=c,x=t)),g=h}return isNaN(j)&&(j=i[a]),l?(l.push(j,N,x),l):[j,N,x]}function n(t,e,n,o,s){let i=[];for(let a=0,l=n.length;a<l;++a){const l=n[a];i=r(t,e,l,o,s,2*a,i),e=l[l.length-1]}return i}
},{"../../array.js":209,"../flat/contains.js":291}],286:[function(require,module,exports) {
"use strict";function e(e,r,t,o,c,n){const s=[e[r],e[r+1]],u=[];let f;for(;r+o<t;r+=o){if(u[0]=e[r+o],u[1]=e[r+o+1],f=c.call(n,s,u))return f;s[0]=u[0],s[1]=u[1]}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.forEach=e;
},{}],284:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.intersectsLineString=r,exports.intersectsLineStringArray=i,exports.intersectsLinearRing=s,exports.intersectsLinearRingArray=o,exports.intersectsLinearRingMultiArray=a;var n=require("../../extent.js"),e=require("../flat/contains.js"),t=require("../flat/segments.js");function r(e,r,i,s,o){const a=(0,n.extendFlatCoordinates)((0,n.createEmpty)(),e,r,i,s);return!!(0,n.intersects)(o,a)&&(!!(0,n.containsExtent)(o,a)||(a[0]>=o[0]&&a[2]<=o[2]||(a[1]>=o[1]&&a[3]<=o[3]||(0,t.forEach)(e,r,i,s,function(e,t){return(0,n.intersectsSegment)(o,e,t)}))))}function i(n,e,t,i,s){for(let o=0,a=t.length;o<a;++o){if(r(n,e,t[o],i,s))return!0;e=t[o]}return!1}function s(n,t,i,s,o){return!!r(n,t,i,s,o)||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[0],o[1])||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[0],o[3])||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[2],o[1])||!!(0,e.linearRingContainsXY)(n,t,i,s,o[2],o[3]))))}function o(n,t,r,i,o){if(!s(n,t,r[0],i,o))return!1;if(1===r.length)return!0;for(let t=1,s=r.length;t<s;++t)if((0,e.linearRingContainsExtent)(n,r[t-1],r[t],i,o))return!1;return!0}function a(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const a=t[s];if(o(n,e,a,r,i))return!0;e=a[a.length-1]}return!1}
},{"../../extent.js":159,"../flat/contains.js":291,"../flat/segments.js":286}],337:[function(require,module,exports) {
"use strict";function e(e,o,t,r){for(;o<t-r;){for(let s=0;s<r;++s){const c=e[o+s];e[o+s]=e[t-r+s],e[t-r+s]=c}o+=r,t-=r}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.coordinates=e;
},{}],293:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingIsClockwise=r,exports.linearRingIsOriented=n,exports.linearRingsAreOriented=t,exports.orientLinearRings=i,exports.orientLinearRingsArray=o;var e=require("../flat/reverse.js");function r(e,r,n,t){let i=0,o=e[n-t],s=e[n-t+1];for(;r<n;r+=t){const n=e[r],t=e[r+1];i+=(n-o)*(t+s),o=n,s=t}return i>0}function n(e,n,t,i,o){const s=void 0!==o&&o;for(let o=0,l=t.length;o<l;++o){const l=t[o],u=r(e,n,l,i);if(0===o){if(s&&u||!s&&!u)return!1}else if(s&&!u||!s&&u)return!1;n=l}return!0}function t(e,r,t,i,o){for(let s=0,l=t.length;s<l;++s)if(!n(e,r,t[s],i,o))return!1;return!0}function i(n,t,i,o,s){const l=void 0!==s&&s;for(let s=0,u=i.length;s<u;++s){const u=i[s],f=r(n,t,u,o);(0===s?l&&f||!l&&!f:l&&!f||!l&&f)&&(0,e.coordinates)(n,t,u,o),t=u}return t}function o(e,r,n,t,o){for(let s=0,l=n.length;s<l;++s)r=i(e,r,n[s],t,o);return r}
},{"../flat/reverse.js":337}],175:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.circular=P,exports.fromExtent=I,exports.fromCircle=L,exports.makeRegular=O;var t=require("../index.js"),e=require("../array.js"),i=require("../extent.js"),n=require("../geom/GeometryLayout.js"),s=j(n),o=require("../geom/GeometryType.js"),r=j(o),a=require("../geom/LinearRing.js"),l=j(a),d=require("../geom/Point.js"),h=j(d),u=require("../geom/SimpleGeometry.js"),f=j(u),g=require("../sphere.js"),c=require("../geom/flat/area.js"),p=require("../geom/flat/closest.js"),C=require("../geom/flat/contains.js"),_=require("../geom/flat/deflate.js"),y=require("../geom/flat/inflate.js"),m=require("../geom/flat/interiorpoint.js"),F=require("../geom/flat/intersectsextent.js"),R=require("../geom/flat/orient.js"),q=require("../geom/flat/simplify.js"),x=require("../math.js");function j(t){return t&&t.__esModule?t:{default:t}}const v=function(t,e){f.default.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};function P(t,i,n,o){const r=n||32,a=[];for(let n=0;n<r;++n)(0,e.extend)(a,(0,g.offset)(t,i,2*Math.PI*n/r,o));a.push(a[0],a[1]);const l=new v(null);return l.setFlatCoordinates(s.default.XY,a,[a.length]),l}function I(t){const e=t[0],i=t[1],n=t[2],o=t[3],r=[e,i,e,o,n,o,n,i,e,i],a=new v(null);return a.setFlatCoordinates(s.default.XY,r,[r.length]),a}function L(t,e,i){const n=e||32,s=t.getStride(),o=t.getLayout(),r=new v(null,o),a=s*(n+1),l=new Array(a);for(let t=0;t<a;t++)l[t]=0;const d=[l.length];return r.setFlatCoordinates(o,l,d),O(r,t.getCenter(),t.getRadius(),i),r}function O(t,e,i,n){const s=t.getFlatCoordinates(),o=t.getLayout(),r=t.getStride(),a=t.getEnds(),l=s.length/r-1,d=n||0;for(let t=0;t<=l;++t){const n=t*r,o=d+2*(0,x.modulo)(t,l)*Math.PI/l;s[n]=e[0]+i*Math.cos(o),s[n+1]=e[1]+i*Math.sin(o)}t.setFlatCoordinates(o,s,a)}(0,t.inherits)(v,f.default),v.prototype.appendLinearRing=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},v.prototype.clone=function(){const t=new v(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},v.prototype.closestPointXY=function(t,e,n,s){return s<(0,i.closestSquaredDistanceXY)(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,p.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,p.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))},v.prototype.containsXY=function(t,e){return(0,C.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},v.prototype.getArea=function(){return(0,c.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},v.prototype.getCoordinates=function(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,R.orientLinearRings)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,(0,y.inflateCoordinatesArray)(e,0,this.ends_,this.stride)},v.prototype.getEnds=function(){return this.ends_},v.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=(0,i.getCenter)(this.getExtent());this.flatInteriorPoint_=(0,m.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},v.prototype.getInteriorPoint=function(){return new h.default(this.getFlatInteriorPoint(),s.default.XYM)},v.prototype.getLinearRingCount=function(){return this.ends_.length},v.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t)return null;const e=new l.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},v.prototype.getLinearRings=function(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,r=i.length;o<r;++o){const r=i[o],a=new l.default(null);a.setFlatCoordinates(t,e.slice(s,r)),n.push(a),s=r}return n},v.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,R.linearRingIsOriented)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,R.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},v.prototype.getSimplifiedGeometryInternal=function(t){const e=[],i=[];e.length=(0,q.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i);const n=new v(null);return n.setFlatCoordinates(s.default.XY,e,i),n},v.prototype.getType=function(){return r.default.POLYGON},v.prototype.intersectsExtent=function(t){return(0,F.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},v.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=(0,_.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}else this.setFlatCoordinates(s.default.XY,null,this.ends_)},v.prototype.setFlatCoordinates=function(t,e,i){this.setFlatCoordinatesInternal(t,e),this.ends_=i,this.changed()},exports.default=v;
},{"../index.js":80,"../array.js":209,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/LinearRing.js":294,"../geom/Point.js":174,"../geom/SimpleGeometry.js":227,"../sphere.js":158,"../geom/flat/area.js":289,"../geom/flat/closest.js":282,"../geom/flat/contains.js":291,"../geom/flat/deflate.js":278,"../geom/flat/inflate.js":281,"../geom/flat/interiorpoint.js":292,"../geom/flat/intersectsextent.js":284,"../geom/flat/orient.js":293,"../geom/flat/simplify.js":287,"../math.js":160}],54:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCenterConstraint=j,exports.createResolutionConstraint=O,exports.createRotationConstraint=F,exports.isNoopAnimation=S;var t=require("./tilegrid/common.js"),o=require("./index.js"),e=require("./functions.js"),i=require("./centerconstraint.js"),n=require("./Object.js"),s=N(n),r=require("./resolutionconstraint.js"),a=require("./rotationconstraint.js"),u=require("./ViewHint.js"),c=N(u),l=require("./ViewProperty.js"),h=N(l),p=require("./array.js"),m=require("./asserts.js"),g=require("./coordinate.js"),d=require("./easing.js"),R=require("./extent.js"),f=require("./geom/GeometryType.js"),_=N(f),y=require("./geom/Polygon.js"),M=require("./geom/SimpleGeometry.js"),v=N(M),C=require("./math.js"),x=require("./obj.js"),A=require("./proj.js"),E=require("./proj/Units.js"),T=N(E);function N(t){return t&&t.__esModule?t:{default:t}}const I=0,Z=function(t){s.default.call(this);const o=(0,x.assign)({},t);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=(0,A.createProjection)(o.projection,"EPSG:3857"),this.applyOptions_(o)};function j(t){return void 0!==t.extent?(0,i.createExtent)(t.extent):i.none}function O(o){let e,i,n;let s=void 0!==o.minZoom?o.minZoom:I,a=void 0!==o.maxZoom?o.maxZoom:28;const u=void 0!==o.zoomFactor?o.zoomFactor:2;if(void 0!==o.resolutions){const t=o.resolutions;i=t[s],n=void 0!==t[a]?t[a]:t[t.length-1],e=(0,r.createSnapToResolutions)(t)}else{const c=(0,A.createProjection)(o.projection,"EPSG:3857"),l=c.getExtent(),h=(l?Math.max((0,R.getWidth)(l),(0,R.getHeight)(l)):360*A.METERS_PER_UNIT[T.default.DEGREES]/c.getMetersPerUnit())/t.DEFAULT_TILE_SIZE/Math.pow(2,I),p=h/Math.pow(2,28-I);void 0!==(i=o.maxResolution)?s=0:i=h/Math.pow(u,s),void 0===(n=o.minResolution)&&(n=void 0!==o.maxZoom?void 0!==o.maxResolution?i/Math.pow(u,a):h/Math.pow(u,a):p),a=s+Math.floor(Math.log(i/n)/Math.log(u)),n=i/Math.pow(u,a-s),e=(0,r.createSnapToPower)(u,i,a-s)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:u}}function F(t){if(void 0===t.enableRotation||t.enableRotation){const o=t.constrainRotation;return void 0===o||!0===o?(0,a.createSnapToZero)():!1===o?a.none:"number"==typeof o?(0,a.createSnapToN)(o):a.none}return a.disable}function S(t){return!(t.sourceCenter&&t.targetCenter&&!(0,g.equals)(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}(0,o.inherits)(Z,s.default),Z.prototype.applyOptions_=function(t){const o={};o[h.default.CENTER]=void 0!==t.center?t.center:null;const e=O(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;const i=j(t),n=e.constraint,s=F(t);this.constraints_={center:i,resolution:n,rotation:s},void 0!==t.resolution?o[h.default.RESOLUTION]=t.resolution:void 0!==t.zoom&&(o[h.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(o[h.default.RESOLUTION]=(0,C.clamp)(Number(this.getResolution()||o[h.default.RESOLUTION]),this.minResolution_,this.maxResolution_))),o[h.default.ROTATION]=void 0!==t.rotation?t.rotation:0,this.setProperties(o),this.options_=t},Z.prototype.getUpdatedOptions_=function(t){const o=(0,x.assign)({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenter(),o.rotation=this.getRotation(),(0,x.assign)({},o,t)},Z.prototype.animate=function(t){let o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){const t=arguments[e-1];return t.center&&this.setCenter(t.center),void 0!==t.zoom&&this.setZoom(t.zoom),void 0!==t.rotation&&this.setRotation(t.rotation),void(o&&setTimeout(function(){o(!0)},0))}let i=Date.now(),n=this.getCenter().slice(),s=this.getResolution(),r=this.getRotation();const a=[];for(let t=0;t<e;++t){const e=arguments[t],u={start:i,complete:!1,anchor:e.anchor,duration:void 0!==e.duration?e.duration:1e3,easing:e.easing||d.inAndOut};if(e.center&&(u.sourceCenter=n,u.targetCenter=e.center,n=u.targetCenter),void 0!==e.zoom?(u.sourceResolution=s,u.targetResolution=this.constrainResolution(this.maxResolution_,e.zoom-this.minZoom_,0),s=u.targetResolution):e.resolution&&(u.sourceResolution=s,u.targetResolution=e.resolution,s=u.targetResolution),void 0!==e.rotation){u.sourceRotation=r;const t=(0,C.modulo)(e.rotation-r+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=r+t,r=u.targetRotation}u.callback=o,S(u)?u.complete=!0:i+=u.duration,a.push(u)}this.animations_.push(a),this.setHint(c.default.ANIMATING,1),this.updateAnimations_()},Z.prototype.getAnimating=function(){return this.hints_[c.default.ANIMATING]>0},Z.prototype.getInteracting=function(){return this.hints_[c.default.INTERACTING]>0},Z.prototype.cancelAnimations=function(){this.setHint(c.default.ANIMATING,-this.hints_[c.default.ANIMATING]);for(let t=0,o=this.animations_.length;t<o;++t){const o=this.animations_[t];o[0].callback&&o[0].callback(!1)}this.animations_.length=0},Z.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let o=!1;for(let e=this.animations_.length-1;e>=0;--e){const i=this.animations_[e];let n=!0;for(let e=0,s=i.length;e<s;++e){const s=i[e];if(s.complete)continue;const r=t-s.start;let a=s.duration>0?r/s.duration:1;a>=1?(s.complete=!0,a=1):n=!1;const u=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],o=s.sourceCenter[1],e=t+u*(s.targetCenter[0]-t),i=o+u*(s.targetCenter[1]-o);this.set(h.default.CENTER,[e,i])}if(s.sourceResolution&&s.targetResolution){const t=1===u?s.targetResolution:s.sourceResolution+u*(s.targetResolution-s.sourceResolution);s.anchor&&this.set(h.default.CENTER,this.calculateCenterZoom(t,s.anchor)),this.set(h.default.RESOLUTION,t)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===u?(0,C.modulo)(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+u*(s.targetRotation-s.sourceRotation);s.anchor&&this.set(h.default.CENTER,this.calculateCenterRotate(t,s.anchor)),this.set(h.default.ROTATION,t)}if(o=!0,!s.complete)break}if(n){this.animations_[e]=null,this.setHint(c.default.ANIMATING,-1);const t=i[0].callback;t&&setTimeout(function(){t(!0)},0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))},Z.prototype.calculateCenterRotate=function(t,o){let e;const i=this.getCenter();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],(0,g.rotate)(e,t-this.getRotation()),(0,g.add)(e,o)),e},Z.prototype.calculateCenterZoom=function(t,o){let e;const i=this.getCenter(),n=this.getResolution();if(void 0!==i&&void 0!==n){e=[o[0]-t*(o[0]-i[0])/n,o[1]-t*(o[1]-i[1])/n]}return e},Z.prototype.getSizeFromViewport_=function(){const t=[100,100],e='.ol-viewport[data-view="'+(0,o.getUid)(this)+'"]',i=document.querySelector(e);if(i){const o=getComputedStyle(i);t[0]=parseInt(o.width,10),t[1]=parseInt(o.height,10)}return t},Z.prototype.constrainCenter=function(t){return this.constraints_.center(t)},Z.prototype.constrainResolution=function(t,o,e){const i=o||0,n=e||0;return this.constraints_.resolution(t,i,n)},Z.prototype.constrainRotation=function(t,o){const e=o||0;return this.constraints_.rotation(t,e)},Z.prototype.getCenter=function(){return this.get(h.default.CENTER)},Z.prototype.getConstraints=function(){return this.constraints_},Z.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},Z.prototype.calculateExtent=function(t){const o=t||this.getSizeFromViewport_(),e=this.getCenter();(0,m.assert)(e,1);const i=this.getResolution();(0,m.assert)(void 0!==i,2);const n=this.getRotation();return(0,m.assert)(void 0!==n,3),(0,R.getForViewAndSize)(e,i,n,o)},Z.prototype.getMaxResolution=function(){return this.maxResolution_},Z.prototype.getMinResolution=function(){return this.minResolution_},Z.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},Z.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},Z.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},Z.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},Z.prototype.getProjection=function(){return this.projection_},Z.prototype.getResolution=function(){return this.get(h.default.RESOLUTION)},Z.prototype.getResolutions=function(){return this.resolutions_},Z.prototype.getResolutionForExtent=function(t,o){const e=o||this.getSizeFromViewport_(),i=(0,R.getWidth)(t)/e[0],n=(0,R.getHeight)(t)/e[1];return Math.max(i,n)},Z.prototype.getResolutionForValueFunction=function(t){const o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*n)}},Z.prototype.getRotation=function(){return this.get(h.default.ROTATION)},Z.prototype.getValueForResolutionFunction=function(t){const o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return Math.log(e/t)/Math.log(o)/n}},Z.prototype.getState=function(){const t=this.getCenter(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},Z.prototype.getZoom=function(){let t;const o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},Z.prototype.getZoomForResolution=function(t){let o,e,i=this.minZoom_||0;if(this.resolutions_){const n=(0,p.linearFindNearest)(this.resolutions_,t,1);i=n,o=this.resolutions_[n],e=n==this.resolutions_.length-1?2:o/this.resolutions_[n+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},Z.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},Z.prototype.fit=function(t,o){const i=o||{};let n,s=i.size;s||(s=this.getSizeFromViewport_()),t instanceof v.default?t.getType()===_.default.CIRCLE?(t=t.getExtent(),(n=(0,y.fromExtent)(t)).rotate(this.getRotation(),(0,R.getCenter)(t))):n=t:((0,m.assert)(Array.isArray(t),24),(0,m.assert)(!(0,R.isEmpty)(t),25),n=(0,y.fromExtent)(t));const r=void 0!==i.padding?i.padding:[0,0,0,0],a=void 0===i.constrainResolution||i.constrainResolution,u=void 0!==i.nearest&&i.nearest;let c;c=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.constrainResolution(this.maxResolution_,i.maxZoom-this.minZoom_,0):0;const l=n.getFlatCoordinates(),h=this.getRotation(),p=Math.cos(-h);let g=Math.sin(-h),d=1/0,f=1/0,M=-1/0,C=-1/0;const x=n.getStride();for(let t=0,o=l.length;t<o;t+=x){const o=l[t]*p-l[t+1]*g,e=l[t]*g+l[t+1]*p;d=Math.min(d,o),f=Math.min(f,e),M=Math.max(M,o),C=Math.max(C,e)}let A=this.getResolutionForExtent([d,f,M,C],[s[0]-r[1]-r[3],s[1]-r[0]-r[2]]);if(A=isNaN(A)?c:Math.max(A,c),a){let t=this.constrainResolution(A,0,0);!u&&t<A&&(t=this.constrainResolution(t,-1,0)),A=t}g=-g;let E=(d+M)/2,T=(f+C)/2;const N=[(E+=(r[1]-r[3])/2*A)*p-(T+=(r[0]-r[2])/2*A)*g,T*p+E*g],I=i.callback?i.callback:e.UNDEFINED;void 0!==i.duration?this.animate({resolution:A,center:N,duration:i.duration,easing:i.easing},I):(this.setResolution(A),this.setCenter(N),setTimeout(I.bind(void 0,!0),0))},Z.prototype.centerOn=function(t,o,e){const i=this.getRotation(),n=Math.cos(-i);let s=Math.sin(-i),r=t[0]*n-t[1]*s,a=t[1]*n+t[0]*s;const u=this.getResolution(),c=(r+=(o[0]/2-e[0])*u)*n-(a+=(e[1]-o[1]/2)*u)*(s=-s),l=a*n+r*s;this.setCenter([c,l])},Z.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},Z.prototype.rotate=function(t,o){if(void 0!==o){const e=this.calculateCenterRotate(t,o);this.setCenter(e)}this.setRotation(t)},Z.prototype.setCenter=function(t){this.set(h.default.CENTER,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},Z.prototype.setResolution=function(t){this.set(h.default.RESOLUTION,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setRotation=function(t){this.set(h.default.ROTATION,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},exports.default=Z;
},{"./tilegrid/common.js":225,"./index.js":80,"./functions.js":195,"./centerconstraint.js":219,"./Object.js":196,"./resolutionconstraint.js":220,"./rotationconstraint.js":221,"./ViewHint.js":222,"./ViewProperty.js":223,"./array.js":209,"./asserts.js":165,"./coordinate.js":217,"./easing.js":224,"./extent.js":159,"./geom/GeometryType.js":226,"./geom/Polygon.js":175,"./geom/SimpleGeometry.js":227,"./math.js":160,"./obj.js":82,"./proj.js":58,"./proj/Units.js":132}],192:[function(require,module,exports) {
"use strict";function e(e,t){const o=document.createElement("CANVAS");return e&&(o.width=e),t&&(o.height=t),o.getContext("2d")}function t(e){let t=e.offsetWidth;const o=getComputedStyle(e);return t+=parseInt(o.marginLeft,10)+parseInt(o.marginRight,10)}function o(e){let t=e.offsetHeight;const o=getComputedStyle(e);return t+=parseInt(o.marginTop,10)+parseInt(o.marginBottom,10)}function r(e,t){const o=t.parentNode;o&&o.replaceChild(e,t)}function n(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function i(e){for(;e.lastChild;)e.removeChild(e.lastChild)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCanvasContext2D=e,exports.outerWidth=t,exports.outerHeight=o,exports.replaceNode=r,exports.removeNode=n,exports.removeChildren=i;
},{}],204:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};
},{}],203:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../Object.js"),i=r(e),o=require("../layer/Property.js"),s=r(o),n=require("../math.js"),u=require("../obj.js");function r(t){return t&&t.__esModule?t:{default:t}}const a=function(t){i.default.call(this);const e=(0,u.assign)({},t);e[s.default.OPACITY]=void 0!==t.opacity?t.opacity:1,e[s.default.VISIBLE]=void 0===t.visible||t.visible,e[s.default.Z_INDEX]=void 0!==t.zIndex?t.zIndex:0,e[s.default.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,e[s.default.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,this.setProperties(e),this.state_={layer:this,managed:!0},this.type};(0,t.inherits)(a,i.default),a.prototype.getType=function(){return this.type},a.prototype.getLayerState=function(){return this.state_.opacity=(0,n.clamp)(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},a.prototype.getLayersArray=function(t){},a.prototype.getLayerStatesArray=function(t){},a.prototype.getExtent=function(){return this.get(s.default.EXTENT)},a.prototype.getMaxResolution=function(){return this.get(s.default.MAX_RESOLUTION)},a.prototype.getMinResolution=function(){return this.get(s.default.MIN_RESOLUTION)},a.prototype.getOpacity=function(){return this.get(s.default.OPACITY)},a.prototype.getSourceState=function(){},a.prototype.getVisible=function(){return this.get(s.default.VISIBLE)},a.prototype.getZIndex=function(){return this.get(s.default.Z_INDEX)},a.prototype.setExtent=function(t){this.set(s.default.EXTENT,t)},a.prototype.setMaxResolution=function(t){this.set(s.default.MAX_RESOLUTION,t)},a.prototype.setMinResolution=function(t){this.set(s.default.MIN_RESOLUTION,t)},a.prototype.setOpacity=function(t){this.set(s.default.OPACITY,t)},a.prototype.setVisible=function(t){this.set(s.default.VISIBLE,t)},a.prototype.setZIndex=function(t){this.set(s.default.Z_INDEX,t)},exports.default=a;
},{"../index.js":80,"../Object.js":196,"../layer/Property.js":204,"../math.js":160,"../obj.js":82}],197:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};
},{}],83:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Collection.js"),s=_(t),n=require("../CollectionEventType.js"),i=_(n),r=require("../Object.js"),a=require("../ObjectEventType.js"),o=_(a),l=require("../asserts.js"),h=require("../events.js"),y=require("../events/EventType.js"),u=_(y),c=require("../extent.js"),d=require("../layer/Base.js"),f=_(d),g=require("../obj.js"),L=require("../source/State.js"),p=_(L);function _(e){return e&&e.__esModule?e:{default:e}}const E={LAYERS:"layers"},A=function(e){const t=e||{},n=(0,g.assign)({},t);delete n.layers;let i=t.layers;f.default.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},(0,h.listen)(this,(0,r.getChangeEventType)(E.LAYERS),this.handleLayersChanged_,this),i?Array.isArray(i)?i=new s.default(i.slice(),{unique:!0}):((0,l.assert)(i instanceof s.default,43),i=i):i=new s.default(void 0,{unique:!0}),this.setLayers(i)};(0,e.inherits)(A,f.default),A.prototype.handleLayerChange_=function(){this.changed()},A.prototype.handleLayersChanged_=function(t){this.layersListenerKeys_.forEach(h.unlistenByKey),this.layersListenerKeys_.length=0;const s=this.getLayers();this.layersListenerKeys_.push((0,h.listen)(s,i.default.ADD,this.handleLayersAdd_,this),(0,h.listen)(s,i.default.REMOVE,this.handleLayersRemove_,this));for(const e in this.listenerKeys_)this.listenerKeys_[e].forEach(h.unlistenByKey);(0,g.clear)(this.listenerKeys_);const n=s.getArray();for(let t=0,s=n.length;t<s;t++){const s=n[t];this.listenerKeys_[(0,e.getUid)(s).toString()]=[(0,h.listen)(s,o.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,h.listen)(s,u.default.CHANGE,this.handleLayerChange_,this)]}this.changed()},A.prototype.handleLayersAdd_=function(t){const s=t.element,n=(0,e.getUid)(s).toString();this.listenerKeys_[n]=[(0,h.listen)(s,o.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,h.listen)(s,u.default.CHANGE,this.handleLayerChange_,this)],this.changed()},A.prototype.handleLayersRemove_=function(t){const s=t.element,n=(0,e.getUid)(s).toString();this.listenerKeys_[n].forEach(h.unlistenByKey),delete this.listenerKeys_[n],this.changed()},A.prototype.getLayers=function(){return this.get(E.LAYERS)},A.prototype.setLayers=function(e){this.set(E.LAYERS,e)},A.prototype.getLayersArray=function(e){const t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},A.prototype.getLayerStatesArray=function(e){const t=void 0!==e?e:[],s=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});const n=this.getLayerState();for(let e=s,i=t.length;e<i;e++){const s=t[e];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=(0,c.getIntersection)(s.extent,n.extent):s.extent=n.extent)}return t},A.prototype.getSourceState=function(){return p.default.READY},exports.default=A;
},{"../index.js":80,"../Collection.js":135,"../CollectionEventType.js":228,"../Object.js":196,"../ObjectEventType.js":229,"../asserts.js":165,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../layer/Base.js":203,"../obj.js":82,"../source/State.js":197}],200:[function(require,module,exports) {
"use strict";function r(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]+2*e,t[1]=r[1]+2*e,t}function e(r){return r[0]>0&&r[1]>0}function t(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function o(r,e){return Array.isArray(r)?r:(void 0===e?e=[r,r]:e[0]=e[1]=r,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=r,exports.hasArea=e,exports.scale=t,exports.toSize=o;
},{}],81:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./Collection.js"),i=N(t),n=require("./CollectionEventType.js"),r=N(n),s=require("./MapBrowserEvent.js"),o=N(s),a=require("./MapBrowserEventHandler.js"),l=N(a),h=require("./MapBrowserEventType.js"),d=N(h),u=require("./MapEvent.js"),p=N(u),y=require("./MapEventType.js"),f=N(y),c=require("./MapProperty.js"),v=N(c),_=require("./Object.js"),E=N(_),g=require("./ObjectEventType.js"),m=N(g),T=require("./TileQueue.js"),w=N(T),C=require("./View.js"),R=N(C),S=require("./ViewHint.js"),x=N(S),I=require("./asserts.js"),L=require("./dom.js"),A=require("./events.js"),P=require("./events/Event.js"),O=require("./events/EventType.js"),F=N(O),K=require("./extent.js"),M=require("./functions.js"),D=require("./has.js"),G=require("./layer/Group.js"),q=N(G),H=require("./size.js"),j=require("./structs/PriorityQueue.js"),B=require("./transform.js");function N(e){return e&&e.__esModule?e:{default:e}}const W=function(e){E.default.call(this);const t=b(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:D.DEVICE_PIXEL_RATIO,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=(0,B.create)(),this.pixelToCoordinateTransform_=(0,B.create)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(D.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";const n=[F.default.CLICK,F.default.DBLCLICK,F.default.MOUSEDOWN,F.default.TOUCHSTART,F.default.MSPOINTERDOWN,d.default.POINTERDOWN,F.default.MOUSEWHEEL,F.default.WHEEL];for(let e=0,t=n.length;e<t;++e)(0,A.listen)(this.overlayContainerStopEvent_,n[e],P.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new l.default(this,e.moveTolerance);for(const e in d.default)(0,A.listen)(this.mapBrowserEventHandler_,d.default[e],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=t.keyboardEventTarget,this.keyHandlerKeys_=null,(0,A.listen)(this.viewport_,F.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,A.listen)(this.viewport_,F.default.WHEEL,this.handleBrowserEvent,this),(0,A.listen)(this.viewport_,F.default.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=t.controls||new i.default,this.interactions=t.interactions||new i.default,this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(this.viewport_,this),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new w.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},(0,A.listen)(this,(0,_.getChangeEventType)(v.default.LAYERGROUP),this.handleLayerGroupChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.VIEW),this.handleViewChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.SIZE),this.handleSizeChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.TARGET),this.handleTargetChanged_,this),this.setProperties(t.values),this.controls.forEach(function(e){e.setMap(this)}.bind(this)),(0,A.listen)(this.controls,r.default.ADD,function(e){e.element.setMap(this)},this),(0,A.listen)(this.controls,r.default.REMOVE,function(e){e.element.setMap(null)},this),this.interactions.forEach(function(e){e.setMap(this)}.bind(this)),(0,A.listen)(this.interactions,r.default.ADD,function(e){e.element.setMap(this)},this),(0,A.listen)(this.interactions,r.default.REMOVE,function(e){e.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),(0,A.listen)(this.overlays_,r.default.ADD,function(e){this.addOverlayInternal_(e.element)},this),(0,A.listen)(this.overlays_,r.default.REMOVE,function(e){const t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)},this)};function b(e){let t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);const n={},r=e.layers instanceof q.default?e.layers:new q.default({layers:e.layers});let s,o,a;return n[v.default.LAYERGROUP]=r,n[v.default.TARGET]=e.target,n[v.default.VIEW]=void 0!==e.view?e.view:new R.default,void 0!==e.controls&&(Array.isArray(e.controls)?s=new i.default(e.controls.slice()):((0,I.assert)(e.controls instanceof i.default,47),s=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?o=new i.default(e.interactions.slice()):((0,I.assert)(e.interactions instanceof i.default,48),o=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?a=new i.default(e.overlays.slice()):((0,I.assert)(e.overlays instanceof i.default,49),a=e.overlays):a=new i.default,{controls:s,interactions:o,keyboardEventTarget:t,overlays:a,values:n}}(0,e.inherits)(W,E.default),W.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},W.prototype.addControl=function(e){this.getControls().push(e)},W.prototype.addInteraction=function(e){this.getInteractions().push(e)},W.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},W.prototype.addOverlay=function(e){this.getOverlays().push(e)},W.prototype.addOverlayInternal_=function(e){const t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},W.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),(0,A.unlisten)(this.viewport_,F.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,A.unlisten)(this.viewport_,F.default.WHEEL,this.handleBrowserEvent,this),(0,A.unlisten)(this.viewport_,F.default.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(F.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),E.default.prototype.disposeInternal.call(this)},W.prototype.forEachFeatureAtPixel=function(e,t,i){if(!this.frameState_)return;const n=this.getCoordinateFromPixel(e),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,s=void 0!==i.layerFilter?i.layerFilter:M.TRUE;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,t,null,s,null)},W.prototype.getFeaturesAtPixel=function(e,t){let i=null;return this.forEachFeatureAtPixel(e,function(e){i||(i=[]),i.push(e)},t),i},W.prototype.forEachLayerAtPixel=function(e,t,i,n,r){if(!this.frameState_)return;const s=void 0!==i?i:null,o=void 0!==n?n:M.TRUE,a=void 0!==r?r:null;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,t,s,o,a)},W.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;const i=this.getCoordinateFromPixel(e),n=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:M.TRUE,r=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},W.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},W.prototype.getEventPixel=function(e){const t=this.viewport_.getBoundingClientRect(),i=e.changedTouches?e.changedTouches[0]:e;return[i.clientX-t.left,i.clientY-t.top]},W.prototype.getTarget=function(){return this.get(v.default.TARGET)},W.prototype.getTargetElement=function(){const e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},W.prototype.getCoordinateFromPixel=function(e){const t=this.frameState_;return t?(0,B.apply)(t.pixelToCoordinateTransform,e.slice()):null},W.prototype.getControls=function(){return this.controls},W.prototype.getOverlays=function(){return this.overlays_},W.prototype.getOverlayById=function(e){const t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},W.prototype.getInteractions=function(){return this.interactions},W.prototype.getLayerGroup=function(){return this.get(v.default.LAYERGROUP)},W.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},W.prototype.getPixelFromCoordinate=function(e){const t=this.frameState_;return t?(0,B.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null},W.prototype.getRenderer=function(){return this.renderer_},W.prototype.getSize=function(){return this.get(v.default.SIZE)},W.prototype.getView=function(){return this.get(v.default.VIEW)},W.prototype.getViewport=function(){return this.viewport_},W.prototype.getOverlayContainer=function(){return this.overlayContainer_},W.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},W.prototype.getTilePriority=function(e,t,i,n){const r=this.frameState_;if(!(r&&t in r.wantedTiles))return j.DROP;if(!r.wantedTiles[t][e.getKey()])return j.DROP;const s=i[0]-r.focus[0],o=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(s*s+o*o)/n},W.prototype.handleBrowserEvent=function(e,t){const i=t||e.type,n=new o.default(i,this,e);this.handleMapBrowserEvent(n)},W.prototype.handleMapBrowserEvent=function(e){if(!this.frameState_)return;this.focus_=e.coordinate,e.frameState=this.frameState_;const t=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(let i=t.length-1;i>=0;i--){const n=t[i];if(n.getActive()&&!n.handleEvent(e))break}},W.prototype.handlePostRender=function(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,n=i;if(e){const t=e.viewHints;t[x.default.ANIMATING]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),t[x.default.INTERACTING]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,n))}const i=this.postRenderFunctions_;for(let t=0,n=i.length;t<n;++t)i[t](this,e);i.length=0},W.prototype.handleSizeChanged_=function(){this.render()},W.prototype.handleTargetChanged_=function(){let e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(let e=0,t=this.keyHandlerKeys_.length;e<t;++e)(0,A.unlistenByKey)(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_);const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[(0,A.listen)(t,F.default.KEYDOWN,this.handleBrowserEvent,this),(0,A.listen)(t,F.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(F.default.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),(0,L.removeNode)(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(F.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},W.prototype.handleTileChange_=function(){this.render()},W.prototype.handleViewPropertyChanged_=function(){this.render()},W.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&((0,A.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,A.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.viewport_.setAttribute("data-view",(0,e.getUid)(t)),this.viewPropertyListenerKey_=(0,A.listen)(t,m.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,A.listen)(t,F.default.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},W.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(A.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[(0,A.listen)(e,m.default.PROPERTYCHANGE,this.render,this),(0,A.listen)(e,F.default.CHANGE,this.render,this)]),this.render()},W.prototype.isRendered=function(){return!!this.frameState_},W.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},W.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},W.prototype.removeControl=function(e){return this.getControls().remove(e)},W.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},W.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},W.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},W.prototype.renderFrame_=function(t){let i;const n=this.getSize(),r=this.getView(),s=(0,K.createEmpty)(),o=this.frameState_;let a=null;if(void 0!==n&&(0,H.hasArea)(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),h={};for(let t=0,i=l.length;t<i;++t)h[(0,e.getUid)(l[t].layer)]=l[t];i=r.getState();let d=this.focus_;if(!d){d=i.center;const e=i.resolution/this.pixelRatio_;d[0]=Math.round(d[0]/e)*e,d[1]=Math.round(d[1]/e)*e}a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:s,focus:d,index:this.frameIndex_++,layerStates:h,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:i,viewHints:o,wantedTiles:{}}}if(a&&(a.extent=(0,K.getForViewAndSize)(i.center,i.resolution,i.rotation,a.size,s)),this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),o){(!this.previousExtent_||!(0,K.isEmpty)(this.previousExtent_)&&!(0,K.equals)(a.extent,this.previousExtent_))&&(this.dispatchEvent(new p.default(f.default.MOVESTART,this,o)),this.previousExtent_=(0,K.createOrUpdateEmpty)(this.previousExtent_))}this.previousExtent_&&!a.viewHints[x.default.ANIMATING]&&!a.viewHints[x.default.INTERACTING]&&!(0,K.equals)(a.extent,this.previousExtent_)&&(this.dispatchEvent(new p.default(f.default.MOVEEND,this,a)),(0,K.clone)(a.extent,this.previousExtent_))}this.dispatchEvent(new p.default(f.default.POSTRENDER,this,a)),setTimeout(this.handlePostRender.bind(this),0)},W.prototype.setLayerGroup=function(e){this.set(v.default.LAYERGROUP,e)},W.prototype.setSize=function(e){this.set(v.default.SIZE,e)},W.prototype.setTarget=function(e){this.set(v.default.TARGET,e)},W.prototype.setView=function(e){this.set(v.default.VIEW,e)},W.prototype.skipFeature=function(t){const i=(0,e.getUid)(t).toString();this.skippedFeatureUids_[i]=!0,this.render()},W.prototype.updateSize=function(){const e=this.getTargetElement();if(e){const t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0)},W.prototype.unskipFeature=function(t){const i=(0,e.getUid)(t).toString();delete this.skippedFeatureUids_[i],this.render()},exports.default=W;
},{"./index.js":80,"./Collection.js":135,"./CollectionEventType.js":228,"./MapBrowserEvent.js":251,"./MapBrowserEventHandler.js":252,"./MapBrowserEventType.js":253,"./MapEvent.js":254,"./MapEventType.js":206,"./MapProperty.js":255,"./Object.js":196,"./ObjectEventType.js":229,"./TileQueue.js":247,"./View.js":54,"./ViewHint.js":222,"./asserts.js":165,"./dom.js":192,"./events.js":193,"./events/Event.js":211,"./events/EventType.js":194,"./extent.js":159,"./functions.js":195,"./has.js":256,"./layer/Group.js":83,"./size.js":200,"./structs/PriorityQueue.js":257,"./transform.js":237}],307:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../functions.js"),s=require("../MapEventType.js"),r=a(s),n=require("../Object.js"),i=a(n),l=require("../dom.js"),o=require("../events.js");function a(e){return e&&e.__esModule?e:{default:e}}const u=function(e){i.default.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:t.UNDEFINED,e.target&&this.setTarget(e.target)};(0,e.inherits)(u,i.default),u.prototype.disposeInternal=function(){(0,l.removeNode)(this.element),i.default.prototype.disposeInternal.call(this)},u.prototype.getMap=function(){return this.map_},u.prototype.setMap=function(e){this.map_&&(0,l.removeNode)(this.element);for(let e=0,t=this.listenerKeys.length;e<t;++e)(0,o.unlistenByKey)(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=e,this.map_){(this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==t.UNDEFINED&&this.listenerKeys.push((0,o.listen)(e,r.default.POSTRENDER,this.render,this)),e.render()}},u.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},exports.default=u;
},{"../index.js":80,"../functions.js":195,"../MapEventType.js":206,"../Object.js":196,"../dom.js":192,"../events.js":193}],208:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.CLASS_HIDDEN="ol-hidden",t=exports.CLASS_SELECTABLE="ol-selectable",o=exports.CLASS_UNSELECTABLE="ol-unselectable",l=exports.CLASS_UNSUPPORTED="ol-unsupported",n=exports.CLASS_CONTROL="ol-control",s=exports.CLASS_COLLAPSED="ol-collapsed",r=exports.getFontFamilies=function(){let e;const t={};return function(o){if(e||(e=document.createElement("div").style),!(o in t)){e.font=o;const l=e.fontFamily;if(e.font="",!l)return null;t[o]=l.split(/,\s?/)}return t[o]}}();
},{}],205:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"};
},{}],86:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.visibleAtResolution=f;var e=require("../events.js"),t=require("../events/EventType.js"),s=d(t),r=require("../index.js"),n=require("../Object.js"),o=require("../layer/Base.js"),i=d(o),u=require("../layer/Property.js"),a=d(u),h=require("../obj.js"),l=require("../render/EventType.js"),c=d(l),p=require("../source/State.js"),y=d(p);function d(e){return e&&e.__esModule?e:{default:e}}const g=function(t){const s=(0,h.assign)({},t);delete s.source,i.default.call(this,s),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,t.map&&this.setMap(t.map),(0,e.listen)(this,(0,n.getChangeEventType)(a.default.SOURCE),this.handleSourcePropertyChange_,this);const r=t.source?t.source:null;this.setSource(r)};function f(e,t){return e.visible&&t>=e.minResolution&&t<e.maxResolution}(0,r.inherits)(g,i.default),g.prototype.getLayersArray=function(e){const t=e||[];return t.push(this),t},g.prototype.getLayerStatesArray=function(e){const t=e||[];return t.push(this.getLayerState()),t},g.prototype.getSource=function(){return this.get(a.default.SOURCE)||null},g.prototype.getSourceState=function(){const e=this.getSource();return e?e.getState():y.default.UNDEFINED},g.prototype.handleSourceChange_=function(){this.changed()},g.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&((0,e.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null);const t=this.getSource();t&&(this.sourceChangeKey_=(0,e.listen)(t,s.default.CHANGE,this.handleSourceChange_,this)),this.changed()},g.prototype.setMap=function(t){this.mapPrecomposeKey_&&((0,e.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&((0,e.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=(0,e.listen)(t,c.default.PRECOMPOSE,function(e){const t=this.getLayerState();t.managed=!1,t.zIndex=1/0,e.frameState.layerStatesArray.push(t),e.frameState.layerStates[(0,r.getUid)(this)]=t},this),this.mapRenderKey_=(0,e.listen)(this,s.default.CHANGE,t.render,t),this.changed())},g.prototype.setSource=function(e){this.set(a.default.SOURCE,e)},exports.default=g;
},{"../events.js":193,"../events/EventType.js":194,"../index.js":80,"../Object.js":196,"../layer/Base.js":203,"../layer/Property.js":204,"../obj.js":82,"../render/EventType.js":205,"../source/State.js":197}],186:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=h;var e=require("../index.js"),t=require("../array.js"),l=require("../control/Control.js"),s=p(l),i=require("../css.js"),o=require("../dom.js"),n=require("../events.js"),a=require("../events/EventType.js"),r=p(a),c=require("../layer/Layer.js");function p(e){return e&&e.__esModule?e:{default:e}}const d=function(e){const t=e||{};this.ulElement_=document.createElement("UL"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const l=void 0!==t.className?t.className:"ol-attribution",o=void 0!==t.tipLabel?t.tipLabel:"Attributions",a=void 0!==t.collapseLabel?t.collapseLabel:"»";"string"==typeof a?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a):this.collapseLabel_=a;const c=void 0!==t.label?t.label:"i";"string"==typeof c?(this.label_=document.createElement("span"),this.label_.textContent=c):this.label_=c;const p=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,d=document.createElement("button");d.setAttribute("type","button"),d.title=o,d.appendChild(p),(0,n.listen)(d,r.default.CLICK,this.handleClick_,this);const u=l+" "+i.CLASS_UNSELECTABLE+" "+i.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+i.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),_=document.createElement("div");_.className=u,_.appendChild(this.ulElement_),_.appendChild(d),s.default.call(this,{element:_,render:t.render||h,target:t.target}),this.renderedAttributions_=[],this.renderedVisible_=!0};function h(e){this.updateElement_(e.frameState)}(0,e.inherits)(d,s.default),d.prototype.getSourceAttributions_=function(e){const t={},l=[],s=e.layerStatesArray,i=e.viewState.resolution;for(let o=0,n=s.length;o<n;++o){const n=s[o];if(!(0,c.visibleAtResolution)(n,i))continue;const a=n.layer.getSource();if(!a)continue;const r=a.getAttributions();if(!r)continue;const p=r(e);if(p)if(Array.isArray(p))for(let e=0,s=p.length;e<s;++e)p[e]in t||(l.push(p[e]),t[p[e]]=!0);else p in t||(l.push(p),t[p]=!0)}return l},d.prototype.updateElement_=function(e){if(!e)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const l=this.getSourceAttributions_(e),s=l.length>0;if(this.renderedVisible_!=s&&(this.element.style.display=s?"":"none",this.renderedVisible_=s),!(0,t.equals)(l,this.renderedAttributions_)){(0,o.removeChildren)(this.ulElement_);for(let e=0,t=l.length;e<t;++e){const t=document.createElement("LI");t.innerHTML=l[e],this.ulElement_.appendChild(t)}this.renderedAttributions_=l}},d.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},d.prototype.handleToggle_=function(){this.element.classList.toggle(i.CLASS_COLLAPSED),this.collapsed_?(0,o.replaceNode)(this.collapseLabel_,this.label_):(0,o.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},d.prototype.getCollapsible=function(){return this.collapsible_},d.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},d.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},d.prototype.getCollapsed=function(){return this.collapsed_},exports.default=d;
},{"../index.js":80,"../array.js":209,"../control/Control.js":307,"../css.js":208,"../dom.js":192,"../events.js":193,"../events/EventType.js":194,"../layer/Layer.js":86}],187:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=c;var t=require("../control/Control.js"),e=r(t),s=require("../css.js"),i=require("../easing.js"),a=require("../events.js"),o=require("../events/EventType.js"),l=r(o),n=require("../index.js");function r(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const i=t||{},o=void 0!==i.className?i.className:"ol-rotate",n=void 0!==i.label?i.label:"⇧";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=n):(this.label_=n,this.label_.classList.add("ol-compass"));const r=i.tipLabel?i.tipLabel:"Reset rotation",h=document.createElement("button");h.className=o+"-reset",h.setAttribute("type","button"),h.title=r,h.appendChild(this.label_),(0,a.listen)(h,l.default.CLICK,d.prototype.handleClick_,this);const u=o+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,_=document.createElement("div");_.className=u,_.appendChild(h),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,e.default.call(this,{element:_,render:i.render||c,target:i.target}),this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(s.CLASS_HIDDEN)};function c(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(s.CLASS_HIDDEN);t||0!==i?t&&0!==i&&this.element.classList.remove(s.CLASS_HIDDEN):this.element.classList.add(s.CLASS_HIDDEN)}this.label_.style.msTransform=t,this.label_.style.webkitTransform=t,this.label_.style.transform=t}this.rotation_=i}(0,n.inherits)(d,e.default),d.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},d.prototype.resetNorth_=function(){const t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:i.easeOut}):t.setRotation(0))},exports.default=d;
},{"../control/Control.js":307,"../css.js":208,"../easing.js":224,"../events.js":193,"../events/EventType.js":194,"../index.js":80}],188:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../events.js"),o=require("../events/EventType.js"),n=u(o),i=require("../control/Control.js"),a=u(i),s=require("../css.js"),l=require("../easing.js");function u(e){return e&&e.__esModule?e:{default:e}}const r=function(e){const o=e||{},i=void 0!==o.className?o.className:"ol-zoom",l=void 0!==o.delta?o.delta:1,u=void 0!==o.zoomInLabel?o.zoomInLabel:"+",d=void 0!==o.zoomOutLabel?o.zoomOutLabel:"−",c=void 0!==o.zoomInTipLabel?o.zoomInTipLabel:"Zoom in",m=void 0!==o.zoomOutTipLabel?o.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=i+"-in",p.setAttribute("type","button"),p.title=c,p.appendChild("string"==typeof u?document.createTextNode(u):u),(0,t.listen)(p,n.default.CLICK,r.prototype.handleClick_.bind(this,l));const b=document.createElement("button");b.className=i+"-out",b.setAttribute("type","button"),b.title=m,b.appendChild("string"==typeof d?document.createTextNode(d):d),(0,t.listen)(b,n.default.CLICK,r.prototype.handleClick_.bind(this,-l));const f=i+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,h=document.createElement("div");h.className=f,h.appendChild(p),h.appendChild(b),a.default.call(this,{element:h,target:o.target}),this.duration_=void 0!==o.duration?o.duration:250};(0,e.inherits)(r,a.default),r.prototype.handleClick_=function(e,t){t.preventDefault(),this.zoomByDelta_(e)},r.prototype.zoomByDelta_=function(e){const t=this.getMap().getView();if(!t)return;const o=t.getResolution();if(o){const n=t.constrainResolution(o,e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:n,duration:this.duration_,easing:l.easeOut})):t.setResolution(n)}},exports.default=r;
},{"../index.js":80,"../events.js":193,"../events/EventType.js":194,"../control/Control.js":307,"../css.js":208,"../easing.js":224}],123:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=d;var t=require("../Collection.js"),e=a(t),o=require("./Attribution.js"),r=a(o),u=require("./Rotate.js"),i=a(u),n=require("./Zoom.js"),s=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function d(t){const o=t||{},u=new e.default;return(void 0===o.zoom||o.zoom)&&u.push(new s.default(o.zoomOptions)),(void 0===o.rotate||o.rotate)&&u.push(new i.default(o.rotateOptions)),(void 0===o.attribution||o.attribution)&&u.push(new r.default(o.attributionOptions)),u}
},{"../Collection.js":135,"./Attribution.js":186,"./Rotate.js":187,"./Zoom.js":188}],136:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0};t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;let n=i-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const s=this.points_[i+2]-this.points_[n+2];if(s<1e3/60)return!1;const e=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,e),this.initialVelocity_=Math.sqrt(e*e+o*o)/s,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},exports.default=t;
},{}],266:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ACTIVE:"active"};
},{}],151:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pan=c,exports.rotate=l,exports.rotateWithoutConstraints=f,exports.zoom=p,exports.zoomByDelta=d,exports.zoomWithoutConstraints=g;var t=require("../index.js"),e=require("../Object.js"),n=a(e),o=require("../easing.js"),i=require("../interaction/Property.js"),s=a(i),r=require("../math.js");function a(t){return t&&t.__esModule?t:{default:t}}const u=function(t){n.default.call(this),this.map_=null,this.setActive(!0),this.handleEvent=t.handleEvent};function c(t,e,n){const i=t.getCenter();if(i){const s=t.constrainCenter([i[0]+e[0],i[1]+e[1]]);n?t.animate({duration:n,easing:o.linear,center:s}):t.setCenter(s)}}function l(t,e,n,o){f(t,e=t.constrainRotation(e,0),n,o)}function f(t,e,n,i){if(void 0!==e){const s=t.getRotation(),r=t.getCenter();void 0!==s&&r&&i>0?t.animate({rotation:e,anchor:n,duration:i,easing:o.easeOut}):t.rotate(e,n)}}function p(t,e,n,o,i){g(t,e=t.constrainResolution(e,0,i),n,o)}function d(t,e,n,o){const i=t.getResolution();let s=t.constrainResolution(i,e,0);if(void 0!==s){const e=t.getResolutions();s=(0,r.clamp)(s,t.getMinResolution()||e[e.length-1],t.getMaxResolution()||e[0])}if(n&&void 0!==s&&s!==i){const e=t.getCenter();let o=t.calculateCenterZoom(s,n);o=t.constrainCenter(o),n=[(s*e[0]-i*o[0])/(s-i),(s*e[1]-i*o[1])/(s-i)]}g(t,s,n,o)}function g(t,e,n,i){if(e){const s=t.getResolution(),r=t.getCenter();if(void 0!==s&&r&&e!==s&&i)t.animate({resolution:e,anchor:n,duration:i,easing:o.easeOut});else{if(n){const o=t.calculateCenterZoom(e,n);t.setCenter(o)}t.setResolution(e)}}}(0,t.inherits)(u,n.default),u.prototype.getActive=function(){return this.get(s.default.ACTIVE)},u.prototype.getMap=function(){return this.map_},u.prototype.setActive=function(t){this.set(s.default.ACTIVE,t)},u.prototype.setMap=function(t){this.map_=t},exports.default=u;
},{"../index.js":80,"../Object.js":196,"../easing.js":224,"../interaction/Property.js":266,"../math.js":160}],137:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../MapBrowserEventType.js"),i=a(e),n=require("../interaction/Interaction.js"),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}const o=function(t){const e=t||{};this.delta_=e.delta?e.delta:1,r.default.call(this,{handleEvent:s}),this.duration_=void 0!==e.duration?e.duration:250};function s(t){let e=!1;const r=t.originalEvent;if(t.type==i.default.DBLCLICK){const i=t.map,a=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_,s=i.getView();(0,n.zoomByDelta)(s,o,a,this.duration_),t.preventDefault(),e=!0}return!e}(0,t.inherits)(o,r.default),exports.default=o;
},{"../index.js":80,"../MapBrowserEventType.js":253,"../interaction/Interaction.js":151}],258:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.primaryAction=exports.mouseOnly=exports.targetNotEditable=exports.shiftKeyOnly=exports.platformModifierKeyOnly=exports.noModifierKeys=exports.doubleClick=exports.singleClick=exports.pointerMove=exports.never=exports.mouseActionButton=exports.click=exports.always=exports.focus=exports.altShiftKeysOnly=exports.altKeyOnly=void 0;var e=require("../MapBrowserEventType.js"),t=s(e),r=require("../asserts.js"),n=require("../functions.js"),o=require("../has.js");function s(e){return e&&e.__esModule?e:{default:e}}const i=exports.altKeyOnly=function(e){const t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},l=exports.altShiftKeysOnly=function(e){const t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},u=exports.focus=function(e){return e.target.getTargetElement()===document.activeElement},y=exports.always=n.TRUE,p=exports.click=function(e){return e.type==t.default.CLICK},a=exports.mouseActionButton=function(e){const t=e.originalEvent;return 0==t.button&&!(o.WEBKIT&&o.MAC&&t.ctrlKey)},c=exports.never=n.FALSE,f=exports.pointerMove=function(e){return"pointermove"==e.type},K=exports.singleClick=function(e){return e.type==t.default.SINGLECLICK},x=exports.doubleClick=function(e){return e.type==t.default.DBLCLICK},E=exports.noModifierKeys=function(e){const t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},m=exports.platformModifierKeyOnly=function(e){const t=e.originalEvent;return!t.altKey&&(o.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},v=exports.shiftKeyOnly=function(e){const t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},d=exports.targetNotEditable=function(e){const t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t},g=exports.mouseOnly=function(e){return(0,r.assert)(e.pointerEvent,56),"mouse"==e.pointerEvent.pointerType},C=exports.primaryAction=function(e){const t=e.pointerEvent;return t.isPrimary&&0===t.button};
},{"../MapBrowserEventType.js":253,"../asserts.js":165,"../functions.js":195,"../has.js":256}],153:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.centroid=f,exports.handleEvent=P;var e=require("../index.js"),t=require("../functions.js"),n=require("../MapBrowserEventType.js"),i=l(n),r=require("../MapBrowserPointerEvent.js"),s=l(r),o=require("../interaction/Interaction.js"),a=l(o),d=require("../obj.js");function l(e){return e&&e.__esModule?e:{default:e}}const h=t.UNDEFINED,u=t.FALSE,E=t.FALSE,c=t.UNDEFINED,p=function(e){const t=e||{};a.default.call(this,{handleEvent:t.handleEvent||P}),this.handleDownEvent_=t.handleDownEvent?t.handleDownEvent:E,this.handleDragEvent_=t.handleDragEvent?t.handleDragEvent:h,this.handleMoveEvent_=t.handleMoveEvent?t.handleMoveEvent:c,this.handleUpEvent_=t.handleUpEvent?t.handleUpEvent:u,this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]};function f(e){const t=e.length;let n=0,i=0;for(let r=0;r<t;r++)n+=e[r].clientX,i+=e[r].clientY;return[n/t,i/t]}function v(e){const t=e.type;return t===i.default.POINTERDOWN||t===i.default.POINTERDRAG||t===i.default.POINTERUP}function P(e){if(!(e instanceof s.default))return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==i.default.POINTERDRAG)this.handleDragEvent_(e);else if(e.type==i.default.POINTERUP){const t=this.handleUpEvent_(e);this.handlingDownUpSequence=t&&this.targetPointers.length>0}}else if(e.type==i.default.POINTERDOWN){const n=this.handleDownEvent_(e);this.handlingDownUpSequence=n,t=this.shouldStopEvent(n)}else e.type==i.default.POINTERMOVE&&this.handleMoveEvent_(e);return!t}(0,e.inherits)(p,a.default),p.prototype.updateTrackedPointers_=function(e){if(v(e)){const t=e.pointerEvent,n=t.pointerId.toString();e.type==i.default.POINTERUP?delete this.trackedPointers_[n]:e.type==i.default.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=(0,d.getValues)(this.trackedPointers_)}},p.prototype.shouldStopEvent=function(e){return e},exports.default=p;
},{"../index.js":80,"../functions.js":195,"../MapBrowserEventType.js":253,"../MapBrowserPointerEvent.js":265,"../interaction/Interaction.js":151,"../obj.js":82}],138:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../ViewHint.js"),i=h(e),n=require("../coordinate.js"),s=require("../easing.js"),o=require("../events/condition.js"),r=require("../functions.js"),a=require("../interaction/Pointer.js"),c=h(a);function h(t){return t&&t.__esModule?t:{default:t}}const l=function(t){c.default.call(this,{handleDownEvent:g,handleDragEvent:u,handleUpEvent:d});const e=t||{};this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=e.condition?e.condition:o.noModifierKeys,this.noKinetic_=!1};function u(t){const e=this.targetPointers,i=(0,a.centroid)(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=this.lastCentroid[0]-i[0],s=i[1]-this.lastCentroid[1],o=t.map.getView();let r=[e,s];(0,n.scale)(r,o.getResolution()),(0,n.rotate)(r,o.getRotation()),(0,n.add)(r,o.getCenter()),r=o.constrainCenter(r),o.setCenter(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length}function d(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenter(),r=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([r[0]-t*Math.cos(i),r[1]-t*Math.sin(i)]);n.animate({center:n.constrainCenter(a),duration:500,easing:s.easeOut})}return n.setHint(i.default.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function g(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(i.default.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}(0,t.inherits)(l,c.default),l.prototype.shouldStopEvent=r.FALSE,exports.default=l;
},{"../index.js":80,"../ViewHint.js":222,"../coordinate.js":217,"../easing.js":224,"../events/condition.js":258,"../functions.js":195,"../interaction/Pointer.js":153}],139:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),n=require("../rotationconstraint.js"),e=require("../ViewHint.js"),i=l(e),o=require("../events/condition.js"),r=require("../functions.js"),s=require("../interaction/Interaction.js"),a=require("../interaction/Pointer.js"),u=l(a);function l(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const n=t||{};u.default.call(this,{handleDownEvent:h,handleDragEvent:c,handleUpEvent:f}),this.condition_=n.condition?n.condition:o.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==n.duration?n.duration:250};function c(t){if(!(0,o.mouseOnly)(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===n.disable)return;const r=e.getSize(),a=t.pixel,u=Math.atan2(r[1]/2-a[1],a[0]-r[0]/2);if(void 0!==this.lastAngle_){const t=u-this.lastAngle_,n=i.getRotation();(0,s.rotateWithoutConstraints)(i,n-t)}this.lastAngle_=u}function f(t){if(!(0,o.mouseOnly)(t))return!0;const n=t.map.getView();n.setHint(i.default.INTERACTING,-1);const e=n.getRotation();return(0,s.rotate)(n,e,void 0,this.duration_),!1}function h(t){if(!(0,o.mouseOnly)(t))return!1;if((0,o.mouseActionButton)(t)&&this.condition_(t)){return t.map.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,!0}return!1}(0,t.inherits)(d,u.default),d.prototype.shouldStopEvent=r.FALSE,exports.default=d;
},{"../index.js":80,"../rotationconstraint.js":221,"../ViewHint.js":222,"../events/condition.js":258,"../functions.js":195,"../interaction/Interaction.js":151,"../interaction/Pointer.js":153}],264:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Disposable.js"),i=o(t),s=require("../geom/Polygon.js"),n=o(s);function o(e){return e&&e.__esModule?e:{default:e}}const r=function(e){this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null};(0,e.inherits)(r,i.default),r.prototype.disposeInternal=function(){this.setMap(null)},r.prototype.render_=function(){const e=this.startPixel_,t=this.endPixel_,i=this.element_.style;i.left=Math.min(e[0],t[0])+"px",i.top=Math.min(e[1],t[1])+"px",i.width=Math.abs(t[0]-e[0])+"px",i.height=Math.abs(t[1]-e[1])+"px"},r.prototype.setMap=function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},r.prototype.setPixels=function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()},r.prototype.createOrUpdateGeometry=function(){const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new n.default([i])},r.prototype.getGeometry=function(){return this.geometry_},exports.default=r;
},{"../index.js":80,"../Disposable.js":312,"../geom/Polygon.js":175}],147:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../events/Event.js"),e=l(t),n=require("../index.js"),i=require("../events/condition.js"),o=require("../functions.js"),s=require("../interaction/Pointer.js"),r=l(s),a=require("../render/Box.js"),d=l(a);function l(t){return t&&t.__esModule?t:{default:t}}const u={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},h=function(t,n,i){e.default.call(this,t),this.coordinate=n,this.mapBrowserEvent=i};(0,n.inherits)(h,e.default);const c=function(t){r.default.call(this,{handleDownEvent:E,handleDragEvent:_,handleUpEvent:p});const e=t||{};this.box_=new d.default(e.className||"ol-dragbox"),this.minArea_=void 0!==e.minArea?e.minArea:64,this.startPixel_=null,this.condition_=e.condition?e.condition:i.always,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:x};function x(t,e,n){const i=n[0]-e[0],o=n[1]-e[1];return i*i+o*o>=this.minArea_}function _(t){(0,i.mouseOnly)(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new h(u.BOXDRAG,t.coordinate,t)))}function p(t){return!(0,i.mouseOnly)(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new h(u.BOXEND,t.coordinate,t))),!1)}function E(t){return!!(0,i.mouseOnly)(t)&&(!(!(0,i.mouseActionButton)(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new h(u.BOXSTART,t.coordinate,t)),!0))}(0,n.inherits)(c,r.default),c.prototype.getGeometry=function(){return this.box_.getGeometry()},c.prototype.onBoxEnd=o.UNDEFINED,exports.default=c;
},{"../events/Event.js":211,"../index.js":80,"../events/condition.js":258,"../functions.js":195,"../interaction/Pointer.js":153,"../render/Box.js":264}],140:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../easing.js"),o=require("../events/condition.js"),n=require("../extent.js"),i=require("../interaction/DragBox.js"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}const a=function(t){const e=t||{},n=e.condition?e.condition:o.shiftKeyOnly;this.duration_=void 0!==e.duration?e.duration:200,this.out_=void 0!==e.out&&e.out,r.default.call(this,{condition:n,className:e.className||"ol-dragzoom"})};(0,t.inherits)(a,r.default),a.prototype.onBoxEnd=function(){const t=this.getMap(),o=t.getView(),i=t.getSize();let r=this.getGeometry().getExtent();if(this.out_){const e=o.calculateExtent(i),s=(0,n.createOrUpdateFromCoordinates)([t.getPixelFromCoordinate((0,n.getBottomLeft)(r)),t.getPixelFromCoordinate((0,n.getTopRight)(r))]),a=o.getResolutionForExtent(s,i);(0,n.scaleFromCenter)(e,1/a),r=e}const s=o.constrainResolution(o.getResolutionForExtent(r,i));let a=(0,n.getCenter)(r);a=o.constrainCenter(a),o.animate({resolution:s,center:a,duration:this.duration_,easing:e.easeOut})},exports.default=a;
},{"../index.js":80,"../easing.js":224,"../events/condition.js":258,"../extent.js":159,"../interaction/DragBox.js":147}],259:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LEFT:37,UP:38,RIGHT:39,DOWN:40};
},{}],141:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../coordinate.js"),i=require("../events/EventType.js"),n=l(i),o=require("../events/KeyCode.js"),d=l(o),a=require("../events/condition.js"),r=require("../interaction/Interaction.js"),u=l(r);function l(e){return e&&e.__esModule?e:{default:e}}const s=function(e){u.default.call(this,{handleEvent:f});const t=e||{};this.defaultCondition_=function(e){return(0,a.noModifierKeys)(e)&&(0,a.targetNotEditable)(e)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128};function f(e){let i=!1;if(e.type==n.default.KEYDOWN){const n=e.originalEvent.keyCode;if(this.condition_(e)&&(n==d.default.DOWN||n==d.default.LEFT||n==d.default.RIGHT||n==d.default.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let u=0,l=0;n==d.default.DOWN?l=-a:n==d.default.LEFT?u=-a:n==d.default.RIGHT?u=a:l=a;const s=[u,l];(0,t.rotate)(s,o.getRotation()),(0,r.pan)(o,s,this.duration_),e.preventDefault(),i=!0}}return!i}(0,e.inherits)(s,u.default),exports.default=s;
},{"../index.js":80,"../coordinate.js":217,"../events/EventType.js":194,"../events/KeyCode.js":259,"../events/condition.js":258,"../interaction/Interaction.js":151}],142:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../events/EventType.js"),i=r(e),n=require("../events/condition.js"),o=require("../interaction/Interaction.js"),d=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const a=function(t){d.default.call(this,{handleEvent:s});const e=t||{};this.condition_=e.condition?e.condition:n.targetNotEditable,this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:100};function s(t){let e=!1;if(t.type==i.default.KEYDOWN||t.type==i.default.KEYPRESS){const i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){const n=t.map,d=i=="+".charCodeAt(0)?this.delta_:-this.delta_,r=n.getView();(0,o.zoomByDelta)(r,d,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}(0,t.inherits)(a,d.default),exports.default=a;
},{"../index.js":80,"../events/EventType.js":194,"../events/condition.js":258,"../interaction/Interaction.js":151}],143:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mode=void 0;var t=require("../index.js"),e=require("../ViewHint.js"),i=c(e),o=require("../events/condition.js"),s=require("../easing.js"),n=require("../events/EventType.js"),a=c(n),r=require("../has.js"),h=require("../interaction/Interaction.js"),d=c(h),u=require("../math.js");function c(t){return t&&t.__esModule?t:{default:t}}const l=1,_=exports.Mode={TRACKPAD:"trackpad",WHEEL:"wheel"},m=function(t){d.default.call(this,{handleEvent:p});const e=t||{};this.delta_=0,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=e.constrainResolution||!1,this.condition_=e.condition?e.condition:o.always,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5};function p(t){if(!this.condition_(t))return!0;const e=t.type;if(e!==a.default.WHEEL&&e!==a.default.MOUSEWHEEL)return!0;t.preventDefault();const o=t.map,n=t.originalEvent;let h;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==a.default.WHEEL?(h=n.deltaY,r.FIREFOX&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(h/=r.DEVICE_PIXEL_RATIO),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(h*=40)):t.type==a.default.MOUSEWHEEL&&(h=-n.wheelDeltaY,r.SAFARI&&(h/=3)),0===h)return!1;const d=Date.now();if(void 0===this.startTime_&&(this.startTime_=d),(!this.mode_||d-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(h)<4?_.TRACKPAD:_.WHEEL),this.mode_===_.TRACKPAD){const t=o.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):t.setHint(i.default.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);let e=t.getResolution()*Math.pow(2,h/this.trackpadDeltaPerZoom_);const n=t.getMinResolution(),a=t.getMaxResolution();let r=0;if(e<n?(e=Math.max(e,n/this.trackpadZoomBuffer_),r=1):e>a&&(e=Math.min(e,a*this.trackpadZoomBuffer_),r=-1),this.lastAnchor_){const i=t.calculateCenterZoom(e,this.lastAnchor_);t.setCenter(t.constrainCenter(i))}return t.setResolution(e),0===r&&this.constrainResolution_&&t.animate({resolution:t.constrainResolution(e,h>0?-1:1),easing:s.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),r>0?t.animate({resolution:n,easing:s.easeOut,anchor:this.lastAnchor_,duration:500}):r<0&&t.animate({resolution:a,easing:s.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=d,!1}this.delta_+=h;const u=Math.max(this.timeout_-(d-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),u),!1}(0,t.inherits)(m,d.default),m.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(i.default.INTERACTING,-1)},m.prototype.handleWheelZoom_=function(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();const i=(0,u.clamp)(this.delta_,-1,1);(0,h.zoomByDelta)(e,-i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},m.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},exports.default=m;
},{"../index.js":80,"../ViewHint.js":222,"../events/condition.js":258,"../easing.js":224,"../events/EventType.js":194,"../has.js":256,"../interaction/Interaction.js":151,"../math.js":160}],144:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../ViewHint.js"),e=h(i),n=require("../functions.js"),o=require("../interaction/Interaction.js"),r=require("../interaction/Pointer.js"),s=h(r),a=require("../rotationconstraint.js");function h(t){return t&&t.__esModule?t:{default:t}}const l=function(t){s.default.call(this,{handleDownEvent:d,handleDragEvent:u,handleUpEvent:c});const i=t||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250};function u(t){let i=0;const e=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-e.clientY,n.clientX-e.clientX);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=t}this.lastAngle_=s;const h=t.map,l=h.getView();if(l.getConstraints().rotation===a.disable)return;const u=h.getViewport().getBoundingClientRect(),c=(0,r.centroid)(this.targetPointers);if(c[0]-=u.left,c[1]-=u.top,this.anchor_=h.getCoordinateFromPixel(c),this.rotating_){const t=l.getRotation();h.render(),(0,o.rotateWithoutConstraints)(l,t+i,this.anchor_)}}function c(t){if(this.targetPointers.length<2){const i=t.map.getView();if(i.setHint(e.default.INTERACTING,-1),this.rotating_){const t=i.getRotation();(0,o.rotate)(i,t,this.anchor_,this.duration_)}return!1}return!0}function d(t){if(this.targetPointers.length>=2){const i=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||i.getView().setHint(e.default.INTERACTING,1),!0}return!1}(0,t.inherits)(l,s.default),l.prototype.shouldStopEvent=n.FALSE,exports.default=l;
},{"../index.js":80,"../ViewHint.js":222,"../functions.js":195,"../interaction/Interaction.js":151,"../interaction/Pointer.js":153,"../rotationconstraint.js":221}],145:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../ViewHint.js"),n=r(e),i=require("../functions.js"),s=require("../interaction/Interaction.js"),o=require("../interaction/Pointer.js"),a=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const l=function(t){a.default.call(this,{handleDownEvent:h,handleDragEvent:c,handleUpEvent:u});const e=t||{};this.constrainResolution_=e.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1};function c(t){let e=1;const n=this.targetPointers[0],i=this.targetPointers[1],a=n.clientX-i.clientX,r=n.clientY-i.clientY,l=Math.sqrt(a*a+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/l),this.lastDistance_=l;const c=t.map,u=c.getView(),h=u.getResolution(),d=u.getMaxResolution(),g=u.getMinResolution();let _=h*e;_>d?(e=d/h,_=d):_<g&&(e=g/h,_=g),1!=e&&(this.lastScaleDelta_=e);const f=c.getViewport().getBoundingClientRect(),p=(0,o.centroid)(this.targetPointers);p[0]-=f.left,p[1]-=f.top,this.anchor_=c.getCoordinateFromPixel(p),c.render(),(0,s.zoomWithoutConstraints)(u,_,this.anchor_)}function u(t){if(this.targetPointers.length<2){const e=t.map.getView();e.setHint(n.default.INTERACTING,-1);const i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){const t=this.lastScaleDelta_-1;(0,s.zoom)(e,i,this.anchor_,this.duration_,t)}return!1}return!0}function h(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(n.default.INTERACTING,1),!0}return!1}(0,t.inherits)(l,a.default),l.prototype.shouldStopEvent=i.FALSE,exports.default=l;
},{"../index.js":80,"../ViewHint.js":222,"../functions.js":195,"../interaction/Interaction.js":151,"../interaction/Pointer.js":153}],146:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../functions.js"),s=require("../events.js"),r=require("../events/Event.js"),i=c(r),n=require("../events/EventType.js"),o=c(n),u=require("../interaction/Interaction.js"),a=c(u),l=require("../proj.js");function c(t){return t&&t.__esModule?t:{default:t}}const h={ADD_FEATURES:"addfeatures"},f=function(t,e,s,r){i.default.call(this,t),this.features=s,this.file=e,this.projection=r};(0,t.inherits)(f,i.default);const p=function(t){const s=t||{};a.default.call(this,{handleEvent:e.TRUE}),this.formatConstructors_=s.formatConstructors?s.formatConstructors:[],this.projection_=s.projection?(0,l.get)(s.projection):null,this.dropListenKeys_=null,this.source_=s.source||null,this.target=s.target?s.target:null};function d(t){const e=t.dataTransfer.files;for(let t=0,s=e.length;t<s;++t){const s=e.item(t),r=new FileReader;r.addEventListener(o.default.LOAD,this.handleResult_.bind(this,s)),r.readAsText(s)}}function _(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}(0,t.inherits)(p,a.default),p.prototype.handleResult_=function(t,e){const s=e.target.result,r=this.getMap();let i=this.projection_;if(!i){i=r.getView().getProjection()}const n=this.formatConstructors_;let o=[];for(let t=0,e=n.length;t<e;++t){const e=new(0,n[t]);if((o=this.tryReadFeatures_(e,s,{featureProjection:i}))&&o.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(o)),this.dispatchEvent(new f(h.ADD_FEATURES,t,o,i))},p.prototype.registerListeners_=function(){const t=this.getMap();if(t){const e=this.target?this.target:t.getViewport();this.dropListenKeys_=[(0,s.listen)(e,o.default.DROP,d,this),(0,s.listen)(e,o.default.DRAGENTER,_,this),(0,s.listen)(e,o.default.DRAGOVER,_,this),(0,s.listen)(e,o.default.DROP,_,this)]}},p.prototype.setActive=function(t){a.default.prototype.setActive.call(this,t),t?this.registerListeners_():this.unregisterListeners_()},p.prototype.setMap=function(t){this.unregisterListeners_(),a.default.prototype.setMap.call(this,t),this.getActive()&&this.registerListeners_()},p.prototype.tryReadFeatures_=function(t,e,s){try{return t.readFeatures(e,s)}catch(t){return null}},p.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(s.unlistenByKey),this.dropListenKeys_=null)},exports.default=p;
},{"../index.js":80,"../functions.js":195,"../events.js":193,"../events/Event.js":211,"../events/EventType.js":194,"../interaction/Interaction.js":151,"../proj.js":58}],148:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../rotationconstraint.js"),e=require("../ViewHint.js"),n=r(e),s=require("../events/condition.js"),o=require("../interaction/Interaction.js"),a=require("../interaction/Pointer.js"),l=r(a);function r(t){return t&&t.__esModule?t:{default:t}}const u=function(t){const i=t||{};l.default.call(this,{handleDownEvent:c,handleDragEvent:d,handleUpEvent:h}),this.condition_=i.condition?i.condition:s.shiftKeyOnly,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=void 0!==i.duration?i.duration:400};function d(t){if(!(0,s.mouseOnly)(t))return;const e=t.map,n=e.getSize(),a=t.pixel,l=a[0]-n[0]/2,r=n[1]/2-a[1],u=Math.atan2(r,l),d=Math.sqrt(l*l+r*r),h=e.getView();if(h.getConstraints().rotation!==i.disable&&void 0!==this.lastAngle_){const t=u-this.lastAngle_;(0,o.rotateWithoutConstraints)(h,h.getRotation()-t)}if(this.lastAngle_=u,void 0!==this.lastMagnitude_){const t=this.lastMagnitude_*(h.getResolution()/d);(0,o.zoomWithoutConstraints)(h,t)}void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/d),this.lastMagnitude_=d}function h(t){if(!(0,s.mouseOnly)(t))return!0;const i=t.map.getView();i.setHint(n.default.INTERACTING,-1);const e=this.lastScaleDelta_-1;return(0,o.rotate)(i,i.getRotation()),(0,o.zoom)(i,i.getResolution(),void 0,this.duration_,e),this.lastScaleDelta_=0,!1}function c(t){return!!(0,s.mouseOnly)(t)&&(!!this.condition_(t)&&(t.map.getView().setHint(n.default.INTERACTING,1),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))}(0,t.inherits)(u,l.default),exports.default=u;
},{"../index.js":80,"../rotationconstraint.js":221,"../ViewHint.js":222,"../events/condition.js":258,"../interaction/Interaction.js":151,"../interaction/Pointer.js":153}],231:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromString=void 0,exports.asString=s,exports.asArray=c,exports.normalize=l,exports.toString=a;var e=require("./asserts.js"),t=require("./math.js");const r=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,n=/^([a-z]*)$/i;function s(e){return"string"==typeof e?e:a(e)}function o(e){const t=document.createElement("div");if(t.style.color=e,""!==t.style.color){document.body.appendChild(t);const e=getComputedStyle(t).color;return document.body.removeChild(t),e}return""}const i=exports.fromString=function(){const e={};let t=0;return function(r){let n;if(e.hasOwnProperty(r))n=e[r];else{if(t>=1024){let r=0;for(const n in e)0==(3&r++)&&(delete e[n],--t)}n=u(r),e[r]=n,++t}return n}}();function c(e){return Array.isArray(e)?e:i(e)}function u(t){let s,i,c,u,a;if(n.exec(t)&&(t=o(t)),r.exec(t)){const e=t.length-1;let r;r=e<=4?1:2;const n=4===e||8===e;s=parseInt(t.substr(1+0*r,r),16),i=parseInt(t.substr(1+1*r,r),16),c=parseInt(t.substr(1+2*r,r),16),u=n?parseInt(t.substr(1+3*r,r),16):255,1==r&&(s=(s<<4)+s,i=(i<<4)+i,c=(c<<4)+c,n&&(u=(u<<4)+u)),a=[s,i,c,u/255]}else 0==t.indexOf("rgba(")?l(a=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((a=t.slice(4,-1).split(",").map(Number)).push(1),l(a)):(0,e.assert)(!1,14);return a}function l(e){return e[0]=(0,t.clamp)(e[0]+.5|0,0,255),e[1]=(0,t.clamp)(e[1]+.5|0,0,255),e[2]=(0,t.clamp)(e[2]+.5|0,0,255),e[3]=(0,t.clamp)(e[3],0,1),e}function a(e){let t=e[0];t!=(0|t)&&(t=t+.5|0);let r=e[1];r!=(0|r)&&(r=r+.5|0);let n=e[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+t+","+r+","+n+","+(void 0===e[3]?1:e[3])+")"}
},{"./asserts.js":165,"./math.js":160}],314:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asColorLike=r,exports.isColorLike=t;var e=require("./color.js");function r(r){return t(r)?r:(0,e.toString)(r)}function t(e){return"string"==typeof e||e instanceof CanvasPattern||e instanceof CanvasGradient}
},{"./color.js":231}],191:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3};
},{}],310:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../asserts.js"),s=require("../events/EventTarget.js"),n=i(s),r=require("../events/EventType.js"),o=i(r);function i(e){return e&&e.__esModule?e:{default:e}}const l=function(e){n.default.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null};(0,e.inherits)(l,n.default),l.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},l.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(o.default.CLEAR)},l.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},l.prototype.forEach=function(e,t){let s=this.oldest_;for(;s;)e.call(t,s.value_,s.key_,this),s=s.newer},l.prototype.get=function(e){const s=this.entries_[e];return(0,t.assert)(void 0!==s,15),s===this.newest_?s.value_:(s===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(s.newer.older=s.older,s.older.newer=s.newer),s.newer=null,s.older=this.newest_,this.newest_.newer=s,this.newest_=s,s.value_)},l.prototype.remove=function(e){const s=this.entries_[e];return(0,t.assert)(void 0!==s,15),s===this.newest_?(this.newest_=s.older,this.newest_&&(this.newest_.newer=null)):s===this.oldest_?(this.oldest_=s.newer,this.oldest_&&(this.oldest_.older=null)):(s.newer.older=s.older,s.older.newer=s.newer),delete this.entries_[e],--this.count_,s.value_},l.prototype.getCount=function(){return this.count_},l.prototype.getKeys=function(){const e=new Array(this.count_);let t,s=0;for(t=this.newest_;t;t=t.older)e[s++]=t.key_;return e},l.prototype.getValues=function(){const e=new Array(this.count_);let t,s=0;for(t=this.newest_;t;t=t.older)e[s++]=t.value_;return e},l.prototype.peekLast=function(){return this.oldest_.value_},l.prototype.peekLastKey=function(){return this.oldest_.key_},l.prototype.peekFirstKey=function(){return this.newest_.key_},l.prototype.pop=function(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},l.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},l.prototype.set=function(e,s){(0,t.assert)(!(e in this.entries_),16);const n={key_:e,newer:null,older:this.newest_,value_:s};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},l.prototype.setSize=function(e){this.highWaterMark=e},l.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},exports.default=l;
},{"../index.js":80,"../asserts.js":165,"../events/EventTarget.js":235,"../events/EventType.js":194}],241:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resetTransform=exports.measureTextHeight=exports.checkFont=exports.textHeights=exports.checkedFonts=exports.labelCache=exports.defaultLineWidth=exports.defaultPadding=exports.defaultTextBaseline=exports.defaultTextAlign=exports.defaultStrokeStyle=exports.defaultMiterLimit=exports.defaultLineJoin=exports.defaultLineDashOffset=exports.defaultLineDash=exports.defaultLineCap=exports.defaultFillStyle=exports.defaultFont=void 0,exports.measureTextWidth=w,exports.rotateAtOffset=k,exports.drawImage=M;var e=require("../css.js"),t=require("../dom.js"),o=require("../obj.js"),r=require("../structs/LRUCache.js"),s=a(r),n=require("../transform.js");function a(e){return e&&e.__esModule?e:{default:e}}const l=exports.defaultFont="10px sans-serif",i=exports.defaultFillStyle=[0,0,0,1],u=exports.defaultLineCap="round",f=exports.defaultLineDash=[],d=exports.defaultLineDashOffset=0,p=exports.defaultLineJoin="round",x=exports.defaultMiterLimit=10,c=exports.defaultStrokeStyle=[0,0,0,1],h=exports.defaultTextAlign="center",m=exports.defaultTextBaseline="middle",g=exports.defaultPadding=[0,0,0,0],y=exports.defaultLineWidth=1,T=exports.labelCache=new s.default,L=exports.checkedFonts={};let b=null;const v=exports.textHeights={},C=exports.checkFont=function(){const t=60,r=L,s="32px ",n=["monospace","serif"],a=n.length,l="wmytzilWMYTZIL@#/&?$%10";let i,u;function f(e){const t=F();let o=!0;for(let r=0;r<a;++r){const a=n[r];if(t.font=s+a,u=t.measureText(l).width,e!=a){t.font=s+e+","+a;const r=t.measureText(l).width;o=o&&r!=u}}return o}function d(){let e=!0;for(const s in r)r[s]<t&&(f(s)?(r[s]=t,(0,o.clear)(v),b=null,T.clear()):(++r[s],e=!1));e&&(clearInterval(i),i=void 0)}return function(o){const s=(0,e.getFontFamilies)(o);if(s)for(let e=0,o=s.length;e<o;++e){const o=s[e];o in r||(r[o]=t,f(o)||(r[o]=0,void 0===i&&(i=setInterval(d,32))))}}}();function F(){return b||(b=(0,t.createCanvasContext2D)(1,1)),b}const j=exports.measureTextHeight=function(){let e;const t=v;return function(o){let r=t[o];return void 0==r&&(e||((e=document.createElement("span")).textContent="M",e.style.margin=e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=o,document.body.appendChild(e),r=t[o]=e.offsetHeight,document.body.removeChild(e)),r}}();function w(e,t){const o=F();return e!=o.font&&(o.font=e),o.measureText(t).width}function k(e,t,o,r){0!==t&&(e.translate(o,r),e.rotate(t),e.translate(-o,-r))}const A=exports.resetTransform=(0,n.create)();function M(e,t,o,r,s,n,a,l,i,u,f){let d;1!=o&&(d=e.globalAlpha,e.globalAlpha=d*o),t&&e.setTransform.apply(e,t),e.drawImage(r,s,n,a,l,i,u,a*f,l*f),d&&(e.globalAlpha=d),t&&e.setTransform.apply(e,A)}
},{"../css.js":208,"../dom.js":192,"../obj.js":82,"../structs/LRUCache.js":310,"../transform.js":237}],118:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.snapToPixel_=t.snapToPixel};t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getSnapToPixel=function(){return this.snapToPixel_},t.prototype.getAnchor=function(){},t.prototype.getImage=function(t){},t.prototype.getHitDetectionImage=function(t){},t.prototype.getImageState=function(){},t.prototype.getImageSize=function(){},t.prototype.getHitDetectionImageSize=function(){},t.prototype.getOrigin=function(){},t.prototype.getSize=function(){},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.setSnapToPixel=function(t){this.snapToPixel_=t},t.prototype.listenImageChange=function(t,o){},t.prototype.load=function(){},t.prototype.unlistenImageChange=function(t,o){},exports.default=t;
},{}],119:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../colorlike.js"),e=require("../dom.js"),s=require("../has.js"),n=require("../ImageState.js"),o=l(n),a=require("../render/canvas.js"),h=require("../style/Image.js"),r=l(h);function l(t){return t&&t.__esModule?t:{default:t}}const u=function(t){this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=t.atlasManager,this.render_(this.atlasManager_);const i=void 0===t.snapToPixel||t.snapToPixel,e=void 0!==t.rotateWithView&&t.rotateWithView;r.default.call(this,{opacity:1,rotateWithView:e,rotation:void 0!==t.rotation?t.rotation:0,scale:1,snapToPixel:i})};(0,t.inherits)(u,r.default),u.prototype.clone=function(){const t=new u({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},u.prototype.getAnchor=function(){return this.anchor_},u.prototype.getAngle=function(){return this.angle_},u.prototype.getFill=function(){return this.fill_},u.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},u.prototype.getImage=function(t){return this.canvas_},u.prototype.getImageSize=function(){return this.imageSize_},u.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},u.prototype.getImageState=function(){return o.default.LOADED},u.prototype.getOrigin=function(){return this.origin_},u.prototype.getPoints=function(){return this.points_},u.prototype.getRadius=function(){return this.radius_},u.prototype.getRadius2=function(){return this.radius2_},u.prototype.getSize=function(){return this.size_},u.prototype.getStroke=function(){return this.stroke_},u.prototype.listenImageChange=function(t,i){},u.prototype.load=function(){},u.prototype.unlistenImageChange=function(t,i){},u.prototype.render_=function(t){let n,o,h="",r="",l=0,u=null,_=0,c=0;this.stroke_&&(null===(o=this.stroke_.getColor())&&(o=a.defaultStrokeStyle),o=(0,i.asColorLike)(o),void 0===(c=this.stroke_.getWidth())&&(c=a.defaultLineWidth),u=this.stroke_.getLineDash(),_=this.stroke_.getLineDashOffset(),s.CANVAS_LINE_DASH||(u=null,_=0),void 0===(r=this.stroke_.getLineJoin())&&(r=a.defaultLineJoin),void 0===(h=this.stroke_.getLineCap())&&(h=a.defaultLineCap),void 0===(l=this.stroke_.getMiterLimit())&&(l=a.defaultMiterLimit));let d=2*(this.radius_+c)+1;const g={strokeStyle:o,strokeWidth:c,size:d,lineCap:h,lineDash:u,lineDashOffset:_,lineJoin:r,miterLimit:l};if(void 0===t){const t=(0,e.createCanvasContext2D)(d,d);this.canvas_=t.canvas,n=d=this.canvas_.width,this.draw_(g,t,0,0),this.createHitDetectionCanvas_(g)}else{d=Math.round(d);const i=!this.fill_;let e;i&&(e=this.drawHitDetectionCanvas_.bind(this,g));const s=this.getChecksum(),o=t.add(s,d,d,this.draw_.bind(this,g),e);this.canvas_=o.image,this.origin_=[o.offsetX,o.offsetY],n=o.image.width,i?(this.hitDetectionCanvas_=o.hitImage,this.hitDetectionImageSize_=[o.hitImage.width,o.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[n,n])}this.anchor_=[d/2,d/2],this.size_=[d,d],this.imageSize_=[n,n]},u.prototype.draw_=function(t,e,s,n){let o,h,r;e.setTransform(1,0,0,1,0,0),e.translate(s,n),e.beginPath();let l=this.points_;if(l===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{const i=void 0!==this.radius2_?this.radius2_:this.radius_;for(i!==this.radius_&&(l*=2),o=0;o<=l;o++)h=2*o*Math.PI/l-Math.PI/2+this.angle_,r=o%2==0?this.radius_:i,e.lineTo(t.size/2+r*Math.cos(h),t.size/2+r*Math.sin(h))}if(this.fill_){let t=this.fill_.getColor();null===t&&(t=a.defaultFillStyle),e.fillStyle=(0,i.asColorLike)(t),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},u.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)return void(this.hitDetectionCanvas_=this.canvas_);const i=(0,e.createCanvasContext2D)(t.size,t.size);this.hitDetectionCanvas_=i.canvas,this.drawHitDetectionCanvas_(t,i,0,0)},u.prototype.drawHitDetectionCanvas_=function(t,i,e,s){i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();let n=this.points_;if(n===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{const e=void 0!==this.radius2_?this.radius2_:this.radius_;let s,o,a;for(e!==this.radius_&&(n*=2),s=0;s<=n;s++)a=2*s*Math.PI/n-Math.PI/2+this.angle_,o=s%2==0?this.radius_:e,i.lineTo(t.size/2+o*Math.cos(a),t.size/2+o*Math.sin(a))}i.fillStyle=a.defaultFillStyle,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},u.prototype.getChecksum=function(){const t=this.stroke_?this.stroke_.getChecksum():"-",i=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||i!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){const e="r"+t+i+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[e,t,i,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},exports.default=u;
},{"../index.js":80,"../colorlike.js":314,"../dom.js":192,"../has.js":256,"../ImageState.js":191,"../render/canvas.js":241,"../style/Image.js":118}],114:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../style/RegularShape.js"),s=i(t);function i(e){return e&&e.__esModule?e:{default:e}}const a=function(e){const t=e||{};s.default.call(this,{points:1/0,fill:t.fill,radius:t.radius,snapToPixel:t.snapToPixel,stroke:t.stroke,atlasManager:t.atlasManager})};(0,e.inherits)(a,s.default),a.prototype.clone=function(){const e=new a({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});return e.setOpacity(this.getOpacity()),e.setScale(this.getScale()),e},a.prototype.setRadius=function(e){this.radius_=e,this.render_(this.atlasManager_)},exports.default=a;
},{"../index.js":80,"../style/RegularShape.js":119}],115:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=require("../index.js"),t=require("../color.js");const e=function(o){const t=o||{};this.color_=void 0!==t.color?t.color:null,this.checksum_=void 0};e.prototype.clone=function(){const o=this.getColor();return new e({color:o&&o.slice?o.slice():o||void 0})},e.prototype.getColor=function(){return this.color_},e.prototype.setColor=function(o){this.color_=o,this.checksum_=void 0},e.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=(0,o.getUid)(this.color_).toString():this.checksum_="f"+(this.color_?(0,t.asString)(this.color_):"-")),this.checksum_},exports.default=e;
},{"../index.js":80,"../color.js":231}],120:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js");const i=function(t){const i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width,this.checksum_=void 0};i.prototype.clone=function(){const t=this.getColor();return new i({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},i.prototype.getColor=function(){return this.color_},i.prototype.getLineCap=function(){return this.lineCap_},i.prototype.getLineDash=function(){return this.lineDash_},i.prototype.getLineDashOffset=function(){return this.lineDashOffset_},i.prototype.getLineJoin=function(){return this.lineJoin_},i.prototype.getMiterLimit=function(){return this.miterLimit_},i.prototype.getWidth=function(){return this.width_},i.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},i.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},i.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},i.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},i.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},i.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},i.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},i.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=(0,t.getUid)(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_},exports.default=i;
},{"../index.js":80}],121:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toFunction=c,exports.createDefaultStyle=g,exports.createEditingStyle=y;var t=require("../asserts.js"),e=require("../geom/GeometryType.js"),o=f(e),n=require("../style/Circle.js"),r=f(n),i=require("../style/Fill.js"),l=f(i),u=require("../style/Stroke.js"),s=f(u);function f(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const e=t||{};this.geometry_=null,this.geometryFunction_=h,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};function c(e){let o;if("function"==typeof e)o=e;else{let n;Array.isArray(e)?n=e:((0,t.assert)(e instanceof d,41),n=[e]),o=function(){return n}}return o}d.prototype.clone=function(){let t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new d({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},d.prototype.getRenderer=function(){return this.renderer_},d.prototype.setRenderer=function(t){this.renderer_=t},d.prototype.getGeometry=function(){return this.geometry_},d.prototype.getGeometryFunction=function(){return this.geometryFunction_},d.prototype.getFill=function(){return this.fill_},d.prototype.setFill=function(t){this.fill_=t},d.prototype.getImage=function(){return this.image_},d.prototype.setImage=function(t){this.image_=t},d.prototype.getStroke=function(){return this.stroke_},d.prototype.setStroke=function(t){this.stroke_=t},d.prototype.getText=function(){return this.text_},d.prototype.setText=function(t){this.text_=t},d.prototype.getZIndex=function(){return this.zIndex_},d.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=h,this.geometry_=t},d.prototype.setZIndex=function(t){this.zIndex_=t};let a=null;function g(t,e){if(!a){const t=new l.default({color:"rgba(255,255,255,0.4)"}),e=new s.default({color:"#3399CC",width:1.25});a=[new d({image:new r.default({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return a}function y(){const t={},e=[255,255,255,1],n=[0,153,255,1];return t[o.default.POLYGON]=[new d({fill:new l.default({color:[255,255,255,.5]})})],t[o.default.MULTI_POLYGON]=t[o.default.POLYGON],t[o.default.LINE_STRING]=[new d({stroke:new s.default({color:e,width:5})}),new d({stroke:new s.default({color:n,width:3})})],t[o.default.MULTI_LINE_STRING]=t[o.default.LINE_STRING],t[o.default.CIRCLE]=t[o.default.POLYGON].concat(t[o.default.LINE_STRING]),t[o.default.POINT]=[new d({image:new r.default({radius:6,fill:new l.default({color:n}),stroke:new s.default({color:e,width:1.5})}),zIndex:1/0})],t[o.default.MULTI_POINT]=t[o.default.POINT],t[o.default.GEOMETRY_COLLECTION]=t[o.default.POLYGON].concat(t[o.default.LINE_STRING],t[o.default.POINT]),t}function h(t){return t.getGeometry()}exports.default=d;
},{"../asserts.js":165,"../geom/GeometryType.js":226,"../style/Circle.js":114,"../style/Fill.js":115,"../style/Stroke.js":120}],166:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStyleFunction=m;var e=require("./asserts.js"),t=require("./events.js"),n=require("./events/EventType.js"),s=g(n),o=require("./index.js"),i=require("./Object.js"),r=g(i),h=require("./geom/Geometry.js"),y=g(h),a=require("./style/Style.js"),u=g(a);function g(e){return e&&e.__esModule?e:{default:e}}const l=function(e){if(r.default.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,(0,t.listen)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),void 0!==e)if(e instanceof y.default||!e){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}};function m(t){if("function"==typeof t)return t;{let n;return Array.isArray(t)?n=t:((0,e.assert)(t instanceof u.default,41),n=[t]),function(){return n}}}(0,o.inherits)(l,r.default),l.prototype.clone=function(){const e=new l(this.getProperties());e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e},l.prototype.getGeometry=function(){return this.get(this.geometryName_)},l.prototype.getId=function(){return this.id_},l.prototype.getGeometryName=function(){return this.geometryName_},l.prototype.getStyle=function(){return this.style_},l.prototype.getStyleFunction=function(){return this.styleFunction_},l.prototype.handleGeometryChange_=function(){this.changed()},l.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&((0,t.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=(0,t.listen)(e,s.default.CHANGE,this.handleGeometryChange_,this)),this.changed()},l.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},l.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?m(e):void 0,this.changed()},l.prototype.setId=function(e){this.id_=e,this.changed()},l.prototype.setGeometryName=function(e){(0,t.unlisten)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=e,(0,t.listen)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},exports.default=l;
},{"./asserts.js":165,"./events.js":193,"./events/EventType.js":194,"./index.js":80,"./Object.js":196,"./geom/Geometry.js":279,"./style/Style.js":121}],270:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../extent.js"),s=require("../geom/GeometryLayout.js"),o=u(s),i=require("../geom/GeometryType.js"),r=u(i),n=require("../geom/SimpleGeometry.js"),a=u(n),d=require("../geom/flat/deflate.js");function u(t){return t&&t.__esModule?t:{default:t}}const l=function(t,e,s){a.default.call(this);const o=e||0;this.setCenterAndRadius(t,o,s)};(0,t.inherits)(l,a.default),l.prototype.clone=function(){const t=new l(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},l.prototype.closestPointXY=function(t,e,s,o){const i=this.flatCoordinates,r=t-i[0],n=e-i[1],a=r*r+n*n;if(a<o){if(0===a)for(let t=0;t<this.stride;++t)s[t]=i[t];else{const t=this.getRadius()/Math.sqrt(a);s[0]=i[0]+t*r,s[1]=i[1]+t*n;for(let t=2;t<this.stride;++t)s[t]=i[t]}return s.length=this.stride,a}return o},l.prototype.containsXY=function(t,e){const s=this.flatCoordinates,o=t-s[0],i=e-s[1];return o*o+i*i<=this.getRadiusSquared_()},l.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},l.prototype.computeExtent=function(t){const s=this.flatCoordinates,o=s[this.stride]-s[0];return(0,e.createOrUpdate)(s[0]-o,s[1]-o,s[0]+o,s[1]+o,t)},l.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},l.prototype.getRadiusSquared_=function(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},l.prototype.getType=function(){return r.default.CIRCLE},l.prototype.intersectsExtent=function(t){const s=this.getExtent();if((0,e.intersects)(t,s)){const s=this.getCenter();return t[0]<=s[0]&&t[2]>=s[0]||(t[1]<=s[1]&&t[3]>=s[1]||(0,e.forEachCorner)(t,this.intersectsCoordinate,this))}return!1},l.prototype.setCenter=function(t){const e=this.stride,s=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+s;for(let s=1;s<e;++s)o[e+s]=t[s];this.setFlatCoordinates(this.layout,o)},l.prototype.setCenterAndRadius=function(t,e,s){if(t){this.setLayout(s,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const o=this.flatCoordinates;let i=(0,d.deflateCoordinate)(o,0,t,this.stride);o[i++]=o[0]+e;for(let t=1,e=this.stride;t<e;++t)o[i++]=o[t];o.length=i,this.changed()}else this.setFlatCoordinates(o.default.XY,null)},l.prototype.getCoordinates=function(){},l.prototype.setCoordinates=function(t,e){},l.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},l.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},l.prototype.transform,exports.default=l;
},{"../index.js":80,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/SimpleGeometry.js":227,"../geom/flat/deflate.js":278}],283:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interpolatePoint=r,exports.lineStringCoordinateAtM=n,exports.lineStringsCoordinateAtM=l;var e=require("../../array.js"),t=require("../../math.js");function r(r,n,l,i,s,u){let o=NaN,f=NaN;const c=(l-n)/i;if(1===c)o=r[n],f=r[n+1];else if(2==c)o=(1-s)*r[n]+s*r[n+i],f=(1-s)*r[n+1]+s*r[n+i+1];else if(0!==c){let u=r[n],c=r[n+1],a=0;const p=[0];for(let e=n+i;e<l;e+=i){const t=r[e],n=r[e+1];a+=Math.sqrt((t-u)*(t-u)+(n-c)*(n-c)),p.push(a),u=t,c=n}const h=s*a,g=(0,e.binarySearch)(p,h);if(g<0){const e=(h-p[-g-2])/(p[-g-1]-p[-g-2]),l=n+(-g-2)*i;o=(0,t.lerp)(r[l],r[l+i],e),f=(0,t.lerp)(r[l+1],r[l+i+1],e)}else o=r[n+g*i],f=r[n+g*i+1]}return u?(u[0]=o,u[1]=f,u):[o,f]}function n(e,r,n,l,i,s){if(n==r)return null;let u;if(i<e[r+l-1])return s?((u=e.slice(r,r+l))[l-1]=i,u):null;if(e[n-1]<i)return s?((u=e.slice(n-l,n))[l-1]=i,u):null;if(i==e[r+l-1])return e.slice(r,r+l);let o=r/l,f=n/l;for(;o<f;){const t=o+f>>1;i<e[(t+1)*l-1]?f=t:o=t+1}const c=e[o*l-1];if(i==c)return e.slice((o-1)*l,(o-1)*l+l);const a=(i-c)/(e[(o+1)*l-1]-c);u=[];for(let r=0;r<l-1;++r)u.push((0,t.lerp)(e[(o-1)*l+r],e[o*l+r],a));return u.push(i),u}function l(e,t,r,l,i,s,u){if(u)return n(e,t,r[r.length-1],l,i,s);let o;if(i<e[l-1])return s?((o=e.slice(0,l))[l-1]=i,o):null;if(e[e.length-1]<i)return s?((o=e.slice(e.length-l))[l-1]=i,o):null;for(let s=0,u=r.length;s<u;++s){const u=r[s];if(t!=u){if(i<e[t+l-1])return null;if(i<=e[u-1])return n(e,t,u,l,i,!1);t=u}}return null}
},{"../../array.js":209,"../../math.js":160}],285:[function(require,module,exports) {
"use strict";function t(t,e,n,r){let o=t[e],s=t[e+1],i=0;for(let l=e+r;l<n;l+=r){const e=t[l],n=t[l+1];i+=Math.sqrt((e-o)*(e-o)+(n-s)*(n-s)),o=e,s=n}return i}function e(e,n,r,o){let s=t(e,n,r,o);const i=e[r-o]-e[n],l=e[r-o+1]-e[n+1];return s+=Math.sqrt(i*i+l*l)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineStringLength=t,exports.linearRingLength=e;
},{}],170:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),i=require("../extent.js"),o=require("../geom/GeometryLayout.js"),s=y(o),n=require("../geom/GeometryType.js"),r=y(n),a=require("../geom/SimpleGeometry.js"),l=y(a),h=require("../geom/flat/closest.js"),d=require("../geom/flat/deflate.js"),f=require("../geom/flat/inflate.js"),u=require("../geom/flat/interpolate.js"),g=require("../geom/flat/intersectsextent.js"),p=require("../geom/flat/length.js"),C=require("../geom/flat/segments.js"),c=require("../geom/flat/simplify.js");function y(t){return t&&t.__esModule?t:{default:t}}const m=function(t,e){l.default.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(m,l.default),m.prototype.appendCoordinate=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},m.prototype.clone=function(){const t=new m(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},m.prototype.closestPointXY=function(t,e,o,s){return s<(0,i.closestSquaredDistanceXY)(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,h.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,h.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,o,s))},m.prototype.forEachSegment=function(t){return(0,C.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},m.prototype.getCoordinateAtM=function(t,e){if(this.layout!=s.default.XYM&&this.layout!=s.default.XYZM)return null;const i=void 0!==e&&e;return(0,u.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},m.prototype.getCoordinates=function(){return(0,f.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getCoordinateAt=function(t,e){return(0,u.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},m.prototype.getLength=function(){return(0,p.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},m.prototype.getSimplifiedGeometryInternal=function(t){const e=[];e.length=(0,c.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);const i=new m(null);return i.setFlatCoordinates(s.default.XY,e),i},m.prototype.getType=function(){return r.default.LINE_STRING},m.prototype.intersectsExtent=function(t){return(0,g.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},m.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,d.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},m.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=m;
},{"../index.js":80,"../array.js":209,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/SimpleGeometry.js":227,"../geom/flat/closest.js":282,"../geom/flat/deflate.js":278,"../geom/flat/inflate.js":281,"../geom/flat/interpolate.js":283,"../geom/flat/intersectsextent.js":284,"../geom/flat/length.js":285,"../geom/flat/segments.js":286,"../geom/flat/simplify.js":287}],171:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),s=require("../extent.js"),i=require("../geom/GeometryLayout.js"),n=C(i),o=require("../geom/GeometryType.js"),r=C(o),a=require("../geom/LineString.js"),l=C(a),d=require("../geom/SimpleGeometry.js"),h=C(d),u=require("../geom/flat/closest.js"),f=require("../geom/flat/deflate.js"),c=require("../geom/flat/inflate.js"),g=require("../geom/flat/interpolate.js"),p=require("../geom/flat/intersectsextent.js"),y=require("../geom/flat/simplify.js");function C(t){return t&&t.__esModule?t:{default:t}}const _=function(t,e){h.default.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(_,h.default),_.prototype.appendLineString=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},_.prototype.clone=function(){const t=new _(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},_.prototype.closestPointXY=function(t,e,i,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,u.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,u.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},_.prototype.getCoordinateAtM=function(t,e,s){if(this.layout!=n.default.XYM&&this.layout!=n.default.XYZM||0===this.flatCoordinates.length)return null;const i=void 0!==e&&e,o=void 0!==s&&s;return(0,g.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,t,i,o)},_.prototype.getCoordinates=function(){return(0,c.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)},_.prototype.getEnds=function(){return this.ends_},_.prototype.getLineString=function(t){if(t<0||this.ends_.length<=t)return null;const e=new l.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},_.prototype.getLineStrings=function(){const t=this.flatCoordinates,e=this.ends_,s=this.layout,i=[];let n=0;for(let o=0,r=e.length;o<r;++o){const r=e[o],a=new l.default(null);a.setFlatCoordinates(s,t.slice(n,r)),i.push(a),n=r}return i},_.prototype.getFlatMidpoints=function(){const t=[],s=this.flatCoordinates;let i=0;const n=this.ends_,o=this.stride;for(let r=0,a=n.length;r<a;++r){const a=n[r],l=(0,g.interpolatePoint)(s,i,a,o,.5);(0,e.extend)(t,l),i=a}return t},_.prototype.getSimplifiedGeometryInternal=function(t){const e=[],s=[];e.length=(0,y.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,s);const i=new _(null);return i.setFlatCoordinates(n.default.XY,e,s),i},_.prototype.getType=function(){return r.default.MULTI_LINE_STRING},_.prototype.intersectsExtent=function(t){return(0,p.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,t)},_.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const s=(0,f.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===s.length?0:s[s.length-1],this.changed()}else this.setFlatCoordinates(n.default.XY,null,this.ends_)},_.prototype.setFlatCoordinates=function(t,e,s){this.setFlatCoordinatesInternal(t,e),this.ends_=s,this.changed()},_.prototype.setLineStrings=function(t){let s=this.getLayout();const i=[],n=[];for(let o=0,r=t.length;o<r;++o){const r=t[o];0===o&&(s=r.getLayout()),(0,e.extend)(i,r.getFlatCoordinates()),n.push(i.length)}this.setFlatCoordinates(s,i,n)},exports.default=_;
},{"../index.js":80,"../array.js":209,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/LineString.js":170,"../geom/SimpleGeometry.js":227,"../geom/flat/closest.js":282,"../geom/flat/deflate.js":278,"../geom/flat/inflate.js":281,"../geom/flat/interpolate.js":283,"../geom/flat/intersectsextent.js":284,"../geom/flat/simplify.js":287}],172:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),o=require("../extent.js"),s=require("../geom/GeometryLayout.js"),i=p(s),n=require("../geom/GeometryType.js"),r=p(n),a=require("../geom/Point.js"),l=p(a),d=require("../geom/SimpleGeometry.js"),u=p(d),f=require("../geom/flat/deflate.js"),h=require("../geom/flat/inflate.js"),c=require("../math.js");function p(t){return t&&t.__esModule?t:{default:t}}const C=function(t,e){u.default.call(this),this.setCoordinates(t,e)};(0,t.inherits)(C,u.default),C.prototype.appendPoint=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},C.prototype.clone=function(){const t=new C(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},C.prototype.closestPointXY=function(t,e,s,i){if(i<(0,o.closestSquaredDistanceXY)(this.getExtent(),t,e))return i;const n=this.flatCoordinates,r=this.stride;for(let o=0,a=n.length;o<a;o+=r){const a=(0,c.squaredDistance)(t,e,n[o],n[o+1]);if(a<i){i=a;for(let t=0;t<r;++t)s[t]=n[o+t];s.length=r}}return i},C.prototype.getCoordinates=function(){return(0,h.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},C.prototype.getPoint=function(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;if(t<0||e<=t)return null;const o=new l.default(null);return o.setFlatCoordinates(this.layout,this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride)),o},C.prototype.getPoints=function(){const t=this.flatCoordinates,e=this.layout,o=this.stride,s=[];for(let i=0,n=t.length;i<n;i+=o){const n=new l.default(null);n.setFlatCoordinates(e,t.slice(i,i+o)),s.push(n)}return s},C.prototype.getType=function(){return r.default.MULTI_POINT},C.prototype.intersectsExtent=function(t){const e=this.flatCoordinates,s=this.stride;for(let i=0,n=e.length;i<n;i+=s){const s=e[i],n=e[i+1];if((0,o.containsXY)(t,s,n))return!0}return!1},C.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,f.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(i.default.XY,null)},C.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=C;
},{"../index.js":80,"../array.js":209,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/Point.js":174,"../geom/SimpleGeometry.js":227,"../geom/flat/deflate.js":278,"../geom/flat/inflate.js":281,"../math.js":160}],290:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingss=t;var e=require("../../extent.js");function t(t,r,n,s){const o=[];let a=(0,e.createEmpty)();for(let l=0,c=n.length;l<c;++l){const c=n[l];a=(0,e.createOrUpdateFromFlatCoordinates)(t,r,c[0],s),o.push((a[0]+a[2])/2,(a[1]+a[3])/2),r=c[c.length-1]}return o}
},{"../../extent.js":159}],173:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../array.js"),s=require("../extent.js"),i=require("../geom/GeometryLayout.js"),n=P(i),o=require("../geom/GeometryType.js"),r=P(o),a=require("../geom/MultiPoint.js"),l=P(a),h=require("../geom/Polygon.js"),d=P(h),u=require("../geom/SimpleGeometry.js"),f=P(u),g=require("../geom/flat/area.js"),c=require("../geom/flat/center.js"),p=require("../geom/flat/closest.js"),_=require("../geom/flat/contains.js"),y=require("../geom/flat/deflate.js"),C=require("../geom/flat/inflate.js"),m=require("../geom/flat/interiorpoint.js"),F=require("../geom/flat/intersectsextent.js"),q=require("../geom/flat/orient.js"),R=require("../geom/flat/simplify.js");function P(t){return t&&t.__esModule?t:{default:t}}const j=function(t,e){f.default.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};(0,t.inherits)(j,f.default),j.prototype.appendPolygon=function(t){let s;if(this.flatCoordinates){const i=this.flatCoordinates.length;(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates());for(let e=0,n=(s=t.getEnds().slice()).length;e<n;++e)s[e]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),s=t.getEnds().slice(),this.endss_.push();this.endss_.push(s),this.changed()},j.prototype.clone=function(){const t=new j(null),e=this.endss_.length,s=new Array(e);for(let t=0;t<e;++t)s[t]=this.endss_[t].slice();return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),s),t},j.prototype.closestPointXY=function(t,e,i,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,p.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,p.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},j.prototype.containsXY=function(t,e){return(0,_.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},j.prototype.getArea=function(){return(0,g.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},j.prototype.getCoordinates=function(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,q.orientLinearRingsArray)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,C.inflateMultiCoordinatesArray)(e,0,this.endss_,this.stride)},j.prototype.getEndss=function(){return this.endss_},j.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=(0,c.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,m.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},j.prototype.getInteriorPoints=function(){const t=new l.default(null);return t.setFlatCoordinates(n.default.XYM,this.getFlatInteriorPoints().slice()),t},j.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,q.linearRingsAreOriented)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,q.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},j.prototype.getSimplifiedGeometryInternal=function(t){const e=[],s=[];e.length=(0,R.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,s);const i=new j(null);return i.setFlatCoordinates(n.default.XY,e,s),i},j.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const s=this.endss_[t].slice(),i=s[s.length-1];if(0!==e)for(let t=0,i=s.length;t<i;++t)s[t]-=e;const n=new d.default(null);return n.setFlatCoordinates(this.layout,this.flatCoordinates.slice(e,i),s),n},j.prototype.getPolygons=function(){const t=this.layout,e=this.flatCoordinates,s=this.endss_,i=[];let n=0;for(let o=0,r=s.length;o<r;++o){const r=s[o].slice(),a=r[r.length-1];if(0!==n)for(let t=0,e=r.length;t<e;++t)r[t]-=n;const l=new d.default(null);l.setFlatCoordinates(t,e.slice(n,a),r),i.push(l),n=a}return i},j.prototype.getType=function(){return r.default.MULTI_POLYGON},j.prototype.intersectsExtent=function(t){return(0,F.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},j.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const s=(0,y.deflateMultiCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===s.length)this.flatCoordinates.length=0;else{const t=s[s.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}else this.setFlatCoordinates(n.default.XY,null,this.endss_)},j.prototype.setFlatCoordinates=function(t,e,s){this.setFlatCoordinatesInternal(t,e),this.endss_=s,this.changed()},j.prototype.setPolygons=function(t){let s=this.getLayout();const i=[],n=[];for(let o=0,r=t.length;o<r;++o){const r=t[o];0===o&&(s=r.getLayout());const a=i.length,l=r.getEnds();for(let t=0,e=l.length;t<e;++t)l[t]+=a;(0,e.extend)(i,r.getFlatCoordinates()),n.push(l)}this.setFlatCoordinates(s,i,n)},exports.default=j;
},{"../index.js":80,"../array.js":209,"../extent.js":159,"../geom/GeometryLayout.js":277,"../geom/GeometryType.js":226,"../geom/MultiPoint.js":172,"../geom/Polygon.js":175,"../geom/SimpleGeometry.js":227,"../geom/flat/area.js":289,"../geom/flat/center.js":290,"../geom/flat/closest.js":282,"../geom/flat/contains.js":291,"../geom/flat/deflate.js":278,"../geom/flat/inflate.js":281,"../geom/flat/interiorpoint.js":292,"../geom/flat/intersectsextent.js":284,"../geom/flat/orient.js":293,"../geom/flat/simplify.js":287}],130:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};
},{}],202:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"image",VECTOR:"vector"};
},{}],87:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderType=void 0;var e=require("../index.js"),t=require("../LayerType.js"),r=l(t),n=require("../layer/Layer.js"),i=l(n),u=require("../layer/VectorRenderType.js"),o=l(u),d=require("../obj.js"),s=require("../style/Style.js");function l(e){return e&&e.__esModule?e:{default:e}}const p=exports.RenderType={IMAGE:"image",VECTOR:"vector"},a={RENDER_ORDER:"renderOrder"},c=function(e){const t=e||{},n=(0,d.assign)({},t);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,i.default.call(this,n),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting,this.renderMode_=t.renderMode||o.default.VECTOR,this.type=r.default.VECTOR};(0,e.inherits)(c,i.default),c.prototype.getDeclutter=function(){return this.declutter_},c.prototype.setDeclutter=function(e){this.declutter_=e},c.prototype.getRenderBuffer=function(){return this.renderBuffer_},c.prototype.getRenderOrder=function(){return this.get(a.RENDER_ORDER)},c.prototype.getSource,c.prototype.getStyle=function(){return this.style_},c.prototype.getStyleFunction=function(){return this.styleFunction_},c.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},c.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},c.prototype.setRenderOrder=function(e){this.set(a.RENDER_ORDER,e)},c.prototype.setStyle=function(e){this.style_=void 0!==e?e:s.createDefaultStyle,this.styleFunction_=null===e?void 0:(0,s.toFunction)(this.style_),this.changed()},c.prototype.getRenderMode=function(){return this.renderMode_},exports.default=c;
},{"../index.js":80,"../LayerType.js":130,"../layer/Layer.js":86,"../layer/VectorRenderType.js":202,"../obj.js":82,"../style/Style.js":121}],280:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};
},{}],325:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFeaturesXhr=n,exports.xhr=o;var e=require("./functions.js"),t=require("./format/FormatType.js"),r=s(t);function s(e){return e&&e.__esModule?e:{default:e}}function n(e,t,s,n){return function(o,a,u){const i=new XMLHttpRequest;i.open("GET","function"==typeof e?e(o,a,u):e,!0),t.getType()==r.default.ARRAY_BUFFER&&(i.responseType="arraybuffer"),i.onload=function(e){if(!i.status||i.status>=200&&i.status<300){const e=t.getType();let o;e==r.default.JSON||e==r.default.TEXT?o=i.responseText:e==r.default.XML?(o=i.responseXML)||(o=(new DOMParser).parseFromString(i.responseText,"application/xml")):e==r.default.ARRAY_BUFFER&&(o=i.response),o?s.call(this,t.readFeatures(o,{featureProjection:u}),t.readProjection(o),t.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),i.onerror=function(){n.call(this)}.bind(this),i.send()}}function o(t,r){return n(t,r,function(e,t){this.addFeatures(e)},e.UNDEFINED)}
},{"./functions.js":195,"./format/FormatType.js":280}],326:[function(require,module,exports) {
"use strict";function e(e,t){return[[-1/0,-1/0,1/0,1/0]]}function t(e,t){return[e]}function n(e){return function(t,n){const o=e.getZForResolution(n),r=e.getTileRangeForExtentAndZ(t,o),u=[],i=[o,0,0];for(i[1]=r.minX;i[1]<=r.maxX;++i[1])for(i[2]=r.minY;i[2]<=r.maxY;++i[2])u.push(e.getTileCoordExtent(i));return u}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=e,exports.bbox=t,exports.tile=n;
},{}],99:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../functions.js"),r=require("../Object.js"),i=u(r),o=require("../proj.js"),n=require("../source/State.js"),s=u(n);function u(t){return t&&t.__esModule?t:{default:t}}const a=function(t){i.default.call(this),this.projection_=(0,o.get)(t.projection),this.attributions_=this.adaptAttributions_(t.attributions),this.state_=void 0!==t.state?t.state:s.default.READY,this.wrapX_=void 0!==t.wrapX&&t.wrapX};(0,t.inherits)(a,i.default),a.prototype.adaptAttributions_=function(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null},a.prototype.forEachFeatureAtCoordinate=e.UNDEFINED,a.prototype.getAttributions=function(){return this.attributions_},a.prototype.getProjection=function(){return this.projection_},a.prototype.getResolutions=function(){},a.prototype.getState=function(){return this.state_},a.prototype.getWrapX=function(){return this.wrapX_},a.prototype.refresh=function(){this.changed()},a.prototype.setAttributions=function(t){this.attributions_=this.adaptAttributions_(t),this.changed()},a.prototype.setState=function(t){this.state_=t,this.changed()},exports.default=a;
},{"../index.js":80,"../functions.js":195,"../Object.js":196,"../proj.js":58,"../source/State.js":197}],268:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};
},{}],342:[function(require,module,exports) {
var define;
var global = arguments[3];
var t,o=arguments[3];!function(o,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof t&&t.amd?t(n):o.quickselect=n()}(this,function(){"use strict";function t(t,o,n){var r=t[o];t[o]=t[n],t[n]=r}function o(t,o){return t<o?-1:t>o?1:0}return function(n,r,e,f,u){!function o(n,r,e,f,u){for(;f>e;){if(f-e>600){var a=f-e+1,i=r-e+1,c=Math.log(a),h=.5*Math.exp(2*c/3),s=.5*Math.sqrt(c*h*(a-h)/a)*(i-a/2<0?-1:1),l=Math.max(e,Math.floor(r-i*h/a+s)),M=Math.min(f,Math.floor(r+(a-i)*h/a+s));o(n,r,l,M,u)}var m=n[r],p=e,d=f;for(t(n,e,r),u(n[f],m)>0&&t(n,e,f);p<d;){for(t(n,p,d),p++,d--;u(n[p],m)<0;)p++;for(;u(n[d],m)>0;)d--}0===u(n[e],m)?t(n,e,d):t(n,++d,f),d<=r&&(e=d+1),r<=d&&(f=d-1)}}(n,r,e||0,f||n.length-1,u||o)}});
},{}],319:[function(require,module,exports) {
"use strict";module.exports=i,module.exports.default=i;var t=require("quickselect");function i(t,n){if(!(this instanceof i))return new i(t,n);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&this._initFormat(n),this.clear()}function n(t,i,n){if(!n)return i.indexOf(t);for(var a=0;a<i.length;a++)if(n(t,i[a]))return a;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,a,h){h||(h=x(null)),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(var r,o=i;o<n;o++)r=t.children[o],e(h,t.leaf?a(r):r);return h}function e(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function r(t,i){return t.minX-i.minX}function o(t,i){return t.minY-i.minY}function s(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function m(t,i){var n=Math.max(t.minX,i.minX),a=Math.max(t.minY,i.minY),h=Math.min(t.maxX,i.maxX),e=Math.min(t.maxY,i.maxY);return Math.max(0,h-n)*Math.max(0,e-a)}function c(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function f(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function x(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,a,h,e){for(var r,o=[n,a];o.length;)(a=o.pop())-(n=o.pop())<=h||(r=n+Math.ceil((a-n)/h/2)*h,t(i,r,n,a,e),o.push(n,r,r,a))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var i=this.data,n=[],a=this.toBBox;if(!f(t,i))return n;for(var h,e,r,o,s=[];i;){for(h=0,e=i.children.length;h<e;h++)r=i.children[h],f(t,o=i.leaf?a(r):r)&&(i.leaf?n.push(r):c(t,o)?this._all(r,n):s.push(r));i=s.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!f(t,i))return!1;for(var a,h,e,r,o=[];i;){for(a=0,h=i.children.length;a<h;a++)if(e=i.children[a],f(t,r=i.leaf?n(e):e)){if(i.leaf||c(t,r))return!0;o.push(e)}i=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var a=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===a.height)this._splitRoot(this.data,a);else{if(this.data.height<a.height){var h=this.data;this.data=a,a=h}this._insert(a,this.data.height-a.height-1,!0)}else this.data=a;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=x([]),this},remove:function(t,i){if(!t)return this;for(var a,h,e,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),h=l[l.length-1],a=u.pop(),r=!0),o.leaf&&-1!==(e=n(t,o.children,i)))return o.children.splice(e,1),l.push(o),this._condense(l),this;r||o.leaf||!c(o,s)?h?(a++,o=h.children[a],r=!1):o=null:(l.push(o),u.push(a),a=0,h=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:r,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},_build:function(t,i,n,h){var e,r=n-i+1,o=this._maxEntries;if(r<=o)return a(e=x(t.slice(i,n+1)),this.toBBox),e;h||(h=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,h-1))),(e=x([])).leaf=!1,e.height=h;var s,l,u,m,c=Math.ceil(r/o),f=c*Math.ceil(Math.sqrt(o));for(d(t,i,n,f,this.compareMinX),s=i;s<=n;s+=f)for(d(t,s,u=Math.min(s+f-1,n),c,this.compareMinY),l=s;l<=u;l+=c)m=Math.min(l+c-1,u),e.children.push(this._build(t,l,m,h-1));return a(e,this.toBBox),e},_chooseSubtree:function(t,i,n,a){for(var h,e,r,o,l,m,c,f;a.push(i),!i.leaf&&a.length-1!==n;){for(c=f=1/0,h=0,e=i.children.length;h<e;h++)l=s(r=i.children[h]),(m=u(t,r)-l)<f?(f=m,c=l<c?l:c,o=r):m===f&&l<c&&(c=l,o=r);i=o||i.children[0]}return i},_insert:function(t,i,n){var a=this.toBBox,h=n?t:a(t),r=[],o=this._chooseSubtree(h,this.data,i,r);for(o.children.push(t),e(o,h);i>=0&&r[i].children.length>this._maxEntries;)this._split(r,i),i--;this._adjustParentBBoxes(h,r,i)},_split:function(t,i){var n=t[i],h=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,h);var r=this._chooseSplitIndex(n,e,h),o=x(n.children.splice(r,n.children.length-r));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,i){this.data=x([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var a,e,r,o,l,u,c,f;for(u=c=1/0,a=i;a<=n-i;a++)o=m(e=h(t,0,a,this.toBBox),r=h(t,a,n,this.toBBox)),l=s(e)+s(r),o<u?(u=o,f=a,c=l<c?l:c):o===u&&l<c&&(c=l,f=a);return f},_chooseSplitAxis:function(t,i,n){var a=t.leaf?this.compareMinX:r,h=t.leaf?this.compareMinY:o;this._allDistMargin(t,i,n,a)<this._allDistMargin(t,i,n,h)&&t.children.sort(a)},_allDistMargin:function(t,i,n,a){t.children.sort(a);var r,o,s=this.toBBox,u=h(t,0,i,s),m=h(t,n-i,n,s),c=l(u)+l(m);for(r=i;r<n-i;r++)o=t.children[r],e(u,t.leaf?s(o):o),c+=l(u);for(r=n-i-1;r>=i;r--)o=t.children[r],e(m,t.leaf?s(o):o),c+=l(m);return c},_adjustParentBBoxes:function(t,i,n){for(var a=n;a>=0;a--)e(i[a],t)},_condense:function(t){for(var i,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children).splice(i.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};
},{"quickselect":342}],269:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("rbush"),n=o(e),r=require("../extent.js"),i=require("../obj.js");function o(t){return t&&t.__esModule?t:{default:t}}const s=function(t){this.rbush_=(0,n.default)(t,void 0),this.items_={}};s.prototype.insert=function(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[(0,t.getUid)(n)]=r},s.prototype.load=function(e,n){const r=new Array(n.length);for(let i=0,o=n.length;i<o;i++){const o=e[i],s=n[i],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};r[i]=u,this.items_[(0,t.getUid)(s)]=u}this.rbush_.load(r)},s.prototype.remove=function(e){const n=(0,t.getUid)(e),r=this.items_[n];return delete this.items_[n],null!==this.rbush_.remove(r)},s.prototype.update=function(e,n){const i=this.items_[(0,t.getUid)(n)],o=[i.minX,i.minY,i.maxX,i.maxY];(0,r.equals)(o,e)||(this.remove(n),this.insert(e,n))},s.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},s.prototype.getInExtent=function(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},s.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},s.prototype.forEachInExtent=function(t,e,n){return this.forEach_(this.getInExtent(t),e,n)},s.prototype.forEach_=function(t,e,n){let r;for(let i=0,o=t.length;i<o;i++)if(r=e.call(n,t[i]))return r;return r},s.prototype.isEmpty=function(){return(0,i.isEmpty)(this.items_)},s.prototype.clear=function(){this.rbush_.clear(),this.items_={}},s.prototype.getExtent=function(t){const e=this.rbush_.data;return(0,r.createOrUpdate)(e.minX,e.minY,e.maxX,e.maxY,t)},s.prototype.concat=function(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[0|e]=t.items_[0|e]},exports.default=s;
},{"../index.js":80,"rbush":319,"../extent.js":159,"../obj.js":82}],109:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VectorSourceEvent=void 0;var e=require("../index.js"),t=require("../Collection.js"),r=A(t),n=require("../CollectionEventType.js"),s=A(n),i=require("../ObjectEventType.js"),o=A(i),u=require("../array.js"),a=require("../asserts.js"),h=require("../events.js"),d=require("../events/Event.js"),l=A(d),f=require("../events/EventType.js"),c=A(f),_=require("../extent.js"),p=require("../featureloader.js"),E=require("../functions.js"),y=require("../loadingstrategy.js"),g=require("../obj.js"),I=require("../source/Source.js"),x=A(I),F=require("../source/State.js"),v=A(F),m=require("../source/VectorEventType.js"),R=A(m),C=require("../structs/RBush.js"),G=A(C);function A(e){return e&&e.__esModule?e:{default:e}}const j=exports.VectorSourceEvent=function(e,t){l.default.call(this,e),this.feature=t};(0,e.inherits)(j,l.default);const q=function(e){const t=e||{};x.default.call(this,{attributions:t.attributions,projection:void 0,state:v.default.READY,wrapX:void 0===t.wrapX||t.wrapX}),this.loader_=E.UNDEFINED,this.format_=t.format,this.overlaps_=void 0==t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&((0,a.assert)(this.format_,7),this.loader_=(0,p.xhr)(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:y.all;const n=void 0===t.useSpatialIndex||t.useSpatialIndex;let s,i;this.featuresRtree_=n?new G.default:null,this.loadedExtentsRtree_=new G.default,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,t.features instanceof r.default?i=(s=t.features).getArray():Array.isArray(t.features)&&(i=t.features),n||void 0!==s||(s=new r.default(i)),void 0!==i&&this.addFeaturesInternal(i),void 0!==s&&this.bindFeaturesCollection_(s)};(0,e.inherits)(q,x.default),q.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},q.prototype.addFeatureInternal=function(t){const r=(0,e.getUid)(t).toString();if(!this.addToIndex_(r,t))return;this.setupChangeEvents_(r,t);const n=t.getGeometry();if(n){const e=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[r]=t;this.dispatchEvent(new j(R.default.ADDFEATURE,t))},q.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[(0,h.listen)(t,c.default.CHANGE,this.handleFeatureChange_,this),(0,h.listen)(t,o.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]},q.prototype.addToIndex_=function(e,t){let r=!0;const n=t.getId();return void 0!==n?n.toString()in this.idIndex_?r=!1:this.idIndex_[n.toString()]=t:((0,a.assert)(!(e in this.undefIdIndex_),30),this.undefIdIndex_[e]=t),r},q.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},q.prototype.addFeaturesInternal=function(t){const r=[],n=[],s=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],i=(0,e.getUid)(s).toString();this.addToIndex_(i,s)&&n.push(s)}for(let t=0,i=n.length;t<i;t++){const i=n[t],o=(0,e.getUid)(i).toString();this.setupChangeEvents_(o,i);const u=i.getGeometry();if(u){const e=u.getExtent();r.push(e),s.push(i)}else this.nullGeometryFeatures_[o]=i}this.featuresRtree_&&this.featuresRtree_.load(r,s);for(let e=0,t=n.length;e<t;e++)this.dispatchEvent(new j(R.default.ADDFEATURE,n[e]))},q.prototype.bindFeaturesCollection_=function(e){let t=!1;(0,h.listen)(this,R.default.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),(0,h.listen)(this,R.default.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),(0,h.listen)(e,s.default.ADD,function(e){t||(t=!0,this.addFeature(e.element),t=!1)},this),(0,h.listen)(e,s.default.REMOVE,function(e){t||(t=!0,this.removeFeature(e.element),t=!1)},this),this.featuresCollection_=e},q.prototype.clear=function(e){if(e){for(const e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(h.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(const e in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[e])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};const t=new j(R.default.CLEAR);this.dispatchEvent(t),this.changed()},q.prototype.forEachFeature=function(e){return this.featuresRtree_?this.featuresRtree_.forEach(e):this.featuresCollection_?this.featuresCollection_.forEach(e):void 0},q.prototype.forEachFeatureAtCoordinateDirect=function(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){return r.getGeometry().intersectsCoordinate(e)?t(r):void 0})},q.prototype.forEachFeatureInExtent=function(e,t){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(e,t):this.featuresCollection_?this.featuresCollection_.forEach(t):void 0},q.prototype.forEachFeatureIntersectingExtent=function(e,t){return this.forEachFeatureInExtent(e,function(r){if(r.getGeometry().intersectsExtent(e)){const e=t(r);if(e)return e}})},q.prototype.getFeaturesCollection=function(){return this.featuresCollection_},q.prototype.getFeatures=function(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,g.isEmpty)(this.nullGeometryFeatures_)||(0,u.extend)(e,(0,g.getValues)(this.nullGeometryFeatures_))),e},q.prototype.getFeaturesAtCoordinate=function(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t},q.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_.getInExtent(e)},q.prototype.getClosestFeatureToCoordinate=function(e,t){const r=e[0],n=e[1];let s=null;const i=[NaN,NaN];let o=1/0;const u=[-1/0,-1/0,1/0,1/0],a=t||E.TRUE;return this.featuresRtree_.forEachInExtent(u,function(e){if(a(e)){const t=e.getGeometry(),a=o;if((o=t.closestPointXY(r,n,i,o))<a){s=e;const t=Math.sqrt(o);u[0]=r-t,u[1]=n-t,u[2]=r+t,u[3]=n+t}}}),s},q.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},q.prototype.getFeatureById=function(e){const t=this.idIndex_[e.toString()];return void 0!==t?t:null},q.prototype.getFormat=function(){return this.format_},q.prototype.getOverlaps=function(){return this.overlaps_},q.prototype.getResolutions=function(){},q.prototype.getUrl=function(){return this.url_},q.prototype.handleFeatureChange_=function(t){const r=t.target,n=(0,e.getUid)(r).toString(),s=r.getGeometry();if(s){const e=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(e,r)):this.featuresRtree_&&this.featuresRtree_.update(e,r)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(r),this.nullGeometryFeatures_[n]=r);const i=r.getId();if(void 0!==i){const e=i.toString();n in this.undefIdIndex_?(delete this.undefIdIndex_[n],this.idIndex_[e]=r):this.idIndex_[e]!==r&&(this.removeFromIdIndex_(r),this.idIndex_[e]=r)}else n in this.undefIdIndex_||(this.removeFromIdIndex_(r),this.undefIdIndex_[n]=r);this.changed(),this.dispatchEvent(new j(R.default.CHANGEFEATURE,r))},q.prototype.hasFeature=function(t){const r=t.getId();if(void 0!==r)return r in this.idIndex_;return(0,e.getUid)(t).toString()in this.undefIdIndex_},q.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&(0,g.isEmpty)(this.nullGeometryFeatures_)},q.prototype.loadFeatures=function(e,t,r){const n=this.loadedExtentsRtree_,s=this.strategy_(e,t);for(let e=0,i=s.length;e<i;++e){const i=s[e];n.forEachInExtent(i,function(e){return(0,_.containsExtent)(e.extent,i)})||(this.loader_.call(this,i,t,r),n.insert(i,{extent:i.slice()}))}},q.prototype.removeLoadedExtent=function(e){const t=this.loadedExtentsRtree_;let r;t.forEachInExtent(e,function(t){if((0,_.equals)(t.extent,e))return r=t,!0}),r&&t.remove(r)},q.prototype.removeFeature=function(t){const r=(0,e.getUid)(t).toString();r in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[r]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},q.prototype.removeFeatureInternal=function(t){const r=(0,e.getUid)(t).toString();this.featureChangeKeys_[r].forEach(h.unlistenByKey),delete this.featureChangeKeys_[r];const n=t.getId();void 0!==n?delete this.idIndex_[n.toString()]:delete this.undefIdIndex_[r],this.dispatchEvent(new j(R.default.REMOVEFEATURE,t))},q.prototype.removeFromIdIndex_=function(e){let t=!1;for(const r in this.idIndex_)if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}return t},q.prototype.setLoader=function(e){this.loader_=e},exports.default=q;
},{"../index.js":80,"../Collection.js":135,"../CollectionEventType.js":228,"../ObjectEventType.js":229,"../array.js":209,"../asserts.js":165,"../events.js":193,"../events/Event.js":211,"../events/EventType.js":194,"../extent.js":159,"../featureloader.js":325,"../functions.js":195,"../loadingstrategy.js":326,"../obj.js":82,"../source/Source.js":99,"../source/State.js":197,"../source/VectorEventType.js":268,"../structs/RBush.js":269}],149:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=z,exports.createRegularPolygon=Z,exports.createBox=$;var t=require("../index.js"),e=require("../events/EventType.js"),i=b(e),s=require("../Feature.js"),o=b(s),n=require("../MapBrowserEventType.js"),h=b(n),r=require("../MapBrowserPointerEvent.js"),a=b(r),d=require("../Object.js"),u=require("../coordinate.js"),_=require("../events.js"),l=require("../events/Event.js"),c=b(l),f=require("../events/condition.js"),p=require("../extent.js"),g=require("../functions.js"),m=require("../geom/Circle.js"),y=b(m),C=require("../geom/GeometryType.js"),k=b(C),T=require("../geom/LineString.js"),P=b(T),N=require("../geom/MultiLineString.js"),L=b(N),w=require("../geom/MultiPoint.js"),O=b(w),E=require("../geom/MultiPolygon.js"),I=b(E),D=require("../pointer/MouseSource.js"),G=require("../geom/Point.js"),F=b(G),R=require("../geom/Polygon.js"),v=b(R),S=require("../interaction/Pointer.js"),q=b(S),x=require("../interaction/Property.js"),M=b(x),j=require("../layer/Vector.js"),Y=b(j),A=require("../source/Vector.js"),U=b(A),V=require("../style/Style.js");function b(t){return t&&t.__esModule?t:{default:t}}const H={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},B={DRAWSTART:"drawstart",DRAWEND:"drawend"},W=function(t,e){c.default.call(this,t),this.feature=e};(0,t.inherits)(W,c.default);const X=function(t){q.default.call(this,{handleDownEvent:J,handleEvent:z,handleUpEvent:Q}),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=tt(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_===H.POLYGON?3:2,this.maxPoints_=t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:g.TRUE;let e=t.geometryFunction;if(!e)if(this.type_===k.default.CIRCLE)e=function(t,e){const i=e||new y.default([NaN,NaN]),s=(0,u.squaredDistance)(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(s)),i};else{let t;const i=this.mode_;i===H.POINT?t=F.default:i===H.LINE_STRING?t=P.default:i===H.POLYGON&&(t=v.default),e=function(e,s){let o=s;return o?i===H.POLYGON?e[0].length?o.setCoordinates([e[0].concat([e[0][0]])]):o.setCoordinates([]):o.setCoordinates(e):o=new t(e),o}}this.geometryFunction_=e,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Y.default({source:new U.default({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:K(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:f.noModifierKeys,this.freehandCondition_,t.freehand?this.freehandCondition_=f.always:this.freehandCondition_=t.freehandCondition?t.freehandCondition:f.shiftKeyOnly,(0,_.listen)(this,(0,d.getChangeEventType)(M.default.ACTIVE),this.updateState_,this)};function K(){const t=(0,V.createEditingStyle)();return function(e,i){return t[e.getGeometry().getType()]}}function z(t){t.originalEvent.type===i.default.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==H.POINT&&this.freehandCondition_(t);let e=t.type===h.default.POINTERMOVE,s=!0;if(this.lastDragTime_&&t.type===h.default.POINTERDRAG){Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&t.type===h.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),s=!1):this.freehand_&&t.type===h.default.POINTERDOWN?s=!1:e?(s=t.type===h.default.POINTERMOVE)&&this.freehand_?s=this.handlePointerMove_(t):(t.pointerEvent.pointerType==D.POINTER_TYPE||t.type===h.default.POINTERDRAG&&!this.downTimeout_)&&this.handlePointerMove_(t):t.type===h.default.DBLCLICK&&(s=!1),S.handleEvent.call(this,t)&&s}function J(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new a.default(h.default.POINTERMOVE,t.map,t.pointerEvent,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)}function Q(t){let e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.mode_===H.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===H.POINT&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e}function Z(t,e){return function(i,s){const o=i[0],n=i[1],h=Math.sqrt((0,u.squaredDistance)(o,n)),r=s||(0,R.fromCircle)(new y.default(o),t),a=e||Math.atan((n[1]-o[1])/(n[0]-o[0]));return(0,R.makeRegular)(r,o,h,a),r}}function $(){return function(t,e){const i=(0,p.boundingExtent)(t),s=e||new v.default(null);return s.setCoordinates([[(0,p.getBottomLeft)(i),(0,p.getBottomRight)(i),(0,p.getTopRight)(i),(0,p.getTopLeft)(i),(0,p.getBottomLeft)(i)]]),s}}function tt(t){let e;return t===k.default.POINT||t===k.default.MULTI_POINT?e=H.POINT:t===k.default.LINE_STRING||t===k.default.MULTI_LINE_STRING?e=H.LINE_STRING:t===k.default.POLYGON||t===k.default.MULTI_POLYGON?e=H.POLYGON:t===k.default.CIRCLE&&(e=H.CIRCLE),e}(0,t.inherits)(X,q.default),X.prototype.setMap=function(t){q.default.prototype.setMap.call(this,t),this.updateState_()},X.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,s=e[0]-i[0],o=e[1]-i[1],n=s*s+o*o;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},X.prototype.atFinish_=function(t){let e=!1;if(this.sketchFeature_){let i=!1,s=[this.finishCoordinate_];if(this.mode_===H.LINE_STRING?i=this.sketchCoords_.length>this.minPoints_:this.mode_===H.POLYGON&&(i=this.sketchCoords_[0].length>this.minPoints_,s=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]),i){const i=t.map;for(let o=0,n=s.length;o<n;o++){const n=s[o],h=i.getPixelFromCoordinate(n),r=t.pixel,a=r[0]-h[0],d=r[1]-h[1],u=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(a*a+d*d)<=u){this.finishCoordinate_=n;break}}}}return e},X.prototype.createOrUpdateSketchPoint_=function(t){const e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(e)}else this.sketchPoint_=new o.default(new F.default(e)),this.updateSketchFeatures_()},X.prototype.startDrawing_=function(t){const e=t.coordinate;this.finishCoordinate_=e,this.mode_===H.POINT?this.sketchCoords_=e.slice():this.mode_===H.POLYGON?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new o.default(new P.default(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new o.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new W(B.DRAWSTART,this.sketchFeature_))},X.prototype.modifyDrawing_=function(t){let e=t.coordinate;const i=this.sketchFeature_.getGeometry();let s,n,h;if(this.mode_===H.POINT?n=this.sketchCoords_:this.mode_===H.POLYGON?(n=(s=this.sketchCoords_[0])[s.length-1],this.atFinish_(t)&&(e=this.finishCoordinate_.slice())):n=(s=this.sketchCoords_)[s.length-1],n[0]=e[0],n[1]=e[1],this.geometryFunction_(this.sketchCoords_,i),this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(e)}if(i instanceof v.default&&this.mode_!==H.POLYGON){this.sketchLine_||(this.sketchLine_=new o.default(new P.default(null)));const t=i.getLinearRing(0);(h=this.sketchLine_.getGeometry()).setFlatCoordinates(t.getLayout(),t.getFlatCoordinates())}else this.sketchLineCoords_&&(h=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},X.prototype.addToDrawing_=function(t){const e=t.coordinate,i=this.sketchFeature_.getGeometry();let s,o;this.mode_===H.LINE_STRING?(this.finishCoordinate_=e.slice(),(o=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?o.pop():s=!0),o.push(e.slice()),this.geometryFunction_(o,i)):this.mode_===H.POLYGON&&((o=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?o.pop():s=!0),o.push(e.slice()),s&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,i)),this.updateSketchFeatures_(),s&&this.finishDrawing()},X.prototype.removeLastPoint=function(){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry();let e,i;this.mode_===H.LINE_STRING?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===H.POLYGON&&((e=this.sketchCoords_[0]).splice(-2,1),(i=this.sketchLine_.getGeometry()).setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t)),0===e.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()},X.prototype.finishDrawing=function(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const i=t.getGeometry();this.mode_===H.LINE_STRING?(e.pop(),this.geometryFunction_(e,i)):this.mode_===H.POLYGON&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===k.default.MULTI_POINT?t.setGeometry(new O.default([e])):this.type_===k.default.MULTI_LINE_STRING?t.setGeometry(new L.default([e])):this.type_===k.default.MULTI_POLYGON&&t.setGeometry(new I.default([e])),this.dispatchEvent(new W(B.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)},X.prototype.abortDrawing_=function(){this.finishCoordinate_=null;const t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},X.prototype.extend=function(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new W(B.DRAWSTART,this.sketchFeature_))},X.prototype.shouldStopEvent=g.FALSE,X.prototype.updateSketchFeatures_=function(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},X.prototype.updateState_=function(){const t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},exports.default=X;
},{"../index.js":80,"../events/EventType.js":194,"../Feature.js":166,"../MapBrowserEventType.js":253,"../MapBrowserPointerEvent.js":265,"../Object.js":196,"../coordinate.js":217,"../events.js":193,"../events/Event.js":211,"../events/condition.js":258,"../extent.js":159,"../functions.js":195,"../geom/Circle.js":270,"../geom/GeometryType.js":226,"../geom/LineString.js":170,"../geom/MultiLineString.js":171,"../geom/MultiPoint.js":172,"../geom/MultiPolygon.js":173,"../pointer/MouseSource.js":271,"../geom/Point.js":174,"../geom/Polygon.js":175,"../interaction/Pointer.js":153,"../interaction/Property.js":266,"../layer/Vector.js":87,"../source/Vector.js":109,"../style/Style.js":121}],150:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Feature.js"),n=q(t),r=require("../MapBrowserEventType.js"),i=q(r),o=require("../MapBrowserPointerEvent.js"),u=q(o),a=require("../coordinate.js"),l=require("../events/Event.js"),s=q(l),c=require("../extent.js"),d=require("../geom/GeometryType.js"),p=q(d),h=require("../geom/Point.js"),x=q(h),f=require("../geom/Polygon.js"),_=require("../interaction/Pointer.js"),E=q(_),y=require("../layer/Vector.js"),g=q(y),v=require("../source/Vector.js"),m=q(v),T=require("../style/Style.js");function q(e){return e&&e.__esModule?e:{default:e}}const F={EXTENTCHANGED:"extentchanged"},P=function(e){s.default.call(this,F.EXTENTCHANGED),this.extent=e};(0,e.inherits)(P,s.default);const O=function(e){const t=e||{};this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),E.default.call(this,{handleDownEvent:j,handleDragEvent:S,handleEvent:w,handleUpEvent:M}),this.extentOverlay_=new g.default({source:new m.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:H(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new g.default({source:new m.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:C(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)};function w(e){return!(e instanceof u.default)||(e.type!=i.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),_.handleEvent.call(this,e),!1)}function j(e){const t=e.pixel,n=e.map,r=this.getExtent();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=D(o(i)):null!==e?this.pointerHandler_=V(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=V(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixel(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=D(i);return!0}function S(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0}function M(e){this.pointerHandler_=null;const t=this.getExtent();return t&&0!==(0,c.getArea)(t)||this.setExtent(null),!1}function H(){const e=(0,T.createEditingStyle)();return function(t,n){return e[p.default.POLYGON]}}function C(){const e=(0,T.createEditingStyle)();return function(t,n){return e[p.default.POINT]}}function D(e){return function(t){return(0,c.boundingExtent)([e,t])}}function V(e,t){return e[0]==t[0]?function(n){return(0,c.boundingExtent)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,c.boundingExtent)([e,[t[0],n[1]]])}:null}function G(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(0,e.inherits)(O,E.default),O.prototype.snapToVertex_=function(e,t){const n=t.getCoordinateFromPixel(e),r=function(e,t){return(0,a.squaredDistanceToSegment)(n,e)-(0,a.squaredDistanceToSegment)(n,t)},i=this.getExtent();if(i){const o=G(i);o.sort(r);const u=o[0];let l=(0,a.closestOnSegment)(n,u);const s=t.getPixelFromCoordinate(l);if((0,a.distance)(e,s)<=this.pixelTolerance_){const e=t.getPixelFromCoordinate(u[0]),n=t.getPixelFromCoordinate(u[1]),r=(0,a.squaredDistance)(s,e),i=(0,a.squaredDistance)(s,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(l=r>i?u[1]:u[0]),l}}return null},O.prototype.handlePointerMove_=function(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixel(t)),this.createOrUpdatePointerFeature_(r)},O.prototype.createOrUpdateExtentFeature_=function(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,f.fromExtent)(e)):t.setGeometry(void 0):(t=e?new n.default((0,f.fromExtent)(e)):new n.default({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},O.prototype.createOrUpdatePointerFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new n.default(new x.default(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t},O.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),E.default.prototype.setMap.call(this,e)},O.prototype.getExtent=function(){return this.extent_},O.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new P(this.extent_))},exports.default=O;
},{"../index.js":80,"../Feature.js":166,"../MapBrowserEventType.js":253,"../MapBrowserPointerEvent.js":265,"../coordinate.js":217,"../events/Event.js":211,"../extent.js":159,"../geom/GeometryType.js":226,"../geom/Point.js":174,"../geom/Polygon.js":175,"../interaction/Pointer.js":153,"../layer/Vector.js":87,"../source/Vector.js":109,"../style/Style.js":121}],152:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModifyEvent=void 0;var e=require("../index.js"),t=require("../Collection.js"),i=O(t),n=require("../CollectionEventType.js"),r=O(n),s=require("../Feature.js"),o=O(s),a=require("../MapBrowserEventType.js"),u=O(a),h=require("../MapBrowserPointerEvent.js"),l=O(h),d=require("../array.js"),g=require("../coordinate.js"),c=require("../events.js"),_=require("../events/Event.js"),f=O(_),p=require("../events/EventType.js"),m=O(p),y=require("../events/condition.js"),x=require("../extent.js"),v=require("../geom/GeometryType.js"),E=O(v),C=require("../geom/Point.js"),S=O(C),F=require("../interaction/Pointer.js"),T=O(F),I=require("../layer/Vector.js"),P=O(I),G=require("../source/Vector.js"),M=O(G),w=require("../source/VectorEventType.js"),N=O(w),L=require("../structs/RBush.js"),R=O(L),q=require("../style/Style.js");function O(e){return e&&e.__esModule?e:{default:e}}const j={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},A=exports.ModifyEvent=function(e,t,i){f.default.call(this,e),this.features=t,this.mapBrowserEvent=i};(0,e.inherits)(A,f.default);const B=function(e){let t;if(T.default.call(this,{handleDownEvent:b,handleDragEvent:k,handleEvent:W,handleUpEvent:Y}),this.condition_=e.condition?e.condition:y.primaryAction,this.defaultDeleteCondition_=function(e){return(0,y.altKeyOnly)(e)&&(0,y.singleClick)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:y.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new R.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new P.default({source:new M.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:X(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new i.default(this.source_.getFeatures()),(0,c.listen)(this.source_,N.default.ADDFEATURE,this.handleSourceAdd_,this),(0,c.listen)(this.source_,N.default.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),(0,c.listen)(this.features_,r.default.ADD,this.handleFeatureAdd_,this),(0,c.listen)(this.features_,r.default.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};(0,e.inherits)(B,T.default);const D=0,U=1;function V(e,t){return e.index-t.index}function b(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);const i=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;const n=this.vertexFeature_;if(n){const r=[],s=n.getGeometry().getCoordinates(),o=(0,x.boundingExtent)([s]),a=this.rBush_.getInExtent(o),u={};a.sort(V);for(let n=0,o=a.length;n<o;++n){const o=a[n],h=o.segment;let l=(0,e.getUid)(o.feature);const d=o.depth;if(d&&(l+="-"+d.join("-")),u[l]||(u[l]=new Array(2)),o.geometry.getType()===E.default.CIRCLE&&o.index===U){const e=H(i,o);(0,g.equals)(e,s)&&!u[l][0]&&(this.dragSegments_.push([o,0]),u[l][0]=o)}else if((0,g.equals)(h[0],s)&&!u[l][0])this.dragSegments_.push([o,0]),u[l][0]=o;else if((0,g.equals)(h[1],s)&&!u[l][1]){if((o.geometry.getType()===E.default.LINE_STRING||o.geometry.getType()===E.default.MULTI_LINE_STRING)&&u[l][0]&&0===u[l][0].index)continue;this.dragSegments_.push([o,1]),u[l][1]=o}else this.insertVertexCondition_(t)&&(0,e.getUid)(h)in this.vertexSegments_&&!u[l][0]&&!u[l][1]&&r.push([o,s])}r.length&&this.willModifyFeatures_(t);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_}function k(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,s=n.geometry;let o;const a=n.segment,u=i[1];for(;t.length<s.getStride();)t.push(a[u][t.length]);switch(s.getType()){case E.default.POINT:o=t,a[0]=a[1]=t;break;case E.default.MULTI_POINT:(o=s.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case E.default.LINE_STRING:(o=s.getCoordinates())[n.index+u]=t,a[u]=t;break;case E.default.MULTI_LINE_STRING:case E.default.POLYGON:(o=s.getCoordinates())[r[0]][n.index+u]=t,a[u]=t;break;case E.default.MULTI_POLYGON:(o=s.getCoordinates())[r[1]][r[0]][n.index+u]=t,a[u]=t;break;case E.default.CIRCLE:a[0]=a[1]=t,n.index===D?(this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,s.setRadius((0,g.distance)(s.getCenter(),t)),this.changingFeature_=!1)}o&&this.setGeometryCoordinates_(s,o)}this.createOrUpdateVertexFeature_(t)}function Y(e){for(let e=this.dragSegments_.length-1;e>=0;--e){const t=this.dragSegments_[e][0],i=t.geometry;if(i.getType()===E.default.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update((0,x.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update((0,x.boundingExtent)(t.segment),t)}return this.modified_&&(this.dispatchEvent(new A(j.MODIFYEND,this.features_,e)),this.modified_=!1),!1}function W(e){if(!(e instanceof l.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=u.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=u.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==u.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),F.handleEvent.call(this,e)&&!t}function K(e,t){const i=t.geometry;if(i.getType()===E.default.CIRCLE){const n=i;if(t.index===U){const t=(0,g.squaredDistance)(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return(0,g.squaredDistanceToSegment)(e,t.segment)}function H(e,t){const i=t.geometry;return i.getType()===E.default.CIRCLE&&t.index===U?i.getClosestPoint(e):(0,g.closestOnSegment)(e,t.segment)}function X(){const e=(0,q.createEditingStyle)();return function(t,i){return e[E.default.POINT]}}B.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),(0,c.listen)(e,m.default.CHANGE,this.handleFeatureChange_,this)},B.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new A(j.MODIFYSTART,this.features_,e)))},B.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,c.unlisten)(e,m.default.CHANGE,this.handleFeatureChange_,this)},B.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},B.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),T.default.prototype.setActive.call(this,e)},B.prototype.setMap=function(e){this.overlay_.setMap(e),T.default.prototype.setMap.call(this,e)},B.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},B.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},B.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},B.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},B.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},B.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},B.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n],s={feature:e,geometry:t,depth:[n],index:n,segment:[r,r]};this.rBush_.insert(t.getExtent(),s)}},B.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length-1;n<r;++n){const r=i.slice(n,n+2),s={feature:e,geometry:t,index:n,segment:r};this.rBush_.insert((0,x.boundingExtent)(r),s)}},B.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length-1;i<s;++i){const s=r.slice(i,i+2),o={feature:e,geometry:t,depth:[n],index:i,segment:s};this.rBush_.insert((0,x.boundingExtent)(s),o)}}},B.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length-1;i<s;++i){const s=r.slice(i,i+2),o={feature:e,geometry:t,depth:[n],index:i,segment:s};this.rBush_.insert((0,x.boundingExtent)(s),o)}}},B.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length;i<s;++i){const s=r[i];for(let r=0,o=s.length-1;r<o;++r){const o=s.slice(r,r+2),a={feature:e,geometry:t,depth:[i,n],index:r,segment:o};this.rBush_.insert((0,x.boundingExtent)(o),a)}}}},B.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:D,segment:[i,i]},r={feature:e,geometry:t,index:U,segment:[i,i]},s=[n,r];n.featureSegments=r.featureSegments=s,this.rBush_.insert((0,x.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},B.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},B.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new o.default(new S.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t);return t},B.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},B.prototype.handlePointerAtPixel_=function(t,i){const n=i.getCoordinateFromPixel(t),r=function(e,t){return K(n,e)-K(n,t)},s=(0,x.buffer)((0,x.createOrUpdateFromCoordinate)(n),i.getView().getResolution()*this.pixelTolerance_),o=this.rBush_.getInExtent(s);if(o.length>0){o.sort(r);const s=o[0],a=s.segment;let u=H(n,s);const h=i.getPixelFromCoordinate(u);let l=(0,g.distance)(t,h);if(l<=this.pixelTolerance_){const t={};if(s.geometry.getType()===E.default.CIRCLE&&s.index===U)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const n=i.getPixelFromCoordinate(a[0]),r=i.getPixelFromCoordinate(a[1]),s=(0,g.squaredDistance)(h,n),d=(0,g.squaredDistance)(h,r);l=Math.sqrt(Math.min(s,d)),this.snappedToVertex_=l<=this.pixelTolerance_,this.snappedToVertex_&&(u=s>d?a[1]:a[0]),this.createOrUpdateVertexFeature_(u);for(let i=1,n=o.length;i<n;++i){const n=o[i].segment;if(!((0,g.equals)(a[0],n[0])&&(0,g.equals)(a[1],n[1])||(0,g.equals)(a[0],n[1])&&(0,g.equals)(a[1],n[0])))break;t[(0,e.getUid)(n)]=!0}}return t[(0,e.getUid)(a)]=!0,void(this.vertexSegments_=t)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},B.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,s=e.depth,o=e.index;let a;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case E.default.MULTI_LINE_STRING:case E.default.POLYGON:(a=r.getCoordinates())[s[0]].splice(o+1,0,t);break;case E.default.MULTI_POLYGON:(a=r.getCoordinates())[s[1]][s[0]].splice(o+1,0,t);break;case E.default.LINE_STRING:(a=r.getCoordinates()).splice(o+1,0,t);break;default:return}this.setGeometryCoordinates_(r,a);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,o,s,1);const h={segment:[i[0],t],feature:n,geometry:r,depth:s,index:o};u.insert((0,x.boundingExtent)(h.segment),h),this.dragSegments_.push([h,1]);const l={segment:[t,i[1]],feature:n,geometry:r,depth:s,index:o+1};u.insert((0,x.boundingExtent)(l.segment),l),this.dragSegments_.push([l,0]),this.ignoreNextSingleClick_=!0},B.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=u.default.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new A(j.MODIFYEND,this.features_,e)),this.modified_=!1,!0}return!1},B.prototype.removeVertex_=function(){const t=this.dragSegments_,i={};let n,r,s,o,a,u,h,l,d,g,c,_=!1;for(a=t.length-1;a>=0;--a)g=(s=t[a])[0],c=(0,e.getUid)(g.feature),g.depth&&(c+="-"+g.depth.join("-")),c in i||(i[c]={}),0===s[1]?(i[c].right=g,i[c].index=g.index):1==s[1]&&(i[c].left=g,i[c].index=g.index+1);for(c in i){switch(d=i[c].right,h=i[c].left,l=(u=i[c].index)-1,g=void 0!==h?h:d,l<0&&(l=0),n=r=(o=g.geometry).getCoordinates(),_=!1,o.getType()){case E.default.MULTI_LINE_STRING:r[g.depth[0]].length>2&&(r[g.depth[0]].splice(u,1),_=!0);break;case E.default.LINE_STRING:r.length>2&&(r.splice(u,1),_=!0);break;case E.default.MULTI_POLYGON:n=n[g.depth[1]];case E.default.POLYGON:(n=n[g.depth[0]]).length>4&&(u==n.length-1&&(u=0),n.splice(u,1),_=!0,0===u&&(n.pop(),n.push(n[0]),l=n.length-1))}if(_){this.setGeometryCoordinates_(o,r);const e=[];if(void 0!==h&&(this.rBush_.remove(h),e.push(h.segment[0])),void 0!==d&&(this.rBush_.remove(d),e.push(d.segment[1])),void 0!==h&&void 0!==d){const t={depth:g.depth,feature:g.feature,geometry:g.geometry,index:l,segment:e};this.rBush_.insert((0,x.boundingExtent)(t.segment),t)}this.updateSegmentIndices_(o,u,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return _},B.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},B.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||(0,d.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},exports.default=B;
},{"../index.js":80,"../Collection.js":135,"../CollectionEventType.js":228,"../Feature.js":166,"../MapBrowserEventType.js":253,"../MapBrowserPointerEvent.js":265,"../array.js":209,"../coordinate.js":217,"../events.js":193,"../events/Event.js":211,"../events/EventType.js":194,"../events/condition.js":258,"../extent.js":159,"../geom/GeometryType.js":226,"../geom/Point.js":174,"../interaction/Pointer.js":153,"../layer/Vector.js":87,"../source/Vector.js":109,"../source/VectorEventType.js":268,"../structs/RBush.js":269,"../style/Style.js":121}],154:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../CollectionEventType.js"),i=m(t),r=require("../array.js"),n=require("../events.js"),o=require("../events/Event.js"),s=m(o),a=require("../events/condition.js"),l=require("../functions.js"),u=require("../geom/GeometryType.js"),c=m(u),h=require("../interaction/Interaction.js"),d=m(h),f=require("../layer/Vector.js"),y=m(f),p=require("../obj.js"),_=require("../source/Vector.js"),g=m(_),v=require("../style/Style.js");function m(e){return e&&e.__esModule?e:{default:e}}const F={SELECT:"select"},E=function(e,t,i,r){s.default.call(this,e),this.selected=t,this.deselected=i,this.mapBrowserEvent=r};(0,e.inherits)(E,s.default);const C=function(e){d.default.call(this,{handleEvent:T});const t=e||{};this.condition_=t.condition?t.condition:a.singleClick,this.addCondition_=t.addCondition?t.addCondition:a.never,this.removeCondition_=t.removeCondition?t.removeCondition:a.never,this.toggleCondition_=t.toggleCondition?t.toggleCondition:a.shiftKeyOnly,this.multi_=!!t.multi&&t.multi,this.filter_=t.filter?t.filter:l.TRUE,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0;const o=new y.default({source:new g.default({useSpatialIndex:!1,features:t.features,wrapX:t.wrapX}),style:t.style?t.style:L(),updateWhileAnimating:!0,updateWhileInteracting:!0});let s;if(this.featureOverlay_=o,t.layers)if("function"==typeof t.layers)s=t.layers;else{const e=t.layers;s=function(t){return(0,r.includes)(e,t)}}else s=l.TRUE;this.layerFilter_=s,this.featureLayerAssociation_={};const u=this.featureOverlay_.getSource().getFeaturesCollection();(0,n.listen)(u,i.default.ADD,this.addFeature_,this),(0,n.listen)(u,i.default.REMOVE,this.removeFeature_,this)};function T(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),n=this.toggleCondition_(e),o=!t&&!i&&!n,s=e.map,l=this.featureOverlay_.getSource().getFeaturesCollection(),u=[],c=[];if(o){(0,p.clear)(this.featureLayerAssociation_),s.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return c.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=l.getLength()-1;e>=0;--e){const t=l.item(e),i=c.indexOf(t);i>-1?c.splice(i,1):(l.remove(t),u.push(t))}0!==c.length&&l.extend(c)}else{s.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!n||(0,r.includes)(l.getArray(),e)?(i||n)&&(0,r.includes)(l.getArray(),e)&&(u.push(e),this.removeFeatureLayerAssociation_(e)):(c.push(e),this.addFeatureLayerAssociation_(e,o)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=u.length-1;e>=0;--e)l.remove(u[e]);l.extend(c)}return(c.length>0||u.length>0)&&this.dispatchEvent(new E(F.SELECT,c,u,e)),(0,a.pointerMove)(e)}function L(){const e=(0,v.createEditingStyle)();return(0,r.extend)(e[c.default.POLYGON],e[c.default.LINE_STRING]),(0,r.extend)(e[c.default.GEOMETRY_COLLECTION],e[c.default.LINE_STRING]),function(t,i){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(0,e.inherits)(C,d.default),C.prototype.addFeatureLayerAssociation_=function(t,i){const r=(0,e.getUid)(t);this.featureLayerAssociation_[r]=i},C.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},C.prototype.getHitTolerance=function(){return this.hitTolerance_},C.prototype.getLayer=function(t){const i=(0,e.getUid)(t);return this.featureLayerAssociation_[i]},C.prototype.setHitTolerance=function(e){this.hitTolerance_=e},C.prototype.setMap=function(e){const t=this.getMap(),i=this.featureOverlay_.getSource().getFeaturesCollection();t&&i.forEach(t.unskipFeature.bind(t)),d.default.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&i.forEach(e.skipFeature.bind(e))},C.prototype.addFeature_=function(e){const t=this.getMap();t&&t.skipFeature(e.element)},C.prototype.removeFeature_=function(e){const t=this.getMap();t&&t.unskipFeature(e.element)},C.prototype.removeFeatureLayerAssociation_=function(t){const i=(0,e.getUid)(t);delete this.featureLayerAssociation_[i]},exports.default=C;
},{"../index.js":80,"../CollectionEventType.js":228,"../array.js":209,"../events.js":193,"../events/Event.js":211,"../events/condition.js":258,"../functions.js":195,"../geom/GeometryType.js":226,"../interaction/Interaction.js":151,"../layer/Vector.js":87,"../obj.js":82,"../source/Vector.js":109,"../style/Style.js":121}],155:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=v;var e=require("../index.js"),t=require("../Collection.js"),n=require("../CollectionEventType.js"),i=F(n),r=require("../coordinate.js"),o=require("../events.js"),s=require("../events/EventType.js"),u=F(s),a=require("../extent.js"),l=require("../functions.js"),h=require("../geom/GeometryType.js"),c=F(h),d=require("../geom/Polygon.js"),g=require("../interaction/Pointer.js"),_=F(g),f=require("../obj.js"),p=require("../source/Vector.js"),y=require("../source/VectorEventType.js"),m=F(y),x=require("../structs/RBush.js"),E=F(x);function F(e){return e&&e.__esModule?e:{default:e}}const C=function(e){_.default.call(this,{handleEvent:v,handleDownEvent:l.TRUE,handleUpEvent:T});const t=e||{};this.source_=t.source?t.source:null,this.vertex_=void 0===t.vertex||t.vertex,this.edge_=void 0===t.edge||t.edge,this.features_=t.features?t.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.sortByDistance_=G.bind(this),this.rBush_=new E.default,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}};function v(e){const t=this.snapTo(e.pixel,e.coordinate,e.map);return t.snapped&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),g.handleEvent.call(this,e)}function T(e){const t=(0,f.getValues)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}function G(e,t){return(0,r.squaredDistanceToSegment)(this.pixelCoordinate_,e.segment)-(0,r.squaredDistanceToSegment)(this.pixelCoordinate_,t.segment)}(0,e.inherits)(C,_.default),C.prototype.addFeature=function(t,n){const i=void 0===n||n,r=(0,e.getUid)(t),s=t.getGeometry();if(s){const e=this.SEGMENT_WRITERS_[s.getType()];e&&(this.indexedFeaturesExtents_[r]=s.getExtent((0,a.createEmpty)()),e.call(this,t,s))}i&&(this.featureChangeListenerKeys_[r]=(0,o.listen)(t,u.default.CHANGE,this.handleFeatureChange_,this))},C.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},C.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},C.prototype.getFeatures_=function(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},C.prototype.handleFeatureAdd_=function(e){let n;e instanceof p.VectorSourceEvent?n=e.feature:e instanceof t.CollectionEvent&&(n=e.element),this.addFeature(n)},C.prototype.handleFeatureRemove_=function(e){let n;e instanceof p.VectorSourceEvent?n=e.feature:e instanceof t.CollectionEvent&&(n=e.element),this.removeFeature(n)},C.prototype.handleFeatureChange_=function(t){const n=t.target;if(this.handlingDownUpSequence){const t=(0,e.getUid)(n);t in this.pendingFeatures_||(this.pendingFeatures_[t]=n)}else this.updateFeature_(n)},C.prototype.removeFeature=function(t,n){const i=void 0===n||n,r=(0,e.getUid)(t),s=this.indexedFeaturesExtents_[r];if(s){const e=this.rBush_,n=[];e.forEachInExtent(s,function(e){t===e.feature&&n.push(e)});for(let t=n.length-1;t>=0;--t)e.remove(n[t])}i&&((0,o.unlistenByKey)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])},C.prototype.setMap=function(e){const t=this.getMap(),n=this.featuresListenerKeys_,r=this.getFeatures_();t&&(n.forEach(o.unlistenByKey),n.length=0,r.forEach(this.forEachFeatureRemove_.bind(this))),_.default.prototype.setMap.call(this,e),e&&(this.features_?n.push((0,o.listen)(this.features_,i.default.ADD,this.handleFeatureAdd_,this),(0,o.listen)(this.features_,i.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&n.push((0,o.listen)(this.source_,m.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,o.listen)(this.source_,m.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(this.forEachFeatureAdd_.bind(this)))},C.prototype.shouldStopEvent=l.FALSE,C.prototype.snapTo=function(e,t,n){const i=n.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=n.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),s=(0,a.boundingExtent)([i,o]);let u=this.rBush_.getInExtent(s);this.vertex_&&!this.edge_&&(u=u.filter(function(e){return e.feature.getGeometry().getType()!==c.default.CIRCLE}));let l,h,d,g,_,f=!1,p=!1,y=null,m=null;if(u.length>0){this.pixelCoordinate_=t,u.sort(this.sortByDistance_);const i=u[0].segment,o=u[0].feature.getGeometry().getType()===c.default.CIRCLE;this.vertex_&&!this.edge_?(h=n.getPixelFromCoordinate(i[0]),d=n.getPixelFromCoordinate(i[1]),g=(0,r.squaredDistance)(e,h),_=(0,r.squaredDistance)(e,d),(f=(l=Math.sqrt(Math.min(g,_)))<=this.pixelTolerance_)&&(p=!0,y=g>_?i[1]:i[0],m=n.getPixelFromCoordinate(y))):this.edge_&&(y=o?(0,r.closestOnCircle)(t,u[0].feature.getGeometry()):(0,r.closestOnSegment)(t,i),m=n.getPixelFromCoordinate(y),(0,r.distance)(e,m)<=this.pixelTolerance_&&(p=!0,this.vertex_&&!o&&(h=n.getPixelFromCoordinate(i[0]),d=n.getPixelFromCoordinate(i[1]),g=(0,r.squaredDistance)(m,h),_=(0,r.squaredDistance)(m,d),(f=(l=Math.sqrt(Math.min(g,_)))<=this.pixelTolerance_)&&(y=g>_?i[1]:i[0],m=n.getPixelFromCoordinate(y))))),p&&(m=[Math.round(m[0]),Math.round(m[1])])}return{snapped:p,vertex:y,vertexPixel:m}},C.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},C.prototype.writeCircleGeometry_=function(e,t){const n=(0,d.fromCircle)(t).getCoordinates()[0];for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}},C.prototype.writeGeometryCollectionGeometry_=function(e,t){const n=t.getGeometriesArray();for(let t=0;t<n.length;++t){const i=this.SEGMENT_WRITERS_[n[t].getType()];i&&i.call(this,e,n[t])}},C.prototype.writeLineStringGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}},C.prototype.writeMultiLineStringGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}}},C.prototype.writeMultiPointGeometry_=function(e,t){const n=t.getCoordinates();for(let i=0,r=n.length;i<r;++i){const r=n[i],o={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),o)}},C.prototype.writeMultiPolygonGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length;t<n;++t){const n=i[t];for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}}}},C.prototype.writePointGeometry_=function(e,t){const n=t.getCoordinates(),i={feature:e,segment:[n,n]};this.rBush_.insert(t.getExtent(),i)},C.prototype.writePolygonGeometry_=function(e,t){const n=t.getCoordinates();for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}}},exports.default=C;
},{"../index.js":80,"../Collection.js":135,"../CollectionEventType.js":228,"../coordinate.js":217,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../functions.js":195,"../geom/GeometryType.js":226,"../geom/Polygon.js":175,"../interaction/Pointer.js":153,"../obj.js":82,"../source/Vector.js":109,"../source/VectorEventType.js":268,"../structs/RBush.js":269}],156:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TranslateEvent=void 0;var t=require("../index.js"),e=require("../Collection.js"),i=f(e),s=require("../Object.js"),a=require("../events.js"),n=require("../events/Event.js"),r=f(n),o=require("../functions.js"),l=require("../array.js"),u=require("../interaction/Pointer.js"),h=f(u),c=require("../interaction/Property.js"),d=f(c);function f(t){return t&&t.__esModule?t:{default:t}}const _={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},p=exports.TranslateEvent=function(t,e,i){r.default.call(this,t),this.features=e,this.coordinate=i};(0,t.inherits)(p,r.default);const T=function(t){h.default.call(this,{handleDownEvent:g,handleDragEvent:A,handleMoveEvent:y,handleUpEvent:v});const e=t||{};let i;if(this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,e.layers)if("function"==typeof e.layers)i=e.layers;else{const t=e.layers;i=function(e){return(0,l.includes)(t,e)}}else i=o.TRUE;this.layerFilter_=i,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.lastFeature_=null,(0,a.listen)(this,(0,s.getChangeEventType)(d.default.ACTIVE),this.handleActiveChanged_,this)};function g(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,y.call(this,t);const e=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new p(_.TRANSLATESTART,e,t.coordinate)),!0}return!1}function v(t){if(this.lastCoordinate_){this.lastCoordinate_=null,y.call(this,t);const e=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new p(_.TRANSLATEEND,e,t.coordinate)),!0}return!1}function A(t){if(this.lastCoordinate_){const e=t.coordinate,s=e[0]-this.lastCoordinate_[0],a=e[1]-this.lastCoordinate_[1],n=this.features_||new i.default([this.lastFeature_]);n.forEach(function(t){const e=t.getGeometry();e.translate(s,a),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new p(_.TRANSLATING,n,e))}}function y(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}(0,t.inherits)(T,h.default),T.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||(0,l.includes)(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},T.prototype.getHitTolerance=function(){return this.hitTolerance_},T.prototype.setHitTolerance=function(t){this.hitTolerance_=t},T.prototype.setMap=function(t){const e=this.getMap();h.default.prototype.setMap.call(this,t),this.updateState_(e)},T.prototype.handleActiveChanged_=function(){this.updateState_(null)},T.prototype.updateState_=function(t){let e=this.getMap();const i=this.getActive();if((!e||!i)&&(e=e||t)){e.getViewport().classList.remove("ol-grab","ol-grabbing")}},exports.default=T;
},{"../index.js":80,"../Collection.js":135,"../Object.js":196,"../events.js":193,"../events/Event.js":211,"../functions.js":195,"../array.js":209,"../interaction/Pointer.js":153,"../interaction/Property.js":266}],73:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Translate=exports.Snap=exports.Select=exports.Pointer=exports.PinchZoom=exports.PinchRotate=exports.MouseWheelZoom=exports.Modify=exports.KeyboardZoom=exports.KeyboardPan=exports.Interaction=exports.Extent=exports.Draw=exports.DragZoom=exports.DragRotateAndZoom=exports.DragRotate=exports.DragPan=exports.DragBox=exports.DragAndDrop=exports.DoubleClickZoom=void 0;var e=require("./interaction/DoubleClickZoom.js");Object.defineProperty(exports,"DoubleClickZoom",{enumerable:!0,get:function(){return K(e).default}});var t=require("./interaction/DragAndDrop.js");Object.defineProperty(exports,"DragAndDrop",{enumerable:!0,get:function(){return K(t).default}});var r=require("./interaction/DragBox.js");Object.defineProperty(exports,"DragBox",{enumerable:!0,get:function(){return K(r).default}});var o=require("./interaction/DragPan.js");Object.defineProperty(exports,"DragPan",{enumerable:!0,get:function(){return K(o).default}});var n=require("./interaction/DragRotate.js");Object.defineProperty(exports,"DragRotate",{enumerable:!0,get:function(){return K(n).default}});var a=require("./interaction/DragRotateAndZoom.js");Object.defineProperty(exports,"DragRotateAndZoom",{enumerable:!0,get:function(){return K(a).default}});var i=require("./interaction/DragZoom.js");Object.defineProperty(exports,"DragZoom",{enumerable:!0,get:function(){return K(i).default}});var u=require("./interaction/Draw.js");Object.defineProperty(exports,"Draw",{enumerable:!0,get:function(){return K(u).default}});var s=require("./interaction/Extent.js");Object.defineProperty(exports,"Extent",{enumerable:!0,get:function(){return K(s).default}});var c=require("./interaction/Interaction.js");Object.defineProperty(exports,"Interaction",{enumerable:!0,get:function(){return K(c).default}});var d=require("./interaction/KeyboardPan.js");Object.defineProperty(exports,"KeyboardPan",{enumerable:!0,get:function(){return K(d).default}});var l=require("./interaction/KeyboardZoom.js");Object.defineProperty(exports,"KeyboardZoom",{enumerable:!0,get:function(){return K(l).default}});var f=require("./interaction/Modify.js");Object.defineProperty(exports,"Modify",{enumerable:!0,get:function(){return K(f).default}});var p=require("./interaction/MouseWheelZoom.js");Object.defineProperty(exports,"MouseWheelZoom",{enumerable:!0,get:function(){return K(p).default}});var m=require("./interaction/PinchRotate.js");Object.defineProperty(exports,"PinchRotate",{enumerable:!0,get:function(){return K(m).default}});var b=require("./interaction/PinchZoom.js");Object.defineProperty(exports,"PinchZoom",{enumerable:!0,get:function(){return K(b).default}});var x=require("./interaction/Pointer.js");Object.defineProperty(exports,"Pointer",{enumerable:!0,get:function(){return K(x).default}});var g=require("./interaction/Select.js");Object.defineProperty(exports,"Select",{enumerable:!0,get:function(){return K(g).default}});var j=require("./interaction/Snap.js");Object.defineProperty(exports,"Snap",{enumerable:!0,get:function(){return K(j).default}});var D=require("./interaction/Translate.js");Object.defineProperty(exports,"Translate",{enumerable:!0,get:function(){return K(D).default}}),exports.defaults=A;var P=require("./Collection.js"),y=K(P),v=require("./Kinetic.js"),h=K(v),Z=K(e),q=K(o),O=K(n),R=K(i),w=K(d),k=K(l),M=K(p),S=K(m),z=K(b);function K(e){return e&&e.__esModule?e:{default:e}}function A(e){const t=e||{},r=new y.default,o=new h.default(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&r.push(new O.default),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&r.push(new Z.default({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&r.push(new q.default({kinetic:o})),(void 0===t.pinchRotate||t.pinchRotate)&&r.push(new S.default),(void 0===t.pinchZoom||t.pinchZoom)&&r.push(new z.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(r.push(new w.default),r.push(new k.default({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&r.push(new M.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&r.push(new R.default({duration:t.zoomDuration})),r}
},{"./Collection.js":135,"./Kinetic.js":136,"./interaction/DoubleClickZoom.js":137,"./interaction/DragPan.js":138,"./interaction/DragRotate.js":139,"./interaction/DragZoom.js":140,"./interaction/KeyboardPan.js":141,"./interaction/KeyboardZoom.js":142,"./interaction/MouseWheelZoom.js":143,"./interaction/PinchRotate.js":144,"./interaction/PinchZoom.js":145,"./interaction/DragAndDrop.js":146,"./interaction/DragBox.js":147,"./interaction/DragRotateAndZoom.js":148,"./interaction/Draw.js":149,"./interaction/Extent.js":150,"./interaction/Interaction.js":151,"./interaction/Modify.js":152,"./interaction/Pointer.js":153,"./interaction/Select.js":154,"./interaction/Snap.js":155,"./interaction/Translate.js":156}],210:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.ERROR_THRESHOLD=.5,t=exports.ENABLE_RASTER_REPROJECTION=!0;
},{}],308:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./events/EventTarget.js"),n=r(e),o=require("./events/EventType.js"),i=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const s=function(t,e,o,i){n.default.call(this),this.extent=t,this.pixelRatio_=o,this.resolution=e,this.state=i};(0,t.inherits)(s,n.default),s.prototype.changed=function(){this.dispatchEvent(i.default.CHANGE)},s.prototype.getExtent=function(){return this.extent},s.prototype.getImage=function(){},s.prototype.getPixelRatio=function(){return this.pixelRatio_},s.prototype.getResolution=function(){return this.resolution},s.prototype.getState=function(){return this.state},s.prototype.load=function(){},exports.default=s;
},{"./index.js":80,"./events/EventTarget.js":235,"./events/EventType.js":194}],189:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./ImageBase.js"),r=i(e),a=require("./ImageState.js"),s=i(a);function i(t){return t&&t.__esModule?t:{default:t}}const o=function(t,e,a,i,o){this.loader_=void 0!==o?o:null;const n=void 0!==o?s.default.IDLE:s.default.LOADED;r.default.call(this,t,e,a,n),this.canvas_=i,this.error_=null};(0,t.inherits)(o,r.default),o.prototype.getError=function(){return this.error_},o.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=s.default.ERROR):this.state=s.default.LOADED,this.changed()},o.prototype.load=function(){this.state==s.default.IDLE&&(this.state=s.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},o.prototype.getImage=function(){return this.canvas_},exports.default=o;
},{"./index.js":80,"./ImageBase.js":308,"./ImageState.js":191}],240:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../events/Event.js"),s=r(t);function r(e){return e&&e.__esModule?e:{default:e}}const i=function(e,t,r,i,n){s.default.call(this,e),this.vectorContext=t,this.frameState=r,this.context=i,this.glContext=n};(0,e.inherits)(i,s.default),exports.default=i;
},{"../index.js":80,"../events/Event.js":211}],315:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(){};t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},exports.default=t;
},{}],243:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../../array.js"),i=require("../../colorlike.js"),s=require("../../extent.js"),o=require("../../geom/GeometryType.js"),n=S(o),a=require("../../geom/SimpleGeometry.js"),l=require("../../geom/flat/transform.js"),h=require("../../has.js"),r=require("../VectorContext.js"),_=S(r),f=require("../canvas.js"),g=require("../../transform.js");function S(t){return t&&t.__esModule?t:{default:t}}const x=function(t,e,i,s,o){_.default.call(this),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=s,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageSnapToPixel_=!1,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,g.create)()};(0,t.inherits)(x,_.default),x.prototype.drawImages_=function(t,e,i,s){if(!this.image_)return;const o=(0,l.transform2D)(t,e,i,2,this.transform_,this.pixelCoordinates_),n=this.context_,a=this.tmpLocalTransform_,h=n.globalAlpha;1!=this.imageOpacity_&&(n.globalAlpha=h*this.imageOpacity_);let r=this.imageRotation_;this.imageRotateWithView_&&(r+=this.viewRotation_);for(let t=0,e=o.length;t<e;t+=2){let e=o[t]-this.imageAnchorX_,i=o[t+1]-this.imageAnchorY_;if(this.imageSnapToPixel_&&(e=Math.round(e),i=Math.round(i)),0!==r||1!=this.imageScale_){const t=e+this.imageAnchorX_,s=i+this.imageAnchorY_;(0,g.compose)(a,t,s,this.imageScale_,this.imageScale_,r,-t,-s),n.setTransform.apply(n,a)}n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}0===r&&1==this.imageScale_||n.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(n.globalAlpha=h)},x.prototype.drawText_=function(t,e,i,s){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const o=(0,l.transform2D)(t,e,i,s,this.transform_,this.pixelCoordinates_),n=this.context_;let a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=s){const t=o[e]+this.textOffsetX_,i=o[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){const e=(0,g.compose)(this.tmpLocalTransform_,t,i,this.textScale_,this.textScale_,a,-t,-i);n.setTransform.apply(n,e)}this.textStrokeState_&&n.strokeText(this.text_,t,i),this.textFillState_&&n.fillText(this.text_,t,i)}0===a&&1==this.textScale_||n.setTransform(1,0,0,1,0,0)},x.prototype.moveToLineTo_=function(t,e,i,s,o){const n=this.context_,a=(0,l.transform2D)(t,e,i,s,this.transform_,this.pixelCoordinates_);n.moveTo(a[0],a[1]);let h=a.length;o&&(h-=2);for(let t=2;t<h;t+=2)n.lineTo(a[t],a[t+1]);return o&&n.closePath(),i},x.prototype.drawRings_=function(t,e,i,s){for(let o=0,n=i.length;o<n;++o)e=this.moveToLineTo_(t,e,i[o],s,!0);return e},x.prototype.drawCircle=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=(0,a.transformGeom2D)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],s=e[3]-e[1],o=Math.sqrt(i*i+s*s),n=this.context_;n.beginPath(),n.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},x.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},x.prototype.drawGeometry=function(t){switch(t.getType()){case n.default.POINT:this.drawPoint(t);break;case n.default.LINE_STRING:this.drawLineString(t);break;case n.default.POLYGON:this.drawPolygon(t);break;case n.default.MULTI_POINT:this.drawMultiPoint(t);break;case n.default.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case n.default.MULTI_POLYGON:this.drawMultiPolygon(t);break;case n.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case n.default.CIRCLE:this.drawCircle(t)}},x.prototype.drawFeature=function(t,e){const i=e.getGeometryFunction()(t);i&&(0,s.intersects)(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},x.prototype.drawGeometryCollection=function(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])},x.prototype.drawPoint=function(t){const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},x.prototype.drawMultiPoint=function(t){const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},x.prototype.drawLineString=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}},x.prototype.drawMultiLineString=function(t){const e=t.getExtent();if((0,s.intersects)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let s=0;const o=t.getEnds(),n=t.getStride();e.beginPath();for(let t=0,e=o.length;t<e;++t)s=this.moveToLineTo_(i,s,o[t],n,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}},x.prototype.drawPolygon=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}},x.prototype.drawMultiPolygon=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const o=t.getEndss(),n=t.getStride();e.beginPath();for(let t=0,e=o.length;t<e;++t){const e=o[t];s=this.drawRings_(i,s,e,n)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}},x.prototype.setContextFillState_=function(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},x.prototype.setContextStrokeState_=function(t){const i=this.context_,s=this.contextStrokeState_;s?(s.lineCap!=t.lineCap&&(s.lineCap=i.lineCap=t.lineCap),h.CANVAS_LINE_DASH&&((0,e.equals)(s.lineDash,t.lineDash)||i.setLineDash(s.lineDash=t.lineDash),s.lineDashOffset!=t.lineDashOffset&&(s.lineDashOffset=i.lineDashOffset=t.lineDashOffset)),s.lineJoin!=t.lineJoin&&(s.lineJoin=i.lineJoin=t.lineJoin),s.lineWidth!=t.lineWidth&&(s.lineWidth=i.lineWidth=t.lineWidth),s.miterLimit!=t.miterLimit&&(s.miterLimit=i.miterLimit=t.miterLimit),s.strokeStyle!=t.strokeStyle&&(s.strokeStyle=i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,h.CANVAS_LINE_DASH&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},x.prototype.setContextTextState_=function(t){const e=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:f.defaultTextAlign;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=s&&(i.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})},x.prototype.setFillStrokeStyle=function(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:(0,i.asColorLike)(e||f.defaultFillStyle)}}else this.fillState_=null;if(e){const t=e.getColor(),s=e.getLineCap(),o=e.getLineDash(),n=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==s?s:f.defaultLineCap,lineDash:o||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==a?a:f.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==l?l:f.defaultLineWidth),miterLimit:void 0!==h?h:f.defaultMiterLimit,strokeStyle:(0,i.asColorLike)(t||f.defaultStrokeStyle)}}else this.strokeState_=null},x.prototype.setImageStyle=function(t){if(t){const e=t.getAnchor(),i=t.getImage(1),s=t.getOrigin(),o=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=o[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageSnapToPixel_=t.getSnapToPixel(),this.imageWidth_=o[0]}else this.image_=null},x.prototype.setTextStyle=function(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:(0,i.asColorLike)(t||f.defaultFillStyle)}}else this.textFillState_=null;const s=t.getStroke();if(s){const t=s.getColor(),e=s.getLineCap(),o=s.getLineDash(),n=s.getLineDashOffset(),a=s.getLineJoin(),l=s.getWidth(),h=s.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:f.defaultLineCap,lineDash:o||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==a?a:f.defaultLineJoin,lineWidth:void 0!==l?l:f.defaultLineWidth,miterLimit:void 0!==h?h:f.defaultMiterLimit,strokeStyle:(0,i.asColorLike)(t||f.defaultStrokeStyle)}}else this.textStrokeState_=null;const o=t.getFont(),n=t.getOffsetX(),a=t.getOffsetY(),l=t.getRotateWithView(),h=t.getRotation(),r=t.getScale(),_=t.getText(),g=t.getTextAlign(),S=t.getTextBaseline();this.textState_={font:void 0!==o?o:f.defaultFont,textAlign:void 0!==g?g:f.defaultTextAlign,textBaseline:void 0!==S?S:f.defaultTextBaseline},this.text_=void 0!==_?_:"",this.textOffsetX_=void 0!==n?this.pixelRatio_*n:0,this.textOffsetY_=void 0!==a?this.pixelRatio_*a:0,this.textRotateWithView_=void 0!==l&&l,this.textRotation_=void 0!==h?h:0,this.textScale_=this.pixelRatio_*(void 0!==r?r:1)}else this.text_=""},exports.default=x;
},{"../../index.js":80,"../../array.js":209,"../../colorlike.js":314,"../../extent.js":159,"../../geom/GeometryType.js":226,"../../geom/SimpleGeometry.js":227,"../../geom/flat/transform.js":311,"../../has.js":256,"../VectorContext.js":315,"../canvas.js":241,"../../transform.js":237}],340:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../ImageState.js"),i=g(t),n=require("../Observable.js"),o=g(n),r=require("../TileState.js"),a=g(r),u=require("../events.js"),s=require("../events/EventType.js"),d=g(s),l=require("../functions.js"),c=require("../source/State.js"),f=g(c);function g(e){return e&&e.__esModule?e:{default:e}}const p=function(e){o.default.call(this),this.layer_=e};(0,e.inherits)(p,o.default),p.prototype.forEachFeatureAtCoordinate=l.UNDEFINED,p.prototype.hasFeatureAtCoordinate=l.FALSE,p.prototype.createLoadedTileFinder=function(e,t,i){return function(n,o){return e.forEachLoadedTile(t,n,o,function(e){i[n]||(i[n]={}),i[n][e.tileCoord.toString()]=e})}},p.prototype.getLayer=function(){return this.layer_},p.prototype.handleImageChange_=function(e){e.target.getState()===i.default.LOADED&&this.renderIfReadyAndVisible()},p.prototype.loadImage=function(e){let t=e.getState();return t!=i.default.LOADED&&t!=i.default.ERROR&&(0,u.listen)(e,d.default.CHANGE,this.handleImageChange_,this),t==i.default.IDLE&&(e.load(),t=e.getState()),t==i.default.LOADED},p.prototype.renderIfReadyAndVisible=function(){const e=this.getLayer();e.getVisible()&&e.getSourceState()==f.default.READY&&this.changed()},p.prototype.scheduleExpireCache=function(t,i){if(i.canExpireCache()){const n=function(t,i,n){const o=(0,e.getUid)(t).toString();o in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[o])}.bind(null,i);t.postRenderFunctions.push(n)}},p.prototype.updateUsedTiles=function(t,i,n,o){const r=(0,e.getUid)(i).toString(),a=n.toString();r in t?a in t[r]?t[r][a].extend(o):t[r][a]=o:(t[r]={},t[r][a]=o)},p.prototype.manageTilePyramid=function(t,i,n,o,r,u,s,d,l,c){const f=(0,e.getUid)(i).toString();f in t.wantedTiles||(t.wantedTiles[f]={});const g=t.wantedTiles[f],p=t.tileQueue;let h,y,E,S,T,C;for(C=n.getMinZoom();C<=s;++C)for(y=n.getTileRangeForExtentAndZ(u,C,y),E=n.getResolution(C),S=y.minX;S<=y.maxX;++S)for(T=y.minY;T<=y.maxY;++T)s-C<=d?((h=i.getTile(C,S,T,o,r)).getState()==a.default.IDLE&&(g[h.getKey()]=!0,p.isKeyQueued(h.getKey())||p.enqueue([h,f,n.getTileCoordCenter(h.tileCoord),E])),void 0!==l&&l.call(c,h)):i.useTile(C,S,T,r)},exports.default=p;
},{"../index.js":80,"../ImageState.js":191,"../Observable.js":181,"../TileState.js":199,"../events.js":193,"../events/EventType.js":194,"../functions.js":195,"../source/State.js":197}],313:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../extent.js"),o=require("../../functions.js"),r=require("../../render/Event.js"),i=d(r),n=require("../../render/EventType.js"),s=d(n),a=require("../../render/canvas.js"),p=require("../../render/canvas/Immediate.js"),f=d(p),c=require("../Layer.js"),u=d(c),l=require("../../transform.js");function d(e){return e&&e.__esModule?e:{default:e}}const h=function(e){u.default.call(this,e),this.renderedResolution,this.transform_=(0,l.create)()};(0,e.inherits)(h,u.default),h.prototype.clip=function(e,o,r){const i=o.pixelRatio,n=o.size[0]*i,s=o.size[1]*i,p=o.viewState.rotation,f=(0,t.getTopLeft)(r),c=(0,t.getTopRight)(r),u=(0,t.getBottomRight)(r),d=(0,t.getBottomLeft)(r);(0,l.apply)(o.coordinateToPixelTransform,f),(0,l.apply)(o.coordinateToPixelTransform,c),(0,l.apply)(o.coordinateToPixelTransform,u),(0,l.apply)(o.coordinateToPixelTransform,d),e.save(),(0,a.rotateAtOffset)(e,-p,n/2,s/2),e.beginPath(),e.moveTo(f[0]*i,f[1]*i),e.lineTo(c[0]*i,c[1]*i),e.lineTo(u[0]*i,u[1]*i),e.lineTo(d[0]*i,d[1]*i),e.clip(),(0,a.rotateAtOffset)(e,p,n/2,s/2)},h.prototype.dispatchComposeEvent_=function(e,t,o,r){const n=this.getLayer();if(n.hasListener(e)){const s=o.size[0]*o.pixelRatio,p=o.size[1]*o.pixelRatio,c=o.viewState.rotation;(0,a.rotateAtOffset)(t,-c,s/2,p/2);const u=void 0!==r?r:this.getTransform(o,0),l=new f.default(t,o.pixelRatio,o.extent,u,o.viewState.rotation),d=new i.default(e,l,o,t,null);n.dispatchEvent(d),(0,a.rotateAtOffset)(t,c,s/2,p/2)}},h.prototype.forEachLayerAtCoordinate=function(e,t,r,i){return this.forEachFeatureAtCoordinate(e,t,0,o.TRUE,this)?r.call(i,this.getLayer(),null):void 0},h.prototype.postCompose=function(e,t,o,r){this.dispatchComposeEvent_(s.default.POSTCOMPOSE,e,t,r)},h.prototype.preCompose=function(e,t,o){this.dispatchComposeEvent_(s.default.PRECOMPOSE,e,t,o)},h.prototype.dispatchRenderEvent=function(e,t,o){this.dispatchComposeEvent_(s.default.RENDER,e,t,o)},h.prototype.getTransform=function(e,t){const o=e.viewState,r=e.pixelRatio,i=r*e.size[0]/2,n=r*e.size[1]/2,s=r/o.resolution,a=-s,p=-o.rotation,f=-o.center[0]+t,c=-o.center[1];return(0,l.compose)(this.transform_,i,n,s,a,p,f,c)},h.prototype.composeFrame=function(e,t,o){},h.prototype.prepareFrame=function(e,t){},exports.default=h;
},{"../../index.js":80,"../../extent.js":159,"../../functions.js":195,"../../render/Event.js":240,"../../render/EventType.js":205,"../../render/canvas.js":241,"../../render/canvas/Immediate.js":243,"../Layer.js":340,"../../transform.js":237}],238:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../../coordinate.js"),o=require("../../dom.js"),a=require("../../extent.js"),r=require("../../functions.js"),n=require("../canvas/Layer.js"),i=h(n),s=require("../../transform.js");function h(t){return t&&t.__esModule?t:{default:t}}const c=function(t){i.default.call(this,t),this.coordinateToCanvasPixelTransform=(0,s.create)(),this.hitCanvasContext_=null};(0,t.inherits)(c,i.default),c.prototype.composeFrame=function(t,e,o){this.preCompose(o,t);const r=this.getImage();if(r){const n=e.extent,i=void 0!==n&&!(0,a.containsExtent)(n,t.extent)&&(0,a.intersects)(n,t.extent);i&&this.clip(o,t,n);const s=this.getImageTransform(),h=o.globalAlpha;o.globalAlpha=e.opacity;const c=s[4],u=s[5],l=r.width*s[0],d=r.height*s[3];o.drawImage(r,0,0,+r.width,+r.height,Math.round(c),Math.round(u),Math.round(l),Math.round(d)),o.globalAlpha=h,i&&o.restore()}this.postCompose(o,t,e)},c.prototype.getImage=function(){},c.prototype.getImageTransform=function(){},c.prototype.forEachFeatureAtCoordinate=function(t,e,o,a,r){const n=this.getLayer(),i=n.getSource(),s=e.viewState.resolution,h=e.viewState.rotation,c=e.skippedFeatureUids;return i.forEachFeatureAtCoordinate(t,s,h,o,c,function(t){return a.call(r,t,n)})},c.prototype.forEachLayerAtCoordinate=function(t,a,n,h){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==r.UNDEFINED)return i.default.prototype.forEachLayerAtCoordinate.apply(this,arguments);{const r=(0,s.apply)(this.coordinateToCanvasPixelTransform,t.slice());(0,e.scale)(r,a.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=(0,o.createCanvasContext2D)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),r[0],r[1],1,1,0,0,1,1);const i=this.hitCanvasContext_.getImageData(0,0,1,1).data;return i[3]>0?n.call(h,this.getLayer(),i):void 0}}},exports.default=c;
},{"../../index.js":80,"../../coordinate.js":217,"../../dom.js":192,"../../extent.js":159,"../../functions.js":195,"../canvas/Layer.js":313,"../../transform.js":237}],124:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../reproj/common.js"),t=require("../../index.js"),r=require("../../ImageCanvas.js"),i=m(r),s=require("../../LayerType.js"),o=m(s),n=require("../../ViewHint.js"),a=m(n),u=require("../../array.js"),c=require("../../extent.js"),d=require("../../layer/VectorRenderType.js"),p=m(d),l=require("../../obj.js"),h=require("../canvas/IntermediateCanvas.js"),f=m(h),g=require("../../transform.js");function m(e){return e&&e.__esModule?e:{default:e}}const _=function(e){f.default.call(this,e),this.image_=null,this.imageTransform_=(0,g.create)(),this.skippedFeatures_=[],this.vectorRenderer_=null};(0,t.inherits)(_,f.default),_.handles=function(e){return e.getType()===o.default.IMAGE||e.getType()===o.default.VECTOR&&e.getRenderMode()===p.default.IMAGE},_.create=function(e,t){const r=new _(t);if(t.getType()===o.default.VECTOR){const i=e.getLayerRendererConstructors();for(let s=0,o=i.length;s<o;++s){const o=i[s];if(o!==_&&o.handles(t)){r.setVectorRenderer(o.create(e,t));break}}}return r},_.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),f.default.prototype.disposeInternal.call(this)},_.prototype.getImage=function(){return this.image_?this.image_.getImage():null},_.prototype.getImageTransform=function(){return this.imageTransform_},_.prototype.prepareFrame=function(t,r){const s=t.pixelRatio,o=t.size,n=t.viewState,d=n.center,p=n.resolution;let h;const f=this.getLayer().getSource(),m=t.viewHints;let _=t.extent;if(void 0!==r.extent&&(_=(0,c.getIntersection)(_,r.extent)),!m[a.default.ANIMATING]&&!m[a.default.INTERACTING]&&!(0,c.isEmpty)(_)){let o=n.projection;if(!e.ENABLE_RASTER_REPROJECTION){const e=f.getProjection();e&&(o=e)}const a=this.vectorRenderer_;if(a){const e=a.context,o=(0,l.assign)({},t,{size:[(0,c.getWidth)(_)/p,(0,c.getHeight)(_)/p],viewState:(0,l.assign)({},t.viewState,{rotation:0})}),n=Object.keys(o.skippedFeatureUids).sort();!a.prepareFrame(o,r)||!a.replayGroupChanged&&(0,u.equals)(n,this.skippedFeatures_)||(e.canvas.width=o.size[0]*s,e.canvas.height=o.size[1]*s,a.composeFrame(o,r,e),this.image_=new i.default(_,p,s,e.canvas),this.skippedFeatures_=n)}else if(h=f.getImage(_,p,s,o)){this.loadImage(h)&&(this.image_=h)}}if(this.image_){const e=(h=this.image_).getExtent(),t=h.getResolution(),r=h.getPixelRatio(),i=s*t/(p*r),n=(0,g.compose)(this.imageTransform_,s*o[0]/2,s*o[1]/2,i,i,0,r*(e[0]-d[0])/t,r*(d[1]-e[3])/t);(0,g.compose)(this.coordinateToCanvasPixelTransform,s*o[0]/2-n[4],s*o[1]/2-n[5],s/p,-s/p,0,-d[0],-d[1]),this.renderedResolution=t*s/r}return!!this.image_},_.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,s){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,r,i,s):f.default.prototype.forEachFeatureAtCoordinate.call(this,e,t,r,i,s)},_.prototype.setVectorRenderer=function(e){this.vectorRenderer_&&this.vectorRenderer_.dispose(),this.vectorRenderer_=e},exports.default=_;
},{"../../reproj/common.js":210,"../../index.js":80,"../../ImageCanvas.js":189,"../../LayerType.js":130,"../../ViewHint.js":222,"../../array.js":209,"../../extent.js":159,"../../layer/VectorRenderType.js":202,"../../obj.js":82,"../canvas/IntermediateCanvas.js":238,"../../transform.js":237}],236:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shared=void 0;var e=require("../color.js");const t=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function c(t,c,i){return c+":"+t+":"+(i?(0,e.asString)(i):"null")}t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){let e=0;for(const t in this.cache_){const c=this.cache_[t];0!=(3&e++)||c.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}},t.prototype.get=function(e,t,i){const s=c(e,t,i);return s in this.cache_?this.cache_[s]:null},t.prototype.set=function(e,t,i,s){const h=c(e,t,i);this.cache_[h]=s,++this.cacheSize_},t.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},exports.default=t;const i=exports.shared=new t;
},{"../color.js":231}],242:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sortByZIndex=h;var e=require("../index.js"),r=require("../Disposable.js"),t=c(r),n=require("../events.js"),o=require("../events/EventType.js"),s=c(o),i=require("../extent.js"),a=require("../functions.js"),u=require("../layer/Layer.js"),d=require("../style/IconImageCache.js"),y=require("../transform.js");function c(e){return e&&e.__esModule?e:{default:e}}const l=function(e){t.default.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]};function p(e,r){d.shared.expire()}function h(e,r){return e.zIndex-r.zIndex}(0,e.inherits)(l,t.default),l.prototype.registerLayerRenderers=function(e){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,e)},l.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},l.prototype.calculateMatrices2D=function(e){const r=e.viewState,t=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;(0,y.compose)(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),(0,y.invert)((0,y.setFromArray)(n,t))},l.prototype.removeLayerRenderers=function(){for(const e in this.layerRenderers_)this.removeLayerRendererByKey_(e).dispose()},l.prototype.forEachFeatureAtCoordinate=function(r,t,n,o,s,a,d){let y;const c=t.viewState,l=c.resolution;function p(r,n){const i=(0,e.getUid)(r).toString(),a=t.layerStates[(0,e.getUid)(n)].managed;if(!(i in t.skippedFeatureUids)||a)return o.call(s,r,a?n:null)}const h=c.projection;let f=r;if(h.canWrapX()){const e=h.getExtent(),t=(0,i.getWidth)(e),n=r[0];if(n<e[0]||n>e[2]){f=[n+t*Math.ceil((e[0]-n)/t),r[1]]}}const R=t.layerStatesArray;let _;for(_=R.length-1;_>=0;--_){const e=R[_],o=e.layer;if((0,u.visibleAtResolution)(e,l)&&a.call(d,o)){const e=this.getLayerRenderer(o);if(o.getSource()&&(y=e.forEachFeatureAtCoordinate(o.getSource().getWrapX()?f:r,t,n,p,s)),y)return y}}},l.prototype.forEachLayerAtPixel=function(e,r,t,n,o,s){},l.prototype.hasFeatureAtCoordinate=function(e,r,t,n,o){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,a.TRUE,this,n,o)},l.prototype.getLayerRenderer=function(r){const t=(0,e.getUid)(r).toString();if(t in this.layerRenderers_)return this.layerRenderers_[t];{let e;for(let t=0,n=this.layerRendererConstructors_.length;t<n;++t){const n=this.layerRendererConstructors_[t];if(n.handles(r)){e=n.create(this,r);break}}if(!e)throw new Error("Unable to create renderer for layer: "+r.getType());return this.layerRenderers_[t]=e,this.layerRendererListeners_[t]=(0,n.listen)(e,s.default.CHANGE,this.handleLayerRendererChange_,this),e}},l.prototype.getLayerRendererByKey=function(e){return this.layerRenderers_[e]},l.prototype.getLayerRenderers=function(){return this.layerRenderers_},l.prototype.getMap=function(){return this.map_},l.prototype.handleLayerRendererChange_=function(){this.map_.render()},l.prototype.removeLayerRendererByKey_=function(e){const r=this.layerRenderers_[e];return delete this.layerRenderers_[e],(0,n.unlistenByKey)(this.layerRendererListeners_[e]),delete this.layerRendererListeners_[e],r},l.prototype.renderFrame=a.UNDEFINED,l.prototype.removeUnusedLayerRenderers_=function(e,r){for(const e in this.layerRenderers_)r&&e in r.layerStates||this.removeLayerRendererByKey_(e).dispose()},l.prototype.scheduleExpireIconCache=function(e){e.postRenderFunctions.push(p)},l.prototype.scheduleRemoveUnusedLayerRenderers=function(e){for(const r in this.layerRenderers_)if(!(r in e.layerStates))return void e.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},exports.default=l;
},{"../index.js":80,"../Disposable.js":312,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../functions.js":195,"../layer/Layer.js":86,"../style/IconImageCache.js":236,"../transform.js":237}],125:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../transform.js"),t=require("../../index.js"),s=require("../../array.js"),r=require("../../css.js"),i=require("../../dom.js"),a=require("../../layer/Layer.js"),n=require("../../render/Event.js"),o=y(n),c=require("../../render/EventType.js"),l=y(c),h=require("../../render/canvas.js"),d=require("../../render/canvas/Immediate.js"),u=y(d),p=require("../Map.js"),v=y(p),f=require("../../source/State.js"),_=y(f);function y(e){return e&&e.__esModule?e:{default:e}}const m=function(t){v.default.call(this,t);const s=t.getViewport();this.context_=(0,i.createCanvasContext2D)(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=r.CLASS_UNSELECTABLE,s.insertBefore(this.canvas_,s.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=(0,e.create)()};(0,t.inherits)(m,v.default),m.prototype.dispatchComposeEvent_=function(e,t){const s=this.getMap(),r=this.context_;if(s.hasListener(e)){const i=t.extent,a=t.pixelRatio,n=t.viewState.rotation,c=this.getTransform(t),l=new u.default(r,a,i,c,n),h=new o.default(e,l,t,r,null);s.dispatchEvent(h)}},m.prototype.getTransform=function(t){const s=t.viewState,r=this.canvas_.width/2,i=this.canvas_.height/2,a=t.pixelRatio/s.resolution,n=-a,o=-s.rotation,c=-s.center[0],l=-s.center[1];return(0,e.compose)(this.transform_,r,i,a,n,o,c,l)},m.prototype.renderFrame=function(e){if(!e)return void(this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1));const t=this.context_,r=e.pixelRatio,i=Math.round(e.size[0]*r),n=Math.round(e.size[1]*r);this.canvas_.width!=i||this.canvas_.height!=n?(this.canvas_.width=i,this.canvas_.height=n):t.clearRect(0,0,i,n);const o=e.viewState.rotation;this.calculateMatrices2D(e),this.dispatchComposeEvent_(l.default.PRECOMPOSE,e);const c=e.layerStatesArray;(0,s.stableSort)(c,p.sortByZIndex),o&&(t.save(),(0,h.rotateAtOffset)(t,o,i/2,n/2));const d=e.viewState.resolution;let u,v,f,y,m;for(u=0,v=c.length;u<v;++u)f=(m=c[u]).layer,y=this.getLayerRenderer(f),(0,a.visibleAtResolution)(m,d)&&m.sourceState==_.default.READY&&y.prepareFrame(e,m)&&y.composeFrame(e,m,t);o&&t.restore(),this.dispatchComposeEvent_(l.default.POSTCOMPOSE,e),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(e),this.scheduleExpireIconCache(e)},m.prototype.forEachLayerAtPixel=function(t,s,r,i,n,o){let c;const l=s.viewState.resolution,h=s.layerStatesArray,d=h.length,u=(0,e.apply)(s.pixelToCoordinateTransform,t.slice());let p;for(p=d-1;p>=0;--p){const e=h[p],t=e.layer;if((0,a.visibleAtResolution)(e,l)&&n.call(o,t)){if(c=this.getLayerRenderer(t).forEachLayerAtCoordinate(u,s,r,i))return c}}},exports.default=m;
},{"../../transform.js":237,"../../index.js":80,"../../array.js":209,"../../css.js":208,"../../dom.js":192,"../../layer/Layer.js":86,"../../render/Event.js":240,"../../render/EventType.js":205,"../../render/canvas.js":241,"../../render/canvas/Immediate.js":243,"../Map.js":242,"../../source/State.js":197}],250:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=i;const t=function(t,i,n,m){this.minX=t,this.maxX=i,this.minY=n,this.maxY=m};function i(i,n,m,e,s){return void 0!==s?(s.minX=i,s.maxX=n,s.minY=m,s.maxY=e,s):new t(i,n,m,e)}t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},exports.default=t;
},{}],126:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../LayerType.js"),i=T(t),n=require("../../TileRange.js"),r=T(n),s=require("../../TileState.js"),o=T(s),a=require("../../ViewHint.js"),l=T(a),d=require("../../dom.js"),h=require("../../extent.js"),u=require("../canvas/IntermediateCanvas.js"),g=T(u),c=require("../../transform.js");function T(e){return e&&e.__esModule?e:{default:e}}const m=function(e){g.default.call(this,e),this.context=null===this.context?null:(0,d.createCanvasContext2D)(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.tmpExtent=(0,h.createEmpty)(),this.tmpTileRange_=new r.default(0,0,0,0),this.imageTransform_=(0,c.create)(),this.zDirection=0};(0,e.inherits)(m,g.default),m.handles=function(e){return e.getType()===i.default.TILE},m.create=function(e,t){return new m(t)},m.prototype.isDrawableTile_=function(e){const t=e.getState(),i=this.getLayer().getUseInterimTilesOnError();return t==o.default.LOADED||t==o.default.EMPTY||t==o.default.ERROR&&!i},m.prototype.prepareFrame=function(t,i){const n=t.pixelRatio,r=t.size,s=t.viewState,a=s.projection,d=s.resolution,u=s.center,g=this.getLayer(),T=g.getSource(),m=T.getRevision(),f=T.getTileGridForProjection(a),p=f.getZForResolution(d,this.zDirection),x=f.getResolution(p);let R=Math.round(d/x)||1,E=t.extent;if(void 0!==i.extent&&(E=(0,h.getIntersection)(E,i.extent)),(0,h.isEmpty)(E))return!1;const _=f.getTileRangeForExtentAndZ(E,p),v=f.getTileRangeExtent(p,_),y=T.getTilePixelRatio(n),w={};w[p]={};const I=this.createLoadedTileFinder(T,a,w),j=this.tmpExtent,C=this.tmpTileRange_;let D,S,q,A=!1;for(S=_.minX;S<=_.maxX;++S)for(q=_.minY;q<=_.maxY;++q){if((D=T.getTile(p,S,q,n,a)).getState()==o.default.ERROR&&(g.getUseInterimTilesOnError()?g.getPreload()>0&&(A=!0):D.setState(o.default.LOADED)),this.isDrawableTile_(D)||(D=D.getInterimTile()),this.isDrawableTile_(D)){const i=(0,e.getUid)(this);if(D.getState()==o.default.LOADED){w[p][D.tileCoord.toString()]=D;const e=D.inTransition(i);A||!e&&-1!==this.renderedTiles.indexOf(D)||(A=!0)}if(1===D.getAlpha(i,t.time))continue}const i=f.getTileCoordChildTileRange(D.tileCoord,C,j);let r=!1;i&&(r=I(p+1,i)),r||f.forEachTileCoordParentTileRange(D.tileCoord,I,null,C,j)}const L=x*n/y*R,O=t.viewHints,P=O[l.default.ANIMATING]||O[l.default.INTERACTING];if(!(this.renderedResolution&&Date.now()-t.time>16&&P)&&(A||!this.renderedExtent_||!(0,h.containsExtent)(this.renderedExtent_,E)||this.renderedRevision!=m||R!=this.oversampling_||!P&&L!=this.renderedResolution)){const e=this.context;if(e){const t=T.getTilePixelSize(p,n,a),i=Math.round(_.getWidth()*t[0]/R),r=Math.round(_.getHeight()*t[1]/R),s=e.canvas;s.width!=i||s.height!=r?(this.oversampling_=R,s.width=i,s.height=r):(this.renderedExtent_&&!(0,h.equals)(v,this.renderedExtent_)&&e.clearRect(0,0,i,r),R=this.oversampling_)}this.renderedTiles.length=0;const r=Object.keys(w).map(Number);let s,o,l,d,u,g,c,E,I,C,A;for(r.sort(function(e,t){return e===p?1:t===p?-1:e>t?1:e<t?-1:0}),u=0,g=r.length;u<g;++u){d=r[u],l=T.getTilePixelSize(d,n,a),o=(s=f.getResolution(d))/x,E=y*T.getGutter(a),I=w[d];for(const e in I)D=I[e],S=((c=f.getTileCoordExtent(D.getTileCoord(),j))[0]-v[0])/x*y/R,q=(v[3]-c[3])/x*y/R,C=l[0]*o/R,A=l[1]*o/R,this.drawTileImage(D,t,i,S,q,C,A,E,p===d),this.renderedTiles.push(D)}this.renderedRevision=m,this.renderedResolution=x*n/y*R,this.renderedExtent_=v}const b=this.renderedResolution/d,M=(0,c.compose)(this.imageTransform_,n*r[0]/2,n*r[1]/2,b,b,0,(this.renderedExtent_[0]-u[0])/this.renderedResolution*n,(u[1]-this.renderedExtent_[3])/this.renderedResolution*n);return(0,c.compose)(this.coordinateToCanvasPixelTransform,n*r[0]/2-M[4],n*r[1]/2-M[5],n/d,-n/d,0,-u[0],-u[1]),this.updateUsedTiles(t.usedTiles,T,p,_),this.manageTilePyramid(t,T,f,n,a,E,p,g.getPreload()),this.scheduleExpireCache(t,T),this.renderedTiles.length>0},m.prototype.drawTileImage=function(t,i,n,r,s,o,a,l,d){const h=t.getImage(this.getLayer());if(!h)return;const u=(0,e.getUid)(this),g=d?t.getAlpha(u,i.time):1;1!==g||this.getLayer().getSource().getOpaque(i.viewState.projection)||this.context.clearRect(r,s,o,a);const c=g!==this.context.globalAlpha;c&&(this.context.save(),this.context.globalAlpha=g),this.context.drawImage(h,l,l,h.width-2*l,h.height-2*l,r,s,o,a),c&&this.context.restore(),1!==g?i.animate=!0:d&&t.endTransition(u)},m.prototype.getImage=function(){const e=this.context;return e?e.canvas:null},m.prototype.getLayer,m.prototype.getImageTransform=function(){return this.imageTransform_},exports.default=m;
},{"../../index.js":80,"../../LayerType.js":130,"../../TileRange.js":250,"../../TileState.js":199,"../../ViewHint.js":222,"../../dom.js":192,"../../extent.js":159,"../canvas/IntermediateCanvas.js":238,"../../transform.js":237}],349:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(){};t.prototype.getReplay=function(t,e){},t.prototype.isEmpty=function(){},exports.default=t;
},{}],327:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};
},{}],360:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawTextOnPath=a;var t=require("../../math.js");function a(a,e,h,r,o,s,n,M){const l=[],p=a[e]>a[h-r],u=o.length;let c,i,P,f=a[e],I=a[e+1],w=a[e+=r],d=a[e+1],q=0,v=Math.sqrt(Math.pow(w-f,2)+Math.pow(d-I,2)),x="",b=0;for(let j=0;j<u;++j){i=p?u-j-1:j;const O=o.charAt(i),_=s(x=p?O+x:x+O)-b;b+=_;const g=n+_/2;for(;e<h-r&&q+v<g;)f=w,I=d,w=a[e+=r],d=a[e+1],q+=v,v=Math.sqrt(Math.pow(w-f,2)+Math.pow(d-I,2));const m=g-q;let y=Math.atan2(d-I,w-f);if(p&&(y+=y>0?-Math.PI:Math.PI),void 0!==P){let t=y-P;if(t+=t>Math.PI?-2*Math.PI:t<-Math.PI?2*Math.PI:0,Math.abs(t)>M)return null}const A=m/v,T=(0,t.lerp)(f,w,A),k=(0,t.lerp)(I,d,A);P==y?(p&&(c[0]=T,c[1]=k,c[2]=_/2),c[4]=x):(b=_,c=[T,k,_/2,y,x=O],p?l.unshift(c):l.push(c),P=y),n+=_}return l}
},{"../../math.js":160}],355:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},E=exports.fillInstruction=[t.FILL],e=exports.strokeInstruction=[t.STROKE],_=exports.beginPathInstruction=[t.BEGIN_PATH],s=exports.closePathInstruction=[t.CLOSE_PATH];exports.default=t;
},{}],328:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEXT_ALIGN=exports.ORDER=void 0;var e=require("../render/ReplayType.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}const d=exports.ORDER=[t.default.POLYGON,t.default.CIRCLE,t.default.LINE_STRING,t.default.IMAGE,t.default.TEXT,t.default.DEFAULT],a=exports.TEXT_ALIGN={};a.left=0,a.end=0,a.center=.5,a.right=1,a.start=1,a.top=0,a.middle=.5,a.hanging=.2,a.alphabetic=.8,a.ideographic=.8,a.bottom=1;
},{"../render/ReplayType.js":327}],350:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../../functions.js"),i=require("../../array.js"),n=require("../../colorlike.js"),s=require("../../extent.js"),o=require("../../extent/Relationship.js"),r=S(o),l=require("../../geom/GeometryType.js"),a=S(l),h=require("../../geom/flat/inflate.js"),u=require("../../geom/flat/length.js"),c=require("../../geom/flat/textpath.js"),d=require("../../geom/flat/transform.js"),f=require("../../has.js"),p=require("../../obj.js"),y=require("../VectorContext.js"),g=S(y),_=require("../canvas.js"),m=require("../canvas/Instruction.js"),E=S(m),x=require("../replay.js"),L=require("../../transform.js");function S(t){return t&&t.__esModule?t:{default:t}}const T=function(t,e,i,n,s,o){g.default.call(this),this.declutterTree=o,this.tolerance=t,this.maxExtent=e,this.overlaps=s,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.fillOrigin_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=(0,L.create)(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0};(0,t.inherits)(T,g.default);const C=(0,s.createEmpty)(),I=(0,L.create)();T.prototype.replayTextBackground_=function(t,e,i,n,s,o,r){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.fillOrigin_=o[2],this.fill_(t)),r&&(this.setStrokeStyle_(t,r),t.stroke())},T.prototype.replayImage_=function(t,e,i,n,o,r,l,a,h,u,c,d,f,p,y,g,m,E){const x=m||E;e-=o*=f,i-=r*=f;const S=y+u>n.width?n.width-u:y,T=a+c>n.height?n.height-c:a,O=g[3]+S*f+g[1],k=g[0]+T*f+g[2],D=e-g[3],b=i-g[0];let v,G,M,R;(x||0!==d)&&(v=[D,b],G=[D+O,b],M=[D+O,b+k],R=[D,b+k]);let N=null;if(0!==d){const t=e+o,n=i+r;N=(0,L.compose)(I,t,n,1,1,d,-t,-n),(0,s.createOrUpdateEmpty)(C),(0,s.extendCoordinate)(C,(0,L.apply)(I,v)),(0,s.extendCoordinate)(C,(0,L.apply)(I,G)),(0,s.extendCoordinate)(C,(0,L.apply)(I,M)),(0,s.extendCoordinate)(C,(0,L.apply)(I,R))}else(0,s.createOrUpdate)(D,b,D+O,b+k,C);const q=t.canvas,j=E?E[2]*f/2:0,F=C[0]-j<=q.width&&C[2]+j>=0&&C[1]-j<=q.height&&C[3]+j>=0;if(p&&(e=Math.round(e),i=Math.round(i)),l){if(!F&&1==l[4])return;(0,s.extend)(l,C);const o=F?[t,N?N.slice(0):null,h,n,u,c,S,T,e,i,f]:null;o&&x&&o.push(m,E,v,G,M,R),l.push(o)}else F&&(x&&this.replayTextBackground_(t,v,G,M,R,m,E),(0,_.drawImage)(t,N,h,n,u,c,S,T,e,i,f))},T.prototype.applyPixelRatio=function(t){const e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},T.prototype.appendFlatCoordinates=function(t,e,i,n,o,l){let a=this.coordinates.length;const h=this.getBufferedMaxExtent();l&&(e+=n);const u=[t[e],t[e+1]],c=[NaN,NaN];let d,f,p,y=!0;for(d=e+n;d<i;d+=n)c[0]=t[d],c[1]=t[d+1],(p=(0,s.coordinateRelationship)(h,c))!==f?(y&&(this.coordinates[a++]=u[0],this.coordinates[a++]=u[1]),this.coordinates[a++]=c[0],this.coordinates[a++]=c[1],y=!1):p===r.default.INTERSECTING?(this.coordinates[a++]=c[0],this.coordinates[a++]=c[1],y=!1):y=!0,u[0]=c[0],u[1]=c[1],f=p;return(o&&y||d===e+n)&&(this.coordinates[a++]=u[0],this.coordinates[a++]=u[1]),a},T.prototype.drawCustomCoordinates_=function(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o],l=this.appendFlatCoordinates(t,e,r,n,!1,!1);s.push(l),e=r}return e},T.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);const n=t.getType(),s=t.getStride(),o=this.coordinates.length;let r,l,u,c,d;if(n==a.default.MULTI_POLYGON){r=(t=t).getOrientedFlatCoordinates(),c=[];const e=t.getEndss();d=0;for(let t=0,i=e.length;t<i;++t){const i=[];d=this.drawCustomCoordinates_(r,d,e[t],s,i),c.push(i)}this.instructions.push([E.default.CUSTOM,o,c,t,i,h.inflateMultiCoordinatesArray])}else n==a.default.POLYGON||n==a.default.MULTI_LINE_STRING?(u=[],r=n==a.default.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(r,0,t.getEnds(),s,u),this.instructions.push([E.default.CUSTOM,o,u,t,i,h.inflateCoordinatesArray])):n==a.default.LINE_STRING||n==a.default.MULTI_POINT?(r=t.getFlatCoordinates(),l=this.appendFlatCoordinates(r,0,r.length,s,!1,!1),this.instructions.push([E.default.CUSTOM,o,l,t,i,h.inflateCoordinates])):n==a.default.POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),l=this.coordinates.length,this.instructions.push([E.default.CUSTOM,o,l,t,i]));this.endGeometry(t,e)},T.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[E.default.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[E.default.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},T.prototype.fill_=function(t){if(this.fillOrigin_){const e=(0,L.apply)(this.renderedTransform_,this.fillOrigin_.slice());t.translate(e[0],e[1]),t.rotate(this.viewRotation_)}t.fill(),this.fillOrigin_&&t.setTransform.apply(t,_.resetTransform)},T.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],f.CANVAS_LINE_DASH&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},T.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){const i=t[4];if(1==i||i==t.length-5){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(i)){this.declutterTree.insert(i);for(let e=5,i=t.length;e<i;++e){const i=t[e];i&&(i.length>11&&this.replayTextBackground_(i[0],i[13],i[14],i[15],i[16],i[11],i[12]),_.drawImage.apply(void 0,i))}}t.length=5,(0,s.createOrUpdateEmpty)(t)}}},T.prototype.replay_=function(e,n,o,r,l,a){let h;this.pixelCoordinates_&&(0,i.equals)(n,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=(0,d.transform2D)(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),(0,L.setFromArray)(this.renderedTransform_,n));const f=!(0,p.isEmpty)(o);let y=0;const g=r.length;let m,S,T,C,I,O,k,D,b,v=0,G=0,M=0,R=null,N=null;const q=this.coordinateCache_,j=this.viewRotation_,F={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:j},w=this.instructions!=r||this.overlaps?0:200;let P,W,Y;for(;y<g;){const i=r[y];switch(i[0]){case E.default.BEGIN_GEOMETRY:P=i[1],f&&o[(0,t.getUid)(P).toString()]||!P.getGeometry()?y=i[2]:void 0===a||(0,s.intersects)(a,P.getGeometry().getExtent())?++y:y=i[2]+1;break;case E.default.BEGIN_PATH:G>w&&(this.fill_(e),G=0),M>w&&(e.stroke(),M=0),G||M||(e.beginPath(),C=I=NaN),++y;break;case E.default.CIRCLE:const n=h[v=i[1]],r=h[v+1],d=h[v+2]-n,p=h[v+3]-r,g=Math.sqrt(d*d+p*p);e.moveTo(n+g,r),e.arc(n,r,g,0,2*Math.PI,!0),++y;break;case E.default.CLOSE_PATH:e.closePath(),++y;break;case E.default.CUSTOM:v=i[1],m=i[2];const L=i[3],A=i[4],U=6==i.length?i[5]:void 0;F.geometry=L,F.feature=P,y in q||(q[y]=[]);const B=q[y];U?U(h,v,m,2,B):(B[0]=h[v],B[1]=h[v+1],B.length=2),A(B,F),++y;break;case E.default.DRAW_IMAGE:v=i[1],m=i[2],b=i[3],S=i[4],T=i[5],D=l?null:i[6];const J=i[7],H=i[8],K=i[9],V=i[10],X=i[11];let z=i[12];const Q=i[13],Z=i[14],$=i[15];let tt,et,it;for(i.length>16?(tt=i[16],et=i[17],it=i[18]):(tt=_.defaultPadding,et=it=!1),X&&(z+=j);v<m;v+=2)this.replayImage_(e,h[v],h[v+1],b,S,T,D,J,H,K,V,z,Q,Z,$,tt,et?R:null,it?N:null);this.renderDeclutter_(D,P),++y;break;case E.default.DRAW_CHARS:const nt=i[1],st=i[2],ot=i[3];D=l?null:i[4];const rt=i[5],lt=i[6],at=i[7],ht=i[8],ut=i[9],ct=i[10],dt=i[11],ft=i[12],pt=i[13],yt=i[14],gt=(0,u.lineStringLength)(h,nt,st,2),_t=ht(ft);if(rt||_t<=gt){const t=this.textStates[pt].textAlign,i=(gt-_t)*x.TEXT_ALIGN[t],n=(0,c.drawTextOnPath)(h,nt,st,2,ft,ht,i,at);if(n){let t,i,s,o,r;if(ct)for(t=0,i=n.length;t<i;++t)s=(r=n[t])[4],o=this.getImage(s,pt,"",ct),S=r[2]+dt,T=ot*o.height+2*(.5-ot)*dt-ut,this.replayImage_(e,r[0],r[1],o,S,T,D,o.height,1,0,0,r[3],yt,!1,o.width,_.defaultPadding,null,null);if(lt)for(t=0,i=n.length;t<i;++t)s=(r=n[t])[4],o=this.getImage(s,pt,lt,""),S=r[2],T=ot*o.height-ut,this.replayImage_(e,r[0],r[1],o,S,T,D,o.height,1,0,0,r[3],yt,!1,o.width,_.defaultPadding,null,null)}}this.renderDeclutter_(D,P),++y;break;case E.default.END_GEOMETRY:if(void 0!==l){const t=l(P=i[1]);if(t)return t}++y;break;case E.default.FILL:w?G++:this.fill_(e),++y;break;case E.default.MOVE_TO_LINE_TO:for(v=i[1],m=i[2],W=h[v],k=(Y=h[v+1])+.5|0,(O=W+.5|0)===C&&k===I||(e.moveTo(W,Y),C=O,I=k),v+=2;v<m;v+=2)O=(W=h[v])+.5|0,k=(Y=h[v+1])+.5|0,v!=m-2&&O===C&&k===I||(e.lineTo(W,Y),C=O,I=k);++y;break;case E.default.SET_FILL_STYLE:R=i,this.fillOrigin_=i[2],G&&(this.fill_(e),G=0,M&&(e.stroke(),M=0)),e.fillStyle=i[1],++y;break;case E.default.SET_STROKE_STYLE:N=i,M&&(e.stroke(),M=0),this.setStrokeStyle_(e,i),++y;break;case E.default.STROKE:w?M++:e.stroke(),++y;break;default:++y}}G&&this.fill_(e),M&&e.stroke()},T.prototype.replay=function(t,e,i,n){this.viewRotation_=i,this.replay_(t,e,n,this.instructions,void 0,void 0)},T.prototype.replayHitDetection=function(t,e,i,n,s,o){return this.viewRotation_=i,this.replay_(t,e,n,this.hitDetectionInstructions,s,o)},T.prototype.reverseHitDetectionInstructions=function(){const t=this.hitDetectionInstructions;let e;t.reverse();const n=t.length;let s,o,r=-1;for(e=0;e<n;++e)(o=(s=t[e])[0])==E.default.END_GEOMETRY?r=e:o==E.default.BEGIN_GEOMETRY&&(s[2]=e,(0,i.reverseSubArray)(this.hitDetectionInstructions,r,e),r=-1)},T.prototype.setFillStrokeStyle=function(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=(0,n.asColorLike)(e||_.defaultFillStyle)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=(0,n.asColorLike)(t||_.defaultStrokeStyle);const s=e.getLineCap();i.lineCap=void 0!==s?s:_.defaultLineCap;const o=e.getLineDash();i.lineDash=o?o.slice():_.defaultLineDash;const r=e.getLineDashOffset();i.lineDashOffset=r||_.defaultLineDashOffset;const l=e.getLineJoin();i.lineJoin=void 0!==l?l:_.defaultLineJoin;const a=e.getWidth();i.lineWidth=void 0!==a?a:_.defaultLineWidth;const h=e.getMiterLimit();i.miterLimit=void 0!==h?h:_.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},T.prototype.createFill=function(t,e){const i=t.fillStyle,n=[E.default.SET_FILL_STYLE,i];if("string"!=typeof i){const t=e.getExtent();n.push([t[0],t[3]])}return n},T.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},T.prototype.createStroke=function(t){return[E.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},T.prototype.updateFillStyle=function(t,e,i){const n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=n)},T.prototype.updateStrokeStyle=function(t,e){const n=t.strokeStyle,s=t.lineCap,o=t.lineDash,r=t.lineDashOffset,l=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=s||o!=t.currentLineDash&&!(0,i.equals)(t.currentLineDash,o)||t.currentLineDashOffset!=r||t.currentLineJoin!=l||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=s,t.currentLineDash=o,t.currentLineDashOffset=r,t.currentLineJoin=l,t.currentLineWidth=a,t.currentMiterLimit=h)},T.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const i=[E.default.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},T.prototype.finish=e.UNDEFINED,T.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,s.clone)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,s.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},exports.default=T;
},{"../../index.js":80,"../../functions.js":195,"../../array.js":209,"../../colorlike.js":314,"../../extent.js":159,"../../extent/Relationship.js":274,"../../geom/GeometryType.js":226,"../../geom/flat/inflate.js":281,"../../geom/flat/length.js":285,"../../geom/flat/textpath.js":360,"../../geom/flat/transform.js":311,"../../has.js":256,"../../obj.js":82,"../VectorContext.js":315,"../canvas.js":241,"../canvas/Instruction.js":355,"../replay.js":328,"../../transform.js":237}],351:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),i=require("../canvas/Instruction.js"),h=o(i),e=require("../canvas/Replay.js"),s=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const n=function(t,i,h,e,o,n){s.default.call(this,t,i,h,e,o,n),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.snapToPixel_=void 0,this.width_=void 0};(0,t.inherits)(n,s.default),n.prototype.drawCoordinates_=function(t,i,h,e){return this.appendFlatCoordinates(t,i,h,e,!1,!1)},n.prototype.drawPoint=function(t,i){if(!this.image_)return;this.beginGeometry(t,i);const e=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(e,0,e.length,s);this.instructions.push([h.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([h.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)},n.prototype.drawMultiPoint=function(t,i){if(!this.image_)return;this.beginGeometry(t,i);const e=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(e,0,e.length,s);this.instructions.push([h.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([h.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)},n.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.snapToPixel_=void 0,this.width_=void 0},n.prototype.setImageStyle=function(t,i){const h=t.getAnchor(),e=t.getSize(),s=t.getHitDetectionImage(1),o=t.getImage(1),n=t.getOrigin();this.anchorX_=h[0],this.anchorY_=h[1],this.declutterGroup_=i,this.hitDetectionImage_=s,this.image_=o,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.snapToPixel_=t.getSnapToPixel(),this.width_=e[0]},exports.default=n;
},{"../../index.js":80,"../canvas/Instruction.js":355,"../canvas/Replay.js":350}],352:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),e=require("../canvas/Instruction.js"),i=o(e),s=require("../canvas/Replay.js"),n=o(s);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t,e,i,s,o,r){n.default.call(this,t,e,i,s,o,r)};(0,t.inherits)(r,n.default),r.prototype.drawFlatCoordinates_=function(t,e,s,n){const o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,s,n,!1,!1),a=[i.default.MOVE_TO_LINE_TO,o,r];return this.instructions.push(a),this.hitDetectionInstructions.push(a),s},r.prototype.drawLineString=function(t,s){const n=this.state,o=n.strokeStyle,r=n.lineWidth;if(void 0===o||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,s),this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],e.beginPathInstruction);const a=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(a,0,a.length,h),this.hitDetectionInstructions.push(e.strokeInstruction),this.endGeometry(t,s)},r.prototype.drawMultiLineString=function(t,s){const n=this.state,o=n.strokeStyle,r=n.lineWidth;if(void 0===o||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,s),this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],e.beginPathInstruction);const a=t.getEnds(),h=t.getFlatCoordinates(),l=t.getStride();let u=0;for(let t=0,e=a.length;t<e;++t)u=this.drawFlatCoordinates_(h,u,a[t],l);this.hitDetectionInstructions.push(e.strokeInstruction),this.endGeometry(t,s)},r.prototype.finish=function(){const t=this.state;void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(e.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null},r.prototype.applyStroke=function(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(e.strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,n.default.prototype.applyStroke.call(this,t),this.instructions.push(e.beginPathInstruction)},exports.default=r;
},{"../../index.js":80,"../canvas/Instruction.js":355,"../canvas/Replay.js":350}],353:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../index.js"),i=require("../../color.js"),e=require("../../geom/flat/simplify.js"),s=require("../canvas.js"),n=require("../canvas/Instruction.js"),o=h(n),r=require("../canvas/Replay.js"),l=h(r);function h(t){return t&&t.__esModule?t:{default:t}}const u=function(t,i,e,s,n,o){l.default.call(this,t,i,e,s,n,o)};(0,t.inherits)(u,l.default),u.prototype.drawFlatCoordinatess_=function(t,i,e,s){const r=this.state,l=void 0!==r.fillStyle,h=void 0!=r.strokeStyle,u=e.length;this.instructions.push(n.beginPathInstruction),this.hitDetectionInstructions.push(n.beginPathInstruction);for(let r=0;r<u;++r){const l=e[r],u=this.coordinates.length,c=this.appendFlatCoordinates(t,i,l,s,!0,!h),a=[o.default.MOVE_TO_LINE_TO,u,c];this.instructions.push(a),this.hitDetectionInstructions.push(a),h&&(this.instructions.push(n.closePathInstruction),this.hitDetectionInstructions.push(n.closePathInstruction)),i=l}return this.hitDetectionInstructions.push(n.fillInstruction),l&&this.instructions.push(n.fillInstruction),h&&(this.instructions.push(n.strokeInstruction),this.hitDetectionInstructions.push(n.strokeInstruction)),i},u.prototype.drawCircle=function(t,e){const r=this.state,l=r.fillStyle,h=r.strokeStyle;if(void 0===l&&void 0===h)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);const u=t.getFlatCoordinates(),c=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(u,0,u.length,c,!1,!1);const d=[o.default.CIRCLE,a];this.instructions.push(n.beginPathInstruction,d),this.hitDetectionInstructions.push(n.beginPathInstruction,d),this.hitDetectionInstructions.push(n.fillInstruction),void 0!==r.fillStyle&&this.instructions.push(n.fillInstruction),void 0!==r.strokeStyle&&(this.instructions.push(n.strokeInstruction),this.hitDetectionInstructions.push(n.strokeInstruction)),this.endGeometry(t,e)},u.prototype.drawPolygon=function(t,e){const n=this.state;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const r=t.getEnds(),l=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(l,0,r,h),this.endGeometry(t,e)},u.prototype.drawMultiPolygon=function(t,e){const n=this.state,r=n.fillStyle,l=n.strokeStyle;if(void 0===r&&void 0===l)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const h=t.getEndss(),u=t.getOrientedFlatCoordinates(),c=t.getStride();let a=0;for(let t=0,i=h.length;t<i;++t)a=this.drawFlatCoordinatess_(u,a,h[t],c);this.endGeometry(t,e)},u.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const i=this.coordinates;for(let s=0,n=i.length;s<n;++s)i[s]=(0,e.snap)(i[s],t)}},u.prototype.setFillStrokeStyles_=function(t){const i=this.state;void 0!==i.fillStyle&&this.updateFillStyle(i,this.createFill,t),void 0!==i.strokeStyle&&this.updateStrokeStyle(i,this.applyStroke)},exports.default=u;
},{"../../index.js":80,"../../color.js":231,"../../geom/flat/simplify.js":287,"../canvas.js":241,"../canvas/Instruction.js":355,"../canvas/Replay.js":350}],359:[function(require,module,exports) {
"use strict";function t(t,e,o,r,s){let n,c,i,u,a,d,h,f,l,p,v=o,M=o,x=0,_=0,b=o;for(c=o;c<r;c+=s){const o=e[c],r=e[c+1];void 0!==a&&(l=o-a,p=r-d,u=Math.sqrt(l*l+p*p),void 0!==h&&(_+=i,(n=Math.acos((h*l+f*p)/(i*u)))>t&&(_>x&&(x=_,v=b,M=c),_=0,b=c-s)),i=u,h=l,f=p),a=o,d=r}return(_+=u)>x?[b,c]:[v,M]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.matchingChunk=t;
},{}],239:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINT:"point",LINE:"line"};
},{}],354:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.measureTextWidths=p;var t=require("../../index.js"),e=require("../../colorlike.js"),i=require("../../dom.js"),s=require("../../extent.js"),l=require("../../geom/flat/straightchunk.js"),n=require("../../geom/GeometryType.js"),a=_(n),o=require("../../has.js"),h=require("../canvas.js"),r=require("../canvas/Instruction.js"),f=_(r),d=require("../canvas/Replay.js"),u=_(d),c=require("../replay.js"),g=require("../../style/TextPlacement.js"),x=_(g);function _(t){return t&&t.__esModule?t:{default:t}}const S=function(t,e,i,s,l,n){u.default.call(this,t,e,i,s,l,n),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},h.labelCache.prune()};function p(t,e,i){const s=e.length;let l=0;for(let n=0;n<s;++n){const s=(0,h.measureTextWidth)(t,e[n]);l=Math.max(l,s),i.push(s)}return l}(0,t.inherits)(S,u.default),S.prototype.drawText=function(t,e){const i=this.textFillState_,n=this.textStrokeState_,o=this.textState_;if(""===this.text_||!o||!i&&!n)return;let h=this.coordinates.length;const r=t.getType();let f,d,u=null,c=2,g=2;if(o.placement===x.default.LINE){if(!(0,s.intersects)(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(u=t.getFlatCoordinates(),g=t.getStride(),r==a.default.LINE_STRING)i=[u.length];else if(r==a.default.MULTI_LINE_STRING)i=t.getEnds();else if(r==a.default.POLYGON)i=t.getEnds().slice(0,1);else if(r==a.default.MULTI_POLYGON){const e=t.getEndss();for(i=[],f=0,d=e.length;f<d;++f)i.push(e[f][0])}this.beginGeometry(t,e);const n=o.textAlign;let x,_=0;for(let t=0,e=i.length;t<e;++t){if(void 0==n){const e=(0,l.matchingChunk)(o.maxAngle,u,_,i[t],g);_=e[0],x=e[1]}else x=i[t];for(f=_;f<x;f+=g)this.coordinates.push(u[f],u[f+1]);c=this.coordinates.length,_=i[t],this.drawChars_(h,c,this.declutterGroup_),h=c}this.endGeometry(t,e)}else{const i=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),s=i.width/this.pixelRatio;switch(r){case a.default.POINT:case a.default.MULTI_POINT:c=(u=t.getFlatCoordinates()).length;break;case a.default.LINE_STRING:u=t.getFlatMidpoint();break;case a.default.CIRCLE:u=t.getCenter();break;case a.default.MULTI_LINE_STRING:c=(u=t.getFlatMidpoints()).length;break;case a.default.POLYGON:if(u=t.getFlatInteriorPoint(),!o.overflow&&u[2]/this.resolution<s)return;g=3;break;case a.default.MULTI_POLYGON:const e=t.getFlatInteriorPoints();for(u=[],f=0,d=e.length;f<d;f+=3)(o.overflow||e[f+2]/this.resolution>=s)&&u.push(e[f],e[f+1]);if(0==(c=u.length))return}c=this.appendFlatCoordinates(u,0,c,g,!1,!1),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(i,h,c),this.endGeometry(t,e)}},S.prototype.getImage=function(t,e,s,l){let n;const a=l+e+t+s+this.pixelRatio;if(!h.labelCache.containsKey(a)){const r=l?this.strokeStates[l]||this.textStrokeState_:null,f=s?this.fillStates[s]||this.textFillState_:null,d=this.textStates[e]||this.textState_,u=this.pixelRatio,g=d.scale*u,x=c.TEXT_ALIGN[d.textAlign||h.defaultTextAlign],_=l&&r.lineWidth?r.lineWidth:0,S=t.split("\n"),k=S.length,y=[],m=p(d.font,S,y),L=(0,h.measureTextHeight)(d.font),T=L*k,I=m+_,A=(0,i.createCanvasContext2D)(Math.ceil(I*g),Math.ceil((T+_)*g));n=A.canvas,h.labelCache.set(a,n),1!=g&&A.scale(g,g),A.font=d.font,l&&(A.strokeStyle=r.strokeStyle,A.lineWidth=_*(o.SAFARI?g:1),A.lineCap=r.lineCap,A.lineJoin=r.lineJoin,A.miterLimit=r.miterLimit,o.CANVAS_LINE_DASH&&r.lineDash.length&&(A.setLineDash(r.lineDash),A.lineDashOffset=r.lineDashOffset)),s&&(A.fillStyle=f.fillStyle),A.textBaseline="middle",A.textAlign="center";const F=.5-x,O=x*n.width/g+F*_;let C;if(l)for(C=0;C<k;++C)A.strokeText(S[C],O+F*y[C],.5*(_+L)+C*L);if(s)for(C=0;C<k;++C)A.fillText(S[C],O+F*y[C],.5*(_+L)+C*L)}return h.labelCache.get(a)},S.prototype.drawTextImage_=function(t,e,i){const s=this.textState_,l=this.textStrokeState_,n=this.pixelRatio,a=c.TEXT_ALIGN[s.textAlign||h.defaultTextAlign],o=c.TEXT_ALIGN[s.textBaseline],r=l&&l.lineWidth?l.lineWidth:0,d=a*t.width/n+2*(.5-a)*r,u=o*t.height/n+2*(.5-o)*r;this.instructions.push([f.default.DRAW_IMAGE,e,i,t,(d-this.textOffsetX_)*n,(u-this.textOffsetY_)*n,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,!0,t.width,s.padding==h.defaultPadding?h.defaultPadding:s.padding.map(function(t){return t*n}),!!s.backgroundFill,!!s.backgroundStroke]),this.hitDetectionInstructions.push([f.default.DRAW_IMAGE,e,i,t,(d-this.textOffsetX_)*n,(u-this.textOffsetY_)*n,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/n,!0,t.width,s.padding,!!s.backgroundFill,!!s.backgroundStroke])},S.prototype.drawChars_=function(t,e,i){const s=this.textStrokeState_,l=this.textState_,n=this.textFillState_,a=this.strokeKey_;s&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:s.strokeStyle,lineCap:s.lineCap,lineDashOffset:s.lineDashOffset,lineWidth:s.lineWidth,lineJoin:s.lineJoin,miterLimit:s.miterLimit,lineDash:s.lineDash}));const o=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:l.font,textAlign:l.textAlign||h.defaultTextAlign,scale:l.scale});const r=this.fillKey_;n&&(r in this.fillStates||(this.fillStates[r]={fillStyle:n.fillStyle}));const d=this.pixelRatio,u=c.TEXT_ALIGN[l.textBaseline],g=this.textOffsetY_*d,x=this.text_,_=l.font,S=l.scale,p=s?s.lineWidth*S/2:0;let k=this.widths_[_];k||(this.widths_[_]=k={}),this.instructions.push([f.default.DRAW_CHARS,t,e,u,i,l.overflow,r,l.maxAngle,function(t){let e=k[t];return e||(e=k[t]=(0,h.measureTextWidth)(_,t)),e*S*d},g,a,p*d,x,o,1]),this.hitDetectionInstructions.push([f.default.DRAW_CHARS,t,e,u,i,l.overflow,r,l.maxAngle,function(t){let e=k[t];return e||(e=k[t]=(0,h.measureTextWidth)(_,t)),e*S},g,a,p,x,o,1/d])},S.prototype.setTextStyle=function(i,s){let l,n,a;if(i){this.declutterGroup_=s;const o=i.getFill();o?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=(0,e.asColorLike)(o.getColor()||h.defaultFillStyle)):n=this.textFillState_=null;const r=i.getStroke();if(r){(a=this.textStrokeState_)||(a=this.textStrokeState_={});const t=r.getLineDash(),i=r.getLineDashOffset(),s=r.getWidth(),l=r.getMiterLimit();a.lineCap=r.getLineCap()||h.defaultLineCap,a.lineDash=t?t.slice():h.defaultLineDash,a.lineDashOffset=void 0===i?h.defaultLineDashOffset:i,a.lineJoin=r.getLineJoin()||h.defaultLineJoin,a.lineWidth=void 0===s?h.defaultLineWidth:s,a.miterLimit=void 0===l?h.defaultMiterLimit:l,a.strokeStyle=(0,e.asColorLike)(r.getColor()||h.defaultStrokeStyle)}else a=this.textStrokeState_=null;l=this.textState_;const f=i.getFont()||h.defaultFont;(0,h.checkFont)(f);const d=i.getScale();l.overflow=i.getOverflow(),l.font=f,l.maxAngle=i.getMaxAngle(),l.placement=i.getPlacement(),l.textAlign=i.getTextAlign(),l.textBaseline=i.getTextBaseline()||h.defaultTextBaseline,l.backgroundFill=i.getBackgroundFill(),l.backgroundStroke=i.getBackgroundStroke(),l.padding=i.getPadding()||h.defaultPadding,l.scale=void 0===d?1:d;const u=i.getOffsetX(),c=i.getOffsetY(),g=i.getRotateWithView(),x=i.getRotation();this.text_=i.getText()||"",this.textOffsetX_=void 0===u?0:u,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===x?0:x,this.strokeKey_=a?("string"==typeof a.strokeStyle?a.strokeStyle:(0,t.getUid)(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=l.font+l.scale+(l.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+(0,t.getUid)(n.fillStyle):""}else this.text_=""},exports.default=S;
},{"../../index.js":80,"../../colorlike.js":314,"../../dom.js":192,"../../extent.js":159,"../../geom/flat/straightchunk.js":359,"../../geom/GeometryType.js":226,"../../has.js":256,"../canvas.js":241,"../canvas/Instruction.js":355,"../canvas/Replay.js":350,"../replay.js":328,"../../style/TextPlacement.js":239}],324:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCircleArray=q,exports.replayDeclutter=C;var e=require("../../index.js"),t=require("../../array.js"),r=require("../../dom.js"),n=require("../../extent.js"),o=require("../../geom/flat/transform.js"),i=require("../../obj.js"),s=require("../ReplayGroup.js"),a=R(s),l=require("../ReplayType.js"),u=R(l),c=require("../canvas/Replay.js"),f=R(c),p=require("../canvas/ImageReplay.js"),h=R(p),y=require("../canvas/LineStringReplay.js"),d=R(y),_=require("../canvas/PolygonReplay.js"),x=R(_),m=require("../canvas/TextReplay.js"),g=R(m),v=require("../replay.js"),j=require("../../transform.js");function R(e){return e&&e.__esModule?e:{default:e}}const T={Circle:x.default,Default:f.default,Image:h.default,LineString:d.default,Polygon:x.default,Text:g.default},I=function(e,t,n,o,i,s,l){a.default.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=t,this.overlaps_=i,this.pixelRatio_=o,this.resolution_=n,this.renderBuffer_=l,this.replaysByZIndex_={},this.hitDetectionContext_=(0,r.createCanvasContext2D)(1,1),this.hitDetectionTransform_=(0,j.create)()};(0,e.inherits)(I,a.default);const E={0:[[!0]]};function B(e,t,r){let n;const o=Math.floor(e.length/2);if(t>=o)for(n=o;n<t;n++)e[n][r]=!0;else if(t<o)for(n=t+1;n<o;n++)e[n][r]=!0}function q(e){if(void 0!==E[e])return E[e];const t=2*e+1,r=new Array(t);for(let e=0;e<t;e++)r[e]=new Array(t);let n=e,o=0,i=0;for(;n>=o;)B(r,e+n,e+o),B(r,e+o,e+n),B(r,e-o,e+n),B(r,e-n,e+o),B(r,e-n,e-o),B(r,e-o,e-n),B(r,e+o,e-n),B(r,e+n,e-o),2*((i+=1+2*++o)-n)+1>0&&(i+=1-2*(n-=1));return E[e]=r,r}function C(e,r,n){const o=Object.keys(e).map(Number).sort(t.numberSafeCompareFunction),i={};for(let t=0,s=o.length;t<s;++t){const s=e[o[t].toString()];for(let e=0,t=s.length;e<t;){const t=s[e++],o=s[e++];t.replay(r,o,n,i)}}}I.prototype.addDeclutter=function(e){let t=null;return this.declutterTree_&&(e?(t=this.declutterGroup_)[4]++:(t=this.declutterGroup_=(0,n.createEmpty)()).push(1)),t},I.prototype.clip=function(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()},I.prototype.hasReplays=function(e){for(const t in this.replaysByZIndex_){const r=this.replaysByZIndex_[t];for(let t=0,n=e.length;t<n;++t)if(e[t]in r)return!0}return!1},I.prototype.finish=function(){for(const e in this.replaysByZIndex_){const t=this.replaysByZIndex_[e];for(const e in t)t[e].finish()}},I.prototype.forEachFeatureAtCoordinate=function(e,r,o,i,s,a,l){const c=2*(i=Math.round(i))+1,f=(0,j.compose)(this.hitDetectionTransform_,i+.5,i+.5,1/r,-1/r,-o,-e[0],-e[1]),p=this.hitDetectionContext_;let h;p.canvas.width!==c||p.canvas.height!==c?(p.canvas.width=c,p.canvas.height=c):p.clearRect(0,0,c,c),void 0!==this.renderBuffer_&&(h=(0,n.createEmpty)(),(0,n.extendCoordinate)(h,e),(0,n.buffer)(h,r*(this.renderBuffer_+i),h));const y=q(i);let d,_;function x(e){const t=p.getImageData(0,0,c,c).data;for(let r=0;r<c;r++)for(let n=0;n<c;n++)if(y[r][n]&&t[4*(n*c+r)+3]>0){let t;return(!d||_!=u.default.IMAGE&&_!=u.default.TEXT||-1!==d.indexOf(e))&&(t=a(e)),t||void p.clearRect(0,0,c,c)}}this.declutterTree_&&(d=this.declutterTree_.all().map(function(e){return e.value}));const m=Object.keys(this.replaysByZIndex_).map(Number);let g,R,T,I,E;for(m.sort(t.numberSafeCompareFunction),g=m.length-1;g>=0;--g){const e=m[g].toString();for(T=this.replaysByZIndex_[e],R=v.ORDER.length-1;R>=0;--R)if(void 0!==(I=T[_=v.ORDER[R]]))if(!l||_!=u.default.IMAGE&&_!=u.default.TEXT){if(E=I.replayHitDetection(p,f,o,s,x,h))return E}else{const t=l[e];t?t.push(I,f.slice(0)):l[e]=[I,f.slice(0)]}}},I.prototype.getClipCoords=function(e){const t=this.maxExtent_,r=t[0],n=t[1],i=t[2],s=t[3],a=[r,n,r,s,i,s,i,n];return(0,o.transform2D)(a,0,8,2,e,a),a},I.prototype.getReplay=function(e,t){const r=void 0!==e?e.toString():"0";let n=this.replaysByZIndex_[r];void 0===n&&(n={},this.replaysByZIndex_[r]=n);let o=n[t];if(void 0===o){o=new(0,T[t])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),n[t]=o}return o},I.prototype.getReplays=function(){return this.replaysByZIndex_},I.prototype.isEmpty=function(){return(0,i.isEmpty)(this.replaysByZIndex_)},I.prototype.replay=function(e,r,n,o,i,s){const a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(t.numberSafeCompareFunction),e.save(),this.clip(e,r);const l=i||v.ORDER;let c,f,p,h,y,d;for(c=0,f=a.length;c<f;++c){const t=a[c].toString();for(y=this.replaysByZIndex_[t],p=0,h=l.length;p<h;++p){const i=l[p];if(void 0!==(d=y[i]))if(!s||i!=u.default.IMAGE&&i!=u.default.TEXT)d.replay(e,r,n,o);else{const e=s[t];e?e.push(d,r.slice(0)):s[t]=[d,r.slice(0)]}}}e.restore()},exports.default=I;
},{"../../index.js":80,"../../array.js":209,"../../dom.js":192,"../../extent.js":159,"../../geom/flat/transform.js":311,"../../obj.js":82,"../ReplayGroup.js":349,"../ReplayType.js":327,"../canvas/Replay.js":350,"../canvas/ImageReplay.js":351,"../canvas/LineStringReplay.js":352,"../canvas/PolygonReplay.js":353,"../canvas/TextReplay.js":354,"../replay.js":328,"../../transform.js":237}],323:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOrder=u,exports.getSquaredTolerance=s,exports.getTolerance=c,exports.renderFeature=T;var e=require("../index.js"),t=require("../ImageState.js"),n=g(t),l=require("../geom/GeometryType.js"),r=g(l),o=require("../render/ReplayType.js"),a=g(o);function g(e){return e&&e.__esModule?e:{default:e}}const d=.5,i={Point:m,LineString:I,Polygon:D,MultiPoint:E,MultiLineString:p,MultiPolygon:R,GeometryCollection:S,Circle:f};function u(t,n){return(0,e.getUid)(t)-(0,e.getUid)(n)}function s(e,t){const n=c(e,t);return n*n}function c(e,t){return d*e/t}function f(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(r||o){const g=e.getReplay(n.getZIndex(),a.default.CIRCLE);g.setFillStrokeStyle(r,o),g.drawCircle(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}function T(e,t,l,r,o,a){let g=!1;const d=l.getImage();if(d){let e=d.getImageState();e==n.default.LOADED||e==n.default.ERROR?d.unlistenImageChange(o,a):(e==n.default.IDLE&&d.load(),e=d.getImageState(),d.listenImageChange(o,a),g=!0)}return y(e,t,l,r),g}function y(e,t,n,l){const r=n.getGeometryFunction()(t);if(!r)return;const o=r.getSimplifiedGeometry(l);if(n.getRenderer())x(e,o,n,t);else{(0,i[o.getType()])(e,o,n,t)}}function x(e,t,n,l){if(t.getType()==r.default.GEOMETRY_COLLECTION){const r=t.getGeometries();for(let t=0,o=r.length;t<o;++t)x(e,r[t],n,l);return}e.getReplay(n.getZIndex(),a.default.DEFAULT).drawCustom(t,l,n.getRenderer())}function S(e,t,n,l){const r=t.getGeometriesArray();let o,a;for(o=0,a=r.length;o<a;++o){(0,i[r[o].getType()])(e,r[o],n,l)}}function I(e,t,n,l){const r=n.getStroke();if(r){const o=e.getReplay(n.getZIndex(),a.default.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawLineString(t,l)}const o=n.getText();if(o){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(o,e.addDeclutter(!1)),r.drawText(t,l)}}function p(e,t,n,l){const r=n.getStroke();if(r){const o=e.getReplay(n.getZIndex(),a.default.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawMultiLineString(t,l)}const o=n.getText();if(o){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(o,e.addDeclutter(!1)),r.drawText(t,l)}}function R(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(o||r){const g=e.getReplay(n.getZIndex(),a.default.POLYGON);g.setFillStrokeStyle(r,o),g.drawMultiPolygon(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}function m(e,t,l,r){const o=l.getImage();if(o){if(o.getImageState()!=n.default.LOADED)return;const g=e.getReplay(l.getZIndex(),a.default.IMAGE);g.setImageStyle(o,e.addDeclutter(!1)),g.drawPoint(t,r)}const g=l.getText();if(g){const n=e.getReplay(l.getZIndex(),a.default.TEXT);n.setTextStyle(g,e.addDeclutter(!!o)),n.drawText(t,r)}}function E(e,t,l,r){const o=l.getImage();if(o){if(o.getImageState()!=n.default.LOADED)return;const g=e.getReplay(l.getZIndex(),a.default.IMAGE);g.setImageStyle(o,e.addDeclutter(!1)),g.drawMultiPoint(t,r)}const g=l.getText();if(g){const n=e.getReplay(l.getZIndex(),a.default.TEXT);n.setTextStyle(g,e.addDeclutter(!!o)),n.drawText(t,r)}}function D(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(r||o){const g=e.getReplay(n.getZIndex(),a.default.POLYGON);g.setFillStrokeStyle(r,o),g.drawPolygon(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}
},{"../index.js":80,"../ImageState.js":191,"../geom/GeometryType.js":226,"../render/ReplayType.js":327}],127:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../LayerType.js"),r=E(t),n=require("../../ViewHint.js"),i=E(n),a=require("../../dom.js"),s=require("../../events.js"),o=require("../../events/EventType.js"),l=E(o),d=require("rbush"),h=E(d),u=require("../../extent.js"),c=require("../../render/EventType.js"),p=E(c),f=require("../../render/canvas.js"),g=require("../../render/canvas/ReplayGroup.js"),y=E(g),_=require("../canvas/Layer.js"),v=E(_),x=require("../vector.js");function E(e){return e&&e.__esModule?e:{default:e}}const R=function(e){v.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,h.default)(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,u.createEmpty)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=(0,a.createCanvasContext2D)(),(0,s.listen)(f.labelCache,l.default.CLEAR,this.handleFontsChanged_,this)};(0,e.inherits)(R,v.default),R.handles=function(e){return e.getType()===r.default.VECTOR},R.create=function(e,t){return new R(t)},R.prototype.disposeInternal=function(){(0,s.unlisten)(f.labelCache,l.default.CLEAR,this.handleFontsChanged_,this),v.default.prototype.disposeInternal.call(this)},R.prototype.composeFrame=function(e,t,r){const n=e.extent,i=e.pixelRatio,a=t.managed?e.skippedFeatureUids:{},s=e.viewState,o=s.projection,l=s.rotation,d=o.getExtent(),h=this.getLayer().getSource();let c=this.getTransform(e,0);this.preCompose(r,e,c);const g=t.extent,y=void 0!==g;y&&this.clip(r,e,g);const _=this.replayGroup_;if(_&&!_.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();const s=this.getLayer();let g,y=0,v=0;const x=1!==t.opacity,E=s.hasListener(p.default.RENDER);if(x||E){let e=r.canvas.width,t=r.canvas.height;if(l){const r=Math.round(Math.sqrt(e*e+t*t));y=(r-e)/2,v=(r-t)/2,e=t=r}this.context.canvas.width=e,this.context.canvas.height=t,g=this.context}else g=r;const R=g.globalAlpha;x||(g.globalAlpha=t.opacity),g!=r&&g.translate(y,v);const C=e.size[0]*i,m=e.size[1]*i;if((0,f.rotateAtOffset)(g,-l,C/2,m/2),_.replay(g,c,l,a),h.getWrapX()&&o.canWrapX()&&!(0,u.containsExtent)(d,n)){let t=n[0];const r=(0,u.getWidth)(d);let i,s=0;for(;t<d[0];)i=r*--s,c=this.getTransform(e,i),_.replay(g,c,l,a),t+=r;for(s=0,t=n[2];t>d[2];)i=r*++s,c=this.getTransform(e,i),_.replay(g,c,l,a),t-=r;c=this.getTransform(e,0)}if((0,f.rotateAtOffset)(g,l,C/2,m/2),g!=r){if(E&&this.dispatchRenderEvent(g,e,c),x){const e=r.globalAlpha;r.globalAlpha=t.opacity,r.drawImage(g.canvas,-y,-v),r.globalAlpha=e}else r.drawImage(g.canvas,-y,-v);g.translate(-y,-v)}x||(g.globalAlpha=R)}y&&r.restore(),this.postCompose(r,e,t,c)},R.prototype.forEachFeatureAtCoordinate=function(t,r,n,i,a){if(this.replayGroup_){const s=r.viewState.resolution,o=r.viewState.rotation,l=this.getLayer(),d={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,o,n,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in d))return d[r]=!0,i.call(a,t,l)},null)}},R.prototype.handleFontsChanged_=function(e){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},R.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},R.prototype.prepareFrame=function(e,t){const r=this.getLayer(),n=r.getSource(),a=e.viewHints[i.default.ANIMATING],s=e.viewHints[i.default.INTERACTING],o=r.getUpdateWhileAnimating(),l=r.getUpdateWhileInteracting();if(!this.dirty_&&!o&&a||!l&&s)return!0;const d=e.extent,h=e.viewState,c=h.projection,p=h.resolution,f=e.pixelRatio,g=r.getRevision(),_=r.getRenderBuffer();let v=r.getRenderOrder();void 0===v&&(v=x.defaultOrder);const E=(0,u.buffer)(d,_*p),R=h.projection.getExtent();if(n.getWrapX()&&h.projection.canWrapX()&&!(0,u.containsExtent)(R,e.extent)){const e=(0,u.getWidth)(R),t=Math.max((0,u.getWidth)(E)/2,e);E[0]=R[0]-t,E[2]=R[2]+t}if(!this.dirty_&&this.renderedResolution_==p&&this.renderedRevision_==g&&this.renderedRenderOrder_==v&&(0,u.containsExtent)(this.renderedExtent_,E))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;const C=new y.default((0,x.getTolerance)(p,f),E,p,f,n.getOverlaps(),this.declutterTree_,r.getRenderBuffer());n.loadFeatures(E,p,c);const m=function(e){let t;const n=e.getStyleFunction()||r.getStyleFunction();if(n&&(t=n(e,p)),t){const r=this.renderFeature(e,p,f,t,C);this.dirty_=this.dirty_||r}}.bind(this);if(v){const e=[];n.forEachFeatureInExtent(E,function(t){e.push(t)},this),e.sort(v);for(let t=0,r=e.length;t<r;++t)m(e[t])}else n.forEachFeatureInExtent(E,m,this);return C.finish(),this.renderedResolution_=p,this.renderedRevision_=g,this.renderedRenderOrder_=v,this.renderedExtent_=E,this.replayGroup_=C,this.replayGroupChanged=!0,!0},R.prototype.renderFeature=function(e,t,r,n,i){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let s=0,o=n.length;s<o;++s)a=(0,x.renderFeature)(i,e,n[s],(0,x.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this)||a;else a=(0,x.renderFeature)(i,e,n,(0,x.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this);return a},exports.default=R;
},{"../../index.js":80,"../../LayerType.js":130,"../../ViewHint.js":222,"../../dom.js":192,"../../events.js":193,"../../events/EventType.js":194,"rbush":319,"../../extent.js":159,"../../render/EventType.js":205,"../../render/canvas.js":241,"../../render/canvas/ReplayGroup.js":324,"../canvas/Layer.js":313,"../vector.js":323}],230:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};
},{}],128:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../index.js"),t=require("../../LayerType.js"),r=L(t),o=require("../../TileState.js"),i=L(o),n=require("../../dom.js"),l=require("../../events.js"),s=require("../../events/EventType.js"),a=L(s),d=require("rbush"),u=L(d),c=require("../../extent.js"),p=require("../../layer/VectorTileRenderType.js"),g=L(p),h=require("../../proj.js"),f=require("../../proj/Units.js"),y=L(f),T=require("../../render/ReplayType.js"),R=L(T),C=require("../../render/canvas.js"),E=require("../../render/canvas/ReplayGroup.js"),v=L(E),S=require("../../render/replay.js"),m=require("../canvas/TileLayer.js"),x=L(m),_=require("../vector.js"),j=require("../../transform.js");function L(e){return e&&e.__esModule?e:{default:e}}const O={image:[R.default.POLYGON,R.default.CIRCLE,R.default.LINE_STRING,R.default.IMAGE,R.default.TEXT],hybrid:[R.default.POLYGON,R.default.LINE_STRING]},q={image:[R.default.DEFAULT],hybrid:[R.default.IMAGE,R.default.TEXT,R.default.DEFAULT],vector:S.ORDER},G=function(e){this.context=null,x.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,u.default)(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=(0,j.create)(),this.zDirection=e.getRenderMode()==g.default.VECTOR?1:0,(0,l.listen)(C.labelCache,a.default.CLEAR,this.handleFontsChanged_,this)};(0,e.inherits)(G,x.default),G.handles=function(e){return e.getType()===r.default.VECTOR_TILE},G.create=function(e,t){return new G(t)},G.prototype.disposeInternal=function(){(0,l.unlisten)(C.labelCache,a.default.CLEAR,this.handleFontsChanged_,this),x.default.prototype.disposeInternal.call(this)},G.prototype.prepareFrame=function(e,t){const r=this.getLayer(),o=r.getRevision();if(this.renderedLayerRevision_!=o){this.renderedTiles.length=0;const e=r.getRenderMode();this.context||e==g.default.VECTOR||(this.context=(0,n.createCanvasContext2D)()),this.context&&e==g.default.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=o,x.default.prototype.prepareFrame.apply(this,arguments)},G.prototype.createReplayGroup_=function(e,t){const r=this.getLayer(),o=t.pixelRatio,n=t.viewState.projection,l=r.getRevision(),s=r.getRenderOrder()||null,a=e.getReplayState(r);if(!a.dirty&&a.renderedRevision==l&&a.renderedRenderOrder==s)return;const d=r.getSource(),u=d.getTileGrid(),p=d.getTileGridForProjection(n),g=p.getResolution(e.tileCoord[0]),f=p.getTileCoordExtent(e.wrappedTileCoord),T={};for(let t=0,l=e.tileKeys.length;t<l;++t){const l=e.getTile(e.tileKeys[t]);if(l.getState()!=i.default.LOADED)continue;const p=l.tileCoord,R=u.getTileCoordExtent(p),C=(0,c.getIntersection)(f,R),E=(0,c.equals)(R,C)?null:(0,c.buffer)(C,r.getRenderBuffer()*g,this.tmpExtent),S=l.getProjection();let m=!1;(0,h.equivalent)(n,S)||(m=!0,l.setProjection(n)),a.dirty=!1;const x=new v.default(0,C,g,o,d.getOverlaps(),this.declutterTree_,r.getRenderBuffer()),j=(0,_.getSquaredTolerance)(g,o),L=function(e){let t;const o=e.getStyleFunction()||r.getStyleFunction();if(o&&(t=o(e,g)),t){const r=this.renderFeature(e,j,t,x);this.dirty_=this.dirty_||r,a.dirty=a.dirty||r}},O=l.getFeatures();s&&s!==a.renderedRenderOrder&&O.sort(s);for(let e=0,t=O.length;e<t;++e){const t=O[e];m&&(S.getUnits()==y.default.TILE_PIXELS&&(S.setWorldExtent(R),S.setExtent(l.getExtent())),t.getGeometry().transform(S,n)),E&&!(0,c.intersects)(E,t.getGeometry().getExtent())||L.call(this,t)}x.finish();for(const e in x.getReplays())T[e]=!0;l.setReplayGroup(r,e.tileCoord.toString(),x)}a.renderedRevision=l,a.renderedRenderOrder=s},G.prototype.drawTileImage=function(e,t,r,o,i,n,l,s,a){const d=e;this.createReplayGroup_(d,t),this.context&&(this.renderTileImage_(d,t,r),x.default.prototype.drawTileImage.apply(this,arguments))},G.prototype.forEachFeatureAtCoordinate=function(t,r,o,n,l){const s=r.viewState.resolution,a=r.viewState.rotation;o=void 0==o?0:o;const d=this.getLayer(),u={},p=this.renderedTiles,g=d.getSource().getTileGridForProjection(r.viewState.projection);let h,f,y,T,R,C,E,v;for(y=0,T=p.length;y<T;++y)if(E=(C=p[y]).wrappedTileCoord,v=g.getTileCoordExtent(E,this.tmpExtent),h=(0,c.buffer)(v,o*s,h),(0,c.containsCoordinate)(h,t))for(let r=0,c=C.tileKeys.length;r<c;++r){const c=C.getTile(C.tileKeys[r]);c.getState()==i.default.LOADED&&(R=c.getReplayGroup(d,C.tileCoord.toString()),f=f||R.forEachFeatureAtCoordinate(t,s,a,o,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in u))return u[r]=!0,n.call(l,t,d)},null))}return f},G.prototype.getReplayTransform_=function(e,t){const r=this.getLayer().getSource().getTileGrid(),o=e.tileCoord,i=r.getResolution(o[0]),n=t.viewState,l=t.pixelRatio,s=n.resolution/l,a=r.getTileCoordExtent(o,this.tmpExtent),d=n.center,u=(0,c.getTopLeft)(a),p=t.size,g=Math.round(l*p[0]/2),h=Math.round(l*p[1]/2);return(0,j.compose)(this.tmpTransform_,g,h,i/s,i/s,n.rotation,(u[0]-d[0])/i,(d[1]-u[1])/i)},G.prototype.handleFontsChanged_=function(e){const t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},G.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},G.prototype.postCompose=function(e,t,r){const o=this.getLayer(),n=o.getDeclutter()?{}:null,l=o.getSource(),s=o.getRenderMode(),a=q[s],d=t.pixelRatio,u=t.viewState.rotation,c=t.size;let p,h;u&&(p=Math.round(d*c[0]/2),h=Math.round(d*c[1]/2),(0,C.rotateAtOffset)(e,-u,p,h)),n&&this.declutterTree_.clear();const f=this.renderedTiles,y=l.getTileGridForProjection(t.viewState.projection),T=[],R=[];for(let l=f.length-1;l>=0;--l){const d=f[l];if(d.getState()==i.default.ABORT)continue;const c=d.tileCoord,p=y.getTileCoordExtent(c,this.tmpExtent)[0]-y.getTileCoordExtent(d.wrappedTileCoord,this.tmpExtent)[0];let h=void 0;for(let l=0,f=d.tileKeys.length;l<f;++l){const f=d.getTile(d.tileKeys[l]);if(f.getState()!=i.default.LOADED)continue;const y=f.getReplayGroup(o,c.toString());if(s!=g.default.VECTOR&&!y.hasReplays(a))continue;h||(h=this.getTransform(t,p));const C=f.tileCoord[0],E=y.getClipCoords(h);e.save(),e.globalAlpha=r.opacity;for(let t=0,r=T.length;t<r;++t){const r=T[t];C<R[t]&&(e.beginPath(),e.moveTo(E[0],E[1]),e.lineTo(E[2],E[3]),e.lineTo(E[4],E[5]),e.lineTo(E[6],E[7]),e.moveTo(r[6],r[7]),e.lineTo(r[4],r[5]),e.lineTo(r[2],r[3]),e.lineTo(r[0],r[1]),e.clip())}y.replay(e,h,u,{},a,n),e.restore(),T.push(E),R.push(C)}}n&&(0,E.replayDeclutter)(n,e,u),u&&(0,C.rotateAtOffset)(e,u,p,h),x.default.prototype.postCompose.apply(this,arguments)},G.prototype.renderFeature=function(e,t,r,o){if(!r)return!1;let i=!1;if(Array.isArray(r))for(let n=0,l=r.length;n<l;++n)i=(0,_.renderFeature)(o,e,r[n],t,this.handleStyleImageChange_,this)||i;else i=(0,_.renderFeature)(o,e,r,t,this.handleStyleImageChange_,this);return i},G.prototype.renderTileImage_=function(e,t,r){const o=this.getLayer(),n=e.getReplayState(o),l=o.getRevision(),s=O[o.getRenderMode()];if(s&&n.renderedTileRevision!==l){n.renderedTileRevision=l;const r=e.wrappedTileCoord,a=r[0],d=t.pixelRatio,u=o.getSource(),c=u.getTileGridForProjection(t.viewState.projection),p=c.getResolution(a),g=e.getContext(o),h=u.getTilePixelSize(a,d,t.viewState.projection);g.canvas.width=h[0],g.canvas.height=h[1];const f=c.getTileCoordExtent(r,this.tmpExtent);for(let t=0,r=e.tileKeys.length;t<r;++t){const r=e.getTile(e.tileKeys[t]);if(r.getState()!=i.default.LOADED)continue;const n=d/p,l=(0,j.reset)(this.tmpTransform_);(0,j.scale)(l,n,-n),(0,j.translate)(l,-f[0],-f[3]),r.getReplayGroup(o,e.tileCoord.toString()).replay(g,l,0,{},s)}}},exports.default=G;
},{"../../index.js":80,"../../LayerType.js":130,"../../TileState.js":199,"../../dom.js":192,"../../events.js":193,"../../events/EventType.js":194,"rbush":319,"../../extent.js":159,"../../layer/VectorTileRenderType.js":230,"../../proj.js":58,"../../proj/Units.js":132,"../../render/ReplayType.js":327,"../../render/canvas.js":241,"../../render/canvas/ReplayGroup.js":324,"../../render/replay.js":328,"../canvas/TileLayer.js":126,"../vector.js":323,"../../transform.js":237}],53:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),r=require("./PluggableMap.js"),t=v(r),a=require("./control/util.js"),n=require("./interaction.js"),s=require("./obj.js"),u=require("./renderer/canvas/ImageLayer.js"),i=v(u),l=require("./renderer/canvas/Map.js"),o=v(l),c=require("./renderer/canvas/TileLayer.js"),d=v(c),f=require("./renderer/canvas/VectorLayer.js"),j=v(f),q=require("./renderer/canvas/VectorTileLayer.js"),p=v(q);function v(e){return e&&e.__esModule?e:{default:e}}const y=function(e){(e=(0,s.assign)({},e)).controls||(e.controls=(0,a.defaults)()),e.interactions||(e.interactions=(0,n.defaults)()),t.default.call(this,e)};(0,e.inherits)(y,t.default),y.prototype.createRenderer=function(){const e=new o.default(this);return e.registerLayerRenderers([i.default,d.default,j.default,p.default]),e},exports.default=y;
},{"./index.js":80,"./PluggableMap.js":81,"./control/util.js":123,"./interaction.js":73,"./obj.js":82,"./renderer/canvas/ImageLayer.js":124,"./renderer/canvas/Map.js":125,"./renderer/canvas/TileLayer.js":126,"./renderer/canvas/VectorLayer.js":127,"./renderer/canvas/VectorTileLayer.js":128}],244:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={FRACTION:"fraction",PIXELS:"pixels"};
},{}],117:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.get=l;var t=require("../index.js"),e=require("../dom.js"),i=require("../events.js"),s=require("../events/EventTarget.js"),a=_(s),n=require("../events/EventType.js"),h=_(n),r=require("../ImageState.js"),o=_(r),g=require("../style/IconImageCache.js");function _(t){return t&&t.__esModule?t:{default:t}}const c=function(t,e,i,s,n,h){a.default.call(this),this.hitDetectionImage_=null,this.image_=t||new Image,null!==s&&(this.image_.crossOrigin=s),this.canvas_=h?document.createElement("CANVAS"):null,this.color_=h,this.imageListenerKeys_=null,this.imageState_=n,this.size_=i,this.src_=e,this.tainting_=!1,this.imageState_==o.default.LOADED&&this.determineTainting_()};function l(t,e,i,s,a,n){let h=g.shared.get(e,s,n);return h||(h=new c(t,e,i,s,a,n),g.shared.set(e,s,n,h)),h}(0,t.inherits)(c,a.default),c.prototype.determineTainting_=function(){const t=(0,e.createCanvasContext2D)(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainting_=!0}},c.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(h.default.CHANGE)},c.prototype.handleImageError_=function(){this.imageState_=o.default.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},c.prototype.handleImageLoad_=function(){this.imageState_=o.default.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.determineTainting_(),this.replaceColor_(),this.dispatchChangeEvent_()},c.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},c.prototype.getImageState=function(){return this.imageState_},c.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.tainting_){const t=this.size_[0],i=this.size_[1],s=(0,e.createCanvasContext2D)(t,i);s.fillRect(0,0,t,i),this.hitDetectionImage_=s.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},c.prototype.getSize=function(){return this.size_},c.prototype.getSrc=function(){return this.src_},c.prototype.load=function(){if(this.imageState_==o.default.IDLE){this.imageState_=o.default.LOADING,this.imageListenerKeys_=[(0,i.listenOnce)(this.image_,h.default.ERROR,this.handleImageError_,this),(0,i.listenOnce)(this.image_,h.default.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},c.prototype.replaceColor_=function(){if(this.tainting_||null===this.color_)return;this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;const t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);const e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,s=this.color_[0]/255,a=this.color_[1]/255,n=this.color_[2]/255;for(let t=0,e=i.length;t<e;t+=4)i[t]*=s,i[t+1]*=a,i[t+2]*=n;t.putImageData(e,0,0)},c.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(i.unlistenByKey),this.imageListenerKeys_=null},exports.default=c;
},{"../index.js":80,"../dom.js":192,"../events.js":193,"../events/EventTarget.js":235,"../events/EventType.js":194,"../ImageState.js":191,"../style/IconImageCache.js":236}],116:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),i=require("../ImageState.js"),e=d(i),o=require("../asserts.js"),n=require("../color.js"),r=require("../events.js"),s=require("../events/EventType.js"),a=d(s),h=require("../style/IconAnchorUnits.js"),c=d(h),l=require("../style/IconImage.js"),g=require("../style/IconOrigin.js"),u=d(g),f=require("../style/Image.js"),_=d(f);function d(t){return t&&t.__esModule?t:{default:t}}const O=function(i){const r=i||{};this.anchor_=void 0!==r.anchor?r.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:u.default.TOP_LEFT,this.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:c.default.FRACTION,this.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:c.default.FRACTION,this.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;const s=void 0!==r.img?r.img:null,a=void 0!==r.imgSize?r.imgSize:null;let h=r.src;(0,o.assert)(!(void 0!==h&&s),4),(0,o.assert)(!s||s&&a,5),void 0!==h&&0!==h.length||!s||(h=s.src||(0,t.getUid)(s).toString()),(0,o.assert)(void 0!==h&&h.length>0,6);const g=void 0!==r.src?e.default.IDLE:e.default.LOADED;this.color_=void 0!==r.color?(0,n.asArray)(r.color):null,this.iconImage_=(0,l.get)(s,h,a,this.crossOrigin_,g,this.color_),this.offset_=void 0!==r.offset?r.offset:[0,0],this.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:u.default.TOP_LEFT,this.origin_=null,this.size_=void 0!==r.size?r.size:null;const f=void 0!==r.opacity?r.opacity:1,d=void 0!==r.rotateWithView&&r.rotateWithView,O=void 0!==r.rotation?r.rotation:0,p=void 0!==r.scale?r.scale:1,T=void 0===r.snapToPixel||r.snapToPixel;_.default.call(this,{opacity:f,rotation:O,scale:p,snapToPixel:T,rotateWithView:d})};(0,t.inherits)(O,_.default),O.prototype.clone=function(){return new O({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),snapToPixel:this.getSnapToPixel(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},O.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;let t=this.anchor_;const i=this.getSize();if(this.anchorXUnits_==c.default.FRACTION||this.anchorYUnits_==c.default.FRACTION){if(!i)return null;t=this.anchor_.slice(),this.anchorXUnits_==c.default.FRACTION&&(t[0]*=i[0]),this.anchorYUnits_==c.default.FRACTION&&(t[1]*=i[1])}if(this.anchorOrigin_!=u.default.TOP_LEFT){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=u.default.TOP_RIGHT&&this.anchorOrigin_!=u.default.BOTTOM_RIGHT||(t[0]=-t[0]+i[0]),this.anchorOrigin_!=u.default.BOTTOM_LEFT&&this.anchorOrigin_!=u.default.BOTTOM_RIGHT||(t[1]=-t[1]+i[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},O.prototype.getColor=function(){return this.color_},O.prototype.getImage=function(t){return this.iconImage_.getImage(t)},O.prototype.getImageSize=function(){return this.iconImage_.getSize()},O.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},O.prototype.getImageState=function(){return this.iconImage_.getImageState()},O.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},O.prototype.getOrigin=function(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!=u.default.TOP_LEFT){const i=this.getSize(),e=this.iconImage_.getSize();if(!i||!e)return null;t=t.slice(),this.offsetOrigin_!=u.default.TOP_RIGHT&&this.offsetOrigin_!=u.default.BOTTOM_RIGHT||(t[0]=e[0]-i[0]-t[0]),this.offsetOrigin_!=u.default.BOTTOM_LEFT&&this.offsetOrigin_!=u.default.BOTTOM_RIGHT||(t[1]=e[1]-i[1]-t[1])}return this.origin_=t,this.origin_},O.prototype.getSrc=function(){return this.iconImage_.getSrc()},O.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},O.prototype.listenImageChange=function(t,i){return(0,r.listen)(this.iconImage_,a.default.CHANGE,t,i)},O.prototype.load=function(){this.iconImage_.load()},O.prototype.unlistenImageChange=function(t,i){(0,r.unlisten)(this.iconImage_,a.default.CHANGE,t,i)},exports.default=O;
},{"../index.js":80,"../ImageState.js":191,"../asserts.js":165,"../color.js":231,"../events.js":193,"../events/EventType.js":194,"../style/IconAnchorUnits.js":244,"../style/IconImage.js":117,"../style/IconOrigin.js":246,"../style/Image.js":118}],84:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../events.js"),e=require("../index.js"),i=require("../Object.js"),s=require("../dom.js"),n=require("../layer/Vector.js"),r=f(n),a=require("../math.js"),h=require("../obj.js"),d=require("../render/EventType.js"),o=f(d),l=require("../style/Icon.js"),u=f(l),c=require("../style/Style.js"),g=f(c);function f(t){return t&&t.__esModule?t:{default:t}}const p={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},y=["#00f","#0ff","#0f0","#ff0","#f00"],_=function(e){const s=e||{},n=(0,h.assign)({},s);delete n.gradient,delete n.radius,delete n.blur,delete n.shadow,delete n.weight,r.default.call(this,n),this.gradient_=null,this.shadow_=void 0!==s.shadow?s.shadow:250,this.circleImage_=void 0,this.styleCache_=null,(0,t.listen)(this,(0,i.getChangeEventType)(p.GRADIENT),this.handleGradientChanged_,this),this.setGradient(s.gradient?s.gradient:y),this.setBlur(void 0!==s.blur?s.blur:15),this.setRadius(void 0!==s.radius?s.radius:8),(0,t.listen)(this,(0,i.getChangeEventType)(p.BLUR),this.handleStyleChanged_,this),(0,t.listen)(this,(0,i.getChangeEventType)(p.RADIUS),this.handleStyleChanged_,this),this.handleStyleChanged_();const d=s.weight?s.weight:"weight";let l;l="string"==typeof d?function(t){return t.get(d)}:d,this.setStyle(function(t,e){const i=l(t),s=void 0!==i?(0,a.clamp)(i,0,1):1,n=255*s|0;let r=this.styleCache_[n];return r||(r=[new g.default({image:new u.default({opacity:s,src:this.circleImage_})})],this.styleCache_[n]=r),r}.bind(this)),this.setRenderOrder(null),(0,t.listen)(this,o.default.RENDER,this.handleRender_,this)};(0,e.inherits)(_,r.default);const R=function(t){const e=(0,s.createCanvasContext2D)(1,256),i=e.createLinearGradient(0,0,1,256),n=1/(t.length-1);for(let e=0,s=t.length;e<s;++e)i.addColorStop(e*n,t[e]);return e.fillStyle=i,e.fillRect(0,0,1,256),e.getImageData(0,0,1,256).data};_.prototype.createCircle_=function(){const t=this.getRadius(),e=this.getBlur(),i=t+e+1,n=2*i,r=(0,s.createCanvasContext2D)(n,n);r.shadowOffsetX=r.shadowOffsetY=this.shadow_,r.shadowBlur=e,r.shadowColor="#000",r.beginPath();const a=i-this.shadow_;return r.arc(a,a,t,0,2*Math.PI,!0),r.fill(),r.canvas.toDataURL()},_.prototype.getBlur=function(){return this.get(p.BLUR)},_.prototype.getGradient=function(){return this.get(p.GRADIENT)},_.prototype.getRadius=function(){return this.get(p.RADIUS)},_.prototype.handleGradientChanged_=function(){this.gradient_=R(this.getGradient())},_.prototype.handleStyleChanged_=function(){this.circleImage_=this.createCircle_(),this.styleCache_=new Array(256),this.changed()},_.prototype.handleRender_=function(t){const e=t.context,i=e.canvas,s=e.getImageData(0,0,i.width,i.height),n=s.data;for(let t=0,e=n.length;t<e;t+=4){const e=4*n[t+3];e&&(n[t]=this.gradient_[e],n[t+1]=this.gradient_[e+1],n[t+2]=this.gradient_[e+2])}e.putImageData(s,0,0)},_.prototype.setBlur=function(t){this.set(p.BLUR,t)},_.prototype.setGradient=function(t){this.set(p.GRADIENT,t)},_.prototype.setRadius=function(t){this.set(p.RADIUS,t)},exports.default=_;
},{"../events.js":193,"../index.js":80,"../Object.js":196,"../dom.js":192,"../layer/Vector.js":87,"../math.js":160,"../obj.js":82,"../render/EventType.js":205,"../style/Icon.js":116,"../style/Style.js":121}],85:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../LayerType.js"),r=i(t),u=require("../layer/Layer.js"),s=i(u);function i(e){return e&&e.__esModule?e:{default:e}}const o=function(e){const t=e||{};s.default.call(this,t),this.type=r.default.IMAGE};(0,e.inherits)(o,s.default),o.prototype.getSource,exports.default=o;
},{"../index.js":80,"../LayerType.js":130,"../layer/Layer.js":86}],131:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};
},{}],61:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../LayerType.js"),r=u(t),s=require("../layer/Layer.js"),i=u(s),o=require("../layer/TileProperty.js"),n=u(o),l=require("../obj.js");function u(e){return e&&e.__esModule?e:{default:e}}const a=function(e){const t=e||{},s=(0,l.assign)({},t);delete s.preload,delete s.useInterimTilesOnError,i.default.call(this,s),this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),this.type=r.default.TILE};(0,e.inherits)(a,i.default),a.prototype.getPreload=function(){return this.get(n.default.PRELOAD)},a.prototype.getSource,a.prototype.setPreload=function(e){this.set(n.default.PRELOAD,e)},a.prototype.getUseInterimTilesOnError=function(){return this.get(n.default.USE_INTERIM_TILES_ON_ERROR)},a.prototype.setUseInterimTilesOnError=function(e){this.set(n.default.USE_INTERIM_TILES_ON_ERROR,e)},exports.default=a;
},{"../index.js":80,"../LayerType.js":130,"../layer/Layer.js":86,"../layer/TileProperty.js":131,"../obj.js":82}],77:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderType=void 0;var e=require("../index.js"),r=require("../LayerType.js"),t=p(r),s=require("../asserts.js"),o=require("../layer/TileProperty.js"),i=p(o),l=require("../layer/Vector.js"),u=p(l),d=require("../layer/VectorTileRenderType.js"),n=p(d),a=require("../obj.js");function p(e){return e&&e.__esModule?e:{default:e}}const E=exports.RenderType={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"},f=function(e){const r=e||{};let o=r.renderMode||n.default.HYBRID;(0,s.assert)(void 0==o||o==n.default.IMAGE||o==n.default.HYBRID||o==n.default.VECTOR,28),r.declutter&&o==n.default.IMAGE&&(o=n.default.HYBRID),r.renderMode=o;const i=(0,a.assign)({},r);delete i.preload,delete i.useInterimTilesOnError,u.default.call(this,i),this.setPreload(r.preload?r.preload:0),this.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),this.type=t.default.VECTOR_TILE};(0,e.inherits)(f,u.default),f.prototype.getPreload=function(){return this.get(i.default.PRELOAD)},f.prototype.getUseInterimTilesOnError=function(){return this.get(i.default.USE_INTERIM_TILES_ON_ERROR)},f.prototype.setPreload=function(e){this.set(i.default.PRELOAD,e)},f.prototype.setUseInterimTilesOnError=function(e){this.set(i.default.USE_INTERIM_TILES_ON_ERROR,e)},f.prototype.getSource,exports.default=f;
},{"../index.js":80,"../LayerType.js":130,"../asserts.js":165,"../layer/TileProperty.js":131,"../layer/Vector.js":87,"../layer/VectorTileRenderType.js":230,"../obj.js":82}],55:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./layer/Group.js");Object.defineProperty(exports,"Group",{enumerable:!0,get:function(){return l(e).default}});var r=require("./layer/Heatmap.js");Object.defineProperty(exports,"Heatmap",{enumerable:!0,get:function(){return l(r).default}});var t=require("./layer/Image.js");Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return l(t).default}});var u=require("./layer/Layer.js");Object.defineProperty(exports,"Layer",{enumerable:!0,get:function(){return l(u).default}});var n=require("./layer/Tile.js");Object.defineProperty(exports,"Tile",{enumerable:!0,get:function(){return l(n).default}});var a=require("./layer/Vector.js");Object.defineProperty(exports,"Vector",{enumerable:!0,get:function(){return l(a).default}});var o=require("./layer/VectorTile.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"VectorTile",{enumerable:!0,get:function(){return l(o).default}});
},{"./layer/Group.js":83,"./layer/Heatmap.js":84,"./layer/Image.js":85,"./layer/Layer.js":86,"./layer/Tile.js":61,"./layer/Vector.js":87,"./layer/VectorTile.js":77}],201:[function(require,module,exports) {
"use strict";function t(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function e(t,e,n){return t+"/"+e+"/"+n}function n(t){return e(t[0],t[1],t[2])}function r(t){return t.split("/").map(Number)}function o(t){return(t[1]<<t[0])+t[2]}function u(t){const e=t[0],n=new Array(e);let r,o,u=1<<e-1;for(r=0;r<e;++r)o=48,t[1]&u&&(o+=1),t[2]&u&&(o+=2),n[r]=String.fromCharCode(o),u>>=1;return n.join("")}function i(t,e){const n=t[0],r=t[1],o=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const u=e.getExtent();let i;return!(i=u?e.getTileRangeForExtentAndZ(u,n):e.getFullTileRange(n))||i.containsXY(r,o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=t,exports.getKeyZXY=e,exports.getKey=n,exports.fromKey=r,exports.hash=o,exports.quadKey=u,exports.withinExtentAndZ=i;
},{}],214:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromTemplate=n,exports.createFromTemplates=o,exports.createFromTileUrlFunctions=c,exports.nullTileUrlFunction=u,exports.expandUrl=s;var e=require("./asserts.js"),t=require("./math.js"),r=require("./tilecoord.js");function n(t,r){const n=/\{z\}/g,o=/\{x\}/g,c=/\{y\}/g,u=/\{-y\}/g;return function(s,i,l){return s?t.replace(n,s[0].toString()).replace(o,s[1].toString()).replace(c,function(){return(-s[2]-1).toString()}).replace(u,function(){const t=s[0],n=r.getFullTileRange(t);return(0,e.assert)(n,55),(n.getHeight()+s[2]).toString()}):void 0}}function o(e,t){const r=e.length,o=new Array(r);for(let c=0;c<r;++c)o[c]=n(e[c],t);return c(o)}function c(e){return 1===e.length?e[0]:function(n,o,c){if(n){const u=(0,r.hash)(n),s=(0,t.modulo)(u,e.length);return e[s](n,o,c)}}}function u(e,t,r){}function s(e){const t=[];let r=/\{([a-z])-([a-z])\}/.exec(e);if(r){const n=r[1].charCodeAt(0),o=r[2].charCodeAt(0);let c;for(c=n;c<=o;++c)t.push(e.replace(r[0],String.fromCharCode(c)));return t}if(r=r=/\{(\d+)-(\d+)\}/.exec(e)){const n=parseInt(r[2],10);for(let o=parseInt(r[1],10);o<=n;o++)t.push(e.replace(r[0],o.toString()));return t}return t.push(e),t}
},{"./asserts.js":165,"./math.js":160,"./tilecoord.js":201}],215:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.jsonp=t;var e=require("./index.js");function t(t,n,o,c){const i=document.createElement("script"),d="olc_"+(0,e.getUid)(n);function r(){delete window[d],i.parentNode.removeChild(i)}i.async=!0,i.src=t+(-1==t.indexOf("?")?"?":"&")+(c||"callback")+"="+d;const s=setTimeout(function(){r(),o&&o()},1e4);window[d]=function(e){clearTimeout(s),r(),n(e)},document.getElementsByTagName("head")[0].appendChild(i)}
},{"./index.js":80}],198:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),i=require("./TileState.js"),e=u(i),n=require("./easing.js"),r=require("./events/EventTarget.js"),s=u(r),o=require("./events/EventType.js"),a=u(o);function u(t){return t&&t.__esModule?t:{default:t}}const l=function(t,i,e){s.default.call(this);const n=e||{};this.tileCoord=t,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={}};(0,t.inherits)(l,s.default),l.prototype.changed=function(){this.dispatchEvent(a.default.CHANGE)},l.prototype.getKey=function(){return this.key+"/"+this.tileCoord},l.prototype.getInterimTile=function(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==e.default.LOADED)return t;t=t.interimTile}while(t);return this},l.prototype.refreshInterimChain=function(){if(!this.interimTile)return;let t=this.interimTile,i=this;do{if(t.getState()==e.default.LOADED){t.interimTile=null;break}t.getState()==e.default.LOADING?i=t:t.getState()==e.default.IDLE?i.interimTile=t.interimTile:i=t,t=i.interimTile}while(t)},l.prototype.getTileCoord=function(){return this.tileCoord},l.prototype.getState=function(){return this.state},l.prototype.setState=function(t){this.state=t,this.changed()},l.prototype.load=function(){},l.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;let e=this.transitionStarts_[t];if(e){if(-1===e)return 1}else e=i,this.transitionStarts_[t]=e;const r=i-e+1e3/60;return r>=this.transition_?1:(0,n.easeIn)(r/this.transition_)},l.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},l.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},exports.default=l;
},{"./index.js":80,"./TileState.js":199,"./easing.js":224,"./events/EventTarget.js":235,"./events/EventType.js":194}],233:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./index.js"),e=require("./Tile.js"),i=o(e),s=require("./TileState.js"),n=o(s),a=require("./dom.js"),r=require("./events.js"),h=require("./events/EventType.js"),l=o(h);function o(t){return t&&t.__esModule?t:{default:t}}const u=function(t,e,s,n,a,r){i.default.call(this,t,e,r),this.crossOrigin_=n,this.src_=s,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.imageListenerKeys_=null,this.tileLoadFunction_=a};function g(){const t=(0,a.createCanvasContext2D)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(0,t.inherits)(u,i.default),u.prototype.disposeInternal=function(){this.state==n.default.LOADING&&(this.unlistenImage_(),this.image_=g()),this.interimTile&&this.interimTile.dispose(),this.state=n.default.ABORT,this.changed(),i.default.prototype.disposeInternal.call(this)},u.prototype.getImage=function(){return this.image_},u.prototype.getKey=function(){return this.src_},u.prototype.handleImageError_=function(){this.state=n.default.ERROR,this.unlistenImage_(),this.image_=g(),this.changed()},u.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=n.default.LOADED:this.state=n.default.EMPTY,this.unlistenImage_(),this.changed()},u.prototype.load=function(){this.state==n.default.ERROR&&(this.state=n.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.default.IDLE&&(this.state=n.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,r.listenOnce)(this.image_,l.default.ERROR,this.handleImageError_,this),(0,r.listenOnce)(this.image_,l.default.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},u.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(r.unlistenByKey),this.imageListenerKeys_=null},exports.default=u;
},{"./index.js":80,"./Tile.js":198,"./TileState.js":199,"./dom.js":192,"./events.js":193,"./events/EventType.js":194}],232:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./structs/LRUCache.js"),i=r(t),o=require("./tilecoord.js");function r(e){return e&&e.__esModule?e:{default:e}}const s=function(e){i.default.call(this,e)};(0,e.inherits)(s,i.default),s.prototype.expireCache=function(e){for(;this.canExpireCache();){const t=this.peekLast(),i=t.tileCoord[0].toString();if(i in e&&e[i].contains(t.tileCoord))break;this.pop().dispose()}},s.prototype.pruneExceptNewestZ=function(){if(0===this.getCount())return;const e=this.peekFirstKey(),t=(0,o.fromKey)(e)[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove((0,o.getKey)(e.tileCoord)),e.dispose())},this)},exports.default=s;
},{"./index.js":80,"./structs/LRUCache.js":310,"./tilecoord.js":201}],260:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateSourceResolution=r,exports.render=a;var t=require("./dom.js"),e=require("./extent.js"),n=require("./math.js"),o=require("./proj.js");function r(t,n,r,s){const a=(0,o.transform)(r,n,t);let i=(0,o.getPointResolution)(n,s,r);const c=n.getMetersPerUnit();void 0!==c&&(i*=c);const u=t.getMetersPerUnit();void 0!==u&&(i/=u);const g=t.getExtent();if(!g||(0,e.containsCoordinate)(g,a)){const e=(0,o.getPointResolution)(t,i,a)/i;isFinite(e)&&e>0&&(i/=e)}return i}function s(t,e,n,o){const r=n-t,s=o-e,a=Math.sqrt(r*r+s*s);return[Math.round(n+r/a),Math.round(o+s/a)]}function a(o,r,a,i,c,u,g,l,h,d,f){const v=(0,t.createCanvasContext2D)(Math.round(a*o),Math.round(a*r));if(0===h.length)return v.canvas;v.scale(a,a);const m=(0,e.createEmpty)();h.forEach(function(t,n,o){(0,e.extend)(m,t.extent)});const x=(0,e.getWidth)(m),M=(0,e.getHeight)(m),T=(0,t.createCanvasContext2D)(Math.round(a*x/i),Math.round(a*M/i)),p=a/i;h.forEach(function(t,n,o){const r=t.extent[0]-m[0],s=-(t.extent[3]-m[3]),a=(0,e.getWidth)(t.extent),i=(0,e.getHeight)(t.extent);T.drawImage(t.image,d,d,t.image.width-2*d,t.image.height-2*d,r*p,s*p,a*p,i*p)});const P=(0,e.getTopLeft)(g);return l.getTriangles().forEach(function(t,e,o){const r=t.source,c=t.target;let g=r[0][0],l=r[0][1],h=r[1][0],d=r[1][1],f=r[2][0],x=r[2][1];const M=(c[0][0]-P[0])/u,p=-(c[0][1]-P[1])/u,j=(c[1][0]-P[0])/u,E=-(c[1][1]-P[1])/u,q=(c[2][0]-P[0])/u,C=-(c[2][1]-P[1])/u,b=g,y=l;g=0,l=0;const k=[[h-=b,d-=y,0,0,j-M],[f-=b,x-=y,0,0,q-M],[0,0,h,d,E-p],[0,0,f,x,C-p]],w=(0,n.solveLinearSystem)(k);if(!w)return;v.save(),v.beginPath();const R=(M+j+q)/3,S=(p+E+C)/3,W=s(R,S,M,p),D=s(R,S,j,E),H=s(R,S,q,C);v.moveTo(D[0],D[1]),v.lineTo(W[0],W[1]),v.lineTo(H[0],H[1]),v.clip(),v.transform(w[0],w[2],w[1],w[3],M,p),v.translate(m[0]-b,m[3]-y),v.scale(i/a,-i/a),v.drawImage(T.canvas,0,0),v.restore()}),f&&(v.save(),v.strokeStyle="black",v.lineWidth=1,l.getTriangles().forEach(function(t,e,n){const o=t.target,r=(o[0][0]-P[0])/u,s=-(o[0][1]-P[1])/u,a=(o[1][0]-P[0])/u,i=-(o[1][1]-P[1])/u,c=(o[2][0]-P[0])/u,g=-(o[2][1]-P[1])/u;v.beginPath(),v.moveTo(a,i),v.lineTo(r,s),v.lineTo(c,g),v.closePath(),v.stroke()}),v.restore()),v.canvas}
},{"./dom.js":192,"./extent.js":159,"./math.js":160,"./proj.js":58}],309:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../extent.js"),r=require("../math.js"),e=require("../proj.js");const s=10,i=.25,o=function(r,s,i,o,n){this.sourceProj_=r,this.targetProj_=s;let h={};const a=(0,e.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const r=t[0]+"/"+t[1];return h[r]||(h[r]=a(t)),h[r]},this.maxSourceExtent_=o,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&(0,t.getWidth)(o)==(0,t.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,t.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,t.getWidth)(this.targetProj_.getExtent()):null;const u=(0,t.getTopLeft)(i),c=(0,t.getTopRight)(i),d=(0,t.getBottomRight)(i),_=(0,t.getBottomLeft)(i),l=this.transformInv_(u),f=this.transformInv_(c),g=this.transformInv_(d),W=this.transformInv_(_);if(this.addQuad_(u,c,d,_,l,f,g,W,10),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach(function(r,e,s){t=Math.min(t,r.source[0][0],r.source[1][0],r.source[2][0])}),this.triangles_.forEach(function(r){if(Math.max(r.source[0][0],r.source[1][0],r.source[2][0])-t>this.sourceWorldWidth_/2){const e=[[r.source[0][0],r.source[0][1]],[r.source[1][0],r.source[1][1]],[r.source[2][0],r.source[2][1]]];e[0][0]-t>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-t>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-t>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);const s=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-s<this.sourceWorldWidth_/2&&(r.source=e)}}.bind(this))}h={}};o.prototype.addTriangle_=function(t,r,e,s,i,o){this.triangles_.push({source:[s,i,o],target:[t,r,e]})},o.prototype.addQuad_=function(e,s,i,o,n,h,a,u,c){const d=(0,t.boundingExtent)([n,h,a,u]),_=this.sourceWorldWidth_?(0,t.getWidth)(d)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&_>.5&&_<1;let g=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,t.boundingExtent)([e,s,i,o]);g|=(0,t.getWidth)(r)/this.targetWorldWidth_>.25}!f&&this.sourceProj_.isGlobal()&&_&&(g|=_>.25)}if(g||!this.maxSourceExtent_||(0,t.intersects)(d,this.maxSourceExtent_)){if(!(g||isFinite(n[0])&&isFinite(n[1])&&isFinite(h[0])&&isFinite(h[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(u[0])&&isFinite(u[1]))){if(!(c>0))return;g=!0}if(c>0){if(!g){const t=[(e[0]+i[0])/2,(e[1]+i[1])/2],s=this.transformInv_(t);let o;if(f){o=((0,r.modulo)(n[0],l)+(0,r.modulo)(a[0],l))/2-(0,r.modulo)(s[0],l)}else o=(n[0]+a[0])/2-s[0];const h=(n[1]+a[1])/2-s[1];g=o*o+h*h>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const t=[(s[0]+i[0])/2,(s[1]+i[1])/2],r=this.transformInv_(t),d=[(o[0]+e[0])/2,(o[1]+e[1])/2],_=this.transformInv_(d);this.addQuad_(e,s,t,d,n,h,r,_,c-1),this.addQuad_(d,t,i,o,_,r,a,u,c-1)}else{const t=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=this.transformInv_(t),d=[(i[0]+o[0])/2,(i[1]+o[1])/2],_=this.transformInv_(d);this.addQuad_(e,t,d,o,n,r,_,u,c-1),this.addQuad_(t,s,i,d,r,h,a,_,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(e,i,o,n,a,u),this.addTriangle_(e,s,i,n,h,a)}},o.prototype.calculateSourceExtent=function(){const r=(0,t.createEmpty)();return this.triangles_.forEach(function(e,s,i){const o=e.source;(0,t.extendCoordinate)(r,o[0]),(0,t.extendCoordinate)(r,o[1]),(0,t.extendCoordinate)(r,o[2])}),r},o.prototype.getTriangles=function(){return this.triangles_},exports.default=o;
},{"../extent.js":159,"../math.js":160,"../proj.js":58}],249:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../index.js"),i=require("../Tile.js"),s=f(i),r=require("../TileState.js"),o=f(r),n=require("../events.js"),u=require("../events/EventType.js"),l=f(u),a=require("../extent.js"),h=require("../math.js"),c=require("../reproj.js"),d=require("../reproj/Triangulation.js"),_=f(d);function f(t){return t&&t.__esModule?t:{default:t}}const g=function(e,i,r,n,u,l,d,f,g,p,T){s.default.call(this,u,o.default.IDLE),this.renderEdges_=void 0!==T&&T,this.pixelRatio_=d,this.gutter_=f,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=n,this.wrappedTileCoord_=l||u,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const E=n.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const R=y?(0,a.getIntersection)(E,y):E;if(0===(0,a.getArea)(R))return void(this.state=o.default.EMPTY);const j=e.getExtent();j&&(x=x?(0,a.getIntersection)(x,j):j);const L=n.getResolution(this.wrappedTileCoord_[0]),m=(0,a.getCenter)(R),D=(0,c.calculateSourceResolution)(e,r,m,L);if(!isFinite(D)||D<=0)return void(this.state=o.default.EMPTY);const G=void 0!==p?p:t.ERROR_THRESHOLD;if(this.triangulation_=new _.default(e,r,R,x,D*G),0===this.triangulation_.getTriangles().length)return void(this.state=o.default.EMPTY);this.sourceZ_=i.getZForResolution(D);let I=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(I[1]=(0,h.clamp)(I[1],x[1],x[3]),I[3]=(0,h.clamp)(I[3],x[1],x[3])):I=(0,a.getIntersection)(I,x)),(0,a.getArea)(I)){const t=i.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=g(this.sourceZ_,e,i,d);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=o.default.EMPTY)}else this.state=o.default.EMPTY};(0,e.inherits)(g,s.default),g.prototype.disposeInternal=function(){this.state==o.default.LOADING&&this.unlistenSources_(),s.default.prototype.disposeInternal.call(this)},g.prototype.getImage=function(){return this.canvas_},g.prototype.reproject_=function(){const t=[];if(this.sourceTiles_.forEach(function(e,i,s){e&&e.getState()==o.default.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=o.default.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],n=this.targetTileGrid_.getResolution(e),u=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,c.render)(s,r,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),n,l,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=o.default.LOADED}this.changed()},g.prototype.load=function(){if(this.state==o.default.IDLE){this.state=o.default.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,s){const r=e.getState();if(r==o.default.IDLE||r==o.default.LOADING){t++;const i=(0,n.listen)(e,l.default.CHANGE,function(s){const r=e.getState();r!=o.default.LOADED&&r!=o.default.ERROR&&r!=o.default.EMPTY||((0,n.unlistenByKey)(i),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(i)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==o.default.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},g.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(n.unlistenByKey),this.sourcesListenerKeys_=null},exports.default=g;
},{"./common.js":210,"../index.js":80,"../Tile.js":198,"../TileState.js":199,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../math.js":160,"../reproj.js":260,"../reproj/Triangulation.js":309}],234:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../asserts.js"),i=require("../TileRange.js"),o=u(i),n=require("../array.js"),r=require("../extent.js"),s=require("../math.js"),l=require("../size.js"),h=require("../tilecoord.js");function u(t){return t&&t.__esModule?t:{default:t}}const g=function(i){let s;if(this.minZoom=void 0!==i.minZoom?i.minZoom:0,this.resolutions_=i.resolutions,(0,e.assert)((0,n.isSorted)(this.resolutions_,function(t,e){return e-t},!0),17),!i.origins)for(let t=0,e=this.resolutions_.length-1;t<e;++t)if(s){if(this.resolutions_[t]/this.resolutions_[t+1]!==s){s=void 0;break}}else s=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=s,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==i.origin?i.origin:null,this.origins_=null,void 0!==i.origins&&(this.origins_=i.origins,(0,e.assert)(this.origins_.length==this.resolutions_.length,20));const l=i.extent;void 0===l||this.origin_||this.origins_||(this.origin_=(0,r.getTopLeft)(l)),(0,e.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==i.tileSizes&&(this.tileSizes_=i.tileSizes,(0,e.assert)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==i.tileSize?i.tileSize:this.tileSizes_?null:t.DEFAULT_TILE_SIZE,(0,e.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==l?l:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==i.sizes?this.fullTileRanges_=i.sizes.map(function(t,e){return new o.default(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):l&&this.calculateTileRanges_(l)},a=[0,0,0];g.prototype.forEachTileCoord=function(t,e,i){const o=this.getTileRangeForExtentAndZ(t,e);for(let t=o.minX,n=o.maxX;t<=n;++t)for(let n=o.minY,r=o.maxY;n<=r;++n)i([e,t,n])},g.prototype.forEachTileCoordParentTileRange=function(t,e,o,n,r){let s,l,h,u=null,g=t[0]-1;for(2===this.zoomFactor_?(l=t[1],h=t[2]):u=this.getTileCoordExtent(t,r);g>=this.minZoom;){if(2===this.zoomFactor_?(l=Math.floor(l/2),h=Math.floor(h/2),s=(0,i.createOrUpdate)(l,l,h,h,n)):s=this.getTileRangeForExtentAndZ(u,g,n),e.call(o,g,s))return!0;--g}return!1},g.prototype.getExtent=function(){return this.extent_},g.prototype.getMaxZoom=function(){return this.maxZoom},g.prototype.getMinZoom=function(){return this.minZoom},g.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},g.prototype.getResolution=function(t){return this.resolutions_[t]},g.prototype.getResolutions=function(){return this.resolutions_},g.prototype.getTileCoordChildTileRange=function(t,e,o){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const o=2*t[1],n=2*t[2];return(0,i.createOrUpdate)(o,o+1,n,n+1,e)}const n=this.getTileCoordExtent(t,o);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null},g.prototype.getTileRangeExtent=function(t,e,i){const o=this.getOrigin(t),n=this.getResolution(t),s=(0,l.toSize)(this.getTileSize(t),this.tmpSize_),h=o[0]+e.minX*s[0]*n,u=o[0]+(e.maxX+1)*s[0]*n,g=o[1]+e.minY*s[1]*n,a=o[1]+(e.maxY+1)*s[1]*n;return(0,r.createOrUpdate)(h,g,u,a,i)},g.prototype.getTileRangeForExtentAndZ=function(t,e,o){const n=a;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);const r=n[1],s=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),(0,i.createOrUpdate)(r,n[1],s,n[2],o)},g.prototype.getTileCoordCenter=function(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),o=(0,l.toSize)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*o[0]*i,e[1]+(t[2]+.5)*o[1]*i]},g.prototype.getTileCoordExtent=function(t,e){const i=this.getOrigin(t[0]),o=this.getResolution(t[0]),n=(0,l.toSize)(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*n[0]*o,h=i[1]+t[2]*n[1]*o,u=s+n[0]*o,g=h+n[1]*o;return(0,r.createOrUpdate)(s,h,u,g,e)},g.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},g.prototype.getTileCoordForXYAndResolution_=function(t,e,i,o,n){const r=this.getZForResolution(i),s=i/this.getResolution(r),u=this.getOrigin(r),g=(0,l.toSize)(this.getTileSize(r),this.tmpSize_),a=o?.5:0,_=o?0:.5,c=Math.floor((t-u[0])/i+a),p=Math.floor((e-u[1])/i+_);let f=s*c/g[0],d=s*p/g[1];return o?(f=Math.ceil(f)-1,d=Math.ceil(d)-1):(f=Math.floor(f),d=Math.floor(d)),(0,h.createOrUpdate)(r,f,d,n)},g.prototype.getTileCoordForXYAndZ_=function(t,e,i,o,n){const r=this.getOrigin(i),s=this.getResolution(i),u=(0,l.toSize)(this.getTileSize(i),this.tmpSize_),g=o?.5:0,a=o?0:.5,_=Math.floor((t-r[0])/s+g),c=Math.floor((e-r[1])/s+a);let p=_/u[0],f=c/u[1];return o?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),(0,h.createOrUpdate)(i,p,f,n)},g.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},g.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},g.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},g.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},g.prototype.getZForResolution=function(t,e){const i=(0,n.linearFindNearest)(this.resolutions_,t,e||0);return(0,s.clamp)(i,this.minZoom,this.maxZoom)},g.prototype.calculateTileRanges_=function(t){const e=this.resolutions_.length,i=new Array(e);for(let o=this.minZoom;o<e;++o)i[o]=this.getTileRangeForExtentAndZ(t,o);this.fullTileRanges_=i},exports.default=g;
},{"./common.js":225,"../asserts.js":165,"../TileRange.js":250,"../array.js":209,"../extent.js":159,"../math.js":160,"../size.js":200,"../tilecoord.js":201}],129:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getForProjection=x,exports.wrapX=f,exports.createForExtent=g,exports.createXYZ=j,exports.createForProjection=p,exports.extentFromProjection=T;var e=require("./tilegrid/common.js"),t=require("./size.js"),r=require("./extent.js"),o=require("./extent/Corner.js"),n=a(o),i=require("./obj.js"),u=require("./proj.js"),s=require("./proj/Units.js"),d=a(s),c=require("./tilegrid/TileGrid.js"),l=a(c);function a(e){return e&&e.__esModule?e:{default:e}}function x(e){let t=e.getDefaultTileGrid();return t||(t=p(e),e.setDefaultTileGrid(t)),t}function f(e,t,o){const n=t[0],i=e.getTileCoordCenter(t),u=T(o);if((0,r.containsCoordinate)(u,i))return t;{const t=(0,r.getWidth)(u),o=Math.ceil((u[0]-i[0])/t);return i[0]+=t*o,e.getTileCoordForCoordAndZ(i,n)}}function g(e,t,o,i){const u=void 0!==i?i:n.default.TOP_LEFT,s=E(e,t,o);return new l.default({extent:e,origin:(0,r.getCorner)(e,u),resolutions:s,tileSize:o})}function j(e){const t={};return(0,i.assign)(t,void 0!==e?e:{}),void 0===t.extent&&(t.extent=(0,u.get)("EPSG:3857").getExtent()),t.resolutions=E(t.extent,t.maxZoom,t.tileSize),delete t.maxZoom,new l.default(t)}function E(o,n,i){const u=void 0!==n?n:e.DEFAULT_MAX_ZOOM,s=(0,r.getHeight)(o),d=(0,r.getWidth)(o),c=(0,t.toSize)(void 0!==i?i:e.DEFAULT_TILE_SIZE),l=Math.max(d/c[0],s/c[1]),a=u+1,x=new Array(a);for(let e=0;e<a;++e)x[e]=l/Math.pow(2,e);return x}function p(e,t,r,o){return g(T(e),t,r,o)}function T(e){let t=(e=(0,u.get)(e)).getExtent();if(!t){const o=180*u.METERS_PER_UNIT[d.default.DEGREES]/e.getMetersPerUnit();t=(0,r.createOrUpdate)(-o,-o,o,o)}return t}
},{"./tilegrid/common.js":225,"./size.js":200,"./extent.js":159,"./extent/Corner.js":246,"./obj.js":82,"./proj.js":58,"./proj/Units.js":132,"./tilegrid/TileGrid.js":234}],101:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileSourceEvent=void 0;var e=require("../index.js"),t=require("../functions.js"),i=require("../TileCache.js"),o=f(i),r=require("../TileState.js"),n=f(r),s=require("../events/Event.js"),l=f(s),u=require("../proj.js"),c=require("../size.js"),a=require("../source/Source.js"),p=f(a),h=require("../tilecoord.js"),d=require("../tilegrid.js");function f(e){return e&&e.__esModule?e:{default:e}}const g=function(e){p.default.call(this,{attributions:e.attributions,extent:e.extent,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new o.default(e.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:e.transition}};(0,e.inherits)(g,p.default),g.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},g.prototype.expireCache=function(e,t){const i=this.getTileCacheForProjection(e);i&&i.expireCache(t)},g.prototype.forEachLoadedTile=function(e,t,i,o){const r=this.getTileCacheForProjection(e);if(!r)return!1;let s,l,u,c=!0;for(let e=i.minX;e<=i.maxX;++e)for(let a=i.minY;a<=i.maxY;++a)l=(0,h.getKeyZXY)(t,e,a),u=!1,r.containsKey(l)&&(u=(s=r.get(l)).getState()===n.default.LOADED)&&(u=!1!==o(s)),u||(c=!1);return c},g.prototype.getGutter=function(e){return 0},g.prototype.getKey=function(){return this.key_},g.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},g.prototype.getOpaque=function(e){return this.opaque_},g.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},g.prototype.getTile=function(e,t,i,o,r){},g.prototype.getTileGrid=function(){return this.tileGrid},g.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:(0,d.getForProjection)(e)},g.prototype.getTileCacheForProjection=function(e){const t=this.getProjection();return t&&!(0,u.equivalent)(t,e)?null:this.tileCache},g.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_},g.prototype.getTilePixelSize=function(e,t,i){const o=this.getTileGridForProjection(i),r=this.getTilePixelRatio(t),n=(0,c.toSize)(o.getTileSize(e),this.tmpSize);return 1==r?n:(0,c.scale)(n,r,this.tmpSize)},g.prototype.getTileCoordForTileUrlFunction=function(e,t){const i=void 0!==t?t:this.getProjection(),o=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=(0,d.wrapX)(o,e,i)),(0,h.withinExtentAndZ)(e,o)?e:null},g.prototype.refresh=function(){this.tileCache.clear(),this.changed()},g.prototype.useTile=t.UNDEFINED;const y=exports.TileSourceEvent=function(e,t){l.default.call(this,e),this.tile=t};(0,e.inherits)(y,l.default),exports.default=g;
},{"../index.js":80,"../functions.js":195,"../TileCache.js":232,"../TileState.js":199,"../events/Event.js":211,"../proj.js":58,"../size.js":200,"../source/Source.js":99,"../tilecoord.js":201,"../tilegrid.js":129}],216:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};
},{}],108:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../TileState.js"),i=c(e),n=require("../tileurlfunction.js"),l=require("../source/Tile.js"),o=c(l),s=require("../source/TileEventType.js"),r=c(s),u=require("../tilecoord.js");function c(t){return t&&t.__esModule?t:{default:t}}const a=function(t){o.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,extent:t.extent,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition}),this.tileLoadFunction=t.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):n.nullTileUrlFunction,this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),t.tileUrlFunction&&this.setTileUrlFunction(t.tileUrlFunction),this.tileLoadingKeys_={}};(0,t.inherits)(a,o.default),a.prototype.fixedTileUrlFunction,a.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},a.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},a.prototype.getUrls=function(){return this.urls},a.prototype.handleTileChange=function(e){const n=e.target,o=(0,t.getUid)(n),s=n.getState();let u;s==i.default.LOADING?(this.tileLoadingKeys_[o]=!0,u=r.default.TILELOADSTART):o in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[o],u=s==i.default.ERROR?r.default.TILELOADERROR:s==i.default.LOADED||s==i.default.ABORT?r.default.TILELOADEND:void 0),void 0!=u&&this.dispatchEvent(new l.TileSourceEvent(u,n))},a.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},a.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},a.prototype.setUrl=function(t){const e=this.urls=(0,n.expandUrl)(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,n.createFromTemplates)(e,this.tileGrid),t)},a.prototype.setUrls=function(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,n.createFromTemplates)(t,this.tileGrid),e)},a.prototype.useTile=function(t,e,i){const n=(0,u.getKeyZXY)(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},exports.default=a;
},{"../index.js":80,"../TileState.js":199,"../tileurlfunction.js":214,"../source/Tile.js":101,"../source/TileEventType.js":216,"../tilecoord.js":201}],104:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../reproj/common.js"),t=require("../index.js"),i=require("../ImageTile.js"),r=f(i),o=require("../TileCache.js"),n=f(o),s=require("../TileState.js"),c=f(s),l=require("../events.js"),h=require("../events/EventType.js"),a=f(h),u=require("../proj.js"),d=require("../reproj/Tile.js"),p=f(d),E=require("../source/UrlTile.js"),g=f(E),j=require("../tilecoord.js"),T=require("../tilegrid.js");function f(e){return e&&e.__esModule?e:{default:e}}const C=function(e){g.default.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:P,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:r.default,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1};function P(e,t){e.getImage().src=t}(0,t.inherits)(C,g.default),C.prototype.canExpireCache=function(){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},C.prototype.expireCache=function(t,i){if(!e.ENABLE_RASTER_REPROJECTION)return void g.default.prototype.expireCache.call(this,t,i);const r=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==r?i:{});for(const e in this.tileCacheForProjection){const t=this.tileCacheForProjection[e];t.expireCache(t==r?i:{})}},C.prototype.getGutter=function(t){return e.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,u.equivalent)(this.getProjection(),t)?0:this.getGutterInternal()},C.prototype.getGutterInternal=function(){return 0},C.prototype.getOpaque=function(t){return!(e.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,u.equivalent)(this.getProjection(),t))&&g.default.prototype.getOpaque.call(this,t)},C.prototype.getTileGridForProjection=function(i){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.getTileGridForProjection.call(this,i);const r=this.getProjection();if(!this.tileGrid||r&&!(0,u.equivalent)(r,i)){const e=(0,t.getUid)(i).toString();return e in this.tileGridForProjection||(this.tileGridForProjection[e]=(0,T.getForProjection)(i)),this.tileGridForProjection[e]}return this.tileGrid},C.prototype.getTileCacheForProjection=function(i){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.getTileCacheForProjection.call(this,i);const r=this.getProjection();if(!r||(0,u.equivalent)(r,i))return this.tileCache;{const e=(0,t.getUid)(i).toString();return e in this.tileCacheForProjection||(this.tileCacheForProjection[e]=new n.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[e]}},C.prototype.createTile_=function(e,t,i,r,o,n){const s=[e,t,i],h=this.getTileCoordForTileUrlFunction(s,o),u=h?this.tileUrlFunction(h,r,o):void 0,d=new this.tileClass(s,void 0!==u?c.default.IDLE:c.default.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=n,(0,l.listen)(d,a.default.CHANGE,this.handleTileChange,this),d},C.prototype.getTile=function(t,i,r,o,n){const s=this.getProjection();if(e.ENABLE_RASTER_REPROJECTION&&s&&n&&!(0,u.equivalent)(s,n)){const e=this.getTileCacheForProjection(n),c=[t,i,r];let l;const h=(0,j.getKey)(c);e.containsKey(h)&&(l=e.get(h));const a=this.getKey();if(l&&l.key==a)return l;{const t=this.getTileGridForProjection(s),i=this.getTileGridForProjection(n),r=this.getTileCoordForTileUrlFunction(c,n),u=new p.default(s,t,n,i,c,r,this.getTilePixelRatio(o),this.getGutterInternal(),function(e,t,i,r){return this.getTileInternal(e,t,i,r,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return u.key=a,l?(u.interimTile=l,u.refreshInterimChain(),e.replace(h,u)):e.set(h,u),u}}return this.getTileInternal(t,i,r,o,s||n)},C.prototype.getTileInternal=function(e,t,i,r,o){let n=null;const s=(0,j.getKeyZXY)(e,t,i),l=this.getKey();if(this.tileCache.containsKey(s)){if((n=this.tileCache.get(s)).key!=l){const h=n;n=this.createTile_(e,t,i,r,o,l),h.getState()==c.default.IDLE?n.interimTile=h.interimTile:n.interimTile=h,n.refreshInterimChain(),this.tileCache.replace(s,n)}}else n=this.createTile_(e,t,i,r,o,l),this.tileCache.set(s,n);return n},C.prototype.setRenderReprojectionEdges=function(t){if(e.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},C.prototype.setTileGridForProjection=function(i,r){if(e.ENABLE_RASTER_REPROJECTION){const e=(0,u.get)(i);if(e){const i=(0,t.getUid)(e).toString();i in this.tileGridForProjection||(this.tileGridForProjection[i]=r)}}},exports.default=C;
},{"../reproj/common.js":210,"../index.js":80,"../ImageTile.js":233,"../TileCache.js":232,"../TileState.js":199,"../events.js":193,"../events/EventType.js":194,"../proj.js":58,"../reproj/Tile.js":249,"../source/UrlTile.js":108,"../tilecoord.js":201,"../tilegrid.js":129}],88:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../tileurlfunction.js"),i=require("../extent.js"),r=require("../net.js"),o=require("../proj.js"),s=require("../source/State.js"),a=l(s),n=require("../source/TileImage.js"),u=l(n),c=require("../tilecoord.js"),h=require("../tilegrid.js");function l(e){return e&&e.__esModule?e:{default:e}}const d=function(e){this.hidpi_=void 0!==e.hidpi&&e.hidpi,u.default.call(this,{cacheSize:e.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:(0,o.get)("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:a.default.LOADING,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:this.hidpi_?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.culture_=void 0!==e.culture?e.culture:"en-us",this.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1,this.apiKey_=e.key,this.imagerySet_=e.imagerySet;const t="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;(0,r.jsonp)(t,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")};(0,e.inherits)(d,u.default);const m='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>';d.prototype.getApiKey=function(){return this.apiKey_},d.prototype.getImagerySet=function(){return this.imagerySet_},d.prototype.handleImageryMetadataResponse=function(e){if(200!=e.statusCode||"OK"!=e.statusDescription||"ValidCredentials"!=e.authenticationResultCode||1!=e.resourceSets.length||1!=e.resourceSets[0].resources.length)return void this.setState(a.default.ERROR);const r=e.resourceSets[0].resources[0],s=-1==this.maxZoom_?r.zoomMax:this.maxZoom_,n=this.getProjection(),u=(0,h.extentFromProjection)(n),l=r.imageWidth==r.imageHeight?r.imageWidth:[r.imageWidth,r.imageHeight],d=(0,h.createXYZ)({extent:u,minZoom:r.zoomMin,maxZoom:s,tileSize:l/(this.hidpi_?2:1)});this.tileGrid=d;const p=this.culture_,g=this.hidpi_;if(this.tileUrlFunction=(0,t.createFromTileUrlFunctions)(r.imageUrlSubdomains.map(function(e){const t=[0,0,0],i=r.imageUrl.replace("{subdomain}",e).replace("{culture}",p);return function(e,r,o){if(e){(0,c.createOrUpdate)(e[0],e[1],-e[2]-1,t);let r=i;return g&&(r+="&dpi=d1&device=mobile"),r.replace("{quadkey}",(0,c.quadKey)(t))}}})),r.imageryProviders){const e=(0,o.getTransformFromProjections)((0,o.get)("EPSG:4326"),this.getProjection());this.setAttributions(function(t){const o=[],s=t.viewState.zoom;return r.imageryProviders.map(function(r){let a=!1;const n=r.coverageAreas;for(let r=0,o=n.length;r<o;++r){const o=n[r];if(s>=o.zoomMin&&s<=o.zoomMax){const r=o.bbox,s=[r[1],r[0],r[3],r[2]],n=(0,i.applyTransform)(s,e);if((0,i.intersects)(n,t.extent)){a=!0;break}}}a&&o.push(r.attribution)}),o.push(m),o})}this.setState(a.default.READY)},exports.default=d;
},{"../index.js":80,"../tileurlfunction.js":214,"../extent.js":159,"../net.js":215,"../proj.js":58,"../source/State.js":197,"../source/TileImage.js":104,"../tilecoord.js":201,"../tilegrid.js":129}],62:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),i=require("../source/TileImage.js"),t=o(i),r=require("../tilegrid.js");function o(e){return e&&e.__esModule?e:{default:e}}const n=function(e){const i=e||{},o=void 0!==i.projection?i.projection:"EPSG:3857",n=void 0!==i.tileGrid?i.tileGrid:(0,r.createXYZ)({extent:(0,r.extentFromProjection)(o),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});t.default.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:o,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})};(0,e.inherits)(n,t.default),exports.default=n;
},{"../index.js":80,"../source/TileImage.js":104,"../tilegrid.js":129}],89:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../obj.js"),i=require("../source/State.js"),s=a(i),n=require("../source/XYZ.js"),o=a(n);function a(t){return t&&t.__esModule?t:{default:t}}const r=function(t){this.account_=t.account,this.mapId_=t.map||"",this.config_=t.config||{},this.templateCache_={},o.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,maxZoom:void 0!==t.maxZoom?t.maxZoom:18,minZoom:t.minZoom,projection:t.projection,state:s.default.LOADING,wrapX:t.wrapX}),this.initializeMap_()};(0,t.inherits)(r,o.default),r.prototype.getConfig=function(){return this.config_},r.prototype.updateConfig=function(t){(0,e.assign)(this.config_,t),this.initializeMap_()},r.prototype.setConfig=function(t){this.config_=t||{},this.initializeMap_()},r.prototype.initializeMap_=function(){const t=JSON.stringify(this.config_);if(this.templateCache_[t])return void this.applyTemplate_(this.templateCache_[t]);let e="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(e+="/named/"+this.mapId_);const i=new XMLHttpRequest;i.addEventListener("load",this.handleInitResponse_.bind(this,t)),i.addEventListener("error",this.handleInitError_.bind(this)),i.open("POST",e),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(this.config_))},r.prototype.handleInitResponse_=function(t,e){const i=e.target;if(!i.status||i.status>=200&&i.status<300){let e;try{e=JSON.parse(i.responseText)}catch(t){return void this.setState(s.default.ERROR)}this.applyTemplate_(e),this.templateCache_[t]=e,this.setState(s.default.READY)}else this.setState(s.default.ERROR)},r.prototype.handleInitError_=function(t){this.setState(s.default.ERROR)},r.prototype.applyTemplate_=function(t){const e="https://"+t.cdn_url.https+"/"+this.account_+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)},exports.default=r;
},{"../index.js":80,"../obj.js":82,"../source/State.js":197,"../source/XYZ.js":62}],90:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../asserts.js"),s=require("../Feature.js"),r=d(s),i=require("../coordinate.js"),o=require("../events.js"),n=require("../events/EventType.js"),u=d(n),c=require("../extent.js"),a=require("../geom/Point.js"),h=d(a),l=require("../source/Vector.js"),f=d(l);function d(t){return t&&t.__esModule?t:{default:t}}const p=function(t){f.default.call(this,{attributions:t.attributions,extent:t.extent,projection:t.projection,wrapX:t.wrapX}),this.resolution=void 0,this.distance=void 0!==t.distance?t.distance:20,this.features=[],this.geometryFunction=t.geometryFunction||function(t){const s=t.getGeometry();return(0,e.assert)(s instanceof h.default,10),s},this.source=t.source,(0,o.listen)(this.source,u.default.CHANGE,this.refresh,this)};(0,t.inherits)(p,f.default),p.prototype.getDistance=function(){return this.distance},p.prototype.getSource=function(){return this.source},p.prototype.loadFeatures=function(t,e,s){this.source.loadFeatures(t,e,s),e!==this.resolution&&(this.clear(),this.resolution=e,this.cluster(),this.addFeatures(this.features))},p.prototype.setDistance=function(t){this.distance=t,this.refresh()},p.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features),f.default.prototype.refresh.call(this)},p.prototype.cluster=function(){if(void 0===this.resolution)return;this.features.length=0;const e=(0,c.createEmpty)(),s=this.distance*this.resolution,r=this.source.getFeatures(),i={};for(let o=0,n=r.length;o<n;o++){const n=r[o];if(!((0,t.getUid)(n).toString()in i)){const r=this.geometryFunction(n);if(r){const o=r.getCoordinates();(0,c.createOrUpdateFromCoordinate)(o,e),(0,c.buffer)(e,s,e);let n=this.source.getFeaturesInExtent(e);n=n.filter(function(e){const s=(0,t.getUid)(e).toString();return!(s in i)&&(i[s]=!0,!0)}),this.features.push(this.createCluster(n))}}}},p.prototype.createCluster=function(t){const e=[0,0];for(let s=t.length-1;s>=0;--s){const r=this.geometryFunction(t[s]);r?(0,i.add)(e,r.getCoordinates()):t.splice(s,1)}(0,i.scale)(e,1/t.length);const s=new r.default(new h.default(e));return s.set("features",t),s},exports.default=p;
},{"../index.js":80,"../asserts.js":165,"../Feature.js":166,"../coordinate.js":217,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../geom/Point.js":174,"../source/Vector.js":109}],212:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../index.js"),s=require("../ImageBase.js"),i=_(s),r=require("../ImageState.js"),o=_(r),n=require("../events.js"),a=require("../events/EventType.js"),u=_(a),c=require("../extent.js"),l=require("../reproj.js"),h=require("../reproj/Triangulation.js"),g=_(h);function _(t){return t&&t.__esModule?t:{default:t}}const d=function(e,s,r,n,a,u){this.targetProj_=s,this.maxSourceExtent_=e.getExtent();const h=s.getExtent(),_=h?(0,c.getIntersection)(r,h):r,d=(0,c.getCenter)(_),f=(0,l.calculateSourceResolution)(e,s,d,n),p=t.ERROR_THRESHOLD;this.triangulation_=new g.default(e,s,_,this.maxSourceExtent_,f*p),this.targetResolution_=n,this.targetExtent_=r;const x=this.triangulation_.calculateSourceExtent();this.sourceImage_=u(x,f,a),this.sourcePixelRatio_=this.sourceImage_?this.sourceImage_.getPixelRatio():1,this.canvas_=null,this.sourceListenerKey_=null;let E=o.default.LOADED;this.sourceImage_&&(E=o.default.IDLE),i.default.call(this,r,n,this.sourcePixelRatio_,E)};(0,e.inherits)(d,i.default),d.prototype.disposeInternal=function(){this.state==o.default.LOADING&&this.unlistenSource_(),i.default.prototype.disposeInternal.call(this)},d.prototype.getImage=function(){return this.canvas_},d.prototype.getProjection=function(){return this.targetProj_},d.prototype.reproject_=function(){const t=this.sourceImage_.getState();if(t==o.default.LOADED){const t=(0,c.getWidth)(this.targetExtent_)/this.targetResolution_,e=(0,c.getHeight)(this.targetExtent_)/this.targetResolution_;this.canvas_=(0,l.render)(t,e,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},d.prototype.load=function(){if(this.state==o.default.IDLE){this.state=o.default.LOADING,this.changed();const t=this.sourceImage_.getState();t==o.default.LOADED||t==o.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,n.listen)(this.sourceImage_,u.default.CHANGE,function(t){const e=this.sourceImage_.getState();e!=o.default.LOADED&&e!=o.default.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},d.prototype.unlistenSource_=function(){(0,n.unlistenByKey)(this.sourceListenerKey_),this.sourceListenerKey_=null},exports.default=d;
},{"./common.js":210,"../index.js":80,"../ImageBase.js":308,"../ImageState.js":191,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../reproj.js":260,"../reproj/Triangulation.js":309}],91:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultImageLoadFunction=f;var e=require("../reproj/common.js"),t=require("../index.js"),r=require("../ImageState.js"),i=h(r),s=require("../array.js"),o=require("../events/Event.js"),n=h(o),a=require("../extent.js"),u=require("../proj.js"),c=require("../reproj/Image.js"),l=h(c),d=require("../source/Source.js"),g=h(d);function h(e){return e&&e.__esModule?e:{default:e}}const p={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},j=function(e,t){n.default.call(this,e),this.image=t};(0,t.inherits)(j,n.default);const I=function(e){g.default.call(this,{attributions:e.attributions,extent:e.extent,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0};function f(e,t){e.getImage().src=t}(0,t.inherits)(I,g.default),I.prototype.getResolutions=function(){return this.resolutions_},I.prototype.findNearestResolution=function(e){if(this.resolutions_){const t=(0,s.linearFindNearest)(this.resolutions_,e,0);e=this.resolutions_[t]}return e},I.prototype.getImage=function(t,r,i,s){const o=this.getProjection();if(e.ENABLE_RASTER_REPROJECTION&&o&&s&&!(0,u.equivalent)(o,s)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,u.equivalent)(this.reprojectedImage_.getProjection(),s)&&this.reprojectedImage_.getResolution()==r&&(0,a.equals)(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new l.default(o,s,t,r,i,function(e,t,r){return this.getImageInternal(e,t,r,o)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return o&&(s=o),this.getImageInternal(t,r,i,s)},I.prototype.getImageInternal=function(e,t,r,i){},I.prototype.handleImageChange=function(e){const t=e.target;switch(t.getState()){case i.default.LOADING:this.dispatchEvent(new j(p.IMAGELOADSTART,t));break;case i.default.LOADED:this.dispatchEvent(new j(p.IMAGELOADEND,t));break;case i.default.ERROR:this.dispatchEvent(new j(p.IMAGELOADERROR,t))}},exports.default=I;
},{"../reproj/common.js":210,"../index.js":80,"../ImageState.js":191,"../array.js":209,"../events/Event.js":211,"../extent.js":159,"../proj.js":58,"../reproj/Image.js":212,"../source/Source.js":99}],190:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index.js"),t=require("./ImageBase.js"),i=o(t),s=require("./ImageState.js"),a=o(s),n=require("./events.js"),h=require("./events/EventType.js"),r=o(h),u=require("./extent.js");function o(e){return e&&e.__esModule?e:{default:e}}const l=function(e,t,s,n,h,r){i.default.call(this,e,t,s,a.default.IDLE),this.src_=n,this.image_=new Image,null!==h&&(this.image_.crossOrigin=h),this.imageListenerKeys_=null,this.state=a.default.IDLE,this.imageLoadFunction_=r};(0,e.inherits)(l,i.default),l.prototype.getImage=function(){return this.image_},l.prototype.handleImageError_=function(){this.state=a.default.ERROR,this.unlistenImage_(),this.changed()},l.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=(0,u.getHeight)(this.extent)/this.image_.height),this.state=a.default.LOADED,this.unlistenImage_(),this.changed()},l.prototype.load=function(){this.state!=a.default.IDLE&&this.state!=a.default.ERROR||(this.state=a.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,n.listenOnce)(this.image_,r.default.ERROR,this.handleImageError_,this),(0,n.listenOnce)(this.image_,r.default.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},l.prototype.setImage=function(e){this.image_=e},l.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(n.unlistenByKey),this.imageListenerKeys_=null},exports.default=l;
},{"./index.js":80,"./ImageBase.js":308,"./ImageState.js":191,"./events.js":193,"./events/EventType.js":194,"./extent.js":159}],218:[function(require,module,exports) {
"use strict";function e(e,n){const o=[];Object.keys(n).forEach(function(e){null!==n[e]&&void 0!==n[e]&&o.push(e+"="+encodeURIComponent(n[e]))});const t=o.join("&");return(e=-1===(e=e.replace(/[?&]$/,"")).indexOf("?")?e+"?":e+"&")+t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.appendParams=e;
},{}],92:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../Image.js"),i=c(e),s=require("../asserts.js"),r=require("../events.js"),n=require("../events/EventType.js"),o=c(n),a=require("../extent.js"),u=require("../obj.js"),h=require("../source/Image.js"),g=c(h),l=require("../uri.js");function c(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const e=t||{};g.default.call(this,{attributions:e.attributions,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,this.hidpi_=void 0===e.hidpi||e.hidpi,this.url_=e.url,this.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:h.defaultImageLoadFunction,this.params_=e.params||{},this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==e.ratio?e.ratio:1.5};(0,t.inherits)(d,g.default),d.prototype.getParams=function(){return this.params_},d.prototype.getImageInternal=function(t,e,s,n){if(void 0===this.url_)return null;e=this.findNearestResolution(e),s=this.hidpi_?s:1;const h=this.image_;if(h&&this.renderedRevision_==this.getRevision()&&h.getResolution()==e&&h.getPixelRatio()==s&&(0,a.containsExtent)(h.getExtent(),t))return h;const g={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};(0,u.assign)(g,this.params_);const l=((t=t.slice())[0]+t[2])/2,c=(t[1]+t[3])/2;if(1!=this.ratio_){const e=this.ratio_*(0,a.getWidth)(t)/2,i=this.ratio_*(0,a.getHeight)(t)/2;t[0]=l-e,t[1]=c-i,t[2]=l+e,t[3]=c+i}const d=e/s,p=Math.ceil((0,a.getWidth)(t)/d),_=Math.ceil((0,a.getHeight)(t)/d);t[0]=l-d*p/2,t[2]=l+d*p/2,t[1]=c-d*_/2,t[3]=c+d*_/2,this.imageSize_[0]=p,this.imageSize_[1]=_;const m=this.getRequestUrl_(t,this.imageSize_,s,n,g);return this.image_=new i.default(t,e,s,m,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),(0,r.listen)(this.image_,o.default.CHANGE,this.handleImageChange,this),this.image_},d.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},d.prototype.getRequestUrl_=function(t,e,i,r,n){const o=r.getCode().split(":").pop();n.SIZE=e[0]+","+e[1],n.BBOX=t.join(","),n.BBOXSR=o,n.IMAGESR=o,n.DPI=Math.round(90*i);const a=this.url_,u=a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return u==a&&(0,s.assert)(!1,50),(0,l.appendParams)(u,n)},d.prototype.getUrl=function(){return this.url_},d.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},d.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},d.prototype.updateParams=function(t){(0,u.assign)(this.params_,t),this.image_=null,this.changed()},exports.default=d;
},{"../index.js":80,"../Image.js":190,"../asserts.js":165,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../obj.js":82,"../source/Image.js":91,"../uri.js":218}],93:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../ImageCanvas.js"),i=r(e),n=require("../extent.js"),s=require("../source/Image.js"),o=r(s);function r(t){return t&&t.__esModule?t:{default:t}}const a=function(t){o.default.call(this,{attributions:t.attributions,projection:t.projection,resolutions:t.resolutions,state:t.state}),this.canvasFunction_=t.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5};(0,t.inherits)(a,o.default),a.prototype.getImageInternal=function(t,e,s,o){e=this.findNearestResolution(e);let r=this.canvas_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==s&&(0,n.containsExtent)(r.getExtent(),t))return r;t=t.slice(),(0,n.scaleFromCenter)(t,this.ratio_);const a=[(0,n.getWidth)(t)/e*s,(0,n.getHeight)(t)/e*s],u=this.canvasFunction_(t,e,s,a,o);return u&&(r=new i.default(t,e,s,u)),this.canvas_=r,this.renderedRevision_=this.getRevision(),r},exports.default=a;
},{"../index.js":80,"../ImageCanvas.js":189,"../extent.js":159,"../source/Image.js":91}],94:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),i=require("../Image.js"),t=l(i),s=require("../events.js"),r=require("../events/EventType.js"),n=l(r),o=require("../extent.js"),a=require("../obj.js"),u=require("../source/Image.js"),h=l(u),d=require("../uri.js");function l(e){return e&&e.__esModule?e:{default:e}}const g=function(e){h.default.call(this,{projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,this.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,this.params_=e.params||{},this.url_=e.url,this.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:u.defaultImageLoadFunction,this.hidpi_=void 0===e.hidpi||e.hidpi,this.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,this.ratio_=void 0!==e.ratio?e.ratio:1,this.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,this.image_=null,this.renderedRevision_=0};function p(e,i,t,s){const r=(0,o.getWidth)(e),n=(0,o.getHeight)(e),a=i[0],u=i[1],h=.0254/s;return u*r>a*n?r*t/(a*h):n*t/(u*h)}(0,e.inherits)(g,h.default),g.prototype.getParams=function(){return this.params_},g.prototype.getImageInternal=function(e,i,r,a){i=this.findNearestResolution(i),r=this.hidpi_?r:1;let u=this.image_;if(u&&this.renderedRevision_==this.getRevision()&&u.getResolution()==i&&u.getPixelRatio()==r&&(0,o.containsExtent)(u.getExtent(),e))return u;1!=this.ratio_&&(e=e.slice(),(0,o.scaleFromCenter)(e,this.ratio_));const h=[(0,o.getWidth)(e)/i*r,(0,o.getHeight)(e)/i*r];if(void 0!==this.url_){const o=this.getUrl(this.url_,this.params_,e,h,a);u=new t.default(e,i,r,o,this.crossOrigin_,this.imageLoadFunction_),(0,s.listen)(u,n.default.CHANGE,this.handleImageChange,this)}else u=null;return this.image_=u,this.renderedRevision_=this.getRevision(),u},g.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},g.prototype.updateParams=function(e){(0,a.assign)(this.params_,e),this.changed()},g.prototype.getUrl=function(e,i,t,s,r){const n=p(t,s,this.metersPerUnit_,this.displayDpi_),u=(0,o.getCenter)(t),h={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(s[0]),SETDISPLAYHEIGHT:Math.round(s[1]),SETVIEWSCALE:n,SETVIEWCENTERX:u[0],SETVIEWCENTERY:u[1]};return(0,a.assign)(h,i),(0,d.appendParams)(e,h)},g.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},exports.default=g;
},{"../index.js":80,"../Image.js":190,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../obj.js":82,"../source/Image.js":91,"../uri.js":218}],95:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Image.js"),i=d(t),a=require("../ImageState.js"),n=d(a),s=require("../dom.js"),r=require("../events.js"),g=require("../events/EventType.js"),o=d(g),u=require("../extent.js"),h=require("../proj.js"),l=require("../source/Image.js"),m=d(l);function d(e){return e&&e.__esModule?e:{default:e}}const c=function(e){const t=e.imageExtent,a=void 0!==e.crossOrigin?e.crossOrigin:null,n=void 0!==e.imageLoadFunction?e.imageLoadFunction:l.defaultImageLoadFunction;m.default.call(this,{attributions:e.attributions,projection:(0,h.get)(e.projection)}),this.image_=new i.default(t,void 0,1,e.url,a,n),this.imageSize_=e.imageSize?e.imageSize:null,(0,r.listen)(this.image_,o.default.CHANGE,this.handleImageChange,this)};(0,e.inherits)(c,m.default),c.prototype.getImageInternal=function(e,t,i,a){return(0,u.intersects)(e,this.image_.getExtent())?this.image_:null},c.prototype.handleImageChange=function(e){if(this.image_.getState()==n.default.LOADED){const e=this.image_.getExtent(),t=this.image_.getImage();let i,a;this.imageSize_?(i=this.imageSize_[0],a=this.imageSize_[1]):(i=t.width,a=t.height);const n=(0,u.getHeight)(e)/a,r=Math.ceil((0,u.getWidth)(e)/n);if(r!=i){const e=(0,s.createCanvasContext2D)(r,a),n=e.canvas;e.drawImage(t,0,0,i,a,0,0,n.width,n.height),this.image_.setImage(n)}}m.default.prototype.handleImageChange.call(this,e)},exports.default=c;
},{"../index.js":80,"../Image.js":190,"../ImageState.js":191,"../dom.js":192,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../proj.js":58,"../source/Image.js":91}],262:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.DEFAULT_WMS_VERSION="1.3.0";
},{}],263:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};
},{}],96:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../index.js"),i=require("../Image.js"),s=m(i),r=require("../asserts.js"),n=require("../events.js"),o=require("../events/EventType.js"),a=m(o),u=require("../extent.js"),h=require("../obj.js"),_=require("../proj.js"),g=require("../reproj.js"),d=require("../source/Image.js"),c=m(d),l=require("../source/WMSServerType.js"),p=m(l),R=require("../string.js"),S=require("../uri.js");function m(t){return t&&t.__esModule?t:{default:t}}const E=function(t){const e=t||{};c.default.call(this,{attributions:e.attributions,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:d.defaultImageLoadFunction,this.params_=e.params||{},this.v13_=!0,this.updateV13_(),this.serverType_=e.serverType,this.hidpi_=void 0===e.hidpi||e.hidpi,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==e.ratio?e.ratio:1.5};(0,e.inherits)(E,c.default);const f=[101,101];E.prototype.getGetFeatureInfoUrl=function(e,i,s,r){if(void 0===this.url_)return;const n=(0,_.get)(s),o=this.getProjection();o&&o!==n&&(i=(0,g.calculateSourceResolution)(o,n,e,i),e=(0,_.transform)(e,n,o));const a=(0,u.getForViewAndSize)(e,i,0,f),d={SERVICE:"WMS",VERSION:t.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};(0,h.assign)(d,this.params_,r);const c=Math.floor((e[0]-a[0])/i),l=Math.floor((a[3]-e[1])/i);return d[this.v13_?"I":"X"]=c,d[this.v13_?"J":"Y"]=l,this.getRequestUrl_(a,f,1,o||n,d)},E.prototype.getParams=function(){return this.params_},E.prototype.getImageInternal=function(e,i,r,o){if(void 0===this.url_)return null;i=this.findNearestResolution(i),1==r||this.hidpi_&&void 0!==this.serverType_||(r=1);const _=i/r,g=(0,u.getCenter)(e),d=Math.ceil((0,u.getWidth)(e)/_),c=Math.ceil((0,u.getHeight)(e)/_),l=(0,u.getForViewAndSize)(g,_,0,[d,c]),p=Math.ceil(this.ratio_*(0,u.getWidth)(e)/_),R=Math.ceil(this.ratio_*(0,u.getHeight)(e)/_),S=(0,u.getForViewAndSize)(g,_,0,[p,R]),m=this.image_;if(m&&this.renderedRevision_==this.getRevision()&&m.getResolution()==i&&m.getPixelRatio()==r&&(0,u.containsExtent)(m.getExtent(),l))return m;const E={SERVICE:"WMS",VERSION:t.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};(0,h.assign)(E,this.params_),this.imageSize_[0]=Math.round((0,u.getWidth)(S)/_),this.imageSize_[1]=Math.round((0,u.getHeight)(S)/_);const f=this.getRequestUrl_(S,this.imageSize_,r,o,E);return this.image_=new s.default(S,i,r,f,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),(0,n.listen)(this.image_,a.default.CHANGE,this.handleImageChange,this),this.image_},E.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},E.prototype.getRequestUrl_=function(t,e,i,s,n){if((0,r.assert)(void 0!==this.url_,9),n[this.v13_?"CRS":"SRS"]=s.getCode(),"STYLES"in this.params_||(n.STYLES=""),1!=i)switch(this.serverType_){case p.default.GEOSERVER:const t=90*i+.5|0;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+t:n.FORMAT_OPTIONS="dpi:"+t;break;case p.default.MAPSERVER:n.MAP_RESOLUTION=90*i;break;case p.default.CARMENTA_SERVER:case p.default.QGIS:n.DPI=90*i;break;default:(0,r.assert)(!1,8)}n.WIDTH=e[0],n.HEIGHT=e[1];const o=s.getAxisOrientation();let a;return a=this.v13_&&"ne"==o.substr(0,2)?[t[1],t[0],t[3],t[2]]:t,n.BBOX=a.join(","),(0,S.appendParams)(this.url_,n)},E.prototype.getUrl=function(){return this.url_},E.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},E.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},E.prototype.updateParams=function(t){(0,h.assign)(this.params_,t),this.updateV13_(),this.image_=null,this.changed()},E.prototype.updateV13_=function(){const e=this.params_.VERSION||t.DEFAULT_WMS_VERSION;this.v13_=(0,R.compareVersions)(e,"1.3")>=0},exports.default=E;
},{"./common.js":262,"../index.js":80,"../Image.js":190,"../asserts.js":165,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../obj.js":82,"../proj.js":58,"../reproj.js":260,"../source/Image.js":91,"../source/WMSServerType.js":263,"../string.js":261,"../uri.js":218}],97:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ATTRIBUTION=void 0;var o=require("../index.js"),e=require("../source/XYZ.js"),r=t(e);function t(o){return o&&o.__esModule?o:{default:o}}const i=exports.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',s=function(o){const e=o||{};let t;t=void 0!==e.attributions?e.attributions:[i];const s=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",n=void 0!==e.url?e.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";r.default.call(this,{attributions:t,cacheSize:e.cacheSize,crossOrigin:s,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:n,wrapX:e.wrapX})};(0,o.inherits)(s,r.default),exports.default=s;
},{"../index.js":80,"../source/XYZ.js":62}],341:[function(require,module,exports) {
var a=!0;try{new ImageData(10,10)}catch(e){a=!1}var e=document.createElement("canvas").getContext("2d");function t(t,n,r){if(a)return new ImageData(t,n,r);var c=e.createImageData(n,r);return c.data.set(t),c}exports.newImageData=t;
},{}],316:[function(require,module,exports) {
var t=require("./util").newImageData;function e(t){var e=!0;try{new ImageData(10,10)}catch(t){e=!1}function a(t,a,i){return e?new ImageData(t,a,i):{data:t,width:a,height:i}}return function(e){var i,r,n=e.buffers,s=e.meta,o=e.imageOps,u=e.width,h=e.height,f=n.length,p=n[0].byteLength;if(o){var _=new Array(f);for(r=0;r<f;++r)_[r]=a(new Uint8ClampedArray(n[r]),u,h);i=t(_,s).data}else{i=new Uint8ClampedArray(p);var l=new Array(f),d=new Array(f);for(r=0;r<f;++r)l[r]=new Uint8ClampedArray(n[r]),d[r]=[0,0,0,0];for(var g=0;g<p;g+=4){for(var m=0;m<f;++m){var c=l[m];d[m][0]=c[g],d[m][1]=c[g+1],d[m][2]=c[g+2],d[m][3]=c[g+3]}var v=t(d,s);i[g]=v[0],i[g+1]=v[1],i[g+2]=v[2],i[g+3]=v[3]}}return i.buffer}}function a(t,a){var i=Object.keys(t.lib||{}).map(function(e){return"var "+e+" = "+t.lib[e].toString()+";"}).concat(["var __minion__ = ("+e.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),r=new Blob(i,{type:"text/javascript"}),n=URL.createObjectURL(r),s=new Worker(n);return s.addEventListener("message",a),s}function i(t,a){var i=e(t.operation);return{postMessage:function(t){setTimeout(function(){a({data:{buffer:i(t),meta:t.meta}})},0)}}}function r(t){var e;this._imageOps=!!t.imageOps;var r=[];if(e=0===t.threads?0:this._imageOps?1:t.threads||1)for(var n=0;n<e;++n)r[n]=a(t,this._onWorkerMessage.bind(this,n));else r[0]=i(t,this._onWorkerMessage.bind(this,0));this._workers=r,this._queue=[],this._maxQueueLength=t.queue||1/0,this._running=0,this._dataLookup={},this._job=null}r.prototype.process=function(t,e,a){this._enqueue({inputs:t,meta:e,callback:a}),this._dispatch()},r.prototype.destroy=function(){for(var t in this)this[t]=null;this._destroyed=!0},r.prototype._enqueue=function(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},r.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var t=this._job=this._queue.shift(),e=t.inputs[0].width,a=t.inputs[0].height,i=t.inputs.map(function(t){return t.data.buffer}),r=this._workers.length;if(this._running=r,1===r)this._workers[0].postMessage({buffers:i,meta:t.meta,imageOps:this._imageOps,width:e,height:a},i);else for(var n=t.inputs[0].data.length,s=4*Math.ceil(n/4/r),o=0;o<r;++o){for(var u=o*s,h=[],f=0,p=i.length;f<p;++f)h.push(i[o].slice(u,u+s));this._workers[o].postMessage({buffers:h,meta:t.meta,imageOps:this._imageOps,width:e,height:a},h)}}},r.prototype._onWorkerMessage=function(t,e){this._destroyed||(this._dataLookup[t]=e.data,--this._running,0===this._running&&this._resolveJob())},r.prototype._resolveJob=function(){var e,a,i=this._job,r=this._workers.length;if(1===r)e=new Uint8ClampedArray(this._dataLookup[0].buffer),a=this._dataLookup[0].meta;else{var n=i.inputs[0].data.length;e=new Uint8ClampedArray(n),a=new Array(n);for(var s=4*Math.ceil(n/4/r),o=0;o<r;++o){var u=this._dataLookup[o].buffer,h=o*s;e.set(new Uint8ClampedArray(u),h),a[o]=this._dataLookup[o].meta}}this._job=null,this._dataLookup={},i.callback(null,t(e,i.inputs[0].width,i.inputs[0].height),a),this._dispatch()},module.exports=r;
},{"./util":341}],248:[function(require,module,exports) {
var r=require("./processor");exports.Processor=r;
},{"./processor":316}],98:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../ImageCanvas.js"),r=j(t),n=require("../TileQueue.js"),s=j(n),i=require("../dom.js"),a=require("../events.js"),o=require("../events/Event.js"),u=j(o),d=require("../events/EventType.js"),l=j(d),h=require("pixelworks/lib/index"),c=require("../extent.js"),f=require("../layer/Image.js"),p=j(f),g=require("../layer/Tile.js"),_=j(g),m=require("../obj.js"),v=require("../renderer/canvas/ImageLayer.js"),S=j(v),y=require("../renderer/canvas/TileLayer.js"),I=j(y),q=require("../source/Image.js"),w=j(q),x=require("../source/State.js"),C=j(x),T=require("../source/Tile.js"),E=j(T),R=require("../transform.js");function j(e){return e&&e.__esModule?e:{default:e}}const F={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"},A={PIXEL:"pixel",IMAGE:"image"},O=function(e,t,r){u.default.call(this,e),this.extent=t.extent,this.resolution=t.viewState.resolution/t.pixelRatio,this.data=r};(0,e.inherits)(O,u.default);const b=function(t){this.worker_=null,this.operationType_=void 0!==t.operationType?t.operationType:A.PIXEL,this.threads_=void 0!==t.threads?t.threads:1,this.renderers_=D(t.sources);for(let e=0,t=this.renderers_.length;e<t;++e)(0,a.listen)(this.renderers_[e],l.default.CHANGE,this.changed,this);this.tileQueue_=new s.default(function(){return 1},this.changed.bind(this));const r=k(this.renderers_),n={};for(let t=0,s=r.length;t<s;++t)n[(0,e.getUid)(r[t].layer)]=r[t];this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:(0,R.create)(),extent:null,focus:null,index:0,layerStates:n,layerStatesArray:r,pixelRatio:1,pixelToCoordinateTransform:(0,R.create)(),postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}},w.default.call(this,{}),void 0!==t.operation&&this.setOperation(t.operation,t.lib)};(0,e.inherits)(b,w.default),b.prototype.setOperation=function(e,t){this.worker_=new h.Processor({operation:e,imageOps:this.operationType_===A.IMAGE,queue:1,lib:t,threads:this.threads_}),this.changed()},b.prototype.updateFrameState_=function(e,t,r){const n=(0,m.assign)({},this.frameState_);n.viewState=(0,m.assign)({},n.viewState);const s=(0,c.getCenter)(e);n.extent=e.slice(),n.focus=s,n.size[0]=Math.round((0,c.getWidth)(e)/t),n.size[1]=Math.round((0,c.getHeight)(e)/t),n.time=Date.now(),n.animate=!1;const i=n.viewState;return i.center=s,i.projection=r,i.resolution=t,n},b.prototype.allSourcesReady_=function(){let e,t=!0;for(let r=0,n=this.renderers_.length;r<n;++r)if((e=this.renderers_[r].getLayer().getSource()).getState()!==C.default.READY){t=!1;break}return t},b.prototype.getImage=function(e,t,r,n){if(!this.allSourcesReady_())return null;const s=this.updateFrameState_(e,t,n);if(this.requestedFrameState_=s,this.renderedImageCanvas_){const r=this.renderedImageCanvas_.getResolution(),n=this.renderedImageCanvas_.getExtent();t===r&&(0,c.equals)(e,n)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),s.tileQueue.loadMoreTiles(16,16),s.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},b.prototype.processSources_=function(){const e=this.requestedFrameState_,t=this.renderers_.length,r=new Array(t);for(let n=0;n<t;++n){const t=P(this.renderers_[n],e,e.layerStatesArray[n]);if(!t)return;r[n]=t}const n={};this.dispatchEvent(new O(F.BEFOREOPERATIONS,e,n)),this.worker_.process(r,n,this.onWorkerComplete_.bind(this,e))},b.prototype.onWorkerComplete_=function(e,t,n,s){if(t||!n)return;const a=e.extent,o=e.viewState.resolution;if(o!==this.requestedFrameState_.viewState.resolution||!(0,c.equals)(a,this.requestedFrameState_.extent))return;let u;if(this.renderedImageCanvas_)u=this.renderedImageCanvas_.getImage().getContext("2d");else{const e=Math.round((0,c.getWidth)(a)/o),t=Math.round((0,c.getHeight)(a)/o);u=(0,i.createCanvasContext2D)(e,t),this.renderedImageCanvas_=new r.default(a,o,1,u.canvas)}u.putImageData(n,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new O(F.AFTEROPERATIONS,e,s))};let M=null;function P(e,t,r){if(!e.prepareFrame(t,r))return null;const n=t.size[0],s=t.size[1];if(M){const e=M.canvas;e.width!==n||e.height!==s?M=(0,i.createCanvasContext2D)(n,s):M.clearRect(0,0,n,s)}else M=(0,i.createCanvasContext2D)(n,s);return e.composeFrame(t,r,M),M.getImageData(0,0,n,s)}function k(e){return e.map(function(e){return e.getLayer().getLayerState()})}function D(e){const t=e.length,r=new Array(t);for(let n=0;n<t;++n)r[n]=L(e[n]);return r}function L(e){let t=null;return e instanceof E.default?t=N(e):e instanceof w.default&&(t=z(e)),t}function z(e){const t=new p.default({source:e});return new S.default(t)}function N(e){const t=new _.default({source:e});return new I.default(t)}b.prototype.getImageInternal=function(){return null},exports.default=b;
},{"../index.js":80,"../ImageCanvas.js":189,"../TileQueue.js":247,"../dom.js":192,"../events.js":193,"../events/Event.js":211,"../events/EventType.js":194,"pixelworks/lib/index":248,"../extent.js":159,"../layer/Image.js":85,"../layer/Tile.js":61,"../obj.js":82,"../renderer/canvas/ImageLayer.js":124,"../renderer/canvas/TileLayer.js":126,"../source/Image.js":91,"../source/State.js":197,"../source/Tile.js":101,"../transform.js":237}],100:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),o=require("../source/OSM.js"),n=require("../source/XYZ.js"),r=t(n);function t(e){return e&&e.__esModule?e:{default:e}}const a=['Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',o.ATTRIBUTION],i={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},s={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}},u=function(e){const o=e.layer.indexOf("-"),n=-1==o?e.layer:e.layer.slice(0,o),t=s[n],u=i[e.layer],l=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+u.extension;r.default.call(this,{attributions:a,cacheSize:e.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=e.maxZoom?e.maxZoom:t.maxZoom,minZoom:void 0!=e.minZoom?e.minZoom:t.minZoom,opaque:u.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:l,wrapX:e.wrapX})};(0,e.inherits)(u,r.default),exports.default=u;
},{"../index.js":80,"../source/OSM.js":97,"../source/XYZ.js":62}],102:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../extent.js"),r=require("../math.js"),i=require("../obj.js"),s=require("../size.js"),o=require("../source/TileImage.js"),n=l(o),a=require("../tilecoord.js"),u=require("../uri.js");function l(e){return e&&e.__esModule?e:{default:e}}const p=function(e){const r=e||{};n.default.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileGrid:r.tileGrid,tileLoadFunction:r.tileLoadFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition}),this.params_=r.params||{},this.tmpExtent_=(0,t.createEmpty)(),this.setKey(this.getKeyForParams_())};(0,e.inherits)(p,n.default),p.prototype.getKeyForParams_=function(){let e=0;const t=[];for(const r in this.params_)t[e++]=r+"-"+this.params_[r];return t.join("/")},p.prototype.getParams=function(){return this.params_},p.prototype.getRequestUrl_=function(e,t,i,s,o,n){const l=this.urls;if(!l)return;const p=o.getCode().split(":").pop();let c;if(n.SIZE=t[0]+","+t[1],n.BBOX=i.join(","),n.BBOXSR=p,n.IMAGESR=p,n.DPI=Math.round(n.DPI?n.DPI*s:90*s),1==l.length)c=l[0];else{c=l[(0,r.modulo)((0,a.hash)(e),l.length)]}const h=c.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return(0,u.appendParams)(h,n)},p.prototype.getTilePixelRatio=function(e){return e},p.prototype.fixedTileUrlFunction=function(e,t,r){let o=this.getTileGrid();if(o||(o=this.getTileGridForProjection(r)),o.getResolutions().length<=e[0])return;const n=o.getTileCoordExtent(e,this.tmpExtent_);let a=(0,s.toSize)(o.getTileSize(e[0]),this.tmpSize);1!=t&&(a=(0,s.scale)(a,t,this.tmpSize));const u={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return(0,i.assign)(u,this.params_),this.getRequestUrl_(e,a,n,t,r,u)},p.prototype.updateParams=function(e){(0,i.assign)(this.params_,e),this.setKey(this.getKeyForParams_())},exports.default=p;
},{"../index.js":80,"../extent.js":159,"../math.js":160,"../obj.js":82,"../size.js":200,"../source/TileImage.js":104,"../tilecoord.js":201,"../uri.js":218}],103:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../Tile.js"),i=u(t),r=require("../TileState.js"),s=u(r),n=require("../dom.js"),l=require("../size.js"),o=require("../source/Tile.js"),a=u(o),c=require("../tilecoord.js");function u(e){return e&&e.__esModule?e:{default:e}}const d=function(e,t,r){i.default.call(this,e,s.default.LOADED),this.tileSize_=t,this.text_=r,this.canvas_=null};(0,e.inherits)(d,i.default),d.prototype.getImage=function(){if(this.canvas_)return this.canvas_;{const e=this.tileSize_,t=(0,n.createCanvasContext2D)(e[0],e[1]);return t.strokeStyle="black",t.strokeRect(.5,.5,e[0]+.5,e[1]+.5),t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.font="24px sans-serif",t.fillText(this.text_,e[0]/2,e[1]/2),this.canvas_=t.canvas,t.canvas}},d.prototype.load=function(){};const h=function(e){a.default.call(this,{opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:void 0===e.wrapX||e.wrapX})};(0,e.inherits)(h,a.default),h.prototype.getTile=function(e,t,i){const r=(0,c.getKeyZXY)(e,t,i);if(this.tileCache.containsKey(r))return this.tileCache.get(r);{const s=(0,l.toSize)(this.tileGrid.getTileSize(e)),n=[e,t,i],o=this.getTileCoordForTileUrlFunction(n),a=o?this.getTileCoordForTileUrlFunction(o).toString():"",c=new d(n,s,a);return this.tileCache.set(r,c),c}},exports.default=h;
},{"../index.js":80,"../Tile.js":198,"../TileState.js":199,"../dom.js":192,"../size.js":200,"../source/Tile.js":101,"../tilecoord.js":201}],105:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../tileurlfunction.js"),i=require("../asserts.js"),r=require("../extent.js"),o=require("../net.js"),s=require("../proj.js"),n=require("../source/State.js"),l=c(n),a=require("../source/TileImage.js"),u=c(a),d=require("../tilegrid.js");function c(t){return t&&t.__esModule?t:{default:t}}const h=function(t){if(this.tileJSON_=null,u.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:(0,s.get)("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:l.default.LOADING,tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition}),t.url)if(t.jsonp)(0,o.jsonp)(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else t.tileJSON?this.handleTileJSONResponse(t.tileJSON):(0,i.assert)(!1,51)};(0,t.inherits)(h,u.default),h.prototype.onXHRLoad_=function(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let t;try{t=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(t)}else this.handleTileJSONError()},h.prototype.onXHRError_=function(t){this.handleTileJSONError()},h.prototype.getTileJSON=function(){return this.tileJSON_},h.prototype.handleTileJSONResponse=function(t){const i=(0,s.get)("EPSG:4326"),o=this.getProjection();let n;if(void 0!==t.bounds){const e=(0,s.getTransformFromProjections)(i,o);n=(0,r.applyTransform)(t.bounds,e)}const a=t.minzoom||0,u=t.maxzoom||22,c=(0,d.createXYZ)({extent:(0,d.extentFromProjection)(o),maxZoom:u,minZoom:a});if(this.tileGrid=c,this.tileUrlFunction=(0,e.createFromTemplates)(t.tiles,c),void 0!==t.attribution&&!this.getAttributions()){const e=void 0!==n?n:i.getExtent();this.setAttributions(function(i){return(0,r.intersects)(e,i.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState(l.default.READY)},h.prototype.handleTileJSONError=function(){this.setState(l.default.ERROR)},exports.default=h;
},{"../index.js":80,"../tileurlfunction.js":214,"../asserts.js":165,"../extent.js":159,"../net.js":215,"../proj.js":58,"../source/State.js":197,"../source/TileImage.js":104,"../tilegrid.js":129}],106:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomTile=void 0;var t=require("../index.js"),e=require("../Tile.js"),i=T(e),s=require("../TileState.js"),n=T(s),o=require("../tileurlfunction.js"),r=require("../asserts.js"),l=require("../events.js"),a=require("../events/EventType.js"),h=T(a),u=require("../extent.js"),d=require("../net.js"),c=require("../proj.js"),p=require("../source/State.js"),f=T(p),_=require("../source/Tile.js"),g=T(_),y=require("../tilecoord.js"),E=require("../tilegrid.js");function T(t){return t&&t.__esModule?t:{default:t}}const m=exports.CustomTile=function(t,e,s,n,o,r){i.default.call(this,t,e),this.src_=s,this.extent_=n,this.preemptive_=o,this.grid_=null,this.keys_=null,this.data_=null,this.jsonp_=r};(0,t.inherits)(m,i.default),m.prototype.getImage=function(){return null},m.prototype.getData=function(t){if(!this.grid_||!this.keys_)return null;const e=(t[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),i=(t[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),s=this.grid_[Math.floor((1-i)*this.grid_.length)];if("string"!=typeof s)return null;let n=s.charCodeAt(Math.floor(e*s.length));n>=93&&n--,n>=35&&n--;let o=null;if((n-=32)in this.keys_){const t=this.keys_[n];o=this.data_&&t in this.data_?this.data_[t]:t}return o},m.prototype.forDataAtCoordinate=function(t,e,i,s){this.state==n.default.IDLE&&!0===s?((0,l.listenOnce)(this,h.default.CHANGE,function(s){e.call(i,this.getData(t))},this),this.loadInternal_()):!0===s?setTimeout(function(){e.call(i,this.getData(t))}.bind(this),0):e.call(i,this.getData(t))},m.prototype.getKey=function(){return this.src_},m.prototype.handleError_=function(){this.state=n.default.ERROR,this.changed()},m.prototype.handleLoad_=function(t){this.grid_=t.grid,this.keys_=t.keys,this.data_=t.data,this.state=n.default.EMPTY,this.changed()},m.prototype.loadInternal_=function(){if(this.state==n.default.IDLE)if(this.state=n.default.LOADING,this.jsonp_)(0,d.jsonp)(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",this.src_),t.send()}},m.prototype.onXHRLoad_=function(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let t;try{t=JSON.parse(e.responseText)}catch(t){return void this.handleError_()}this.handleLoad_(t)}else this.handleError_()},m.prototype.onXHRError_=function(t){this.handleError_()},m.prototype.load=function(){this.preemptive_&&this.loadInternal_()};const j=function(t){if(g.default.call(this,{projection:(0,c.get)("EPSG:3857"),state:f.default.LOADING}),this.preemptive_=void 0===t.preemptive||t.preemptive,this.tileUrlFunction_=o.nullTileUrlFunction,this.template_=void 0,this.jsonp_=t.jsonp||!1,t.url)if(this.jsonp_)(0,d.jsonp)(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else t.tileJSON?this.handleTileJSONResponse(t.tileJSON):(0,r.assert)(!1,51)};(0,t.inherits)(j,g.default),j.prototype.onXHRLoad_=function(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let t;try{t=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(t)}else this.handleTileJSONError()},j.prototype.onXHRError_=function(t){this.handleTileJSONError()},j.prototype.getTemplate=function(){return this.template_},j.prototype.forDataAtCoordinateAndResolution=function(t,e,i,s){if(this.tileGrid){const n=this.tileGrid.getTileCoordForCoordAndResolution(t,e);this.getTile(n[0],n[1],n[2],1,this.getProjection()).forDataAtCoordinate(t,i,null,s)}else!0===s?setTimeout(function(){i(null)},0):i(null)},j.prototype.handleTileJSONError=function(){this.setState(f.default.ERROR)},j.prototype.handleTileJSONResponse=function(t){const e=(0,c.get)("EPSG:4326"),i=this.getProjection();let s;if(void 0!==t.bounds){const n=(0,c.getTransformFromProjections)(e,i);s=(0,u.applyTransform)(t.bounds,n)}const n=t.minzoom||0,r=t.maxzoom||22,l=(0,E.createXYZ)({extent:(0,E.extentFromProjection)(i),maxZoom:r,minZoom:n});this.tileGrid=l,this.template_=t.template;const a=t.grids;if(a){if(this.tileUrlFunction_=(0,o.createFromTemplates)(a,l),void 0!==t.attribution){const i=void 0!==s?s:e.getExtent();this.setAttributions(function(e){return(0,u.intersects)(i,e.extent)?[t.attribution]:null})}this.setState(f.default.READY)}else this.setState(f.default.ERROR)},j.prototype.getTile=function(t,e,i,s,o){const r=(0,y.getKeyZXY)(t,e,i);if(this.tileCache.containsKey(r))return this.tileCache.get(r);{const l=[t,e,i],a=this.getTileCoordForTileUrlFunction(l,o),h=this.tileUrlFunction_(a,s,o),u=new m(l,void 0!==h?n.default.IDLE:n.default.EMPTY,void 0!==h?h:"",this.tileGrid.getTileCoordExtent(l),this.preemptive_,this.jsonp_);return this.tileCache.set(r,u),u}},j.prototype.useTile=function(t,e,i){const s=(0,y.getKeyZXY)(t,e,i);this.tileCache.containsKey(s)&&this.tileCache.get(s)},exports.default=j;
},{"../index.js":80,"../Tile.js":198,"../TileState.js":199,"../tileurlfunction.js":214,"../asserts.js":165,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../net.js":215,"../proj.js":58,"../source/State.js":197,"../source/Tile.js":101,"../tilecoord.js":201,"../tilegrid.js":129}],107:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../index.js"),i=require("../asserts.js"),r=require("../extent.js"),s=require("../obj.js"),o=require("../math.js"),n=require("../proj.js"),a=require("../reproj.js"),u=require("../size.js"),p=require("../source/TileImage.js"),l=g(p),h=require("../source/WMSServerType.js"),c=g(h),_=require("../tilecoord.js"),S=require("../string.js"),d=require("../uri.js");function g(t){return t&&t.__esModule?t:{default:t}}const T=function(t){const e=t||{},i=e.params||{},s=!("TRANSPARENT"in i)||i.TRANSPARENT;l.default.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,opaque:!s,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.gutter_=void 0!==e.gutter?e.gutter:0,this.params_=i,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=void 0===e.hidpi||e.hidpi,this.tmpExtent_=(0,r.createEmpty)(),this.updateV13_(),this.setKey(this.getKeyForParams_())};(0,e.inherits)(T,l.default),T.prototype.getGetFeatureInfoUrl=function(e,i,o,p){const l=(0,n.get)(o),h=this.getProjection();let c=this.getTileGrid();c||(c=this.getTileGridForProjection(l));const _=c.getTileCoordForCoordAndResolution(e,i);if(c.getResolutions().length<=_[0])return;let S=c.getResolution(_[0]),d=c.getTileCoordExtent(_,this.tmpExtent_),g=(0,u.toSize)(c.getTileSize(_[0]),this.tmpSize);const T=this.gutter_;0!==T&&(g=(0,u.buffer)(g,T,this.tmpSize),d=(0,r.buffer)(d,S*T,d)),h&&h!==l&&(S=(0,a.calculateSourceResolution)(h,l,e,S),d=(0,n.transformExtent)(d,l,h),e=(0,n.transform)(e,l,h));const R={SERVICE:"WMS",VERSION:t.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};(0,s.assign)(R,this.params_,p);const E=Math.floor((e[0]-d[0])/S),f=Math.floor((d[3]-e[1])/S);return R[this.v13_?"I":"X"]=E,R[this.v13_?"J":"Y"]=f,this.getRequestUrl_(_,g,d,1,h||l,R)},T.prototype.getGutterInternal=function(){return this.gutter_},T.prototype.getParams=function(){return this.params_},T.prototype.getRequestUrl_=function(t,e,r,s,n,a){const u=this.urls;if(!u)return;if(a.WIDTH=e[0],a.HEIGHT=e[1],a[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(a.STYLES=""),1!=s)switch(this.serverType_){case c.default.GEOSERVER:const t=90*s+.5|0;"FORMAT_OPTIONS"in a?a.FORMAT_OPTIONS+=";dpi:"+t:a.FORMAT_OPTIONS="dpi:"+t;break;case c.default.MAPSERVER:a.MAP_RESOLUTION=90*s;break;case c.default.CARMENTA_SERVER:case c.default.QGIS:a.DPI=90*s;break;default:(0,i.assert)(!1,52)}const p=n.getAxisOrientation(),l=r;if(this.v13_&&"ne"==p.substr(0,2)){let t;t=r[0],l[0]=r[1],l[1]=t,t=r[2],l[2]=r[3],l[3]=t}let h;if(a.BBOX=l.join(","),1==u.length)h=u[0];else{h=u[(0,o.modulo)((0,_.hash)(t),u.length)]}return(0,d.appendParams)(h,a)},T.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},T.prototype.getKeyForParams_=function(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},T.prototype.fixedTileUrlFunction=function(e,i,o){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(o)),n.getResolutions().length<=e[0])return;1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);const a=n.getResolution(e[0]);let p=n.getTileCoordExtent(e,this.tmpExtent_),l=(0,u.toSize)(n.getTileSize(e[0]),this.tmpSize);const h=this.gutter_;0!==h&&(l=(0,u.buffer)(l,h,this.tmpSize),p=(0,r.buffer)(p,a*h,p)),1!=i&&(l=(0,u.scale)(l,i,this.tmpSize));const c={SERVICE:"WMS",VERSION:t.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return(0,s.assign)(c,this.params_),this.getRequestUrl_(e,l,p,i,o,c)},T.prototype.updateParams=function(t){(0,s.assign)(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},T.prototype.updateV13_=function(){const e=this.params_.VERSION||t.DEFAULT_WMS_VERSION;this.v13_=(0,S.compareVersions)(e,"1.3")>=0},exports.default=T;
},{"./common.js":262,"../index.js":80,"../asserts.js":165,"../extent.js":159,"../obj.js":82,"../math.js":160,"../proj.js":58,"../reproj.js":260,"../size.js":200,"../source/TileImage.js":104,"../source/WMSServerType.js":263,"../tilecoord.js":201,"../string.js":261,"../uri.js":218}],321:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={KVP:"KVP",REST:"REST"};
},{}],322:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromCapabilitiesMatrixSet=u;var e=require("../index.js"),i=require("../array.js"),t=require("../proj.js"),r=require("../tilegrid/TileGrid.js"),n=s(r);function s(e){return e&&e.__esModule?e:{default:e}}const o=function(e){this.matrixIds_=e.matrixIds,n.default.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})};function u(e,r,n){const s=[],u=[],a=[],l=[],d=[],f=void 0!==n?n:[],x=e.SupportedCRS,c=(0,t.get)(x.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,t.get)(x),p=c.getMetersPerUnit(),h="ne"==c.getAxisOrientation().substr(0,2);return e.TileMatrix.sort(function(e,i){return i.ScaleDenominator-e.ScaleDenominator}),e.TileMatrix.forEach(function(t){let r;if(r=!(f.length>0)||(0,i.find)(f,function(i){return t.Identifier==i.TileMatrix||-1===t.Identifier.indexOf(":")&&e.Identifier+":"+t.Identifier===i.TileMatrix})){u.push(t.Identifier);const e=28e-5*t.ScaleDenominator/p,i=t.TileWidth,r=t.TileHeight;h?a.push([t.TopLeftCorner[1],t.TopLeftCorner[0]]):a.push(t.TopLeftCorner),s.push(e),l.push(i==r?i:[i,r]),d.push([t.MatrixWidth,-t.MatrixHeight])}}),new o({extent:r,origins:a,resolutions:s,matrixIds:u,tileSizes:l,sizes:d})}(0,e.inherits)(o,n.default),o.prototype.getMatrixId=function(e){return this.matrixIds_[e]},o.prototype.getMatrixIds=function(){return this.matrixIds_},exports.default=o;
},{"../index.js":80,"../array.js":209,"../proj.js":58,"../tilegrid/TileGrid.js":234}],110:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.optionsFromCapabilities=h;var t=require("../index.js"),e=require("../tileurlfunction.js"),i=require("../array.js"),n=require("../extent.js"),r=require("../obj.js"),o=require("../proj.js"),s=require("../source/TileImage.js"),a=f(s),l=require("../source/WMTSRequestEncoding.js"),u=f(l),c=require("../tilegrid/WMTS.js"),d=require("../uri.js");function f(t){return t&&t.__esModule?t:{default:t}}const p=function(t){this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style;let i=t.urls;void 0===i&&void 0!==t.url&&(i=(0,e.expandUrl)(t.url)),this.requestEncoding_=void 0!==t.requestEncoding?t.requestEncoding:u.default.KVP;const n=this.requestEncoding_,o=t.tileGrid,s={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};n==u.default.KVP&&(0,r.assign)(s,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_});const l=this.dimensions_;this.createFromWMTSTemplate_=function(t){return t=n==u.default.KVP?(0,d.appendParams)(t,s):t.replace(/\{(\w+?)\}/g,function(t,e){return e.toLowerCase()in s?s[e.toLowerCase()]:t}),function(e,i,s){if(e){const i={TileMatrix:o.getMatrixId(e[0]),TileCol:e[1],TileRow:-e[2]-1};(0,r.assign)(i,l);let s=t;return s=n==u.default.KVP?(0,d.appendParams)(s,i):s.replace(/\{(\w+?)\}/g,function(t,e){return i[e]})}}};const c=i&&i.length>0?(0,e.createFromTileUrlFunctions)(i.map(this.createFromWMTSTemplate_)):e.nullTileUrlFunction;a.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:c,urls:i,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition}),this.setKey(this.getKeyForDimensions_())};function h(t,e){const r=t.Contents.Layer,s=(0,i.find)(r,function(t,i,n){return t.Identifier==e.layer});if(null===s)return null;const a=t.Contents.TileMatrixSet;let l;(l=s.TileMatrixSetLink.length>1?"projection"in e?(0,i.findIndex)(s.TileMatrixSetLink,function(t,n,r){const s=(0,i.find)(a,function(e){return e.Identifier==t.TileMatrixSet}).SupportedCRS,l=(0,o.get)(s.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,o.get)(s),u=(0,o.get)(e.projection);return l&&u?(0,o.equivalent)(l,u):s==e.projection}):(0,i.findIndex)(s.TileMatrixSetLink,function(t,i,n){return t.TileMatrixSet==e.matrixSet}):0)<0&&(l=0);const d=s.TileMatrixSetLink[l].TileMatrixSet,f=s.TileMatrixSetLink[l].TileMatrixSetLimits;let p=s.Format[0];"format"in e&&(p=e.format),(l=(0,i.findIndex)(s.Style,function(t,i,n){return"style"in e?t.Title==e.style:t.isDefault}))<0&&(l=0);const h=s.Style[l].Identifier,m={};"Dimension"in s&&s.Dimension.forEach(function(t,e,i){const n=t.Identifier;let r=t.Default;void 0===r&&(r=t.Value[0]),m[n]=r});const g=t.Contents.TileMatrixSet,x=(0,i.find)(g,function(t,e,i){return t.Identifier==d});let T;const y=x.SupportedCRS;if(y&&(T=(0,o.get)(y.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||(0,o.get)(y)),"projection"in e){const t=(0,o.get)(e.projection);t&&(T&&!(0,o.equivalent)(t,T)||(T=t))}const S=s.WGS84BoundingBox;let _,j;if(void 0!==S){const t=(0,o.get)("EPSG:4326").getExtent();j=S[0]==t[0]&&S[2]==t[2],_=(0,o.transformExtent)(S,"EPSG:4326",T);const e=T.getExtent();e&&((0,n.containsExtent)(e,_)||(_=void 0))}const M=(0,c.createFromCapabilitiesMatrixSet)(x,_,f),q=[];let F=e.requestEncoding;if(F=void 0!==F?F:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata){const e=t.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let t=0,n=e.length;t<n;++t)if(e[t].Constraint){const n=(0,i.find)(e[t].Constraint,function(t){return"GetEncoding"==t.name}).AllowedValues.Value;if(""===F&&(F=n[0]),F!==u.default.KVP)break;(0,i.includes)(n,u.default.KVP)&&q.push(e[t].href)}else e[t].href&&(F=u.default.KVP,q.push(e[t].href))}return 0===q.length&&(F=u.default.REST,s.ResourceURL.forEach(function(t){"tile"===t.resourceType&&(p=t.format,q.push(t.template))})),{urls:q,layer:e.layer,matrixSet:d,format:p,projection:T,requestEncoding:F,tileGrid:M,style:h,dimensions:m,wrapX:j,crossOrigin:e.crossOrigin}}(0,t.inherits)(p,a.default),p.prototype.setUrls=function(t){this.urls=t;const i=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,e.createFromTileUrlFunctions)(t.map(this.createFromWMTSTemplate_.bind(this))),i)},p.prototype.getDimensions=function(){return this.dimensions_},p.prototype.getFormat=function(){return this.format_},p.prototype.getLayer=function(){return this.layer_},p.prototype.getMatrixSet=function(){return this.matrixSet_},p.prototype.getRequestEncoding=function(){return this.requestEncoding_},p.prototype.getStyle=function(){return this.style_},p.prototype.getVersion=function(){return this.version_},p.prototype.getKeyForDimensions_=function(){let t=0;const e=[];for(const i in this.dimensions_)e[t++]=i+"-"+this.dimensions_[i];return e.join("/")},p.prototype.updateDimensions=function(t){(0,r.assign)(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())},exports.default=p;
},{"../index.js":80,"../tileurlfunction.js":214,"../array.js":209,"../extent.js":159,"../obj.js":82,"../proj.js":58,"../source/TileImage.js":104,"../source/WMTSRequestEncoding.js":321,"../tilegrid/WMTS.js":322,"../uri.js":218}],111:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CustomTile=void 0;var e=require("../tilegrid/common.js"),t=require("../index.js"),i=require("../ImageTile.js"),r=T(i),o=require("../TileState.js"),s=T(o),n=require("../tileurlfunction.js"),l=require("../asserts.js"),u=require("../dom.js"),a=require("../extent.js"),c=require("../size.js"),f=require("../source/TileImage.js"),d=T(f),h=require("../tilegrid/TileGrid.js"),p=T(h);function T(e){return e&&e.__esModule?e:{default:e}}const g={DEFAULT:"default",TRUNCATED:"truncated"},m=exports.CustomTile=function(e,t,i,o,s,n,l){r.default.call(this,t,i,o,s,n,l),this.zoomifyImage_=null,this.tileSize_=(0,c.toSize)(e.getTileSize(t[0]))};(0,t.inherits)(m,r.default),m.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;const e=r.default.prototype.getImage.call(this);if(this.state==s.default.LOADED){const t=this.tileSize_;if(e.width==t[0]&&e.height==t[1])return this.zoomifyImage_=e,e;{const i=(0,u.createCanvasContext2D)(t[0],t[1]);return i.drawImage(e,0,0),this.zoomifyImage_=i.canvas,i.canvas}}return e};const z=function(t){const i=t||{},r=i.size,o=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:g.DEFAULT,s=r[0],u=r[1],c=i.extent||[0,-r[1],r[0],0],f=[],h=i.tileSize||e.DEFAULT_TILE_SIZE;let T=h;switch(o){case g.DEFAULT:for(;s>T||u>T;)f.push([Math.ceil(s/T),Math.ceil(u/T)]),T+=T;break;case g.TRUNCATED:let e=s,t=u;for(;e>T||t>T;)f.push([Math.ceil(e/T),Math.ceil(t/T)]),e>>=1,t>>=1;break;default:(0,l.assert)(!1,53)}f.push([1,1]),f.reverse();const z=[1],j=[0];for(let e=1,t=f.length;e<t;e++)z.push(1<<e),j.push(f[e-1][0]*f[e-1][1]+j[e-1]);z.reverse();const x=new p.default({tileSize:h,extent:c,origin:(0,a.getTopLeft)(c),resolutions:z});let I=i.url;I&&-1==I.indexOf("{TileGroup}")&&-1==I.indexOf("{tileIndex}")&&(I+="{TileGroup}/{z}-{x}-{y}.jpg");const S=(0,n.expandUrl)(I);const _=(0,n.createFromTileUrlFunctions)(S.map(function(e){return function(t,i,r){if(t){const i=t[0],r=t[1],o=-t[2]-1,s=r+o*f[i][0],n=x.getTileSize(i),l={z:i,x:r,y:o,tileIndex:s,TileGroup:"TileGroup"+((s+j[i])/n|0)};return e.replace(/\{(\w+?)\}/g,function(e,t){return l[t]})}}})),q=m.bind(null,x);d.default.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:q,tileGrid:x,tileUrlFunction:_,transition:i.transition})};(0,t.inherits)(z,d.default),exports.default=z;
},{"../tilegrid/common.js":225,"../index.js":80,"../ImageTile.js":233,"../TileState.js":199,"../tileurlfunction.js":214,"../asserts.js":165,"../dom.js":192,"../extent.js":159,"../size.js":200,"../source/TileImage.js":104,"../tilegrid/TileGrid.js":234}],56:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./source/BingMaps.js");Object.defineProperty(exports,"BingMaps",{enumerable:!0,get:function(){return T(e).default}});var r=require("./source/CartoDB.js");Object.defineProperty(exports,"CartoDB",{enumerable:!0,get:function(){return T(r).default}});var t=require("./source/Cluster.js");Object.defineProperty(exports,"Cluster",{enumerable:!0,get:function(){return T(t).default}});var u=require("./source/Image.js");Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return T(u).default}});var n=require("./source/ImageArcGISRest.js");Object.defineProperty(exports,"ImageArcGISRest",{enumerable:!0,get:function(){return T(n).default}});var o=require("./source/ImageCanvas.js");Object.defineProperty(exports,"ImageCanvas",{enumerable:!0,get:function(){return T(o).default}});var a=require("./source/ImageMapGuide.js");Object.defineProperty(exports,"ImageMapGuide",{enumerable:!0,get:function(){return T(a).default}});var i=require("./source/ImageStatic.js");Object.defineProperty(exports,"ImageStatic",{enumerable:!0,get:function(){return T(i).default}});var s=require("./source/ImageWMS.js");Object.defineProperty(exports,"ImageWMS",{enumerable:!0,get:function(){return T(s).default}});var c=require("./source/OSM.js");Object.defineProperty(exports,"OSM",{enumerable:!0,get:function(){return T(c).default}});var f=require("./source/Raster.js");Object.defineProperty(exports,"Raster",{enumerable:!0,get:function(){return T(f).default}});var l=require("./source/Source.js");Object.defineProperty(exports,"Source",{enumerable:!0,get:function(){return T(l).default}});var d=require("./source/Stamen.js");Object.defineProperty(exports,"Stamen",{enumerable:!0,get:function(){return T(d).default}});var p=require("./source/Tile.js");Object.defineProperty(exports,"Tile",{enumerable:!0,get:function(){return T(p).default}});var b=require("./source/TileArcGISRest.js");Object.defineProperty(exports,"TileArcGISRest",{enumerable:!0,get:function(){return T(b).default}});var j=require("./source/TileDebug.js");Object.defineProperty(exports,"TileDebug",{enumerable:!0,get:function(){return T(j).default}});var g=require("./source/TileImage.js");Object.defineProperty(exports,"TileImage",{enumerable:!0,get:function(){return T(g).default}});var m=require("./source/TileJSON.js");Object.defineProperty(exports,"TileJSON",{enumerable:!0,get:function(){return T(m).default}});var O=require("./source/TileUTFGrid.js");Object.defineProperty(exports,"TileUTFGrid",{enumerable:!0,get:function(){return T(O).default}});var v=require("./source/TileWMS.js");Object.defineProperty(exports,"TileWMS",{enumerable:!0,get:function(){return T(v).default}});var y=require("./source/UrlTile.js");Object.defineProperty(exports,"UrlTile",{enumerable:!0,get:function(){return T(y).default}});var x=require("./source/Vector.js");Object.defineProperty(exports,"Vector",{enumerable:!0,get:function(){return T(x).default}});var P=require("./source/WMTS.js");Object.defineProperty(exports,"WMTS",{enumerable:!0,get:function(){return T(P).default}});var q=require("./source/XYZ.js");Object.defineProperty(exports,"XYZ",{enumerable:!0,get:function(){return T(q).default}});var S=require("./source/Zoomify.js");function T(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"Zoomify",{enumerable:!0,get:function(){return T(S).default}});
},{"./source/BingMaps.js":88,"./source/CartoDB.js":89,"./source/Cluster.js":90,"./source/Image.js":91,"./source/ImageArcGISRest.js":92,"./source/ImageCanvas.js":93,"./source/ImageMapGuide.js":94,"./source/ImageStatic.js":95,"./source/ImageWMS.js":96,"./source/OSM.js":97,"./source/Raster.js":98,"./source/Source.js":99,"./source/Stamen.js":100,"./source/Tile.js":101,"./source/TileArcGISRest.js":102,"./source/TileDebug.js":103,"./source/TileImage.js":104,"./source/TileJSON.js":105,"./source/TileUTFGrid.js":106,"./source/TileWMS.js":107,"./source/UrlTile.js":108,"./source/Vector.js":109,"./source/WMTS.js":110,"./source/XYZ.js":62,"./source/Zoomify.js":111}],167:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transformWithOptions=i;var t=require("../geom/Geometry.js"),e=n(t),o=require("../obj.js"),r=require("../proj.js");function n(t){return t&&t.__esModule?t:{default:t}}const a=function(){this.defaultDataProjection=null,this.defaultFeatureProjection=null};function i(t,o,n){const a=n?(0,r.get)(n.featureProjection):null,i=n?(0,r.get)(n.dataProjection):null;let u;if(u=a&&i&&!(0,r.equivalent)(a,i)?t instanceof e.default?(o?t.clone():t).transform(o?a:i,o?i:a):(0,r.transformExtent)(t,i,a):t,o&&n&&void 0!==n.decimals){const e=Math.pow(10,n.decimals),o=function(t){for(let o=0,r=t.length;o<r;++o)t[o]=Math.round(t[o]*e)/e;return t};u===t&&(u=u.clone()),u.applyTransform(o)}return u}a.prototype.getReadOptions=function(t,e){let o;return e&&(o={dataProjection:e.dataProjection?e.dataProjection:this.readProjection(t),featureProjection:e.featureProjection}),this.adaptOptions(o)},a.prototype.adaptOptions=function(t){return(0,o.assign)({dataProjection:this.defaultDataProjection,featureProjection:this.defaultFeatureProjection},t)},a.prototype.getLastExtent=function(){return null},a.prototype.getType=function(){},a.prototype.readFeature=function(t,e){},a.prototype.readFeatures=function(t,e){},a.prototype.readGeometry=function(t,e){},a.prototype.readProjection=function(t){},a.prototype.writeFeature=function(t,e){},a.prototype.writeFeatures=function(t,e){},a.prototype.writeGeometry=function(t,e){},exports.default=a;
},{"../geom/Geometry.js":279,"../obj.js":82,"../proj.js":58}],168:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../format/Feature.js"),r=i(e),o=require("../format/FormatType.js"),n=i(o);function i(t){return t&&t.__esModule?t:{default:t}}const u=function(){r.default.call(this)};function a(t){if("string"==typeof t){const e=JSON.parse(t);return e||null}return null!==t?t:null}(0,t.inherits)(u,r.default),u.prototype.getType=function(){return n.default.JSON},u.prototype.readFeature=function(t,e){return this.readFeatureFromObject(a(t),this.getReadOptions(t,e))},u.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(a(t),this.getReadOptions(t,e))},u.prototype.readFeatureFromObject=function(t,e){},u.prototype.readFeaturesFromObject=function(t,e){},u.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(a(t),this.getReadOptions(t,e))},u.prototype.readGeometryFromObject=function(t,e){},u.prototype.readProjection=function(t){return this.readProjectionFromObject(a(t))},u.prototype.readProjectionFromObject=function(t){},u.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},u.prototype.writeFeatureObject=function(t,e){},u.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},u.prototype.writeFeaturesObject=function(t,e){},u.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},u.prototype.writeGeometryObject=function(t,e){},exports.default=u;
},{"../index.js":80,"../format/Feature.js":167,"../format/FormatType.js":280}],169:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../events.js"),i=require("../events/EventType.js"),r=c(i),s=require("../extent.js"),o=require("../geom/Geometry.js"),n=c(o),h=require("../geom/GeometryType.js"),l=c(h),u=require("../obj.js");function c(e){return e&&e.__esModule?e:{default:e}}const p=function(e){n.default.call(this),this.geometries_=e||null,this.listenGeometriesChange_()};function a(e){const t=[];for(let i=0,r=e.length;i<r;++i)t.push(e[i].clone());return t}(0,e.inherits)(p,n.default),p.prototype.unlistenGeometriesChange_=function(){if(this.geometries_)for(let e=0,i=this.geometries_.length;e<i;++e)(0,t.unlisten)(this.geometries_[e],r.default.CHANGE,this.changed,this)},p.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(let e=0,i=this.geometries_.length;e<i;++e)(0,t.listen)(this.geometries_[e],r.default.CHANGE,this.changed,this)},p.prototype.clone=function(){const e=new p(null);return e.setGeometries(this.geometries_),e},p.prototype.closestPointXY=function(e,t,i,r){if(r<(0,s.closestSquaredDistanceXY)(this.getExtent(),e,t))return r;const o=this.geometries_;for(let s=0,n=o.length;s<n;++s)r=o[s].closestPointXY(e,t,i,r);return r},p.prototype.containsXY=function(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(e,t))return!0;return!1},p.prototype.computeExtent=function(e){(0,s.createOrUpdateEmpty)(e);const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)(0,s.extend)(e,t[i].getExtent());return e},p.prototype.getGeometries=function(){return a(this.geometries_)},p.prototype.getGeometriesArray=function(){return this.geometries_},p.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!=this.getRevision()&&((0,u.clear)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=e.toString();if(this.simplifiedGeometryCache.hasOwnProperty(t))return this.simplifiedGeometryCache[t];{const i=[],r=this.geometries_;let s=!1;for(let t=0,o=r.length;t<o;++t){const o=r[t],n=o.getSimplifiedGeometry(e);i.push(n),n!==o&&(s=!0)}if(s){const e=new p(null);return e.setGeometriesArray(i),this.simplifiedGeometryCache[t]=e,e}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this}},p.prototype.getType=function(){return l.default.GEOMETRY_COLLECTION},p.prototype.intersectsExtent=function(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)if(t[i].intersectsExtent(e))return!0;return!1},p.prototype.isEmpty=function(){return 0===this.geometries_.length},p.prototype.rotate=function(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(e,t);this.changed()},p.prototype.scale=function(e,t,i){let r=i;r||(r=(0,s.getCenter)(this.getExtent()));const o=this.geometries_;for(let i=0,s=o.length;i<s;++i)o[i].scale(e,t,r);this.changed()},p.prototype.setGeometries=function(e){this.setGeometriesArray(a(e))},p.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},p.prototype.applyTransform=function(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].applyTransform(e);this.changed()},p.prototype.translate=function(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(e,t);this.changed()},p.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),n.default.prototype.disposeInternal.call(this)},exports.default=p;
},{"../index.js":80,"../events.js":193,"../events/EventType.js":194,"../extent.js":159,"../geom/Geometry.js":279,"../geom/GeometryType.js":226,"../obj.js":82}],57:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../index.js"),t=require("../asserts.js"),r=require("../Feature.js"),o=w(r),n=require("../format/Feature.js"),i=require("../format/JSONFeature.js"),u=w(i),a=require("../geom/GeometryCollection.js"),s=w(a),c=require("../geom/LineString.js"),l=w(c),p=require("../geom/MultiLineString.js"),y=w(p),d=require("../geom/MultiPoint.js"),m=w(d),f=require("../geom/MultiPolygon.js"),g=w(f),j=require("../geom/Point.js"),P=w(j),F=require("../geom/Polygon.js"),h=w(F),G=require("../obj.js"),O=require("../proj.js");function w(e){return e&&e.__esModule?e:{default:e}}const q=function(e){const t=e||{};u.default.call(this),this.defaultDataProjection=(0,O.get)(t.defaultDataProjection?t.defaultDataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=(0,O.get)(t.featureProjection)),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName};(0,e.inherits)(q,u.default);const C={Point:_,LineString:S,Polygon:D,MultiPoint:x,MultiLineString:L,MultiPolygon:v,GeometryCollection:N},M={Point:k,LineString:W,Polygon:z,MultiPoint:J,MultiLineString:A,MultiPolygon:T,GeometryCollection:I,Circle:H};function b(e,t){if(!e)return null;const r=C[e.type];return(0,n.transformWithOptions)(r(e),!1,t)}function N(e,t){const r=e.geometries.map(function(e){return b(e,t)});return new s.default(r)}function _(e){return new P.default(e.coordinates)}function S(e){return new l.default(e.coordinates)}function L(e){return new y.default(e.coordinates)}function x(e){return new m.default(e.coordinates)}function v(e){return new g.default(e.coordinates)}function D(e){return new h.default(e.coordinates)}function E(e,t){return(0,M[e.getType()])((0,n.transformWithOptions)(e,!0,t),t)}function H(e){return{type:"GeometryCollection",geometries:[]}}function I(e,t){return{type:"GeometryCollection",geometries:e.getGeometriesArray().map(function(e){const r=(0,G.assign)({},t);return delete r.featureProjection,E(e,r)})}}function W(e,t){return{type:"LineString",coordinates:e.getCoordinates()}}function A(e,t){return{type:"MultiLineString",coordinates:e.getCoordinates()}}function J(e,t){return{type:"MultiPoint",coordinates:e.getCoordinates()}}function T(e,t){let r;return t&&(r=t.rightHanded),{type:"MultiPolygon",coordinates:e.getCoordinates(r)}}function k(e,t){return{type:"Point",coordinates:e.getCoordinates()}}function z(e,t){let r;return t&&(r=t.rightHanded),{type:"Polygon",coordinates:e.getCoordinates(r)}}q.prototype.readFeature,q.prototype.readFeatures,q.prototype.readFeatureFromObject=function(e,t){let r=null;const n=b((r="Feature"===e.type?e:{type:"Feature",geometry:e}).geometry,t),i=new o.default;return this.geometryName_?i.setGeometryName(this.geometryName_):this.extractGeometryName_&&void 0!==r.geometry_name&&i.setGeometryName(r.geometry_name),i.setGeometry(n),void 0!==r.id&&i.setId(r.id),r.properties&&i.setProperties(r.properties),i},q.prototype.readFeaturesFromObject=function(e,t){let r=null;if("FeatureCollection"===e.type){r=[];const o=e.features;for(let e=0,n=o.length;e<n;++e)r.push(this.readFeatureFromObject(o[e],t))}else r=[this.readFeatureFromObject(e,t)];return r},q.prototype.readGeometry,q.prototype.readGeometryFromObject=function(e,t){return b(e,t)},q.prototype.readProjection,q.prototype.readProjectionFromObject=function(e){const r=e.crs;let o;return r?"name"==r.type?o=(0,O.get)(r.properties.name):(0,t.assert)(!1,36):o=this.defaultDataProjection,o},q.prototype.writeFeature,q.prototype.writeFeatureObject=function(e,t){t=this.adaptOptions(t);const r={type:"Feature"},o=e.getId();void 0!==o&&(r.id=o);const n=e.getGeometry();r.geometry=n?E(n,t):null;const i=e.getProperties();return delete i[e.getGeometryName()],(0,G.isEmpty)(i)?r.properties=null:r.properties=i,r},q.prototype.writeFeatures,q.prototype.writeFeaturesObject=function(e,t){t=this.adaptOptions(t);const r=[];for(let o=0,n=e.length;o<n;++o)r.push(this.writeFeatureObject(e[o],t));return{type:"FeatureCollection",features:r}},q.prototype.writeGeometry,q.prototype.writeGeometryObject=function(e,t){return E(e,this.adaptOptions(t))},exports.default=q;
},{"../index.js":80,"../asserts.js":165,"../Feature.js":166,"../format/Feature.js":167,"../format/JSONFeature.js":168,"../geom/GeometryCollection.js":169,"../geom/LineString.js":170,"../geom/MultiLineString.js":171,"../geom/MultiPoint.js":172,"../geom/MultiPolygon.js":173,"../geom/Point.js":174,"../geom/Polygon.js":175,"../obj.js":82,"../proj.js":58}],112:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom.js");const e=function(e,s){this.space_=s,this.emptyBlocks_=[{x:0,y:0,width:e,height:e}],this.entries_={},this.context_=(0,t.createCanvasContext2D)(e,e),this.canvas_=this.context_.canvas};e.prototype.get=function(t){return this.entries_[t]||null},e.prototype.add=function(t,e,s,i,h){for(let c=0,o=this.emptyBlocks_.length;c<o;++c){const o=this.emptyBlocks_[c];if(o.width>=e+this.space_&&o.height>=s+this.space_){const p={offsetX:o.x+this.space_,offsetY:o.y+this.space_,image:this.canvas_};return this.entries_[t]=p,i.call(h,this.context_,o.x+this.space_,o.y+this.space_),this.split_(c,o,e+this.space_,s+this.space_),p}}return null},e.prototype.split_=function(t,e,s,i){let h,c;e.width-s>e.height-i?(h={x:e.x+s,y:e.y,width:e.width-s,height:e.height},c={x:e.x,y:e.y+i,width:s,height:e.height-i},this.updateBlocks_(t,h,c)):(h={x:e.x+s,y:e.y,width:e.width-s,height:i},c={x:e.x,y:e.y+i,width:e.width,height:e.height-i},this.updateBlocks_(t,h,c))},e.prototype.updateBlocks_=function(t,e,s){const i=[t,1];e.width>0&&e.height>0&&i.push(e),s.width>0&&s.height>0&&i.push(s),this.emptyBlocks_.splice.apply(this.emptyBlocks_,i)},exports.default=e;
},{"../dom.js":192}],113:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../index.js"),e=require("../functions.js"),i=require("../style/Atlas.js"),s=n(i);function n(t){return t&&t.__esModule?t:{default:t}}const r=256,o=-1,u=function(e){const i=e||{};this.currentSize_=void 0!==i.initialSize?i.initialSize:256,this.maxSize_=void 0!==i.maxSize?i.maxSize:void 0!==t.WEBGL_MAX_TEXTURE_SIZE?t.WEBGL_MAX_TEXTURE_SIZE:2048,this.space_=void 0!==i.space?i.space:1,this.atlases_=[new s.default(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new s.default(this.currentHitSize_,this.space_)]};u.prototype.getInfo=function(t){const e=this.getInfo_(this.atlases_,t);if(!e)return null;const i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},u.prototype.getInfo_=function(t,e){for(let i=0,s=t.length;i<s;++i){const s=t[i].get(e);if(s)return s}return null},u.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},u.prototype.add=function(t,i,s,n,r,o){if(i+this.space_>this.maxSize_||s+this.space_>this.maxSize_)return null;const u=this.add_(!1,t,i,s,n,o);if(!u)return null;const a=void 0!==r?r:e.UNDEFINED,_=this.add_(!0,t,i,s,a,o);return this.mergeInfos_(u,_)},u.prototype.add_=function(t,e,i,n,r,o){const u=t?this.hitAtlases_:this.atlases_;let a,_,h,f;for(h=0,f=u.length;h<f;++h){if(_=(a=u[h]).add(e,i,n,r,o))return _;if(!_&&h===f-1){let e;t?(e=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=e):(e=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=e),a=new s.default(e,this.space_),u.push(a),++f}}return null},exports.default=u;
},{"../index.js":80,"../functions.js":195,"../style/Atlas.js":112}],122:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../style/Fill.js"),e=n(t),o=require("../style/TextPlacement.js"),i=n(o);function n(t){return t&&t.__esModule?t:{default:t}}const r="#333",s=function(t){const o=t||{};this.font_=o.font,this.rotation_=o.rotation,this.rotateWithView_=o.rotateWithView,this.scale_=o.scale,this.text_=o.text,this.textAlign_=o.textAlign,this.textBaseline_=o.textBaseline,this.fill_=void 0!==o.fill?o.fill:new e.default({color:"#333"}),this.maxAngle_=void 0!==o.maxAngle?o.maxAngle:Math.PI/4,this.placement_=void 0!==o.placement?o.placement:i.default.POINT,this.overflow_=!!o.overflow,this.stroke_=void 0!==o.stroke?o.stroke:null,this.offsetX_=void 0!==o.offsetX?o.offsetX:0,this.offsetY_=void 0!==o.offsetY?o.offsetY:0,this.backgroundFill_=o.backgroundFill?o.backgroundFill:null,this.backgroundStroke_=o.backgroundStroke?o.backgroundStroke:null,this.padding_=void 0===o.padding?null:o.padding};s.prototype.clone=function(){return new s({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},s.prototype.getOverflow=function(){return this.overflow_},s.prototype.getFont=function(){return this.font_},s.prototype.getMaxAngle=function(){return this.maxAngle_},s.prototype.getPlacement=function(){return this.placement_},s.prototype.getOffsetX=function(){return this.offsetX_},s.prototype.getOffsetY=function(){return this.offsetY_},s.prototype.getFill=function(){return this.fill_},s.prototype.getRotateWithView=function(){return this.rotateWithView_},s.prototype.getRotation=function(){return this.rotation_},s.prototype.getScale=function(){return this.scale_},s.prototype.getStroke=function(){return this.stroke_},s.prototype.getText=function(){return this.text_},s.prototype.getTextAlign=function(){return this.textAlign_},s.prototype.getTextBaseline=function(){return this.textBaseline_},s.prototype.getBackgroundFill=function(){return this.backgroundFill_},s.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},s.prototype.getPadding=function(){return this.padding_},s.prototype.setOverflow=function(t){this.overflow_=t},s.prototype.setFont=function(t){this.font_=t},s.prototype.setMaxAngle=function(t){this.maxAngle_=t},s.prototype.setOffsetX=function(t){this.offsetX_=t},s.prototype.setOffsetY=function(t){this.offsetY_=t},s.prototype.setPlacement=function(t){this.placement_=t},s.prototype.setFill=function(t){this.fill_=t},s.prototype.setRotation=function(t){this.rotation_=t},s.prototype.setScale=function(t){this.scale_=t},s.prototype.setStroke=function(t){this.stroke_=t},s.prototype.setText=function(t){this.text_=t},s.prototype.setTextAlign=function(t){this.textAlign_=t},s.prototype.setTextBaseline=function(t){this.textBaseline_=t},s.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},s.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},s.prototype.setPadding=function(t){this.padding_=t},exports.default=s;
},{"../style/Fill.js":115,"../style/TextPlacement.js":239}],59:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./style/Atlas.js");Object.defineProperty(exports,"Atlas",{enumerable:!0,get:function(){return c(e).default}});var r=require("./style/AtlasManager.js");Object.defineProperty(exports,"AtlasManager",{enumerable:!0,get:function(){return c(r).default}});var t=require("./style/Circle.js");Object.defineProperty(exports,"Circle",{enumerable:!0,get:function(){return c(t).default}});var n=require("./style/Fill.js");Object.defineProperty(exports,"Fill",{enumerable:!0,get:function(){return c(n).default}});var u=require("./style/Icon.js");Object.defineProperty(exports,"Icon",{enumerable:!0,get:function(){return c(u).default}});var a=require("./style/IconImage.js");Object.defineProperty(exports,"IconImage",{enumerable:!0,get:function(){return c(a).default}});var l=require("./style/Image.js");Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return c(l).default}});var o=require("./style/RegularShape.js");Object.defineProperty(exports,"RegularShape",{enumerable:!0,get:function(){return c(o).default}});var s=require("./style/Stroke.js");Object.defineProperty(exports,"Stroke",{enumerable:!0,get:function(){return c(s).default}});var i=require("./style/Style.js");Object.defineProperty(exports,"Style",{enumerable:!0,get:function(){return c(i).default}});var f=require("./style/Text.js");function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"Text",{enumerable:!0,get:function(){return c(f).default}});
},{"./style/Atlas.js":112,"./style/AtlasManager.js":113,"./style/Circle.js":114,"./style/Fill.js":115,"./style/Icon.js":116,"./style/IconImage.js":117,"./style/Image.js":118,"./style/RegularShape.js":119,"./style/Stroke.js":120,"./style/Style.js":121,"./style/Text.js":122}],276:[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],329:[function(require,module,exports) {
var process = require("process");
var r=require("process");function t(r,t){for(var e=0,n=r.length-1;n>=0;n--){var s=r[n];"."===s?r.splice(n,1):".."===s?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,n=function(r){return e.exec(r).slice(1)};function s(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}exports.resolve=function(){for(var e="",n=!1,o=arguments.length-1;o>=-1&&!n;o--){var i=o>=0?arguments[o]:r.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,n="/"===i.charAt(0))}return e=t(s(e.split("/"),function(r){return!!r}),!n).join("/"),(n?"/":"")+e||"."},exports.normalize=function(r){var e=exports.isAbsolute(r),n="/"===o(r,-1);return(r=t(s(r.split("/"),function(r){return!!r}),!e).join("/"))||e||(r="."),r&&n&&(r+="/"),(e?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(s(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),s=e(t.split("/")),o=Math.min(n.length,s.length),i=o,u=0;u<o;u++)if(n[u]!==s[u]){i=u;break}var l=[];for(u=i;u<n.length;u++)l.push("..");return(l=l.concat(s.slice(i))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){var t=n(r),e=t[0],s=t[1];return e||s?(s&&(s=s.substr(0,s.length-1)),e+s):"."},exports.basename=function(r,t){var e=n(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e},exports.extname=function(r){return n(r)[3]};var o="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)};
},{"process":276}],52:[function(require,module,exports) {
var __filename = "/Users/tschaub/projects/f4gna18-frenzy/node_modules/mproj/dist/mproj.js";
var define;
var i,t="/Users/tschaub/projects/f4gna18-frenzy/node_modules/mproj/dist/mproj.js",n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i};!function(){var a=Math.abs,e=Math.floor,r=Math.sin,s=Math.cos,o=Math.tan,h=Math.asin,p=Math.acos,l=Math.atan,c=Math.atan2,u=Math.sqrt,f=Math.pow,_=Math.exp,m=Math.log,y=Math.hypot,d=Math.sinh,v=Math.cosh,g=Math.min,x=Math.max,C=1/0,S=Math.PI,A=57.29577951308232,E=.017453292519943295,M=6378137,b=.0066943799901413165,w=S/4,k=S/2,I=1.5*S,P=2*S,G=2/S,N=0,O=1,R=2,T=3,D=4,L=-45,q=-47,U=1e-10,z={last_errno:0,debug_level:0,logger:null},W=["no arguments in initialization list","no options found in 'init' file","invalid init= string","projection not named","unknown projection id","effective eccentricity = 1","unknown unit conversion id","invalid boolean param argument","unknown elliptical parameter name","reciprocal flattening (1/f) = 0","|radius reference latitude| > 90","squared eccentricity < 0","major axis or radius = 0 or not given","latitude or longitude exceeded limits","invalid x or y","improperly formed DMS value","non-convergent inverse meridional dist","non-convergent inverse phi2","acos/asin: |arg| >1+1e-14","tolerance condition error","conic lat_1 = -lat_2","lat_1 >= 90","lat_1 = 0","lat_ts >= 90","no distance between control points","projection not selected to be rotated","W <= 0 or M <= 0","lsat not in 1-5 range","path not in range","h <= 0","k <= 0","lat_0 = 0 or 90 or alpha = 90","lat_1=lat_2 or lat_1=0 or lat_2=90","elliptical usage required","invalid UTM zone number","arg(s) out of range for Tcheby eval","failed to find projection to be rotated","failed to load datum shift file","both n & m must be spec'd and > 0","n <= 0, n > 1 or not specified","lat_1 or lat_2 not specified","|lat_1| == |lat_2|","lat_0 is pi/2 from mean lat","unparseable coordinate system definition","geocentric transformation missing z or ellps","unknown prime meridian conversion id","illegal axis orientation combination","point not within available datum shift grids","invalid sweep axis, choose x or y"];function j(){var i=z.last_errno;i&&(i>0||!function(i){return H.indexOf(i)>-1}(i))&&K(i)}var H=[-14,-15,-17,-18,-19,-20,-27,-48];function F(i){z.last_errno=i}function B(){F(-20)}function V(){F(-20)}function J(i){K(i)}function K(i){F(i),Z()}function Z(i,t){var n;throw t||(t={}),t.code||(t.code=z.last_errno||0),i||(n=t.code,i=W[~n]||"unknown error"),new function(i,t){var n=new Error(i);return n.name="ProjError",Object.keys(t).forEach(function(i){n[i]=t[i]}),n}(i,t)}function $(i){return Q(i)*E}function Q(i){var t=/(-?[0-9.]+)d?([0-9.]*)'?([0-9.]*)"?([nsew]?)$/i.exec(i),n=NaN;return t&&(n=+(t[1]||"0")+ +(t[2]||"0")/60+ +(t[3]||"0")/3600,/[ws]/i.test(t[4])&&(n=-n)),isNaN(n)&&K(-16),n}function X(i){return Y(i)}function Y(i){return parseFloat(i)}function ii(i,t){var n,a,e=t[0],r=i[t.substr(1)],s=void 0!==r;return"t"==e?n=s:s?(a=r.param,r.used=!0,"i"==e?n=parseInt(a):"d"==e?n=X(a):"r"==e?n=$(a):"s"==e?n=String(a):"b"==e&&("T"==a||"t"==a||!0===a?n=!0:"F"==a||"f"==a?n=!1:(F(-8),n=!1))):n={i:0,b:!1,d:0,r:0,s:""}[e],void 0===n&&Z("invalid request to pj_param, fatal"),n}function ti(i){for(var t,n=/\+([a-z][a-z0-9_]*(?:=[^\s]*)?)/gi,a={};t=n.exec(i);)ni(a,t[1]);return a}function ni(i,t){var n,a,e=t.split("=");1==e.length?(n=t,a=!0):(n=e[0],a=t.substr(e[0].length+1)),i[n]={used:!1,param:a}}var ai={};function ei(i,t,n,a){ai[t]={init:i,name:n,description:a}}function ri(i){return!i||i.is_latlong}function si(i){var t=!1,n="";return"datum"in i.params?(t=!0,n+=oi(i,"datum")):"ellps"in i.params?n+=oi(i,"ellps"):"a"in i.params?(n+=oi(i,"a"),"b"in i.params?n+=oi(i,"b"):"es"in i.params?n+=oi(i,"es"):"f"in i.params?n+=oi(i,"f"):n+=" +es="+i.es):J(-13),t||(n+=oi(i,"towgs84"),n+=oi(i,"nadgrids")),n+=oi(i,"R"),n+=oi(i,"R_A"),n+=oi(i,"R_V"),n+=oi(i,"R_a"),n+=oi(i,"R_lat_a"),n+=oi(i,"R_lat_g"),n+=oi(i,"pm")}function oi(i,t){var n="";return t in i.params&&(n=" +"+t,!0!==i.params[t].param&&(n+="="+ii(i.params,"s"+t))),n}var hi=[["WGS84","towgs84=0,0,0","WGS84","WGS_1984"],["GGRS87","towgs84=-199.87,74.79,246.62","GRS80","Greek_Geodetic_Reference_System_1987"],["NAD83","towgs84=0,0,0","GRS80","North_American_Datum_1983"],["NAD27","nadgrids=@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat","clrk66","North_American_Datum_1927"],["potsdam","towgs84=598.1,73.7,418.2,0.202,0.045,-2.455,6.7","bessel","Potsdam Rauenberg 1950 DHDN"],["carthage","towgs84=-263.0,6.0,431.0","clrk80ign","Carthage 1934 Tunisia"],["hermannskogel","towgs84=577.326,90.129,463.919,5.137,1.474,5.297,2.4232","bessel","Hermannskogel"],["ire65","towgs84=482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15","mod_airy","Ireland 1965"],["nzgd49","towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993","intl","New Zealand Geodetic Datum 1949"],["OSGB36","towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894","airy","OSGB 1936"],[null,null,null,null]],pi=[["greenwich","0dE"],["lisbon","9d07'54.862\"W"],["paris","2d20'14.025\"E"],["bogota","74d04'51.3\"W"],["madrid","3d41'16.58\"W"],["rome","12d27'8.4\"E"],["bern","7d26'22.5\"E"],["jakarta","106d48'27.79\"E"],["ferro","17d40'W"],["brussels","4d22'4.71\"E"],["stockholm","18d3'29.8\"E"],["athens","23d42'58.815\"E"],["oslo","10d43'22.5\"E"],[null,null]];function li(i){var t=hi.reduce(function(t,n){return n[0]===i?n:t},null);return t?{id:t[0],defn:t[1],ellipse_id:t[2],name:t[3]}:null}var ci=[["MERIT","a=6378137.0","rf=298.257","MERIT 1983"],["SGS85","a=6378136.0","rf=298.257","Soviet Geodetic System 85"],["GRS80","a=6378137.0","rf=298.257222101","GRS 1980(IUGG, 1980)"],["IAU76","a=6378140.0","rf=298.257","IAU 1976"],["airy","a=6377563.396","b=6356256.910","Airy 1830"],["APL4.9","a=6378137.0","rf=298.25","Appl. Physics. 1965"],["NWL9D","a=6378145.0","rf=298.25","Naval Weapons Lab., 1965"],["mod_airy","a=6377340.189","b=6356034.446","Modified Airy"],["andrae","a=6377104.43","rf=300.0","Andrae 1876 (Den., Iclnd.)"],["aust_SA","a=6378160.0","rf=298.25","Australian Natl & S. Amer. 1969"],["GRS67","a=6378160.0","rf=298.2471674270","GRS 67(IUGG 1967)"],["bessel","a=6377397.155","rf=299.1528128","Bessel 1841"],["bess_nam","a=6377483.865","rf=299.1528128","Bessel 1841 (Namibia)"],["clrk66","a=6378206.4","b=6356583.8","Clarke 1866"],["clrk80","a=6378249.145","rf=293.4663","Clarke 1880 mod."],["clrk80ign","a=6378249.2","rf=293.4660212936269","Clarke 1880 (IGN)."],["CPM","a=6375738.7","rf=334.29","Comm. des Poids et Mesures 1799"],["delmbr","a=6376428","rf=311.5","Delambre 1810 (Belgium)"],["engelis","a=6378136.05","rf=298.2566","Engelis 1985"],["evrst30","a=6377276.345","rf=300.8017","Everest 1830"],["evrst48","a=6377304.063","rf=300.8017","Everest 1948"],["evrst56","a=6377301.243","rf=300.8017","Everest 1956"],["evrst69","a=6377295.664","rf=300.8017","Everest 1969"],["evrstSS","a=6377298.556","rf=300.8017","Everest (Sabah & Sarawak)"],["fschr60","a=6378166","rf=298.3","Fischer (Mercury Datum) 1960"],["fschr60m","a=6378155","rf=298.3","Modified Fischer 1960"],["fschr68","a=6378150","rf=298.3","Fischer 1968"],["helmert","a=6378200","rf=298.3","Helmert 1906"],["hough","a=6378270.0","rf=297","Hough"],["intl","a=6378388.0","rf=297","International 1909 (Hayford)"],["krass","a=6378245.0","rf=298.3","Krasovsky 1940"],["kaula","a=6378163","rf=298.24","Kaula 1961"],["lerch","a=6378139","rf=298.257","Lerch 1979"],["mprts","a=6397300","rf=191","Maupertius 1738"],["new_intl","a=6378157.5","b=6356772.2","New International 1967"],["plessis","a=6376523","b=6355863","Plessis 1817 (France)"],["SEasia","a=6378155.0","b=6356773.3205","Southeast Asia"],["walbeck","a=6376896.0","b=6355834.8467","Walbeck"],["WGS60","a=6378165.0","rf=298.3","WGS 60"],["WGS66","a=6378145.0","rf=298.25","WGS 66"],["WGS72","a=6378135.0","rf=298.26","WGS 72"],["WGS84","a=6378137.0","rf=298.257223563","WGS 84"],["sphere","a=6370997.0","b=6370997.0","Normal Sphere (r=6370997)"],[null,null,null,null]];function ui(i){var t=ci.reduce(function(t,n){return n[0]===i?n:t},null);return t?{id:t[0],major:t[1],ell:t[2],name:t[3]}:null}var fi=[["km","1000","Kilometer"],["m","1","Meter"],["dm","1/10","Decimeter"],["cm","1/100","Centimeter"],["mm","1/1000","Millimeter"],["kmi","1852.0","International Nautical Mile"],["in","0.0254","International Inch"],["ft","0.3048","International Foot"],["yd","0.9144","International Yard"],["mi","1609.344","International Statute Mile"],["fath","1.8288","International Fathom"],["ch","20.1168","International Chain"],["link","0.201168","International Link"],["us-in","1/39.37","U.S. Surveyor's Inch"],["us-ft","0.304800609601219","U.S. Surveyor's Foot"],["us-yd","0.914401828803658","U.S. Surveyor's Yard"],["us-ch","20.11684023368047","U.S. Surveyor's Chain"],["us-mi","1609.347218694437","U.S. Surveyor's Statute Mile"],["ind-yd","0.91439523","Indian Yard"],["ind-ft","0.30479841","Indian Foot"],["ind-ch","20.11669506","Indian Chain"],[null,null,null]];function _i(i){var t=fi.reduce(function(t,n){return i===n[0]?n:t},null);return t?{id:t[0],to_meter:t[1],name:t[2]}:null}var mi={};var yi={};function di(i){return yi[i]||null}function vi(i){var n,a,e,r,s,o,h,p,l=i.split(":"),c=l[0],u=l[1];return u&&c||J(-3),(n=di(c=c.toLowerCase()))||(a=c,r=require("fs"),s=require("path"),o=s.join(s.dirname(t),"../nad"),h=s.join(o,a.toUpperCase()),p=s.join(o,a.toLowerCase()),r.existsSync(h)?e=r.readFileSync(h,"utf8"):r.existsSync(p)?e=r.readFileSync(p,"utf8"):Z("unable to read from 'init' file named "+a),n=e,yi[c]=n),n?function(i,t){var n,a,e="",r="";(n=i.indexOf("<"+t+">"))>-1&&((a=i.lastIndexOf("#",n))>-1&&(r=i.substring(a+1,n).trim(),/\n/.test(r)&&(r="")),e=(e=(e=" "+(e=(e=(e=(e=(e=i.substr(n+t.length+2)).substr(0,e.indexOf("<"))).replace(/#.*/g,"")).replace(/[\s]+/g," ")).replace(/\+title=[^+]*[^ +]/g,function(i){return i.replace(/ /g,"\t")}))).replace(/ (?=[a-z])/gi," +")).replace(/\t/g," ").trim());return e?{opts:e,comment:r}:null}(n,u):null}function gi(i){var t,n,e=ti(i),s={params:e,is_latlong:!1,is_geocent:!1,is_long_wrap_set:!1,long_wrap_center:0,axis:"enu",gridlist:null,gridlist_count:0,vgridlist_geoid:null,vgridlist_geoid_count:0};return Object.keys(e).length||J(-1),ii(e,"tinit")&&function(i,t){var n=(a=t,mi[a.toLowerCase()]||null);var a;n||(n=vi(t),function(i,t){mi[i.toLowerCase()]=t}(t,n));n||J(-2);xi(i,n.opts)}(e,ii(e,"sinit")),(t=ii(e,"sproj"))||J(-4),(n=ai[t])||J(-5),ii(e,"bno_defs")||function(i,t){xi(i,"+ellps=WGS84")}(s.params),function(i){var t,n,a,e,r=i.datum_params=[0,0,0,0,0,0,0];i.datum_type=N,(t=ii(i.params,"sdatum"))&&((n=li(t))||J(-9),n.ellipse_id&&ni(i.params,"ellps="+n.ellipse_id),n.defn&&ni(i.params,n.defn)),(a=ii(i.params,"snadgrids"))&&"@null"!=a&&Z("+nadgrids is not implemented"),ii(i.params,"scatalog")&&Z("+catalog is not implemented"),(e=ii(i.params,"stowgs84"))&&(e.split(",").forEach(function(i,t){r[t]=X(i)||0}),0!=r[3]||0!=r[4]||0!=r[5]||0!=r[6]?(i.datum_type=R,r[3]*=484813681109536e-20,r[4]*=484813681109536e-20,r[5]*=484813681109536e-20,r[6]=r[6]/1e6+1):i.datum_type=O)}(s),function(i){var t,n,e,s,o,h=.16666666666666666,p=i.params,l=0,c=0;ii(p,"tR")?l=ii(p,"dR"):((t=ii(p,"sellps"))&&((n=ui(t))||J(-9),ni(p,n.major),ni(p,n.ell)),l=ii(p,"da"),ii(p,"tes")?c=ii(p,"des"):ii(p,"te")?c=(e=ii(p,"de"))*e:ii(p,"trf")?((e=ii(p,"drf"))||J(-10),c=(e=1/e)*(2-e)):ii(p,"tf")?c=(e=ii(p,"df"))*(2-e):ii(p,"tb")&&(c=1-(s=ii(p,"db"))*s/(l*l)),s||(s=l*u(1-c)),ii(p,"bR_A")?(l*=1-c*(h+c*(.04722222222222222+.022156084656084655*c)),c=0):ii(p,"bR_V")?l*=1-c*(h+c*(.06944444444444445+.04243827160493827*c)):ii(p,"bR_a")?(l=.5*(l+s),c=0):ii(p,"bR_g")?(l=u(l*s),c=0):ii(p,"bR_h")?(l+s===0&&J(-20),l=2*l*s/(l+s),c=0):(o=ii(p,"tR_lat_a")||ii(p,"tR_lat_g"))&&(e=r(ii(p,o?"rR_lat_a":"rR_lat_g")),a(e)>k&&J(-11),e=1-c*e*e,l*=o?.5*(1-c+e)/(e*u(e)):u(1-c)/e,c=0)),c<0&&J(-12),l<=0&&J(-13),i.es=c,i.a=l}(s),s.a_orig=s.a,s.es_orig=s.es,s.e=u(s.es),s.ra=1/s.a,s.one_es=1-s.es,s.one_es||J(-6),s.rone_es=1/s.one_es,function(i){return i.datum_type==O&&i.datum_params[0]==i.datum_params[1]==i.datum_params[2]===0&&6378137==i.a&&Math.abs(i.es-.00669437999)<5e-11}(s)&&(s.datum_type=D),s.geoc=!!s.es&&ii(e,"bgeoc"),s.over=ii(e,"bover"),s.has_geoid_vgrids=ii(e,"tgeoidgrids"),s.has_geoid_vgrids&&ii(e,"sgeoidgrids"),s.is_long_wrap_set=ii(e,"tlon_wrap"),s.is_long_wrap_set&&(s.long_wrap_center=ii(e,"rlon_wrap"),a(s.long_wrap_center)<10*P==!1&&J(-14)),ii(e,"saxis")&&function(i){var t=ii(i.params,"saxis");3!=t.length&&J(q);-1!="ewnsud".indexOf(t[0])&&-1!="ewnsud".indexOf(t[1])&&-1!="ewnsud".indexOf(t[2])||J(q);i.axis=t}(s),s.lam0=ii(e,"rlon_0"),s.phi0=ii(e,"rlat_0"),s.x0=ii(e,"dx_0"),s.y0=ii(e,"dy_0"),ii(e,"tk_0")?s.k0=ii(e,"dk_0"):ii(e,"tk")?s.k0=ii(e,"dk"):s.k0=1,s.k0<=0&&J(-31),function(i){var t,n,a,e=i.params;(t=ii(e,"sunits"))&&((a=_i(t))||J(-7),n=a.to_meter);n||(n=ii(e,"sto_meter"))?(i.to_meter=Ci(n),i.fr_meter=1/i.to_meter):i.to_meter=i.fr_meter=1;n=null,(t=ii(e,"svunits"))&&((a=_i(t))||J(-7),n=a.to_meter);n||ii(e,"svto_meter")?(i.vto_meter=Ci(n),i.vfr_meter=1/i.vto_meter):(i.vto_meter=i.to_meter,i.vfr_meter=i.fr_meter)}(s),function(i){var t,n,a,e=i.params;(t=ii(e,"spm"))?(r=t,s=pi.reduce(function(i,t){return t[0]===r?t:i},null),n=s?{id:s[0],definition:s[1]}:null,a=$(n?n.definition:t),isNaN(a)&&J(-46),i.from_greenwich=a):i.from_greenwich=0;var r,s}(s),n.init(s),s}function xi(i,t){var n=ti(t),a=["datum","ellps","a","b","rf","f"].reduce(function(t,n){return t||n in i},!1);Object.keys(n).forEach(function(t){t in i||"ellps"==t&&a||(i[t]=n[t])})}function Ci(i){var t=i.split("/"),n=Y(t[0]);return t.length>1&&(n/=Y(t[1])),n}var Si=0,Ai=1,Ei=4,Mi=8,bi=16;function wi(i,t){var n=Si,a=i*i,e=t*t;return i<=0&&(n|=Ei),t<=0&&(n|=Mi),i<t&&(n|=bi),n?null:{a:i,b:t,a2:a,b2:e,e2:(a-e)/a,ep2:(a-e)/e}}function ki(i,t,n,a,e){var o,h,p,l,c=Si,f=n[t],_=a[t],m=e[t];return _<-k&&_>-1.001*k?_=-k:_>k&&_<1.001*k?_=k:(_<-k||_>k)&&(c|=Ai),c||(f>S&&(f-=2*S),h=r(_),l=s(_),p=h*h,o=i.a/u(1-i.e2*p),n[t]=(o+m)*l*s(f),a[t]=(o+m)*l*r(f),e[t]=(o*(1-i.e2)+m)*h),c}function Ii(i,t,n,e,r){var s,o,h,p,f,_,m,y,d,v,g,x,C,S,A,E,M=n[t],b=e[t],w=r[t];if(p=u(M*M+b*b),f=u(M*M+b*b+w*w),p/i.a<1e-12){if(o=0,f/i.a<1e-12)return n[t]=0,e[t]=k,r[t]=-i.b,0}else o=c(b,M);_=w/f,m=p/f,y=1/u(1-i.e2*(2-i.e2)*m*m),g=m*(1-i.e2)*y,x=_*y,E=0;do{E++,h=p*g+w*x-(d=i.a/u(1-i.e2*x*x))*(1-i.e2*x*x),v=i.e2*d/(d+h),A=(S=_*(y=1/u(1-v*(2-v)*m*m)))*g-(C=m*(1-v)*y)*x,g=C,x=S}while(A*A>1e-24&&E<30);s=l(S/a(C)),n[t]=o,e[t]=s,r[t]=h}function Pi(i,t,n){var a=n.length>2,e=[n[0]],r=[n[1]],s=[a?n[2]:0];i.is_latlong&&(e[0]*=E,r[0]*=E),z.last_errno=0,Gi(i,t,e,r,s),(z.last_errno||e[0]==C)&&Z(null,{point:n}),t.is_latlong&&(e[0]*=A,r[0]*=A),n[0]=e[0],n[1]=r[0],a&&(n[2]=s[0])}function Gi(i,t,n,a,e){var r,s,o=n.length,h={},p={};if("enu"!=i.axis&&Ni(i.axis,!1,n,a,e),1!=i.vto_meter&&e)for(r=0;r<o;r++)e[r]*=i.vto_meter;if(i.is_geocent){if(e||J(L),1!=i.to_meter)for(r=0;r<o;r++)n[r]!=C&&(n[r]*=i.to_meter,a[r]*=i.to_meter);Oi(i.a_orig,i.es_orig,n,a,e)}else if(!i.is_latlong)if(i.inv3d||i.inv||Z("source projection not invertible"),i.inv3d)Z("inverse 3d transformations not supported");else for(r=0;r<o;r++)p.x=n[r],p.y=a[r],s=Li(p,i),n[r]=s.lam,a[r]=s.phi,j();if(0!==i.from_greenwich)for(r=0;r<o;r++)n[r]!=C&&(n[r]+=i.from_greenwich);if(i.has_geoid_vgrids&&e&&Z("vgrid transformation not supported"),function(i,t,n,a,e){var r,s,o,h,p=n.length;if(i.datum_type==N||t.datum_type==N)return;if(function(i,t){if(i.datum_type!=t.datum_type)return!1;if(i.a_orig!=t.a_orig||Math.abs(i.es_orig-t.es_orig)>5e-11)return!1;if(i.datum_type==O)return i.datum_params[0]==t.datum_params[0]&&i.datum_params[1]==t.datum_params[1]&&i.datum_params[2]==t.datum_params[2];if(i.datum_type==R)return i.datum_params[0]==t.datum_params[0]&&i.datum_params[1]==t.datum_params[1]&&i.datum_params[2]==t.datum_params[2]&&i.datum_params[3]==t.datum_params[3]&&i.datum_params[4]==t.datum_params[4]&&i.datum_params[5]==t.datum_params[5]&&i.datum_params[6]==t.datum_params[6];if(i.datum_type==T)return ii(i.params,"snadgrids")==ii(t.params,"snadgrids");return!0}(i,t))return;r=i.a_orig,s=i.es_orig,o=t.a_orig,h=t.es_orig,e||(e=new Float64Array(p),!0);i.datum_type==T&&(Z("gridshift not implemented"),r=M,s=b);t.datum_type==T&&(o=M,h=b);s==h&&r==o&&i.datum_type!=O&&i.datum_type!=R&&t.datum_type!=O&&t.datum_type!=R||(Ri(r,s,n,a,e),i.datum_type!=O&&i.datum_type!=R||function(i,t,n,a){var e,r,s,o,h,p,l,c,u=t.length,f=i.datum_params,_=f[0],m=f[1],y=f[2];if(i.datum_type==O)for(c=0;c<u;c++)t[c]!=C&&(t[c]+=_,n[c]+=m,a[c]+=y);else if(i.datum_type==R)for(o=f[3],h=f[4],p=f[5],l=f[6],c=0;c<u;c++)t[c]!=C&&(e=l*(t[c]-p*n[c]+h*a[c])+_,r=l*(p*t[c]+n[c]-o*a[c])+m,s=l*(-h*t[c]+o*n[c]+a[c])+y,t[c]=e,n[c]=r,a[c]=s)}(i,n,a,e),t.datum_type!=O&&t.datum_type!=R||function(i,t,n,a){var e,r,s,o,h,p,l,c,u=t.length,f=i.datum_params,_=f[0],m=f[1],y=f[2];if(i.datum_type==O)for(c=0;c<u;c++)t[c]!=C&&(t[c]-=_,n[c]-=m,a[c]-=y);else if(i.datum_type==R)for(o=f[3],h=f[4],p=f[5],l=f[6],c=0;c<u;c++)t[c]!=C&&(e=(t[c]-_)/l,r=(n[c]-m)/l,s=(a[c]-y)/l,t[c]=e+p*r-h*s,n[c]=-p*e+r+o*s,a[c]=h*e-o*r+s)}(t,n,a,e),Oi(o,h,n,a,e),t.datum_type==T&&pj_apply_gridshift_2(t,1,n,a,e))}(i,t,n,a,e),t.has_geoid_vgrids&&e&&Z("vgrid transformation not supported"),0!==t.from_greenwich)for(r=0;r<o;r++)n[r]!=C&&(n[r]-=t.from_greenwich);if(t.is_geocent){if(e||J(L),Ri(t.a_orig,t.es_orig,n,a,e),1!=t.fr_meter)for(r=0;r<o;r++)n[r]!=C&&(n[r]*=t.fr_meter,a[r]*=t.fr_meter)}else if(t.is_latlong){if(t.is_latlong&&t.is_long_wrap_set)for(r=0;r<o;r++)if(n[r]!=C){for(;n[r]<t.long_wrap_center-S;)n[r]+=P;for(;n[r]>t.long_wrap_center+S;)n[r]-=P}}else if(t.fwd3d)Z("3d transformation not supported");else for(r=0;r<o;r++)h.lam=n[r],h.phi=a[r],s=Di(h,t),n[r]=s.x,a[r]=s.y,j();if(1!=t.vto_meter&&e)for(r=0;r<o;r++)e[r]*=t.vfr_meter;return"enu"!=t.axis&&Ni(t.axis,!0,n,a,e),1==o?z.last_errno:0}function Ni(i,t,n,a,e){var r,s,o,h,p,l,c=n.length,u=0;if(t){for(o=0;o<c;o++)if(r=n[o],s=a[o],r!=C)for(e&&(u=e[o]),h=0;h<3;h++)if(2!=h||e)switch(l=0==h?n:1==h?a:e,i[h]){case"e":l[o]=r;break;case"w":l[o]=-r;break;case"n":l[o]=s;break;case"s":l[o]=-s;break;case"u":l[o]=u;break;case"d":l[o]=-u;break;default:J(q)}}else for(o=0;o<c;o++)if(r=n[o],s=a[o],r!=C)for(e&&(u=e[o]),h=0;h<3;h++)switch(p=0==h?r:1==h?s:u,i[h]){case"e":n[o]=p;break;case"w":n[o]=-p;break;case"n":a[o]=p;break;case"s":a[o]=-p;break;case"u":e&&(e[o]=p);break;case"d":e&&(e[o]=-p);break;default:J(q)}}function Oi(i,t,n,a,e){var r,s,o=n.length;for((s=wi(i,0==t?i:i*u(1-t)))||J(L),r=0;r<o;r++)n[r]!=C&&Ii(s,r,n,a,e)}function Ri(i,t,n,a,e){var r,s,o=n.length;for((s=wi(i,0===t?i:i*u(1-t)))||J(L),r=0;r<o;r++)n[r]!=C&&ki(s,r,n,a,e)&&(n[r]=a[r]=C)}function Ti(i){return a(i)>3.14159265359&&(i+=3.141592653589793,i-=6.283185307179586*e(i/6.283185307179586),i-=3.141592653589793),i}function Di(i,t){var n={x:0,y:0},e=a(i.phi)-k;return e<=1e-12&&a(i.lam)<=10?(z.last_errno=0,a(e)<=1e-12?i.phi=i.phi<0?-k:k:t.geoc&&(i.phi=l(t.rone_es*o(i.phi))),i.lam-=t.lam0,t.over||(i.lam=Ti(i.lam)),t.fwd?(t.fwd(i,n),n.x=t.fr_meter*(t.a*n.x+t.x0),n.y=t.fr_meter*(t.a*n.y+t.y0)):n.x=n.y=C):F(-14),!z.last_errno&&isFinite(n.x)&&isFinite(n.y)||(n.x=n.y=C),n}function Li(i,t){var n={lam:0,phi:0};return i.x<C&&i.y<C?(z.last_errno=0,t.inv?(i.x=(i.x*t.to_meter-t.x0)*t.ra,i.y=(i.y*t.to_meter-t.y0)*t.ra,t.inv(i,n),n.lam+=t.lam0,t.over||(n.lam=Ti(n.lam)),t.geoc&&a(a(n.phi)-k)>1e-12&&(n.phi=l(t.one_es*o(n.phi)))):n.lam=n.phi=C):F(-15),!z.last_errno&&isFinite(n.lam)&&isFinite(n.phi)||(n.lam=n.phi=C),n}function qi(i,t,n,a){var r,s,o;for((i<0||i>=9)&&(i=3),r=1,o=0;o<i;o++)r*=10;return s=3600*r,function(o){var h,p,l,c,u="",f="",_="";return o===C||isNaN(o)?"":(o<0?(o=-o,(l=a||"")||(u="-")):l=n||"",p=(o=e(o*s+.5))/r%60,h=(o=e(o/(60*r)))%60,c=e(o/60)+"d",_=p.toFixed(i),_=(p=parseFloat(_))?(t?_:String(p))+'"':"",(p||h)&&2==(f=String(h)+"'").length&&t&&(f="0"+f),u+c+f+_+l)}}function Ui(i,t,n){var a,e,r,s,o,h;return"string"!=typeof t?(e="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",r=i,a=t):(e=i,r=t,a=n),h=zi(s=gi(e),o=gi(r)),a?h(a):{forward:h,inverse:zi(o,s)}}function zi(i,t){return function(n){var a=Array.isArray(n);return n=a?n.concat():[n.x,n.y],Pi(i,t,n),a||(n={x:n[0],y:n[1]}),n}}Ui.WGS84="+proj=longlat +datum=WGS84",Ui.toPoint=function(i){var t={x:i[0],y:i[1]};return i.length>2&&(t.z=i[2]),i.length>3&&(t.m=i[3]),t};var Wi=[],ji=[];function Hi(i){return"string"==typeof i}function Fi(i){var t=Bi(i,Wi);return t||Zi("unsupported projection: "+function(i){return Vi(i)||"[unknown]"}(i)),t}function Bi(i,t){for(var n=0;n<t.length;n++)if(t[n][0](i))return t[n][1];return null}function Vi(i){return ii(i.params,"sproj")}function Ji(i){return i.replace(/[-_ \/]+/g,"_").toLowerCase()}function Ki(i){var t;return Array.isArray(i)?t=i:i&&i.length>0&&(t=i.split(",")),t}function Zi(i){throw new Error(i)}function $i(i){return{to_meter:i.UNIT[1]}}function Qi(i,t){var n,a,e=i.DATUM,r=e.SPHEROID,s=function(i){var t,n={northamerican1983:"NAD83",newzealand1949:"nzgd49"},a=Xi(i.NAME);if(a in n)return n[a];for(var e=0;e<hi.length&&(Xi((t=hi[e])[3])!=a&&Xi(t[0])!=a);e++);return t?t[0]:null}(e),o=function(i){var t,n={international1924:"intl"},a=Xi(i[0]);if(a in n)return n[a];if(/^grs1980/.test(a))return"GRS80";if("sphere"==a)return null;for(var e=0;e<ci.length&&(Xi((t=ci[e])[3])!=a&&Xi(t[0])!=a);e++);return t?t[0]:null}(r),h=t&&t.aux_sphere,p=r[1],l=r[2];return Yi(i.UNIT,"degree"),h?n="+a="+r[1]:s?n="+datum="+s:o?n="+ellps="+o:(n="+a="+p,l>0&&(n+=" +rf="+l)),!e.TOWGS84||h||s||(n+=" +towgs84="+e.TOWGS84.join(",")),((a=i.PRIMEM?i.PRIMEM[1]:0)>0||a<0)&&(n+=" +pm="+a),n}function Xi(i){return(i||"").replace(/^(GCS|D)_/i,"").replace(/[ _]/g,"").toLowerCase()}function Yi(i,t){i&&i[0].toLowerCase()!=t&&Zi("unexpected geographic units: "+geogcs.UNIT[0])}function it(i){return function(i){var t=Bi(i,ji);return t||Zi("unsupported WKT definition: "+(i.NAME||"[unknown]")),t}(i)(i)}function tt(i){return function(){return"+proj="+i}}function nt(i){return function(t){var n,a;return[i.PROJECTION(t),i.PARAMETER(t),i.GEOGCS?i.GEOGCS(t):Qi(t.GEOGCS),(n=$i(t),a="",1!=n.to_meter?a="+to_meter="+n.to_meter:Wt||(a="+units=m"),a),"+no_defs"].filter(function(i){return!!i}).join(" ")}}function at(i){return{NAME:et(i),DATUM:function(i){var t={NAME:function(i){var t=li(rt(i));return t&&t.name||"Unknown datum"}(i),SPHEROID:function(i){var t;t=ii(i.params,"trf")?ii(i.params,"drf"):i.es?1/(1-Math.sqrt(1-i.es)):0;return[function(i){var t=ui(function(i){var t,n=rt(i),a=n?li(n):null;t=a?a.ellipse_id:ii(i.params,"sellps");return t||""}(i));return t?t.name:"Unknown ellipsoid"}(i),i.a,t]}(i)},n=ii(i.params,"stowgs84");/[1-9]/.test(n)&&(t.TOWGS84=n);return t}(i),PRIMEM:["Greenwich",0],UNIT:["degree",.017453292519943295]}}function et(i){var t;return ri(i)&&(t=pt(i)),t||(t=rt(i),t=/^[a-z]+$/.test(t)?t[0].toUpperCase()+t.substr(1):t.toUpperCase()),t||"UNK"}function rt(i){return ii(i.params,"sdatum")}function st(i){return Fi(i)(i)}function ot(i,t){return ht({PROJECTION:i,PARAMETER:Nt(t)})}function ht(i){return function(t){var n={GEOGCS:i.GEOGCS&&i.GEOGCS(t)||at(t),PROJECTION:Hi(i.PROJECTION)?i.PROJECTION:i.PROJECTION(t),PARAMETER:i.PARAMETER(t),UNIT:function(i){return["Meter",i.to_meter||1]}(t)};return n.NAME=i.NAME&&i.NAME(t,n)||function(i,t){return pt(i)||t.GEOGCS.NAME+" / "+t.PROJECTION}(t,n),{PROJCS:n}}}function pt(i){var t;return ii(i.params,"tinit")&&(t=vi(ii(i.params,"sinit"))),t?t.comment:""}function lt(i,t,n){_t(ut(t),function(i,t){return nt({PROJECTION:tt(i),PARAMETER:Gt(t)})}(i,n))}function ct(i,t,n){mt(ft(i),ot(t,n))}function ut(i){var t=Ki(i).map(Ji);return function(i){var n=i.PROJECTION[0];return t.indexOf(Ji(n))>-1}}function ft(i){return function(t){var n=Vi(t);return n&&n==i}}function _t(i,t){"function"!=typeof i&&Zi("Missing WKT parser test"),"function"!=typeof t&&Zi("Missing WKT parse function"),ji.push([i,t])}function mt(i,t){"function"!=typeof i&&Zi("Missing WKT maker test"),"function"!=typeof t&&Zi("Missing WKT maker function"),Wi.push([i,t])}_t(function(i){return yt.test(Ji(i.NAME))},function(i){return nt({PROJECTION:tt("utm"),PARAMETER:function(i){var t=yt.exec(Ji(i.NAME)),n="+zone="+t[1];"S"==t[2]&&(n+=" +south");return n}})(i)}),_t(function(i){return dt.test(Ji(i.NAME))},function(i){return nt({PROJECTION:tt("ups"),PARAMETER:function(i){return"south"==dt.exec(Ji(i.NAME))[1].toLowerCase()?"+south":""}})(i)}),mt(ft("utm"),function(i){return ht({NAME:vt,PROJECTION:function(){return"Transverse_Mercator"},PARAMETER:xt})(i)}),mt(ft("ups"),function(i){return ht({NAME:gt,PROJECTION:function(){return"Polar_Stereographic"},PARAMETER:Ct})(i)});var yt=/UTM_zone_([0-9]{1,2})(N|S)/i,dt=/UPS_(North|South)/i;function vt(i,t){return t.GEOGCS.NAME+" / UTM zone "+ii(i.params,"szone")+(ii(i.params,"tsouth")?"S":"N")}function gt(i,t){return t.GEOGCS.NAME+" / UPS "+(ii(i.params,"tsouth")?"South":"North")}function xt(i){return[["latitude_of_origin",0],["central_meridian",180*i.lam0/S],["scale_factor",i.k0],["false_easting",i.x0],["false_northing",i.y0]]}function Ct(i){return[["latitude_of_origin",-90],["central_meridian",0],["scale_factor",.994],["false_easting",2e6],["false_northing",2e6]]}function St(i){return ii(i.params,"tlat_ts")&&0!=ii(i.params,"dlat_ts")}function At(i){return 0===i.es&&6378137==i.a}_t(ut("Mercator_2SP,Mercator_1SP,Mercator,Mercator_Auxiliary_Sphere"),nt({GEOGCS:function(i){var t=function(i){return/(Web_Mercator|Pseudo_Mercator)/i.test(Ji(i.NAME))}(i)?{aux_sphere:!0}:null;return Qi(i.GEOGCS,t)},PROJECTION:tt("merc"),PARAMETER:function(i){return Gt(function(i){var t=It(i,"standard_parallel_1");return t&&0!=t[1]}(i)?"lat_ts,lat_0b":"lat_tsb,lat_ts")(i)}})),mt(ft("merc"),ht({GEOGCS:function(i){if(At(i))return at(gi("+proj=longlat +datum=WGS84"));return null},PROJECTION:function(i){return St(i)?"Mercator_2SP":"Mercator_1SP"},PARAMETER:function(i){return Nt(St(i)?"lat_ts,lat_0b":"lat_tsb")(i)},NAME:function(i){return At(i)?"WGS 84 / Pseudo-Mercator":null}}));var Et=[["x_0","false_easting","m"],["y_0","false_northing","m"],["k_0","scale_factor","f"],["lat_0","latitude_of_center"],["lon_0","central_meridian"]],Mt={lat_0b:["lat_0","latitude_of_origin"],lat_0c:["lat_0",null],lat_0d:["lat_0","standard_parallel_1"],lat_1:["lat_1","standard_parallel_1"],lat_1b:["lat_1","latitude_of_point_1"],lat_1c:["lat_1","latitude_of_origin"],lat_2:["lat_2","standard_parallel_2"],lat_2b:["lat_2","latitude_of_point_2"],lat_ts:["lat_ts","standard_parallel_1"],lat_tsb:["lat_ts","latitude_of_origin"],lonc:["lonc","central_meridian"],lon_1:["lon_1","longitude_of_point_1"],lon_2:["lon_2","longitude_of_point_2"],alpha:["alpha","azimuth"],gamma:["gamma","rectified_grid_angle"],h:["h","height","f"]},bt={longitude_of_center:"central_meridian",latitude_of_origin:"latitude_of_center",latitude_of_center:"latitude_of_origin",longitude_of_1st_point:"longitude_of_point_1",longitude_of_2nd_point:"longitude_of_point_2",latitude_of_1st_point:"latitude_of_point_1",latitude_of_2nd_point:"latitude_of_point_2",k:"k_0"};function wt(i,t,n){for(var a=0;a<n.length;a++)if(n[a][t]===i)return n[a];return null}function kt(i,t,n){var a=null;return!(a=wt(i=i.toLowerCase(),t,n))&&i in bt&&(a=wt(bt[i],t,n)),a}function It(i,t){for(var n,a=i.PARAMETER||[],e=0;e<a.length;e++)if(t===(n=a[e][0].toLowerCase())||t===bt[n])return a[e];return null}function Pt(i){var t=null;return i&&(t=Ki(i).reduce(function(i,t){var n=Mt[t];return n||Zi("missing parameter rule: "+t),i.push(n),i},[])),(t||[]).concat(Et)}function Gt(i){return function(t){var n=[],a=Pt(i),e=$i(t);return(t.PARAMETER||[]).forEach(function(i){var t,r,s=kt(i[0],1,a);s?(t=function(i,t,n){var a=i[0];if("m"==i[2]&&(t*=n.to_meter),!Wt||!("x_0,y_0,lat_0,lon_0".indexOf(a)>-1&&0===t||"k_0"==a&&1==t))return"+"+a+"="+t}(s,i[1],e))&&n.push(t):(r="unhandled parameter: "+i[0],console.error("[wkt] "+r))}),n.join(" ")}}function Nt(i){return function(t){var n=[],a=Pt(i);return Object.keys(t.params).forEach(function(i){var e,r=kt(i,0,a);r&&r[1]&&(e=ii(t.params,"s"+i),n.push(function(i,t,n){var a,e=i[2];return a="m"==e?parseFloat(t)/n:"f"==e?parseFloat(t):Q(t),[i[1],a]}(r,e,t.to_meter)))}),n}}function Ot(i){return!("lat_1"in i.params&&"lat_2"in i.params)}function Rt(i){return"omerc"==Vi(i)&&("alpha"in i.params||"gamma"in i.params)}function Tt(i){return Rt(i)&&("no_uoff"in i.params||"no_off"in i.params)}function Dt(i){return ii(i.params,"tlat_ts")}function Lt(i){var t=JSON.stringify(function i(t,a){var e,r=[];a=a||0;(function(i){return Object.keys(i).sort(function(i,t){return qt(i)-qt(t)})})(t).forEach(function(s){var o=t[s];!function(i){return!!i&&"object"==(void 0===i?"undefined":n(i))&&!Array.isArray(i)}(o)?"NAME"==s?r.push(Hi(o)?o:o[0]):"PARAMETER"==s||"AXIS"==s?o.forEach(function(i){r.push([s].concat(i))}):Hi(o)?r.push([s,o]):Array.isArray(o)?r.push([s].concat(o)):((e={})[s]=o,Zi("Incorrectly formatted WKT element: "+JSON.stringify(e))):r.push([s].concat(i(o,a+1)))});0===a&&1==r.length&&(r=r[0]);return r}(i));return t=(t=t.replace(/\["([A-Z0-9]+)",/g,"$1[")).replace(/"(EAST|NORTH|SOUTH|WEST)"/g,"$1")}function qt(i){return"NAME,PROJCS,GEOGCS,GEOCCS,DATUM,SPHEROID,PRIMEM,PROJECTION,PARAMETER,UNIT,AXIS".indexOf(i)+1||999}function Ut(i){var t={};return zt(i).forEach(function(i){!function i(t,n){var a,e=t[0];if("GEOGCS"==e||"GEOCCS"==e||"PROJCS"==e||"DATUM"==e||"VERTCS"==e)for(n[e]={NAME:t[1]},a=2;a<t.length;a++){if(!Array.isArray(t[a]))throw Zi("WKT parse error");i(t[a],n[e])}else"AXIS"==e||"PARAMETER"==e?(e in n==!1&&(n[e]=[]),n[e].push(t.slice(1))):n[e]=t.slice(1);return n}(i,t)}),t}function zt(i){var t;i="["+(i=(i=(i=i.replace(/""/g,'\\"')).replace(/([A-Z0-9]+)\[/g,'["$1",')).replace(/, *([a-zA-Z]+) *(?=[,\]])/g,',"$1"'))+"]";try{t=JSON.parse(i)}catch(i){Zi("unparsable WKT format")}return t}_t(ut("Lambert_Conformal_Conic,Lambert_Conformal_Conic_1SP,Lambert_Conformal_Conic_2SP"),nt({PROJECTION:tt("lcc"),PARAMETER:function(i){return Gt(function(i){return!It(i,"standard_parallel_2")}(i)?"lat_1c":"lat_0b,lat_1,lat_2")(i)}})),mt(ft("lcc"),ht({PROJECTION:function(i){return Ot(i)?"Lambert_Conformal_Conic_1SP":"Lambert_Conformal_Conic_2SP"},PARAMETER:function(i){return Nt(Ot(i)?"lat_1c,lat_0c":"lat_0b,lat_1,lat_2")(i)}})),_t(ut("Hotine_Oblique_Mercator,Hotine_Oblique_Mercator_Azimuth_Natural_Origin"),nt({PROJECTION:tt("omerc"),PARAMETER:function(i){return Gt("alpha,gamma,lonc")(i)+" +no_uoff"}})),mt(Tt,ot("Hotine_Oblique_Mercator","alpha,gamma,lonc")),lt("omerc","Oblique_Mercator,Hotine_Oblique_Mercator_Azimuth_Center","alpha,gamma,lonc"),mt(function(i){return Rt(i)&&!Tt(i)},ot("Oblique_Mercator","alpha,gamma,lonc")),lt("omerc","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","lat_1b,lat_2b,lon_1,lon_2"),mt(function(i){return"omerc"==Vi(i)&&"lat_2"in i.params&&"lon_2"in i.params},ot("Hotine_Oblique_Mercator_Two_Point_Natural_Origin","lat_1b,lat_2b,lon_1,lon_2")),_t(ut("Stereographic,Polar_Stereographic,Stereographic_North_Pole,Stereographic_South_Pole"),nt({PROJECTION:tt("stere"),PARAMETER:function(i){var t=Gt("lat_ts,lat_tsb")(i),n=/lat_ts=([^ ]+)/.exec(t);n&&-1==t.indexOf("lat_0=")&&(t="+lat_0="+(parseFloat(n[1])<0?-90:90)+" "+t);return t}})),mt(ft("stere"),ht({PROJECTION:function(i){return Dt(i)?"Polar_Stereographic":"Oblique_Stereographic"},PARAMETER:function(i){return Dt(i)?Nt("lat_tsb,lat_0c")(i):Nt("lat_0b")}})),ct("vandg","VanDerGrinten"),_t(ut("VanDerGrinten,Van_der_Grinten_I"),nt({PROJECTION:tt("vandg"),PARAMETER:function(i){var t=Gt("")(i);return t&&(t+=" "),t+"+R_A"}})),[["aitoff","Aitoff","lat1"],["aea","Albers_Conic_Equal_Area,Albers","lat_1,lat_2"],["aeqd","Azimuthal_Equidistant"],["bonne","Bonne","lat_1"],["cass","Cassini_Soldner,Cassini"],["cea","Cylindrical_Equal_Area","lat_ts"],["eck1","Eckert_I"],["eck2","Eckert_II"],["eck3","Eckert_III"],["eck4","Eckert_IV"],["eck5","Eckert_V"],["eck6","Eckert_VI"],["eqdc","Equidistant_Conic","lat_1,lat_2"],["eqc","Plate_Carree,Equirectangular,Equidistant_Cylindrical","lat_ts"],["gall","Gall_Stereographic"],["gnom","Gnomonic"],["laea","Lambert_Azimuthal_Equal_Area"],["loxim","Loximuthal","lat_1"],["mill","Miller_Cylindrical"],["moll","Mollweide"],["nsper","Vertical_Near_Side_Perspective","h"],["nzmg","New_Zealand_Map_Grid","lat_0b"],["ortho","Orthographic","lat_0b"],["poly","Polyconic"],["robin","Robinson"],["sinu","Sinusoidal"],["sterea","Oblique_Stereographic,Double_Stereographic"],["tmerc","Transverse_Mercator,Gauss_Kruger","lat_0b"],["tpeqd","Two_Point_Equidistant","lat_1b,lat_2b,lon_1,lon_2"],["wag1","Wagner_I"],["wag2","Wagner_II"],["wag3","Wagner_III","lat_ts"],["wag4","Wagner_IV"],["wag5","Wagner_V"],["wag6","Wagner_VI"],["wag7","Wagner_VII"],["wink1","Winkel_I","lat_ts"],["wink2","Winkel_II"],["wintri","Winkel_Tripel","lat_1"]].forEach(function(i){var t=i[2]||null;lt(i[0],i[1],t),ct(i[0],i[1].split(",")[0],t)});var Wt=!0;function jt(i,t,n){var a;return t>=1e-7?n*(i/(1-(a=t*i)*a)-.5/t*m((1-a)/(1+a))):i+i}function Ht(i,t,n){return t/u(1-n*i*i)}function Ft(i,t,n){var e,o,p,l,f,_,d,v,g,x,S,A,E,M;i.fwd=function(t,n){var a,e=t.lam;(a=p-(d?o*jt(r(t.phi),i.e,i.one_es):f*r(t.phi)))<0&&B();a=l*u(a),n.x=a*r(e*=o),n.y=_-a*s(e)},i.inv=function(t,n){var u=t.x,v=_-t.y,g=y(u,v);0!=g?(o<0&&(g=-g,u=-u,v=-v),n.phi=g/l,d?(n.phi=(p-n.phi*n.phi)/o,a(e-a(n.phi))>1e-7?(n.phi=function(i,t,n){var e,o,p,l,c,u,f;if(e=h(.5*i),t<1e-7)return e;f=15;do{o=r(e),p=s(e),u=.5*(c=1-(l=t*o)*l)*c/p*(i/n-o/c+.5/t*m((1-l)/(1+l))),e+=u}while(a(u)>1e-10&&--f);return f?e:C}(n.phi,i.e,i.one_es))==C&&V():n.phi=n.phi<0?-k:k):a(n.phi=(p-n.phi*n.phi)/f)<=1?n.phi=h(n.phi):n.phi=n.phi<0?-k:k,n.lam=c(u,v)/o):(n.lam=0,n.phi=o>0?k:-k)},a(t+n)<U&&K(-21),o=g=r(t),v=s(t),x=a(t-n)>=U,(d=i.es>0)?(Bt(i.es),M=Ht(g,v,i.es),E=jt(g,i.e,i.one_es),x&&(A=Ht(g=r(n),v=s(n),i.es),S=jt(g,i.e,i.one_es),o=(M*M-A*A)/(S-E)),e=1-.5*i.one_es*m((1-i.e)/(1+i.e))/i.e,_=(l=1/o)*u((p=M*M+o*E)-o*jt(r(i.phi0),i.e,i.one_es))):(x&&(o=.5*(o+r(n))),_=(l=1/o)*u((p=v*v+(f=o+o)*g)-f*r(i.phi0)))}function Bt(i){var t,n=.01068115234375,a=[];return a[0]=1-i*(.25+i*(.046875+i*(.01953125+i*n))),a[1]=i*(.75-i*(.046875+i*(.01953125+i*n))),a[2]=(t=i*i)*(.46875-i*(.013020833333333334+.007120768229166667*i)),a[3]=(t*=i)*(.3645833333333333-.005696614583333333*i),a[4]=t*i*.3076171875,a}function Vt(i,t,n,a){return n*=t,t*=t,a[0]*i-n*(a[1]+t*(a[2]+t*(a[3]+t*a[4])))}function Jt(i,t,n){var e,o,h,p=1/(1-t);h=i;for(var l=10;l>0;--l)if(o=1-t*(e=r(h))*e,h-=o=(Vt(h,e,s(h),n)-i)*(o*u(o))*p,a(o)<1e-11)return h;return F(z),h}function Kt(i){var t=a(i);return t>=1?(t>1.00000000000001&&F(-19),i<0?-k:k):h(i)}function Zt(i){var t=a(i);return t>=1?(t>1.00000000000001&&F(-19),i<0?S:0):p(i)}function $t(i){return i<=0?0:u(i)}function Qt(i,t){return a(i)<1e-50&&a(t)<1e-50?0:c(i,t)}ei(function(i){var t=ii(i.params,"rlat_1"),n=ii(i.params,"rlat_2");Ft(i,t,n)},"aea","Albers Equal Area","\n\tConic Sph&Ell\n\tlat_1= lat_2="),ei(function(i){var t=ii(i.params,"rlat_1"),n=ii(i.params,"bsouth")?-k:k;Ft(i,t,n)},"leac","Lambert Equal Area Conic","\n\tConic, Sph&Ell\n\tlat_1= south");var Xt,Yt,tn={};function nn(i){var t=i.opaque||{mode:0};i.inv=function(i,n){var e,o,h,l,c,u,_,m,y,d,v,g,x,C,A,E,M,b=0;if(a(i.x)<1e-12&&a(i.y)<1e-12)return n.phi=0,void(n.lam=0);n.phi=i.y,n.lam=i.x;do{e=0;do{for(g=r(.5*n.lam),A=s(.5*n.lam),x=r(n.phi),C=s(n.phi),h=1-(o=C*A)*o,o=p(o)/f(h,1.5),l=2*o*h*C*g,c=o*h*x,u=2*(g*A*x*C/h-o*x*g),_=C*C*g*g/h+o*C*A*x*x,m=x*x*A/h+o*g*g*C,y=.5*(x*C*g/h-o*x*C*C*g*A),t.mode&&(l=.5*(l+n.lam*t.cosphi1),c=.5*(c+n.phi),u*=.5,_=.5*(_+t.cosphi1),m=.5*(m+1),y*=.5),l-=i.x,c-=i.y,v=(c*u-l*m)/(d=u*y-m*_),d=(l*y-c*_)/d;v>S;)v-=S;for(;v<-S;)v+=S;n.phi-=d,n.lam-=v}while((a(d)>1e-12||a(v)>1e-12)&&e++<10);n.phi>k&&(n.phi-=2*(n.phi-k)),n.phi<-k&&(n.phi-=2*(n.phi+k)),a(a(n.phi)-k)<1e-12&&!t.mode&&(n.lam=0),(o=p(s(n.phi)*s(h=.5*n.lam)))?(E=2*o*s(n.phi)*r(h)*(M=1/r(o)),M*=o*r(n.phi)):E=M=0,t.mode&&(E=.5*(E+n.lam*t.cosphi1),M=.5*(M+n.phi))}while((a(i.x-E)>1e-12||a(i.y-M)>1e-12)&&b++<20)},i.fwd=function(i,n){var a,e;(e=p(s(i.phi)*s(a=.5*i.lam)))?(n.x=2*e*s(i.phi)*r(a)*(n.y=1/r(e)),n.y*=e*r(i.phi)):n.x=n.y=0;t.mode&&(n.x=.5*(n.x+i.lam*t.cosphi1),n.y=.5*(n.y+i.phi))},i.es=0}function an(i,t,n){i.es=0,i.fwd=function(i,e){var s,o;e.y=t?k*r(i.phi):i.phi,(s=a(i.lam))>=1e-10?(n&&s>=k?e.x=u(2.4674011002723395-i.phi*i.phi+1e-10)+s-k:(o=.5*(2.4674011002723395/s+s),e.x=s-o+u(o*o-e.y*e.y)),i.lam<0&&(e.x=-e.x)):e.x=0}}function en(i){var t,n=[];return n[0]=.3333333333333333*i,t=i*i,n[0]+=.17222222222222222*t,n[1]=.06388888888888888*t,t*=i,n[0]+=.10257936507936508*t,n[1]+=.0664021164021164*t,n[2]=.01677689594356261*t,n}function rn(i,t){var n=i+i;return i+t[0]*r(n)+t[1]*r(n+n)+t[2]*r(n+n+n)}function sn(i,t){i.es=0,i.fwd=function(i,n){n.y=t.C_y*i.phi,n.x=t.C_x*i.lam*(t.A+$t(1-t.B*i.phi*i.phi))},i.inv=function(i,n){n.phi=i.y/t.C_y,n.lam=i.x/(t.C_x*(t.A+$t(1-t.B*n.phi*n.phi)))}}function on(i){var t,n,e,h,p,f,_=[],g=[],x=[],S=[];function A(i,t){for(var n,a=2*s(2*t),e=i.length-1,o=i[e],h=0;--e>=0;)n=a*o-h+i[e],h=o,o=n;return t+n*r(2*t)}function E(i,t,n){for(var a,e,o=r(t),h=s(t),p=d(n),l=v(n),c=2*h*l,u=-2*o*p,f=i.length-1,_=i[f],m=0,y=0,g=0;--f>=0;)a=y,e=m,_=c*(y=_)-a-u*(m=g)+i[f],g=u*y-e+c*m;return[(c=o*l)*_-(u=h*p)*g,c*g+u*_]}i.es<=0&&K(-34),p=h=(e=i.es/(1+u(1-i.es)))/(2-e),_[0]=h*(2+h*(-2/3+h*(h*(116/45+h*(26/45+h*(-2854/675)))-2))),g[0]=h*(h*(2/3+h*(4/3+h*(-82/45+h*(32/45+h*(4642/4725)))))-2),p*=h,_[1]=p*(7/3+h*(h*(-227/45+h*(2704/315+h*(2323/945)))-1.6)),g[1]=p*(5/3+h*(-16/15+h*(-13/9+h*(904/315+h*(-1522/945))))),p*=h,_[2]=p*(56/15+h*(-136/35+h*(-1262/105+h*(73814/2835)))),g[2]=p*(-26/15+h*(34/21+h*(1.6+h*(-12686/2835)))),p*=h,_[3]=p*(4279/630+h*(-332/35+h*(-399572/14175))),g[3]=p*(1237/630+h*(h*(-24832/14175)-2.4)),p*=h,_[4]=p*(4174/315+h*(-144838/6237)),g[4]=p*(-734/315+h*(109598/31185)),p*=h,_[5]=p*(601676/22275),g[5]=p*(444337/155925),p=h*h,t=i.k0/(1+h)*(1+p*(.25+p*(1/64+p/256))),x[0]=h*(h*(2/3+h*(-37/96+h*(1/360+h*(81/512+h*(-96199/604800)))))-.5),S[0]=h*(.5+h*(-2/3+h*(5/16+h*(41/180+h*(-127/288+h*(7891/37800)))))),x[1]=p*(-1/48+h*(-1/15+h*(437/1440+h*(-46/105+h*(1118711/3870720))))),S[1]=p*(13/48+h*(h*(557/1440+h*(281/630+h*(-1983433/1935360)))-.6)),p*=h,x[2]=p*(-17/480+h*(37/840+h*(209/4480+h*(-5569/90720)))),S[2]=p*(61/240+h*(-103/140+h*(15061/26880+h*(167603/181440)))),p*=h,x[3]=p*(-4397/161280+h*(11/504+h*(830251/7257600))),S[3]=p*(49561/161280+h*(-179/168+h*(6601661/7257600))),p*=h,x[4]=p*(-4583/161280+h*(108847/3991680)),S[4]=p*(34729/80640+h*(-3418889/1995840)),p*=h,x[5]=-.03233083094085698*p,S[5]=.6650675310896665*p,f=A(g,i.phi0),n=-t*(f+function(i,t){var n,a=2*s(t),e=i.length-1,o=i[e],h=0;for(;--e>=0;)n=a*o-h+i[e],h=o,o=n;return r(t)*n}(S,2*f)),i.fwd=function(i,e){var h,p,l,u,f,_=i.phi,d=i.lam;_=A(g,_),h=r(_),p=s(_),u=r(d),l=s(d),_=c(h,l*p),d=c(u*p,y(h,p*l)),v=o(d),x=a(v),x=function(i){var t=1+i,n=t-1;return 0===n?i:i*m(t)/n}(x*(1+x/(y(1,x)+1))),d=v<0?-x:x,f=E(S,2*_,2*d),_+=f[0],d+=f[1],a(d)<=2.623395162778?(e.y=t*_+n,e.x=t*d):e.x=e.y=C;var v,x},i.inv=function(i,e){var o,h,p,u,f,m=i.y,v=i.x;m=(m-n)/t,a(v/=t)<=2.623395162778?(f=E(x,2*m,2*v),m+=f[0],v+=f[1],v=l(d(v)),o=r(m),h=s(m),u=r(v),p=s(v),v=c(u,p*h),m=c(o*p,y(u,p*h)),e.phi=A(_,m),e.lam=v):e.phi=e.lam=C}}function hn(i){var t;i.es?(t=Bt(i.es),i.fwd=function(n,a){var e,o;a.y=Vt(n.phi,e=r(n.phi),o=s(n.phi),t),a.x=n.lam*o/u(1-i.es*e*e)},i.inv=function(n,e){var o=a(e.phi=Jt(n.y,i.es,t));o<k?(o=r(e.phi),e.lam=n.x*u(1-i.es*o*o)/s(e.phi)):o-U<k?e.lam=0:V()}):pn(i,0,1)}function pn(i,t,n){var e,o,h=8,p=1e-7;e=(o=u((t+1)/n))/(t+1),i.es=0,i.fwd=function(i,l){var c,u,f;if(t){for(c=n*r(i.phi),f=h;f&&(i.phi-=u=(t*i.phi+r(i.phi)-c)/(t+s(i.phi)),!(a(u)<p));--f);f||B()}else i.phi=1!=n?Kt(n*r(i.phi)):i.phi;l.x=e*i.lam*(t+s(i.phi)),l.y=o*i.phi},i.inv=function(i,a){i.y/=o,a.phi=t?Kt((t*i.y+r(i.y))/n):1!=n?Kt(r(i.y)/n):i.y,a.lam=i.x/(e*(t+s(i.y)))}}function ln(i){un(i,cn(i,k))}function cn(i,t){var n=r(t),a=t+t,e=u(P*n/(a+r(a)));return{C_x:2*e/S,C_y:e/n,C_p:a+r(a)}}function un(i,t){var n=10,e=1e-7;i.fwd=function(i,o){var h,p,l;for(h=t.C_p*r(i.phi),l=n;l&&(i.phi-=p=(i.phi+r(i.phi)-h)/(1+s(i.phi)),!(a(p)<e));--l);l?i.phi*=.5:i.phi=i.phi<0?-k:k;o.x=t.C_x*i.lam*s(i.phi),o.y=t.C_y*r(i.phi)},i.inv=function(i,n){n.phi=Kt(i.y/t.C_y),n.lam=i.x/(t.C_x*s(n.phi)),a(n.lam)-S<U?(n.phi+=n.phi,n.phi=Kt((n.phi+r(n.phi))/t.C_p)):n.lam=n.phi=C},i.es=0}function fn(i,t){var n,s,o,p,l,c=[[0,-1],[1,0]],_=[[-1,0],[0,-1]],m=[[0,1],[-1,0]],y=[[[1,0],[0,1]],c,_,m,m,_,c],d=1e-15;function v(i,t){var n=i.lam,s=i.phi,o=h(2/3);if(a(s)<=o)t.x=n,t.y=3*S/8*r(s);else{var p,l=u(3*(1-a(r(s)))),c=e(2*n/S+2);c>=4&&(c=3),p=-3*w+k*c,t.x=p+(n-p)*l,t.y=E(s)*w*(2-l)}}function A(i,t){var n=i.x,r=i.y,s=w;if(a(r)<=s)t.lam=n,t.phi=h(8*r/(3*S));else if(a(r)<k){var o,p,l=e(2*n/S+2);l>=4&&(l=3),o=-3*w+k*l,p=2-4*a(r)/S,t.lam=o+(n-o)/p,t.phi=E(r)*h(1-f(p,2)/3)}else t.lam=-S,t.phi=E(r)*k}function E(i){return i>0?1:i<0?-1:0}function M(i){switch(i){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case-1:return 4;case-2:return 5;case-3:return 6}return 0}function b(i,t){return function(i,t,n){var a,e,r,s,o,h=0,p=i.length;for(o=0;o<p;o++)if(t==i[o][0]&&n==i[o][1])return!0;for(a=i[0][0],e=i[0][1],o=1;o<p;o++)r=i[o%p][0],s=i[o%p][1],n>g(e,s)&&n<=x(e,s)&&t<=x(a,r)&&e!=s&&(a==r||t<=(n-e)*(r-a)/(s-e)+a)&&h++,a=r,e=s;return h%2!=0}(l,i,t)}function I(i,t,n){if(n)return rn(t,p);var e=jt(r(t),i.e,1-i.es)/o;return a(e)>1&&(e=E(e)),h(e)}function P(i,t,n,a){var e,r,s,o,h=0,p=function(i,t,n,a,e){var r,s={};if(s.x=i,s.y=t,e){if(t>w)s.region="north",s.x=-3*w+n*k,s.y=k,i-=n*k;else{if(!(t<-w))return s.region="equatorial",s.cn=0,s;s.region="south",s.x=-3*w+a*k,s.y=-k,i-=a*k}"north"==s.region?s.cn=t>=-i-w-d&&t<i+5*w-d?(n+1)%4:t>-i-w+d&&t>=i+5*w-d?(n+2)%4:t<=-i-w+d&&t>i+5*w+d?(n+3)%4:n:"south"==s.region&&(s.cn=t<=i+w+d&&t>-i-5*w+d?(a+1)%4:t<i+w-d&&t<=-i-5*w+d?(a+2)%4:t>=i+w-d&&t<-i-5*w-d?(a+3)%4:a)}else{if(t>w)s.region="north",r=k;else{if(!(t<-w))return s.region="equatorial",s.cn=0,s;s.region="south",r=-k}i<-k?(s.cn=0,s.x=-3*w,s.y=r):i>=-k&&i<0?(s.cn=1,s.x=-w,s.y=r):i>=0&&i<k?(s.cn=2,s.x=w,s.y=r):(s.cn=3,s.x=3*w,s.y=r)}return s}(i.x,i.y,t,n,a);if("equatorial"==p.region)return i.x=p.x,void(i.y=p.y);e=[i.x,i.y],r=[p.x,p.y],a?"north"==p.region?(h=t,o=y[M(-1*(p.cn-h))]):(h=n,o=y[M(p.cn-h)]):"north"==p.region?(h=t,o=y[M(p.cn-h)]):(h=n,o=y[M(-1*(p.cn-h))]),s=function(i,t){return[i[0]+t[0],i[1]+t[1]]}(function(i,t){var n,a,e=[0,0];for(n=0;n<2;n++)for(a=0;a<2;a++)e[n]+=i[n][a]*t[a];return e}(o,function(i,t){return[i[0]-t[0],i[1]-t[1]]}(e,r)),[-3*w+(a?p.cn:0)*k,k]),i.x=s[0],i.y=s[1]}t?(n=ii(i.params,"inorth_square"),s=ii(i.params,"isouth_square"),(n<0||n>3)&&K(-47),(s<0||s>3)&&K(-47),l=[[-S-d,w+d],[n*k-S-d,w+d],[n*k-S-d,3*w+d],[(n+1)*k-S+d,3*w+d],[(n+1)*k-S+d,w+d],[S+d,w+d],[S+d,-w-d],[(s+1)*k-S+d,-w-d],[(s+1)*k-S+d,-3*w-d],[s*k-S-d,-3*w-d],[s*k-S-d,-w-d],[-S-d,-w-d]],0!=i.es?(p=en(i.es),o=jt(1,i.e,i.one_es),i.a=i.a*u(.5*o),i.ra=1/i.a,i.fwd=function(t,a){return t.phi=I(i,t.phi,0),v(t,a),P(a,n,s,0)},i.inv=function(t,a){if(!b(t.x,t.y))return a.lam=C,a.phi=C,void F(-15);P(t,n,s,1),A(t,a),a.phi=I(i,a.phi,1)}):(i.fwd=function(i,t){v(i,t),P(t,n,s,0)},i.inv=function(i,t){if(!b(i.x,i.y))return t.lam=C,t.phi=C,void F(-15);P(i,n,s,1),A(i,t)})):(l=[[-S-d,w],[-3*w,k+d],[-k,w+d],[-w,k+d],[0,w+d],[w,k+d],[k,w+d],[3*w,k+d],[S+d,w],[S+d,-w],[3*w,-k-d],[k,-w-d],[w,-k-d],[0,-w-d],[-w,-k-d],[-k,-w-d],[-3*w,-k-d],[-S-d,-w]],0!=i.es?(p=en(i.es),o=jt(1,i.e,i.one_es),i.a=i.a*u(.5*o),i.ra=1/i.a,i.fwd=function(t,n){t.phi=I(i,t.phi,0),v(t,n)},i.inv=function(t,n){if(!b(t.x,t.y))return n.lam=C,n.phi=C,void F(-15);A(t,n),n.phi=I(i,n.phi,1)}):(i.fwd=function(i,t){v(i,t)},i.inv=function(i,t){if(!b(i.x,i.y))return t.lam=C,t.phi=C,void F(-15);A(i,t)}))}function _n(i){i.x0=0,i.y0=0,i.is_latlong=!0,i.fwd=function(t,n){n.x=t.lam/i.a,n.y=t.phi/i.a},i.inv=function(t,n){n.lam=t.x*i.a,n.phi=t.y*i.a}}function mn(i,t,n){return t*=n,o(.5*(k-i))/f((1-t)/(1+t),.5*n)}function yn(i,t){var n,e,s=.5*t,o=k-2*l(i),h=15;do{n=t*r(o),o+=e=k-2*l(i*f((1-n)/(1+n),s))-o}while(a(e)>1e-10&&--h);return h<=0&&F(-18),o}function dn(i,t){var n,a,e,r=t.length-1;for(a=t[r][0],e=t[r][1];--r>=0;)n=a,a=t[r][0]+i.r*n-i.i*e,e=t[r][1]+i.r*e+i.i*n;return{r:i.r*a-i.i*e,i:i.r*e+i.i*a}}function vn(i,t,n){var a,e,r,s,o,h=!0,p=t.length-1;for(e=s=t[p][0],a=r=t[p][1];--p>=0;)h?h=!1:(s=e+i.r*(o=s)-i.i*r,r=a+i.r*r+i.i*o),e=t[p][0]+i.r*(o=e)-i.i*a,a=t[p][1]+i.r*a+i.i*o;return n.r=e+i.r*s-i.i*r,n.i=a+i.r*r+i.i*s,{r:i.r*e-i.i*a,i:i.r*a+i.i*e}}function gn(i,t){var n,e,h,p,u=1e-12;0!=i.es?(n=i.e*r(i.phi0),e=2*l(o(.5*(k+i.phi0))*f((1-n)/(1+n),.5*i.e))-k):e=i.phi0,p=r(e),h=s(e),i.inv=function(n,e){var _,m,d,v,g,x,S,A={},E={},M={},b=0,w=0,I=0,P=0;for(A.r=n.x,A.i=n.y,_=20;_&&((m=vn(A,t,E)).r-=n.x,m.i-=n.y,d=E.r*E.r+E.i*E.i,M.r=-(m.r*E.r+m.i*E.i)/d,M.i=-(m.i*E.r-m.r*E.i)/d,A.r+=M.r,A.i+=M.i,!(a(M.r)+a(M.i)<=u));--_);if(_){if(b=y(A.r,A.i),v=2*l(.5*b),w=r(v),I=s(v),e.lam=i.lam0,a(b)<=u)return e.lam=0,void(e.phi=i.phi0);for(g=Kt(I*p+A.i*w*h/b),P=g,_=20;_&&(x=i.e*r(P),S=2*l(o(.5*(k+g))*f((1+x)/(1-x),.5*i.e))-k-P,P+=S,!(a(S)<=u));--_);}_?(e.phi=P,e.lam=c(A.r*w,b*h*I-A.i*p*w)):e.lam=e.phi=C},i.fwd=function(n,a){var e,c,u,_,m,y,d,v={};e=r(n.lam),c=s(n.lam),u=i.e*r(n.phi),_=2*l(o(.5*(k+n.phi))*f((1-u)/(1+u),.5*i.e))-k,m=r(_),y=s(_),d=2/(1+p*m+h*y*c),v.r=d*y*e,v.i=d*(h*m-p*y*c),v=dn(v,t),a.x=v.r,a.y=v.i}}function xn(i,t,n,e){var o,p,l,f,_,m,d,v,g,x,C,S,A=0,E=1,M=2,b=3,w=!isNaN(n)&&!isNaN(e);t<=0&&K(-30),w&&(g=s(e),x=r(e),S=s(n),C=r(n)),a(a(i.phi0)-k)<U?o=i.phi0<0?E:A:a(i.phi0)<U?o=M:(o=b,p=r(i.phi0),l=s(i.phi0)),m=t/i.a,_=1/(f=1+m),d=(f+1)*(v=1/m),i.fwd=function(i,t){var n,a,e,h,c;switch(e=r(i.phi),a=s(i.phi),n=s(i.lam),o){case b:t.y=p*e+l*a*n;break;case M:t.y=a*n;break;case E:t.y=-e;break;case A:t.y=e}t.y<_&&B();switch(t.y=m/(f-t.y),t.x=t.y*a*r(i.lam),o){case b:t.y*=l*e-p*a*n;break;case M:t.y*=e;break;case A:n=-n;case E:t.y*=a*n}w&&(h=t.y*g+t.x*x,c=1/(h*C*v+S),t.x=(t.x*g-t.y*x)*S*c,t.y=h*c)},i.inv=function(t,n){var e,s,_,v,k,I;w&&(I=1/(m-t.y*C),v=m*t.x*I,k=m*t.y*S*I,t.x=v*g+k*x,t.y=k*g-v*x);e=y(t.x,t.y),(_=1-e*e*d)<0&&V();if(_=(f-u(_))/(m/e+e/m),s=u(1-_*_),a(e)<=U)n.lam=0,n.phi=i.phi0;else{switch(o){case b:n.phi=h(s*p+t.y*_*l/e),t.y=(s-p*r(n.phi))*e,t.x*=_*l;break;case M:n.phi=h(t.y*_/e),t.y=s*e,t.x*=_;break;case A:n.phi=h(s),t.y=-t.y;break;case E:n.phi=-h(s)}n.lam=c(t.x,t.y)}},i.es=0}function Cn(i,t){var n=.79788456,a=.1013211836*(t?2:4);i.es=0,i.fwd=function(i,t){t.x=n*i.lam*(1-a*i.phi*i.phi),t.y=n*i.phi},i.inv=function(i,t){t.phi=i.y/n,t.lam=i.x/(n*(1-a*t.phi*t.phi))}}function Sn(i,t,n){i.es=0,i.fwd=function(i,a){i.phi=Kt(.883883476*r(i.phi)),a.x=t*i.lam*s(i.phi),a.x/=s(i.phi*=.333333333333333),a.y=n*r(i.phi)},i.inv=function(i,a){a.phi=Kt(i.y/n),a.lam=i.x*s(a.phi)/t,a.phi*=3,a.lam/=s(a.phi),a.phi=Kt(1.13137085*r(a.phi))}}function An(i,t){var n=t?1.5:2,a=t?.5:1,e=1.01346,r=1.2158542;i.es=0,i.fwd=function(i,t){t.x=e*i.lam*(n-a*u(1+r*i.phi*i.phi)),t.y=e*i.phi},i.inv=function(i,t){t.phi=i.y/e,t.lam=i.x/(e*(n-a*u(1+r*t.phi*t.phi)))}}function En(i,t){var n,e,s,o,h,p=1e-10,l=10,c=1.732050807568877;t?(s=.44329,o=.80404,n=6,e=5.61125,h=3):(s=1.01346,o=.9191,n=4,e=2.147143718212938,h=2),i.es=0,i.fwd=function(i,t){var f,_,y,d;for(f=e*r(i.phi),i.phi*=1.10265779,d=l;d&&(_=u(1+i.phi*i.phi),i.phi-=y=((n-_)*i.phi-m(i.phi+_)-f)/(n-2*_),!(a(y)<p));--d);d||(i.phi=f<0?-c:c);t.x=s*i.lam*(h-u(1+i.phi*i.phi)),t.y=o*i.phi},i.inv=function(i,t){var a;t.phi=i.y/o,a=u(1+t.phi*t.phi),t.lam=i.x/(s*(h-a)),t.phi=Kt(((n-a)*t.phi-m(t.phi+a))/e)}}function Mn(i){return function(t){!function(i,t){var n,e,h,p,f,_,m,d,v,g;ii(i.params,"tlat_1")&&ii(i.params,"tlat_2")?(h=ii(i.params,"rlat_1"),p=ii(i.params,"rlat_2"),d=.5*(p+h),(a(n=.5*(p-h))<1e-10||a(d)<1e-10)&&K(-42)):K(-41);switch(t){case"TISSOT":f=r(d),e=s(n),m=u(((_=f/e+e/f)-2*r(i.phi0))/f);break;case"MURD1":_=r(n)/(n*o(d))+d,m=_-i.phi0,f=r(d);break;case"MURD2":_=(e=u(s(n)))/o(d),m=_+o(d-i.phi0),f=r(d)*e;break;case"MURD3":_=n/(o(d)*o(n))+d,m=_-i.phi0,f=r(d)*r(n)*o(n)/(n*n);break;case"EULER":f=r(d)*r(n)/n,_=(n*=.5)/(o(n)*o(d))+d,m=_-i.phi0;break;case"PCONIC":f=r(d),g=s(n),v=1/o(d),a(n=i.phi0-d)-1e-10>=k&&K(-43),m=g*(v-o(n));break;case"VITK1":f=(e=o(n))*r(d)/n,_=n/(e*o(d))+d,m=_-i.phi0}i.inv=function(i,n){var a;a=y(i.x,i.y=m-i.y),f<0&&(a=-a,i.x=-i.x,i.y=-i.y);switch(n.lam=c(i.x,i.y)/f,t){case"PCONIC":n.phi=l(v-a/g)+d;break;case"MURD2":n.phi=d-l(a-_);break;default:n.phi=_-a}},i.fwd=function(i,n){var a;switch(t){case"MURD2":a=_+o(d-i.phi);break;case"PCONIC":a=g*(v-o(i.phi-d));break;default:a=_-i.phi}n.x=a*r(i.lam*=f),n.y=m-a*s(i.lam)},i.es=0}(t,i)}}function bn(i,t){var n,e,p,_,m,d,v,g,x=1e-10,C=1e-8,S=8,A=1e-10,E=0,M=1,b=2,I=3;if(g=a((e=a(i.phi0))-k)<x?i.phi0<0?E:M:e>x?b:I,t=a(t),i.es){switch(g){case M:case E:a(t-k)<x?v=2*i.k0/u(f(1+i.e,1+i.e)*f(1-i.e,1-i.e)):(v=s(t)/mn(t,e=r(t),i.e),e*=i.e,v/=u(1-e*e));break;case I:case b:e=r(i.phi0),n=2*l(P(i.phi0,e,i.e))-k,e*=i.e,v=2*i.k0*s(i.phi0)/u(1-e*e),m=r(n),d=s(n)}i.fwd=function(t,n){var a,e,o,h,p,c=0,u=0;a=s(t.lam),e=r(t.lam),p=r(t.phi),(g==b||g==I)&&(c=r(o=2*l(P(t.phi,p,i.e))-k),u=s(o));switch(g){case b:h=v/(d*(1+m*c+d*u*a)),n.y=h*(d*c-m*u*a),n.x=h*u;break;case I:h=v/(1+u*a),n.y=h*c,n.x=h*u;break;case E:t.phi=-t.phi,a=-a,p=-p;case M:n.x=v*mn(t.phi,p,i.e),n.y=-n.x*a}n.x=n.x*e},i.inv=function(t,n){n.phi;var e,p,u,_,x=0,C=0,w=0,P=0;switch(u=y(t.x,t.y),g){case b:case I:e=s(x=2*c(u*d,v)),p=r(x),C=h(0==u?e*m:e*m+t.y*p*d/u),x=o(.5*(k+C)),t.x*=p,t.y=u*d*e-t.y*m*p,P=k,w=.5*i.e;break;case M:t.y=-t.y;case E:C=k-2*l(x=-u/v),P=-k,w=-.5*i.e}for(_=0;_<S;_++,C=n.phi)if(p=i.e*r(C),n.phi=2*l(x*f((1+p)/(1-p),w))-P,a(C-n.phi)<A)return g==E&&(n.phi=-n.phi),void(n.lam=0==t.x&&0==t.y?0:c(t.x,t.y));V()}}else{switch(g){case b:p=r(i.phi0),_=s(i.phi0);case I:v=2*i.k0;break;case E:case M:v=a(t-k)>=x?s(t)/o(w-.5*t):2*i.k0}i.fwd=function(i,t){var n=i.phi,e=r(n),h=s(n),l=s(i.lam),c=r(i.lam);switch(g){case I:case b:t.y=g==I?1+h*l:1+p*e+_*h*l,t.y<=x&&B(),t.x=(t.y=v/t.y)*h*c,t.y*=g==I?e:_*e-p*h*l;break;case M:l=-l,n=-n;case E:a(n-k)<C&&B(),t.x=c*(t.y=v*o(w+.5*n)),t.y*=l}},i.inv=function(t,n){var e,o,u,f;switch(u=r(e=2*l((o=y(t.x,t.y))/v)),f=s(e),n.lam=0,g){case I:a(o)<=x?n.phi=0:n.phi=h(t.y*u/o),0==f&&0==t.x||(n.lam=c(t.x*u,f*o));break;case b:a(o)<=x?n.phi=i.phi0:n.phi=h(f*p+t.y*u*_/o),0==(e=f-p*r(n.phi))&&0==t.x||(n.lam=c(t.x*u*_,e*o));break;case M:t.y=-t.y;case E:a(o)<=x?n.phi=i.phi0:n.phi=h(g==E?-f:f),n.lam=0==t.x&&0==t.y?0:c(t.x,t.y)}}}function P(i,t,n){return t*=n,o(.5*(k+i))*f((1-t)/(1+t),.5*n)}}function wn(i,t){return f((1-i)/(1+i),t)}function kn(i,t,n,a){var e=n/t,h=t,p=1/n;i.inv=function(i,t){var n;i.y/=h,n=s(t.phi=a?l(i.y):Kt(i.y)),t.phi/=p,t.lam=i.x/(e*s(t.phi)),a?t.lam/=n*n:t.lam*=n},i.fwd=function(i,t){var n;t.x=e*i.lam*s(i.phi),t.y=h,i.phi*=p,n=s(i.phi),a?(t.x*=n*n,t.y*=o(i.phi)):(t.x/=n,t.y*=r(i.phi))},i.es=0}function In(i,t){var n=.8773826753,a=1.139753528477/t;i.es=0,i.fwd=function(i,e){var o=Kt(t*r(i.phi));e.x=n*i.lam*s(o),e.y=a*o},i.inv=function(i,e){i.y/=a,e.phi=Kt(r(i.y)/t),e.lam=i.x/(n*s(i.y))}}function Pn(i,t){var n=1e-10;i.fwd=function(i,e){var r,s,o,h;o=a(G*i.phi),h=(h=1-o*o)<0?0:u(h);a(i.lam)<n?(e.x=0,e.y=S*(i.phi<0?-o:o)/(1+h)):(s=.5*a(S/i.lam-i.lam/S),t?(r=o/(1+h),e.x=S*(u(s*s+1-r*r)-s),e.y=S*r):(r=(h*u(1+s*s)-s*h*h)/(1+s*s*o*o),e.x=S*r,e.y=S*u(1-r*(r+2*s)+n)),i.lam<0&&(e.x=-e.x),i.phi<0&&(e.y=-e.y))},i.es=0}tn.Constants={},tn.Math={},tn.Accumulator={},(Xt=tn.Constants).WGS84={a:6378137,f:1/298.257223563},Xt.version={major:1,minor:48,patch:0},Xt.version_string="1.48",(Yt=tn.Math).digits=53,Yt.epsilon=Math.pow(.5,Yt.digits-1),Yt.degree=Math.PI/180,Yt.sq=function(i){return i*i},Yt.hypot=function(i,t){var n,a;return i=Math.abs(i),t=Math.abs(t),n=Math.max(i,t),a=Math.min(i,t)/(n||1),n*Math.sqrt(1+a*a)},Yt.cbrt=function(i){var t=Math.pow(Math.abs(i),1/3);return i<0?-t:t},Yt.log1p=function(i){var t=1+i,n=t-1;return 0===n?i:i*Math.log(t)/n},Yt.atanh=function(i){var t=Math.abs(i);return t=Yt.log1p(2*t/(1-t))/2,i<0?-t:t},Yt.copysign=function(i,t){return Math.abs(i)*(t<0||0===t&&1/t<0?-1:1)},Yt.sum=function(i,t){var n=i+t,a=n-t,e=n-a;return{s:n,t:-((a-=i)+(e-=t))}},Yt.polyval=function(i,t,n,a){for(var e=i<0?0:t[n++];--i>=0;)e=e*a+t[n++];return e},Yt.AngRound=function(i){if(0===i)return i;var t=1/16,n=Math.abs(i);return n=n<t?t-(t-n):n,i<0?-n:n},Yt.AngNormalize=function(i){return(i%=360)<=-180?i+360:i<=180?i:i-360},Yt.LatFix=function(i){return Math.abs(i)>90?Number.NaN:i},Yt.AngDiff=function(i,t){var n=Yt.sum(Yt.AngNormalize(-i),Yt.AngNormalize(t)),a=Yt.AngNormalize(n.s),e=n.t;return Yt.sum(180===a&&e>0?-180:a,e)},Yt.sincosd=function(i){var t,n,a,e,r,s;switch(t=i%360,t-=90*(n=Math.floor(t/90+.5)),t*=this.degree,a=Math.sin(t),e=Math.cos(t),3&n){case 0:r=a,s=e;break;case 1:r=e,s=-a;break;case 2:r=-a,s=-e;break;default:r=-e,s=a}return i&&(r+=0,s+=0),{s:r,c:s}},Yt.atan2d=function(i,t){var n,a,e=0;switch(Math.abs(i)>Math.abs(t)&&(n=t,t=i,i=n,e=2),t<0&&(t=-t,++e),a=Math.atan2(i,t)/this.degree,e){case 1:a=(i>=0?180:-180)-a;break;case 2:a=90-a;break;case 3:a=-90+a}return a},function(i,t){i.Accumulator=function(i){this.Set(i)},i.Accumulator.prototype.Set=function(t){t||(t=0),t.constructor===i.Accumulator?(this._s=t._s,this._t=t._t):(this._s=t,this._t=0)},i.Accumulator.prototype.Add=function(i){var n=t.sum(i,this._t),a=t.sum(n.s,this._s);n=n.t,this._s=a.s,this._t=a.t,0===this._s?this._s=n:this._t+=n},i.Accumulator.prototype.Sum=function(t){var n;return t?((n=new i.Accumulator(this)).Add(t),n._s):this._s},i.Accumulator.prototype.Negate=function(){this._s*=-1,this._t*=-1}}(tn.Accumulator,tn.Math),tn.Geodesic={},tn.GeodesicLine={},tn.PolygonArea={},function(i,t,n,a,e){var r,s,o,h,p,l,c,u,f,_,m,y=20+a.digits+10,d=a.epsilon,v=200*d,g=Math.sqrt(d),x=d*v,C=1e3*g;i.tiny_=Math.sqrt(Number.MIN_VALUE),i.nC1_=6,i.nC1p_=6,i.nC2_=6,i.nC3_=6,i.nC4_=6,r=i.nC3_*(i.nC3_-1)/2,s=i.nC4_*(i.nC4_+1)/2,i.CAP_C1=1,i.CAP_C1p=2,i.CAP_C2=4,i.CAP_C3=8,i.CAP_C4=16,i.NONE=0,i.ARC=64,i.LATITUDE=128,i.LONGITUDE=256|i.CAP_C3,i.AZIMUTH=512,i.DISTANCE=1024|i.CAP_C1,i.STANDARD=i.LATITUDE|i.LONGITUDE|i.AZIMUTH|i.DISTANCE,i.DISTANCE_IN=2048|i.CAP_C1|i.CAP_C1p,i.REDUCEDLENGTH=4096|i.CAP_C1|i.CAP_C2,i.GEODESICSCALE=8192|i.CAP_C1|i.CAP_C2,i.AREA=16384|i.CAP_C4,i.ALL=32671,i.LONG_UNROLL=32768,i.OUT_MASK=32640|i.LONG_UNROLL,i.SinCosSeries=function(i,t,n,a){var e=a.length,r=e-(i?1:0),s=2*(n-t)*(n+t),o=1&r?a[--e]:0,h=0;for(r=Math.floor(r/2);r--;)o=s*(h=s*o-h+a[--e])-o+a[--e];return i?2*t*n*o:n*(o-h)},o=function(i,t){var n,e,r,s,o,h,p,l,c,u,f,_,m=a.sq(i),y=a.sq(t),d=(m+y-1)/6;return 0===y&&d<=0?n=0:(h=d,(o=(e=m*y/4)*(e+2*(s=d*(r=a.sq(d)))))>=0?(p=e+s,p+=p<0?-Math.sqrt(o):Math.sqrt(o),h+=(l=a.cbrt(p))+(0!==l?r/l:0)):(c=Math.atan2(Math.sqrt(-o),-(e+s)),h+=2*d*Math.cos(c/3)),u=Math.sqrt(a.sq(h)+y),_=((f=h<0?y/(u-h):h+u)-y)/(2*u),n=f/(Math.sqrt(f+a.sq(_))+_)),n},h=[1,4,64,0,256],i.A1m1f=function(i){var t=Math.floor(3);return(a.polyval(t,h,0,a.sq(i))/h[t+1]+i)/(1-i)},p=[-1,6,-16,32,-9,64,-128,2048,9,-16,768,3,-5,512,-7,1280,-7,2048],i.C1f=function(t,n){var e,r,s=a.sq(t),o=t,h=0;for(e=1;e<=i.nC1_;++e)r=Math.floor((i.nC1_-e)/2),n[e]=o*a.polyval(r,p,h,s)/p[h+r+1],h+=r+2,o*=t},l=[205,-432,768,1536,4005,-4736,3840,12288,-225,116,384,-7173,2695,7680,3467,7680,38081,61440],i.C1pf=function(t,n){var e,r,s=a.sq(t),o=t,h=0;for(e=1;e<=i.nC1p_;++e)r=Math.floor((i.nC1p_-e)/2),n[e]=o*a.polyval(r,l,h,s)/l[h+r+1],h+=r+2,o*=t},c=[-11,-28,-192,0,256],i.A2m1f=function(i){var t=Math.floor(3);return(a.polyval(t,c,0,a.sq(i))/c[t+1]-i)/(1+i)},u=[1,2,16,32,35,64,384,2048,15,80,768,7,35,512,63,1280,77,2048],i.C2f=function(t,n){var e,r,s=a.sq(t),o=t,h=0;for(e=1;e<=i.nC2_;++e)r=Math.floor((i.nC2_-e)/2),n[e]=o*a.polyval(r,u,h,s)/u[h+r+1],h+=r+2,o*=t},i.Geodesic=function(i,t){if(this.a=i,this.f=t,this._f1=1-this.f,this._e2=this.f*(2-this.f),this._ep2=this._e2/a.sq(this._f1),this._n=this.f/(2-this.f),this._b=this.a*this._f1,this._c2=(a.sq(this.a)+a.sq(this._b)*(0===this._e2?1:(this._e2>0?a.atanh(Math.sqrt(this._e2)):Math.atan(Math.sqrt(-this._e2)))/Math.sqrt(Math.abs(this._e2))))/2,this._etol2=.1*g/Math.sqrt(Math.max(.001,Math.abs(this.f))*Math.min(1,1-this.f/2)/2),!(isFinite(this.a)&&this.a>0))throw new Error("Equatorial radius is not positive");if(!(isFinite(this._b)&&this._b>0))throw new Error("Polar semi-axis is not positive");this._A3x=new Array(6),this._C3x=new Array(r),this._C4x=new Array(s),this.A3coeff(),this.C3coeff(),this.C4coeff()},f=[-3,128,-2,-3,64,-1,-3,-1,16,3,-1,-2,8,1,-1,2,1,1],i.Geodesic.prototype.A3coeff=function(){var i,t,n=0,e=0;for(i=5;i>=0;--i)t=Math.min(6-i-1,i),this._A3x[e++]=a.polyval(t,f,n,this._n)/f[n+t+1],n+=t+2},_=[3,128,2,5,128,-1,3,3,64,-1,0,1,8,-1,1,4,5,256,1,3,128,-3,-2,3,64,1,-3,2,32,7,512,-10,9,384,5,-9,5,192,7,512,-14,7,512,21,2560],i.Geodesic.prototype.C3coeff=function(){var t,n,e,r=0,s=0;for(t=1;t<i.nC3_;++t)for(n=i.nC3_-1;n>=t;--n)e=Math.min(i.nC3_-n-1,n),this._C3x[s++]=a.polyval(e,_,r,this._n)/_[r+e+1],r+=e+2},m=[97,15015,1088,156,45045,-224,-4784,1573,45045,-10656,14144,-4576,-858,45045,64,624,-4576,6864,-3003,15015,100,208,572,3432,-12012,30030,45045,1,9009,-2944,468,135135,5792,1040,-1287,135135,5952,-11648,9152,-2574,135135,-64,-624,4576,-6864,3003,135135,8,10725,1856,-936,225225,-8448,4992,-1144,225225,-1440,4160,-4576,1716,225225,-136,63063,1024,-208,105105,3584,-3328,1144,315315,-128,135135,-2560,832,405405,128,99099],i.Geodesic.prototype.C4coeff=function(){var t,n,e,r=0,s=0;for(t=0;t<i.nC4_;++t)for(n=i.nC4_-1;n>=t;--n)e=i.nC4_-n-1,this._C4x[s++]=a.polyval(e,m,r,this._n)/m[r+e+1],r+=e+2},i.Geodesic.prototype.A3f=function(i){return a.polyval(5,this._A3x,0,i)},i.Geodesic.prototype.C3f=function(t,n){var e,r,s=1,o=0;for(e=1;e<i.nC3_;++e)r=i.nC3_-e-1,s*=t,n[e]=s*a.polyval(r,this._C3x,o,t),o+=r+1},i.Geodesic.prototype.C4f=function(t,n){var e,r,s=1,o=0;for(e=0;e<i.nC4_;++e)r=i.nC4_-e-1,n[e]=s*a.polyval(r,this._C4x,o,t),o+=r+1,s*=t},i.Geodesic.prototype.Lengths=function(t,n,a,e,r,s,o,h,p,l,c,u,f){var _,m,y,d,v={},g=0,x=0,C=0,S=0;if((c&=i.OUT_MASK)&(i.DISTANCE|i.REDUCEDLENGTH|i.GEODESICSCALE)&&(C=i.A1m1f(t),i.C1f(t,u),c&(i.REDUCEDLENGTH|i.GEODESICSCALE)&&(S=i.A2m1f(t),i.C2f(t,f),g=C-S,S=1+S),C=1+C),c&i.DISTANCE)_=i.SinCosSeries(!0,s,o,u)-i.SinCosSeries(!0,a,e,u),v.s12b=C*(n+_),c&(i.REDUCEDLENGTH|i.GEODESICSCALE)&&(x=g*n+(C*_-S*(i.SinCosSeries(!0,s,o,f)-i.SinCosSeries(!0,a,e,f))));else if(c&(i.REDUCEDLENGTH|i.GEODESICSCALE)){for(m=1;m<=i.nC2_;++m)f[m]=C*u[m]-S*f[m];x=g*n+(i.SinCosSeries(!0,s,o,f)-i.SinCosSeries(!0,a,e,f))}return c&i.REDUCEDLENGTH&&(v.m0=g,v.m12b=h*(e*s)-r*(a*o)-e*o*x),c&i.GEODESICSCALE&&(y=e*o+a*s,d=this._ep2*(p-l)*(p+l)/(r+h),v.M12=y+(d*s-o*x)*a/r,v.M21=y-(d*a-e*x)*s/h),v},i.Geodesic.prototype.InverseStart=function(t,n,e,r,s,h,p,l,c,u,f){var _,m,y,d,g,x,S,A,E,M,b,w,k,I,P,G,N,O,R,T,D={},L=r*n-s*t,q=s*n+r*t;return D.sig12=-1,_=r*n,_+=s*t,(m=q>=0&&L<.5&&s*p<.5)?(d=a.sq(t+r),d/=d+a.sq(n+s),D.dnm=Math.sqrt(1+this._ep2*d),y=p/(this._f1*D.dnm),g=Math.sin(y),x=Math.cos(y)):(g=l,x=c),D.salp1=s*g,D.calp1=x>=0?L+s*t*a.sq(g)/(1+x):_-s*t*a.sq(g)/(1-x),A=a.hypot(D.salp1,D.calp1),E=t*r+n*s*x,m&&A<this._etol2?(D.salp2=n*g,D.calp2=L-n*r*(x>=0?a.sq(g)/(1+x):1-x),S=a.hypot(D.salp2,D.calp2),D.salp2/=S,D.calp2/=S,D.sig12=Math.atan2(A,E)):Math.abs(this._n)>.1||E>=0||A>=6*Math.abs(this._n)*Math.PI*a.sq(n)||(T=Math.atan2(-l,-c),this.f>=0?(I=(k=a.sq(t)*this._ep2)/(2*(1+Math.sqrt(1+k))+k),M=T/(w=this.f*n*this.A3f(I)*Math.PI),b=_/(w*n)):(P=s*n-r*t,G=Math.atan2(_,P),b=p/(w=((M=(N=this.Lengths(this._n,Math.PI+G,t,-n,e,r,s,h,n,s,i.REDUCEDLENGTH,u,f)).m12b/(n*s*N.m0*Math.PI)-1)<-.01?_/M:-this.f*a.sq(n)*Math.PI)/n)),b>-v&&M>-1-C?this.f>=0?(D.salp1=Math.min(1,-M),D.calp1=-Math.sqrt(1-a.sq(D.salp1))):(D.calp1=Math.max(M>-v?0:-1,M),D.salp1=Math.sqrt(1-a.sq(D.calp1))):(O=o(M,b),R=w*(this.f>=0?-M*O/(1+O):-b*(1+O)/O),g=Math.sin(R),x=-Math.cos(R),D.salp1=s*g,D.calp1=_-s*t*a.sq(g)/(1-x))),D.salp1<=0?(D.salp1=1,D.calp1=0):(S=a.hypot(D.salp1,D.calp1),D.salp1/=S,D.calp1/=S),D},i.Geodesic.prototype.Lambda12=function(t,n,e,r,s,o,h,p,l,c,u,f,_,m){var y,d,v,g,x,C,S,A,E,M,b,w,k,I={};return 0===t&&0===p&&(p=-i.tiny_),d=h*n,v=a.hypot(p,h*t),I.ssig1=t,g=d*t,I.csig1=x=p*n,y=a.hypot(I.ssig1,I.csig1),I.ssig1/=y,I.csig1/=y,I.salp2=s!==n?d/s:h,I.calp2=s!==n||Math.abs(r)!==-t?Math.sqrt(a.sq(p*n)+(n<-t?(s-n)*(n+s):(t-r)*(t+r)))/s:Math.abs(p),I.ssig2=r,C=d*r,I.csig2=S=I.calp2*s,y=a.hypot(I.ssig2,I.csig2),I.ssig2/=y,I.csig2/=y,I.sig12=Math.atan2(Math.max(0,I.csig1*I.ssig2-I.ssig1*I.csig2),I.csig1*I.csig2+I.ssig1*I.ssig2),A=Math.max(0,x*C-g*S),E=x*S+g*C,b=Math.atan2(A*c-E*l,E*c+A*l),w=a.sq(v)*this._ep2,I.eps=w/(2*(1+Math.sqrt(1+w))+w),this.C3f(I.eps,m),M=i.SinCosSeries(!0,I.ssig2,I.csig2,m)-i.SinCosSeries(!0,I.ssig1,I.csig1,m),I.domg12=-this.f*this.A3f(I.eps)*d*(I.sig12+M),I.lam12=b+I.domg12,u&&(0===I.calp2?I.dlam12=-2*this._f1*e/t:(k=this.Lengths(I.eps,I.sig12,I.ssig1,I.csig1,e,I.ssig2,I.csig2,o,n,s,i.REDUCEDLENGTH,f,_),I.dlam12=k.m12b,I.dlam12*=this._f1/(I.calp2*s))),I},i.Geodesic.prototype.Inverse=function(t,n,e,r,s){var o,h;return s||(s=i.STANDARD),s===i.LONG_UNROLL&&(s|=i.STANDARD),s&=i.OUT_MASK,h=(o=this.InverseInt(t,n,e,r,s)).vals,s&i.AZIMUTH&&(h.azi1=a.atan2d(o.salp1,o.calp1),h.azi2=a.atan2d(o.salp2,o.calp2)),h},i.Geodesic.prototype.InverseInt=function(t,n,e,r,s){var o,h,p,l,c,u,f,_,m,v,g,C,S,A,E,M,b,w,k,I,P,G,N,O,R,T,D,L,q,U,z,W,j,H,F,B,V,J,K,Z,$,Q,X,Y,ii,ti,ni,ai,ei,ri,si,oi,hi,pi,li,ci,ui,fi,_i,mi,yi,di,vi,gi,xi,Ci={};if(Ci.lat1=t=a.LatFix(t),Ci.lat2=e=a.LatFix(e),t=a.AngRound(t),e=a.AngRound(e),h=(o=a.AngDiff(n,r)).t,o=o.s,s&i.LONG_UNROLL?(Ci.lon1=n,Ci.lon2=n+o+h):(Ci.lon1=a.AngNormalize(n),Ci.lon2=a.AngNormalize(r)),o=(p=o>=0?1:-1)*a.AngRound(o),h=a.AngRound(180-o-p*h),E=o*a.degree,M=(l=a.sincosd(o>90?h:o)).s,b=(o>90?-1:1)*l.c,(c=Math.abs(t)<Math.abs(e)?-1:1)<0&&(p*=-1,l=t,t=e,e=l),t*=u=t<0?1:-1,e*=u,l=a.sincosd(t),f=this._f1*l.s,_=l.c,f/=l=a.hypot(f,_),_/=l,_=Math.max(i.tiny_,_),l=a.sincosd(e),m=this._f1*l.s,v=l.c,m/=l=a.hypot(m,v),v/=l,v=Math.max(i.tiny_,v),_<-f?v===_&&(m=m<0?f:-f):Math.abs(m)===-f&&(v=_),S=Math.sqrt(1+this._ep2*a.sq(f)),A=Math.sqrt(1+this._ep2*a.sq(m)),N=new Array(i.nC1_+1),O=new Array(i.nC2_+1),R=new Array(i.nC3_),(T=-90===t||0===M)&&(I=M,G=0,L=f,q=(k=b)*_,U=m,z=(P=1)*v,w=Math.atan2(Math.max(0,q*U-L*z),q*z+L*U),g=(D=this.Lengths(this._n,w,L,q,S,U,z,A,_,v,s|i.DISTANCE|i.REDUCEDLENGTH,N,O)).s12b,C=D.m12b,0!=(s&i.GEODESICSCALE)&&(Ci.M12=D.M12,Ci.M21=D.M21),w<1||C>=0?(w<3*i.tiny_&&(w=C=g=0),C*=this._b,g*=this._b,Ci.a12=w/a.degree):T=!1),ui=2,!T&&0===f&&(this.f<=0||h>=180*this.f))k=P=0,I=G=1,g=this.a*E,w=j=E/this._f1,C=this._b*Math.sin(w),s&i.GEODESICSCALE&&(Ci.M12=Ci.M21=Math.cos(w)),Ci.a12=o/this._f1;else if(!T)if(w=(D=this.InverseStart(f,_,S,m,v,A,E,M,b,N,O)).sig12,I=D.salp1,k=D.calp1,w>=0)G=D.salp2,P=D.calp2,H=D.dnm,g=w*this._b*H,C=a.sq(H)*this._b*Math.sin(w/H),s&i.GEODESICSCALE&&(Ci.M12=Ci.M21=Math.cos(w/H)),Ci.a12=w/a.degree,j=E/(this._f1*H);else{for(F=0,B=i.tiny_,V=1,J=i.tiny_,K=-1,Z=!1,$=!1;F<y&&(Q=(D=this.Lambda12(f,_,S,m,v,A,I,k,M,b,F<20,N,O,R)).lam12,G=D.salp2,P=D.calp2,w=D.sig12,L=D.ssig1,q=D.csig1,U=D.ssig2,z=D.csig2,W=D.eps,_i=D.domg12,X=D.dlam12,!$&&Math.abs(Q)>=(Z?8:1)*d);++F)Q>0&&(F<20||k/I>K/J)?(J=I,K=k):Q<0&&(F<20||k/I<V/B)&&(B=I,V=k),F<20&&X>0&&(Y=-Q/X,ii=Math.sin(Y),(ni=I*(ti=Math.cos(Y))+k*ii)>0&&Math.abs(Y)<Math.PI)?(k=k*ti-I*ii,I=ni,I/=l=a.hypot(I,k),k/=l,Z=Math.abs(Q)<=16*d):(I=(B+J)/2,k=(V+K)/2,I/=l=a.hypot(I,k),k/=l,Z=!1,$=Math.abs(B-I)+(V-k)<x||Math.abs(I-J)+(k-K)<x);ai=s|(s&(i.REDUCEDLENGTH|i.GEODESICSCALE)?i.DISTANCE:i.NONE),g=(D=this.Lengths(W,w,L,q,S,U,z,A,_,v,ai,N,O)).s12b,C=D.m12b,0!=(s&i.GEODESICSCALE)&&(Ci.M12=D.M12,Ci.M21=D.M21),C*=this._b,g*=this._b,Ci.a12=w/a.degree,s&i.AREA&&(gi=Math.sin(_i),ui=M*(xi=Math.cos(_i))-b*gi,fi=b*xi+M*gi)}return s&i.DISTANCE&&(Ci.s12=0+g),s&i.REDUCEDLENGTH&&(Ci.m12=0+C),s&i.AREA&&(ei=I*_,0!==(ri=a.hypot(k,I*f))&&0!==ei?(L=f,q=k*_,U=m,z=P*v,W=(oi=a.sq(ri)*this._ep2)/(2*(1+Math.sqrt(1+oi))+oi),hi=a.sq(this.a)*ri*ei*this._e2,L/=l=a.hypot(L,q),q/=l,U/=l=a.hypot(U,z),z/=l,pi=new Array(i.nC4_),this.C4f(W,pi),li=i.SinCosSeries(!1,L,q,pi),ci=i.SinCosSeries(!1,U,z,pi),Ci.S12=hi*(ci-li)):Ci.S12=0,!T&&ui>1&&(ui=Math.sin(j),fi=Math.cos(j)),!T&&fi>-.7071&&m-f<1.75?(_i=1+fi,mi=1+_,yi=1+v,si=2*Math.atan2(ui*(f*yi+m*mi),_i*(f*m+mi*yi))):(vi=P*k+G*I,0===(di=G*k-P*I)&&vi<0&&(di=i.tiny_*k,vi=-1),si=Math.atan2(di,vi)),Ci.S12+=this._c2*si,Ci.S12*=c*p*u,Ci.S12+=0),c<0&&(l=I,I=G,G=l,l=k,k=P,P=l,s&i.GEODESICSCALE&&(l=Ci.M12,Ci.M12=Ci.M21,Ci.M21=l)),{vals:Ci,salp1:I*=c*p,calp1:k*=c*u,salp2:G*=c*p,calp2:P*=c*u}},i.Geodesic.prototype.GenDirect=function(n,a,e,r,s,o){return o?o===i.LONG_UNROLL&&(o|=i.STANDARD):o=i.STANDARD,r||(o|=i.DISTANCE_IN),new t.GeodesicLine(this,n,a,e,o).GenPosition(r,s,o)},i.Geodesic.prototype.Direct=function(i,t,n,a,e){return this.GenDirect(i,t,n,!1,a,e)},i.Geodesic.prototype.ArcDirect=function(i,t,n,a,e){return this.GenDirect(i,t,n,!0,a,e)},i.Geodesic.prototype.Line=function(i,n,a,e){return new t.GeodesicLine(this,i,n,a,e)},i.Geodesic.prototype.DirectLine=function(i,t,n,a,e){return this.GenDirectLine(i,t,n,!1,a,e)},i.Geodesic.prototype.ArcDirectLine=function(i,t,n,a,e){return this.GenDirectLine(i,t,n,!0,a,e)},i.Geodesic.prototype.GenDirectLine=function(n,a,e,r,s,o){var h;return o||(o=i.STANDARD|i.DISTANCE_IN),r||(o|=i.DISTANCE_IN),(h=new t.GeodesicLine(this,n,a,e,o)).GenSetDistance(r,s),h},i.Geodesic.prototype.InverseLine=function(n,e,r,s,o){var h,p,l;return o||(o=i.STANDARD|i.DISTANCE_IN),h=this.InverseInt(n,e,r,s,i.ARC),l=a.atan2d(h.salp1,h.calp1),o&i.OUT_MASK&i.DISTANCE_IN&&(o|=i.DISTANCE),(p=new t.GeodesicLine(this,n,e,l,o,h.salp1,h.calp1)).SetArc(h.vals.a12),p},i.Geodesic.prototype.Polygon=function(i){return new n.PolygonArea(this,i)},i.WGS84=new i.Geodesic(e.WGS84.a,e.WGS84.f)}(tn.Geodesic,tn.GeodesicLine,tn.PolygonArea,tn.Math,tn.Constants),function(i,t,n){t.GeodesicLine=function(t,a,e,r,s,o,h){var p,l,c,u,f,_;s||(s=i.STANDARD|i.DISTANCE_IN),this.a=t.a,this.f=t.f,this._b=t._b,this._c2=t._c2,this._f1=t._f1,this.caps=s|i.LATITUDE|i.AZIMUTH|i.LONG_UNROLL,this.lat1=n.LatFix(a),this.lon1=e,void 0===o||void 0===h?(this.azi1=n.AngNormalize(r),p=n.sincosd(n.AngRound(this.azi1)),this.salp1=p.s,this.calp1=p.c):(this.azi1=r,this.salp1=o,this.calp1=h),p=n.sincosd(n.AngRound(this.lat1)),c=this._f1*p.s,l=p.c,c/=p=n.hypot(c,l),l/=p,l=Math.max(i.tiny_,l),this._dn1=Math.sqrt(1+t._ep2*n.sq(c)),this._salp0=this.salp1*l,this._calp0=n.hypot(this.calp1,this.salp1*c),this._ssig1=c,this._somg1=this._salp0*c,this._csig1=this._comg1=0!==c||0!==this.calp1?l*this.calp1:1,p=n.hypot(this._ssig1,this._csig1),this._ssig1/=p,this._csig1/=p,this._k2=n.sq(this._calp0)*t._ep2,u=this._k2/(2*(1+Math.sqrt(1+this._k2))+this._k2),this.caps&i.CAP_C1&&(this._A1m1=i.A1m1f(u),this._C1a=new Array(i.nC1_+1),i.C1f(u,this._C1a),this._B11=i.SinCosSeries(!0,this._ssig1,this._csig1,this._C1a),f=Math.sin(this._B11),_=Math.cos(this._B11),this._stau1=this._ssig1*_+this._csig1*f,this._ctau1=this._csig1*_-this._ssig1*f),this.caps&i.CAP_C1p&&(this._C1pa=new Array(i.nC1p_+1),i.C1pf(u,this._C1pa)),this.caps&i.CAP_C2&&(this._A2m1=i.A2m1f(u),this._C2a=new Array(i.nC2_+1),i.C2f(u,this._C2a),this._B21=i.SinCosSeries(!0,this._ssig1,this._csig1,this._C2a)),this.caps&i.CAP_C3&&(this._C3a=new Array(i.nC3_),t.C3f(u,this._C3a),this._A3c=-this.f*this._salp0*t.A3f(u),this._B31=i.SinCosSeries(!0,this._ssig1,this._csig1,this._C3a)),this.caps&i.CAP_C4&&(this._C4a=new Array(i.nC4_),t.C4f(u,this._C4a),this._A4=n.sq(this.a)*this._calp0*this._salp0*t._e2,this._B41=i.SinCosSeries(!1,this._ssig1,this._csig1,this._C4a)),this.a13=this.s13=Number.NaN},t.GeodesicLine.prototype.GenPosition=function(t,a,e){var r,s,o,h,p,l,c,u,f,_,m,y,d,v,g,x,C,S,A,E,M,b,w,k,I,P,G={};return e?e===i.LONG_UNROLL&&(e|=i.STANDARD):e=i.STANDARD,e&=this.caps&i.OUT_MASK,G.lat1=this.lat1,G.azi1=this.azi1,G.lon1=e&i.LONG_UNROLL?this.lon1:n.AngNormalize(this.lon1),t?G.a12=a:G.s12=a,t||this.caps&i.DISTANCE_IN&i.OUT_MASK?(h=0,p=0,t?(r=a*n.degree,s=(w=n.sincosd(a)).s,o=w.c):(u=a/(this._b*(1+this._A1m1)),f=Math.sin(u),_=Math.cos(u),r=u-((h=-i.SinCosSeries(!0,this._stau1*_+this._ctau1*f,this._ctau1*_-this._stau1*f,this._C1pa))-this._B11),s=Math.sin(r),o=Math.cos(r),Math.abs(this.f)>.01&&(l=this._ssig1*o+this._csig1*s,c=this._csig1*o-this._ssig1*s,h=i.SinCosSeries(!0,l,c,this._C1a),r-=((1+this._A1m1)*(r+(h-this._B11))-a/this._b)/Math.sqrt(1+this._k2*n.sq(l)),s=Math.sin(r),o=Math.cos(r))),l=this._ssig1*o+this._csig1*s,c=this._csig1*o-this._ssig1*s,A=Math.sqrt(1+this._k2*n.sq(l)),e&(i.DISTANCE|i.REDUCEDLENGTH|i.GEODESICSCALE)&&((t||Math.abs(this.f)>.01)&&(h=i.SinCosSeries(!0,l,c,this._C1a)),p=(1+this._A1m1)*(h-this._B11)),d=this._calp0*l,0===(v=n.hypot(this._salp0,this._calp0*c))&&(v=c=i.tiny_),C=this._salp0,S=this._calp0*c,t&&e&i.DISTANCE&&(G.s12=this._b*((1+this._A1m1)*r+p)),e&i.LONGITUDE&&(g=this._salp0*l,x=c,y=n.copysign(1,this._salp0),m=((e&i.LONG_UNROLL?y*(r-(Math.atan2(l,c)-Math.atan2(this._ssig1,this._csig1))+(Math.atan2(y*g,x)-Math.atan2(y*this._somg1,this._comg1))):Math.atan2(g*this._comg1-x*this._somg1,x*this._comg1+g*this._somg1))+this._A3c*(r+(i.SinCosSeries(!0,l,c,this._C3a)-this._B31)))/n.degree,G.lon2=e&i.LONG_UNROLL?this.lon1+m:n.AngNormalize(n.AngNormalize(this.lon1)+n.AngNormalize(m))),e&i.LATITUDE&&(G.lat2=n.atan2d(d,this._f1*v)),e&i.AZIMUTH&&(G.azi2=n.atan2d(C,S)),e&(i.REDUCEDLENGTH|i.GEODESICSCALE)&&(E=i.SinCosSeries(!0,l,c,this._C2a),M=(1+this._A2m1)*(E-this._B21),b=(this._A1m1-this._A2m1)*r+(p-M),e&i.REDUCEDLENGTH&&(G.m12=this._b*(A*(this._csig1*l)-this._dn1*(this._ssig1*c)-this._csig1*c*b)),e&i.GEODESICSCALE&&(w=this._k2*(l-this._ssig1)*(l+this._ssig1)/(this._dn1+A),G.M12=o+(w*l-c*b)*this._ssig1/this._dn1,G.M21=o-(w*this._ssig1-this._csig1*b)*l/A)),e&i.AREA&&(k=i.SinCosSeries(!1,l,c,this._C4a),0===this._calp0||0===this._salp0?(I=C*this.calp1-S*this.salp1,P=S*this.calp1+C*this.salp1):(I=this._calp0*this._salp0*(o<=0?this._csig1*(1-o)+s*this._ssig1:s*(this._csig1*s/(1+o)+this._ssig1)),P=n.sq(this._salp0)+n.sq(this._calp0)*this._csig1*c),G.S12=this._c2*Math.atan2(I,P)+this._A4*(k-this._B41)),t||(G.a12=r/n.degree),G):(G.a12=Number.NaN,G)},t.GeodesicLine.prototype.Position=function(i,t){return this.GenPosition(!1,i,t)},t.GeodesicLine.prototype.ArcPosition=function(i,t){return this.GenPosition(!0,i,t)},t.GeodesicLine.prototype.GenSetDistance=function(i,t){i?this.SetArc(t):this.SetDistance(t)},t.GeodesicLine.prototype.SetDistance=function(t){var n;this.s13=t,n=this.GenPosition(!1,this.s13,i.ARC),this.a13=0+n.a12},t.GeodesicLine.prototype.SetArc=function(t){var n;this.a13=t,n=this.GenPosition(!0,this.a13,i.DISTANCE),this.s13=0+n.s12}}(tn.Geodesic,tn.GeodesicLine,tn.Math),ei(function(i){var t,n,e,h,l,f,_,m=1e-10,d=1e-14,v=0,g=1,x=2,C=3;i.phi0=ii(i.params,"rlat_0"),a(a(i.phi0)-k)<m?(l=i.phi0<0?g:v,t=i.phi0<0?-1:1,n=0):a(i.phi0)<m?(l=x,t=0,n=1):(l=C,t=r(i.phi0),n=s(i.phi0));if(i.es)if(_=new tn.Geodesic.Geodesic(i.a,i.es/(1+u(i.one_es))),f=Bt(i.es),ii(i.params,"bguam"))e=Vt(i.phi0,t,n,f),i.inv=function(t,n){var a,h,p;for(a=.5*t.x*t.x,n.phi=i.phi0,p=0;p<3;++p)h=i.e*r(n.phi),n.phi=Jt(e+t.y-a*o(n.phi)*(h=u(1-h*h)),i.es,f);n.lam=t.x*h/s(n.phi)},i.fwd=function(t,n){var a,o,h;a=s(t.phi),o=r(t.phi),h=1/u(1-i.es*o*o),n.x=t.lam*a*h,n.y=Vt(t.phi,o,a,f)-e+.5*t.lam*t.lam*a*o*h};else{switch(l){case v:h=Vt(k,1,0,f);break;case g:h=Vt(-k,-1,0,f);break;case x:case C:i.inv=M,i.fwd=A,1/u(1-i.es*t*t),t*(i.e/u(i.one_es)),n}i.inv=M,i.fwd=A}else i.inv=function(a,e){var o,h,p,u=a.x,f=a.y;if((h=y(u,f))>S)h-m>S&&V(),h=S;else if(h<m)return e.phi=i.phi0,void(e.lam=0);l==C||l==x?(p=r(h),o=s(h),l==x?(e.phi=Kt(f*p/h),u*=p,f=o*h):(e.phi=Kt(o*t+f*p*n/h),f=(o-t*r(e.phi))*h,u*=p*n),e.lam=0==f?0:c(u,f)):l==v?(e.phi=k-h,e.lam=c(u,-f)):(e.phi=h-k,e.lam=c(u,f))},i.fwd=function(i,e){var o,h,c;switch(c=r(i.phi),h=s(i.phi),o=s(i.lam),l){case x:case C:e.y=l==x?h*o:t*c+n*h*o,a(a(e.y)-1)<d?e.y<0?B():e.x=e.y=0:(e.y=p(e.y),e.y/=r(e.y),e.x=e.y*h*r(i.lam),e.y*=l==x?c:n*c-t*h*o);break;case v:i.phi=-i.phi,o=-o;case g:a(i.phi-k)<m&&B(),e.x=(e.y=k+i.phi)*r(i.lam),e.y*=o}};function A(t,n){var e,o,p,c,u,y,d,S,A,M,b;switch(e=s(t.lam),o=s(t.phi),p=r(t.phi),l){case v:e=-e;case g:n.x=(c=a(h-Vt(t.phi,p,o,f)))*r(t.lam),n.y=c*e;break;case x:case C:if(a(t.lam)<m&&a(t.phi-i.phi0)<m){n.x=n.y=0;break}S=i.phi0/E,d=i.lam0/E,M=t.phi/E,A=(t.lam+i.lam0)/E,b=_.Inverse(S,d,M,A,_.AZIMUTH),u=b.azi1*E,y=b.s12,n.x=y*r(u)/i.a,n.y=y*s(u)/i.a}}function M(t,n){var a,e,r,s,o,p,d,g;if((a=y(t.x,t.y))<m)return n.phi=i.phi0,n.lam=0,n;l==C||l==x?(s=t.x*i.a,o=t.y*i.a,p=i.phi0/E,d=i.lam0/E,e=c(s,o)/E,r=u(s*s+o*o),g=_.Direct(p,d,e,r,_.STANDARD),n.phi=g.lat2*E,n.lam=g.lon2*E,n.lam-=i.lam0):(n.phi=Jt(l==v?h-a:h+a,i.es,f),n.lam=c(t.x,l==v?-t.y:t.y))}},"aeqd","Azimuthal Equidistant","\n\tAzi, Sph&Ell\n\tlat_0 guam"),ei(function(i){var t,n,e,h,p,l,c=1e-10,u=0,f=1,_=2,y=3;i.es=0,i.fwd=function(i,l){var d,v,g,x,C,S,A,E;switch(d=r(i.lam),v=s(i.lam),h){case _:case y:x=r(i.phi),g=s(i.phi),E=g*v,h==y&&(E=t*x+n*E),!p&&E<-c&&B(),A=a(S=1-E)>c?-m(C=.5*(1+E))/S-e/C:.5-e,l.x=A*g*d,l.y=h==y?A*(n*x-t*g*v):A*x;break;case f:case u:i.phi=a(p_halfpi-i.phi),!p&&i.phi-c>k&&B(),(i.phi*=.5)>c?(C=o(i.phi),A=-2*(m(s(i.phi))/C+C*e),l.x=A*d,l.y=A*v,h==u&&(l.y=-l.y)):l.x=l.y=0}},p=ii(i.params,"bno_cut"),l=.5*(k-ii(i.params,"rlat_b")),a(l)<c?e=-.5:(e=1/o(l),e*=e*m(s(l)));a(a(i.phi0)-k)<c?i.phi0<0?(p_halfpi=-k,h=f):(p_halfpi=k,h=u):a(i.phi0)<c?h=_:(h=y,t=r(i.phi0),n=s(i.phi0))},"airy","Airy","\n\tMisc Sph, no inv.\n\tno_cut lat_b="),ei(function(i){var t=i.opaque={mode:1};ii(i.params,"tlat_1")?0===(t.cosphi1=s(ii(i.params,"rlat_1")))&&K(-22):t.cosphi1=.6366197723675814;nn(i)},"wintri","Winkel Tripel","\n\tMisc Sph\n\tlat_1"),ei(nn,"aitoff","Aitoff","\n\tMisc Sph"),ei(function(i){i.fwd=function(i,t){var n,a,e,h,p,l,c,f=i.lam;n=o(.5*i.phi),a=u(1-n*n),e=1+a*s(f*=.5),h=r(f)*a/e,l=n/e,t.x=4/3*h*(3+(p=h*h)-3*(c=l*l)),t.y=4/3*l*(3+3*p-c)},i.es=0},"august","August Epicycloidal","\n\tMisc Sph, no inv."),ei(function(i){an(i,!1,!1)},"apian","Apian Globular I","\n\tMisc Sph, no inv."),ei(function(i){an(i,!1,!0)},"ortel","Ortelius Oval","\n\tMisc Sph, no inv."),ei(function(i){an(i,!0,!1)},"bacon","Bacon Globular","\n\tMisc Sph, no inv."),ei(function(i){var t=20,n=1e-7,e=u(2),o=2.00276,h=1.11072,p=.49931;i.fwd=function(i,l){var c,u,f,_;if(c=i.phi,a(a(i.phi)-k)<n)l.x=0;else{for(f=r(c)*S,_=t;_&&(c-=u=(c+r(c)-f)/(1+s(c)),!(a(u)<n));--_);c*=.5,l.x=o*i.lam/(1/s(i.phi)+h/s(c))}l.y=p*(i.phi+e*r(c))},i.es=0},"boggs","Boggs Eumorphic","\n\tPCyl., no inv., Sph."),ei(function(i){var t,n,e,h,p,l,f=1e-10;t=ii(i.params,"rlat_1"),a(t)<f&&K(-23);i.es?(p=Bt(i.es),h=Vt(t,e=r(t),l=s(t),p),e=l/(u(1-i.es*e*e)*e),i.inv=function(t,n){var o,l;l=y(t.x,t.y=e-t.y),n.phi=Jt(e+h-l,i.es,p),(o=a(n.phi))<k?(o=r(n.phi),n.lam=l*c(t.x,t.y)*u(1-i.es*o*o)/s(n.phi)):a(o-k)<=f?n.lam=0:V()},i.fwd=function(t,n){var a,o,l;a=e+h-Vt(t.phi,o=r(t.phi),l=s(t.phi),p),o=l*t.lam/(a*u(1-i.es*o*o)),n.x=a*r(o),n.y=e-a*s(o)}):(n=a(t)+f>=k?0:1/o(t),i.inv=function(i,e){var r=y(i.x,i.y=n-i.y);e.phi=n+t-r,a(e.phi)>k&&V();a(a(e.phi)-k)<=f?e.lam=0:e.lam=r*c(i.x,i.y)/s(e.phi)},i.fwd=function(i,e){var o,h;h=n+t-i.phi,a(h)>f?(e.x=h*r(o=i.lam*s(i.phi)/h),e.y=n-h*s(o)):e.x=e.y=0})},"bonne","Bonne (Werner lat_1=90)","\n\tConic Sph&Ell\n\tlat_1="),ei(function(i){var t,n,a=.16666666666666666,e=.008333333333333333,p=.041666666666666664,l=.3333333333333333,f=.06666666666666667;i.es?(n=Bt(i.es),t=Vt(i.phi0,r(i.phi0),s(i.phi0),n),i.fwd=function(h,l){var c,f,_,m,y,d;l.y=Vt(h.phi,c=r(h.phi),m=s(h.phi),n),c=1/u(1-i.es*c*c),d=o(h.phi),f=d*d,_=h.lam*m,m*=i.es*m/(1-i.es),y=_*_,l.x=c*_*(1-y*f*(a-(8-f+8*m)*y*e)),l.y-=t-c*d*y*(.5+(5-f+6*m)*y*p)},i.inv=function(a,e){var h,c,_,m,y,d,v;v=Jt(t+a.y,i.es,n),d=o(v),c=d*d,h=r(v),_=1/(1-i.es*h*h),h=u(_),_*=(1-i.es)*h,m=a.x/h,y=m*m,e.phi=v-h*d/_*y*(.5-(1+3*c)*y*p),e.lam=m*(1+c*y*((1+3*c)*y*f-l))/s(v)}):(i.fwd=function(t,n){n.x=h(s(t.phi)*r(t.lam)),n.y=c(o(t.phi),s(t.lam))-i.phi0},i.inv=function(t,n){var a=t.y+i.phi0;n.phi=h(r(a)*s(t.x)),n.lam=c(o(t.x),s(a))})},"cass","Cassini","\n\tCyl, Sph&Ell"),ei(function(i){var t,n,e=0;ii(i.params,"tlat_ts")&&(i.k0=s(e=ii(i.params,"rlat_ts")),i.k0<0&&K(-24));i.es?(e=r(e),i.k0/=u(1-i.es*e*e),i.e=u(i.es),(n=en(i.es))||e_error_0(),t=jt(1,i.e,i.one_es),i.fwd=function(t,n){n.x=i.k0*t.lam,n.y=.5*jt(r(t.phi),i.e,i.one_es)/i.k0},i.inv=function(a,e){e.phi=rn(h(2*a.y*i.k0/t),n),e.lam=a.x/i.k0}):(i.fwd=function(t,n){n.x=i.k0*t.lam,n.y=r(t.phi)/i.k0},i.inv=function(t,n){var e,r=t.x,s=t.y;(e=a(s*=i.k0))-U<=1?(n.phi=e>=1?s<0?-k:k:h(s),n.lam=r/i.k0):V()})},"cea","Equal Area Cylindrical","\n\tCyl, Sph&Ell\n\tlat_ts="),ei(function(i){var t,n,e,o,h,p,l,f=1/3,_=1e-9,m=[];for(p=0;p<3;++p)m[p]={p:{}},m[p].phi=ii(i.params,"rlat_"+(p+1)),m[p].lam=ii(i.params,"rlon_"+(p+1)),m[p].lam=Ti(m[p].lam-i.lam0),m[p].cosphi=s(m[p].phi),m[p].sinphi=r(m[p].phi);for(p=0;p<3;++p)l=2==p?0:p+1,m[p].v=y(m[l].phi-m[p].phi,m[p].cosphi,m[p].sinphi,m[l].cosphi,m[l].sinphi,m[l].lam-m[p].lam),m[p].v.r||K(-25);function y(i,t,n,e,o,h){var p,l,f,m={};return p=s(h),a(i)>1||a(h)>1?m.r=Zt(cs1*o+t*e*p):(l=r(.5*i),f=r(.5*h),m.r=2*Kt(u(l*l+t*e*f*f))),a(m.r)>_?m.Az=c(e*r(h),t*o-n*e*p):m.r=m.Az=0,m}function d(i,t,n){return Zt(.5*(i*i+t*t-n*n)/(i*t))}e=d(m[0].v.r,m[2].v.r,m[1].v.r),o=d(m[0].v.r,m[1].v.r,m[2].v.r),h=S-e,n=2*(m[0].p.y=m[1].p.y=m[2].v.r*r(e)),m[2].p.y=0,m[0].p.x=-(m[1].p.x=.5*m[0].v.r),t=m[2].p.x=m[0].p.x+m[2].v.r*s(e),i.es=0,i.fwd=function(i,a){var e,p,l,c,u,_,v,g=[];for(e=r(i.phi),p=s(i.phi),c=0;c<3&&(g[c]=y(i.phi-m[c].phi,m[c].cosphi,m[c].sinphi,p,e,i.lam-m[c].lam),g[c].r);++c)g[c].Az=Ti(g[c].Az-m[c].v.Az);if(c<3)_=m[c].p.x,v=m[c].p.y;else{for(_=t,v=n,c=0;c<3;++c)u=2==c?0:c+1,l=d(m[c].v.r,g[c].r,g[u].r),g[c].Az<0&&(l=-l),c?1==c?(l=o-l,_-=g[c].r*s(l),v-=g[c].r*r(l)):(l=h-l,_+=g[c].r*s(l),v+=g[c].r*r(l)):(_+=g[c].r*s(l),v-=g[c].r*r(l));_*=f,v*=f}a.x=_,a.y=v}},"chamb","Chamberlin Trimetric","\n\tMisc Sph, no inv.\n\tlat_1= lon_1= lat_2= lon_2= lat_3= lon_3="),ei(function(i){var t=.9772050238058398,n=1.0233267079464885,a=3.0699801238394655,e=.32573500793527993,o=1/3;i.inv=function(i,t){t.phi=3*h(i.y*e),t.lam=i.x*n/(2*s((t.phi+t.phi)*o)-1)},i.fwd=function(i,n){i.phi*=o,n.x=t*i.lam*(2*s(i.phi+i.phi)-1),n.y=a*r(i.phi)},i.es=0},"crast","Craster Parabolic (Putnins P4)","\n\tPCyl., Sph."),ei(function(i){i.fwd=function(i,t){var n=a(i.lam);t.y=i.phi,t.x=i.lam,t.x*=s((.95+n*(n*n*.0016666666666666666-.08333333333333333))*(i.phi*(.9+.03*i.phi*i.phi*i.phi*i.phi)))},i.es=0},"denoy","Denoyer Semi-Elliptical","\n\tPCyl, Sph., no inv."),ei(function(i){var t=.9213177319235613,n=.3183098861837907;i.es=0,i.fwd=function(i,e){e.x=t*i.lam*(1-n*a(i.phi)),e.y=t*i.phi},i.inv=function(i,e){e.phi=i.y/t,e.lam=i.x/(t*(1-n*a(e.phi)))}},"eck1","Eckert I","\n\tPCyl Sph"),ei(function(i){var t=.46065886596178063,n=1.4472025091165353,e=.3333333333333333,s=1.0000001;i.es=0,i.fwd=function(i,e){e.x=t*i.lam*(e.y=u(4-3*r(a(i.phi)))),e.y=n*(2-e.y),i.phi<0&&(e.y=-e.y)},i.inv=function(i,r){r.lam=i.x/(t*(r.phi=2-a(i.y)/n)),r.phi=(4-r.phi*r.phi)*e,a(r.phi)>=1?a(r.phi)>s?V():r.phi=r.phi<0?-k:k:r.phi=h(r.phi);i.y<0&&(r.phi=-r.phi)}},"eck2","Eckert II","\n\tPCyl Sph"),ei(function(i){sn(i,{C_x:.4222382003157712,C_y:.8444764006315424,A:1,B:.4052847345693511})},"eck3","Eckert III","\n\tPCyl Sph"),ei(function(i){sn(i,{C_x:.94745,C_y:.94745,A:0,B:.3039635509270133})},"wag6","Wagner VI","\n\tPCyl Sph"),ei(function(i){sn(i,{C_x:.8660254037844,C_y:1,A:0,B:.3039635509270133})},"kav7","Kavraisky VII","\n\tPCyl Sph"),ei(function(i){sn(i,{C_x:1.8949,C_y:.94745,A:-.5,B:.3039635509270133})},"putp1","Putnins P1","\n\tPCyl Sph"),ei(function(i){var t=.4222382003157712,n=1.3265004281770023,e=3.5707963267948966,o=1e-7,h=6;i.es=0,i.fwd=function(i,p){var l,c,u,f,_;for(l=e*r(i.phi),c=i.phi*i.phi,i.phi*=.895168+c*(.0218849+.00826809*c),_=h;_&&(f=s(i.phi),u=r(i.phi),i.phi-=c=(i.phi+u*(f+2)-l)/(1+f*(f+2)-u*u),!(a(c)<o));--_);_?(p.x=t*i.lam*(1+s(i.phi)),p.y=n*r(i.phi)):(p.x=t*i.lam,p.y=i.phi<0?-n:n)},i.inv=function(i,a){var o;a.phi=Kt(i.y/n),a.lam=i.x/(t*(1+(o=s(a.phi)))),a.phi=Kt((a.phi+r(a.phi)*(o+2))/e)}},"eck4","Eckert IV","\n\tPCyl Sph"),ei(function(i){var t=.4410127717245515,n=2.267508027238226,a=.882025543449103,e=1.133754013619113;i.es=0,i.fwd=function(i,n){n.x=t*(1+s(i.phi))*i.lam,n.y=a*i.phi},i.inv=function(i,t){t.lam=n*i.x/(1+s(t.phi=e*i.y))}},"eck5","Eckert V","\n\tPCyl Sph"),ei(function(i){var t=s(ii(i.params,"rlat_ts"));t<=0&&K(-24);i.es=0,i.fwd=function(n,a){a.x=t*n.lam,a.y=n.phi-i.phi0},i.inv=function(n,a){a.lam=n.x/t,a.phi=n.y+i.phi0}},"eqc","Equidistant Cylindrical (Plate Caree)","\n\tCyl, Sph\n\tlat_ts=[, lat_0=0]"),ei(function(i){var t,n,e,o,h,p,l,u,f,_,m,d,v;t=ii(i.params,"rlat_1"),n=ii(i.params,"rlat_2"),a(t+n)<U&&K(-21);(l=Bt(i.es))||e_error_0();e=_=r(t),f=s(t),m=a(t-n)>=U,(u=i.es>0)?(v=Ht(_,f,i.es),d=Vt(t,_,f,l),m&&(_=r(n),f=s(n),e=(v-Ht(_,f,i.es))/(Vt(n,_,f,l)-d)),h=(p=d+v/e)-Vt(i.phi0,r(i.phi0),s(i.phi0),l)):(m&&(e=(f-s(n))/(n-t)),p=t+s(t)/e,h=p-i.phi0);i.fwd=function(i,t){o=p-(u?Vt(i.phi,r(i.phi),s(i.phi),l):i.phi),t.x=o*r(i.lam*=e),t.y=h-o*s(i.lam)},i.inv=function(t,n){0!=(o=y(t.x,t.y=h-t.y))?(e<0&&(o=-o,t.x=-t.x,t.y=-t.y),n.phi=p-o,u&&(n.phi=Jt(n.phi,i.es,l)),n.lam=c(t.x,t.y)/e):(n.lam=0,n.phi=e>0?k:-k)}},"eqdc","Equidistant Conic","\n\tConic, Sph&Ell\n\tlat_1= lat_2="),ei(on,"etmerc","Extended Transverse Mercator","\n\tCyl, Sph\n\tlat_ts=(0)\nlat_0=(0)"),ei(function(i){var t;i.es||K(-34);i.y0=ii(i.params,"bsouth")?1e7:0,i.x0=5e5,ii(i.params,"tzone")?(t=ii(i.params,"izone"))>0&&t<=60?--t:K(-35):(t=e(30*(Ti(i.lam0)+S)/S))<0?t=0:t>=60&&(t=59);i.lam0=(t+.5)*S/30-S,i.k0=.9996,i.phi0=0,on(i)},"utm","Universal Transverse Mercator (UTM)","\n\tCyl, Sph\n\tzone= south"),ei(function(i){var t=1.7071067811865475,n=.7071067811865476,a=.585786437626905,e=1.4142135623730951;i.fwd=function(i,a){a.x=n*i.lam,a.y=t*o(.5*i.phi)},i.inv=function(i,t){t.lam=e*i.x,t.phi=2*l(i.y*a)},i.es=0},"gall","Gall (Gall Stereographic)","\n\tCyl, Sph"),ei(function(i){i.is_geocent=!0,i.x0=0,i.y0=0,i.fwd=function(i,t){t.x=i.lam,t.y=i.phi},i.inv=function(i,t){t.phi=i.y,t.lam=i.x}},"geocent","Geocentric","\n\t"),ei(function(i){var t=e(ii(i.params,"tlat_1")?ii(i.params,"rlat_1"):0),n=r(t),a=s(t);function e(i){return Kt(o(.5*i))}i.fwd=function(i,t){var o=.5*i.lam,h=e(i.phi),p=r(h),l=s(h),c=s(o);n*p+a*l*c>=0?(t.x=l*r(o),t.y=a*p-n*l*c):B()},i.es=0},"gilbert","Gilbert Two World Perspective","\n\tPCyl., Sph., NoInv.\n\tlat_1="),ei(function(i){i.fwd=function(i,t){var n=i.phi*i.phi;t.y=i.phi*(1+.08333333333333333*n),t.x=i.lam*(1-.162388*n),n=i.lam*i.lam,t.x*=.87-952426e-9*n*n},i.es=0},"gins8","Ginsburg VIII (TsNIIGAiK)","\n\tPCyl, Sph., no inv."),ei(function(i){ii(i.params,"tn"),ii(i.params,"tm")?pn(i,ii(i.params,"dm"),ii(i.params,"dn")):K(-99)},"gn_sinu","General Sinusoidal Series","\n\tPCyl, Sph.\n\tm= n="),ei(hn,"sinu","Sinusoidal (Sanson-Flamsteed)","\n\tPCyl, Sph&Ell"),ei(function(i){pn(i,1,2.5707963267948966)},"eck6","Eckert VI","\n\tPCyl, Sph.\n\tm= n="),ei(function(i){pn(i,.5,1.7853981633974483)},"mbtfps","McBryde-Thomas Flat-Polar Sinusoidal","\n\tPCyl, Sph."),ei(function(i){var t,n,e=1e-10,o=0,p=1,f=2,_=3;a(a(i.phi0)-k)<e?n=i.phi0<0?p:o:a(i.phi0)<e?n=f:(n=_,sinph0=r(i.phi0),t=s(i.phi0));i.inv=function(s,m){var d,v,g,x=s.x,C=s.y;if(d=y(x,C),g=r(m.phi=l(d)),v=u(1-g*g),a(d)<=e)m.phi=i.phi0,m.lam=0;else{switch(n){case _:m.phi=v*sinph0+C*g*t/d,a(m.phi)>=1?m.phi=m.phi>0?k:-k:m.phi=h(m.phi),C=(v-sinph0*r(m.phi))*d,x*=g*t;break;case f:m.phi=C*g/d,a(m.phi)>=1?m.phi=m.phi>0?k:-k:m.phi=h(m.phi),C=v*d,x*=g;break;case p:m.phi-=k;break;case o:m.phi=k-m.phi,C=-C}m.lam=c(x,C)}},i.fwd=function(i,a){var h,l,c;switch(c=r(i.phi),l=s(i.phi),h=s(i.lam),n){case f:a.y=l*h;break;case _:a.y=sinph0*c+t*l*h;break;case p:a.y=-c;break;case o:a.y=c}a.y<=e&&B();switch(a.x=(a.y=1/a.y)*l*r(i.lam),n){case f:a.y*=c;break;case _:a.y*=t*c-sinph0*l*h;break;case o:h=-h;case p:a.y*=l*h}},i.es=0},"gnom","Gnomonic","\n\tAzi, Sph."),ei(ln,"moll","Mollweide","\n\tPCyl Sph"),ei(function(i){un(i,cn(i,S/3))},"wag4","Wagner IV","\n\tPCyl Sph"),ei(function(i){un(i,{C_x:.90977,C_y:1.65014,C_p:3.00896})},"wag5","Wagner V","\n\tPCyl Sph"),ei(function(i){var t,n,e,r;i.es=0,hn(i),t=i.fwd,n=i.inv,ln(i),e=i.fwd,r=i.inv,i.fwd=function(i,n){a(i.phi)<.7109307819790236?t(i,n):(e(i,n),n.y-=i.phi>0?.0528:-.0528)},i.inv=function(i,t){a(i.y)<=.7109307819790236?n(i,t):(i.y+=i.y>0?.0528:-.0528,r(i,t))}},"goode","Goode Homolosine","\n\tPCyl, Sph."),ei(function(i){var t,n,e,o=1e-10;i.inv=function(i,n){var e=u(1-.25*t*t*i.x*i.x-.25*i.y*i.y);a(2*e*e-1)<o?(n.lam=C,n.phi=C,pj_errno=-14):(n.lam=Qt(t*i.x*e,2*e*e-1)/t,n.phi=Kt(e*i.y))},i.fwd=function(i,a){var o,h;h=u(2/(1+(o=s(i.phi))*s(i.lam*=t))),a.x=n*h*o*r(i.lam),a.y=e*h*r(i.phi)},i.es=0,ii(i.params,"tW")?(t=a(ii(i.params,"dW")))<=0&&K(-27):t=.5;ii(i.params,"tM")?(n=a(ii(i.params,"dM")))<=0&&K(-27):n=1;e=1/n,n/=t},"hammer","Hammer & Eckert-Greifendorff","\n\tMisc Sph, \n\tW= M="),ei(function(i){var t=20,n=1e-7,e=1.000001,o=2.67595,p=2.43763,l=.3736990601468637,c=.4102345310814193,u=1.75859,f=1.93052,_=.5686373742600607,m=.5179951515653813,y=.85,d=1.1764705882352942;i.inv=function(i,t){var n=i.y*(i.y<0?m:_);a(n)>1?a(n)>e?V():n=n>0?k:-k:n=h(n);t.lam=d*i.x/s(n),n+=n,t.phi=(n+r(n))*(i.y<0?c:l),a(t.phi)>1?a(t.phi)>e?V():t.phi=t.phi>0?k:-k:t.phi=h(t.phi)},i.fwd=function(i,e){var h,l,c;for(l=r(i.phi)*(i.phi<0?p:o),c=t;c&&(i.phi-=h=(i.phi+r(i.phi)-l)/(1+s(i.phi)),!(a(h)<n));--c);e.x=y*i.lam*s(i.phi*=.5),e.y=r(i.phi)*(i.phi<0?f:u)},i.es=0},"hatano","Hatano Asymmetrical Equal Area","\n\tPCyl., Sph."),ei(fn,"healpix","HEALPix","\n\tSph., Ellps."),ei(function(i){fn(i,!0)},"rhealpix","rHEALPix","\n\tSph., Ellps.\n\tnorth_square= south_square="),ei(function(i){var t,n,e,p,_,m,y,d,v,g=1e-15,x=.785398163397448,C=1.37008346281555;i.a=6377397.155,i.e=u(i.es=.006674372230614),ii(i.params,"tlat_0")||(i.phi0=.863937979737193);ii(i.params,"tlon_0")||(i.lam0=.4334234309119251);ii(i.params,"tk")||(i.k0=.9999);v=1,ii(i.params,"tczech")||(v=-1);p=u(1+i.es*f(s(i.phi0),4)/(1-i.es)),t=h(r(i.phi0)/p),e=f((1+i.e*r(i.phi0))/(1-i.e*r(i.phi0)),p*i.e/2),_=o(t/2+x)/f(o(i.phi0/2+x),p)*e,n=u(1-i.es)/(1-i.es*f(r(i.phi0),2)),m=r(C),y=i.k0*n/o(C),d=.5286277629901559,i.inv=function(t,n){var e,S,A,E,M,b,w,k,I;k=t.x,t.x=t.y,t.y=k,t.x*=v,t.y*=v,b=u(t.x*t.x+t.y*t.y),M=c(t.y,t.x),E=M/r(C),A=2*(l(f(y/b,1/m)*o(C/2+x))-x),e=h(s(d)*r(A)-r(d)*s(A)*s(E)),S=h(s(A)*r(E)/s(e)),n.lam=i.lam0-S/p,w=e,I=0;do{n.phi=2*(l(f(_,-1/p)*f(o(e/2+x),1/p)*f((1+i.e*r(w))/(1-i.e*r(w)),i.e/2))-x),a(w-n.phi)<g&&(I=1),w=n.phi}while(0===I);n.lam-=i.lam0},i.fwd=function(t,n){var a,e,c,u,g,S,A;a=f((1+i.e*r(t.phi))/(1-i.e*r(t.phi)),p*i.e/2),e=2*(l(_*f(o(t.phi/2+x),p)/a)-x),c=-t.lam*p,u=h(s(d)*r(e)+r(d)*s(e)*s(c)),g=h(s(e)*r(c)/s(u)),S=m*g,A=y*f(o(C/2+x),m)/f(o(u/2+x),m),n.y=A*s(S),n.x=A*r(S),n.y*=v,n.x*=v}},"krovak","Krovak","\n\tPCyl., Ellps."),ei(function(i){var t,n,e,o,p,l,f,_,m,d,v,g=1e-10,x=0,C=1,S=2,A=3;d=a(i.phi0),m=a(d-k)<g?i.phi0<0?C:x:a(d)<g?S:A;if(i.es){switch(i.e=u(i.es),p=jt(1,i.e,i.one_es),.5/(1-i.es),_=en(i.es),m){case x:case C:l=1;break;case S:l=1/(f=u(.5*p)),e=1,o=.5*p;break;case A:f=u(.5*p),v=r(i.phi0),t=jt(v,i.e,i.one_es)/p,n=u(1-t*t),l=s(i.phi0)/(u(1-i.es*v*v)*f*n),o=(e=f)/l,e*=l}i.inv=function(a,e){var o,u,d,v,E=0;switch(m){case S:case A:if(a.x/=l,a.y*=l,(v=y(a.x,a.y))<g)return e.lam=0,e.phi=i.phi0,e;u=2*h(.5*v/f),o=s(u),u=r(u),a.x*=u,m==A?(E=o*t+a.y*u*n/v,a.y=v*n*o-a.y*t*u):(E=a.y*u/v,a.y=v*o);break;case x:a.y=-a.y;case C:if(!(d=a.x*a.x+a.y*a.y))return e.lam=0,e.phi=i.phi0,e;E=1-d/p,m==C&&(E=-E)}return e.lam=c(a.x,a.y),e.phi=rn(h(E),_),e},i.fwd=function(h,l){var c,f,_,y,d=0,v=0,E=0;c=s(h.lam),f=r(h.lam),_=r(h.phi),y=jt(_,i.e,i.one_es),(m==A||m==S)&&(v=u(1-(d=y/p)*d));switch(m){case A:E=1+t*d+n*v*c;break;case S:E=1+v*c;break;case x:E=k+h.phi,y=p-y;break;case C:E=h.phi-k,y=p+y}a(E)<g&&B();switch(m){case A:case S:m==A?(E=u(2/E),l.y=o*E*(n*d-t*v*c)):(E=u(2/(1+v*c)),l.y=E*d*o),l.x=e*E*v*f;break;case x:case C:y>=0?(E=u(y),l.x=E*f,l.y=c*(m==C?E:-E)):l.x=l.y=0}}}else m==A&&(t=r(i.phi0),n=s(i.phi0)),i.inv=function(e,o){var p,l=0,u=0;p=y(e.x,e.y),(o.phi=.5*p)>1&&V();o.phi=2*h(o.phi),(m==A||m==S)&&(u=r(o.phi),l=s(o.phi));switch(m){case S:o.phi=a(p)<=g?0:h(e.y*u/p),e.x*=u,e.y=l*p;break;case A:o.phi=a(p)<=g?i.phi0:h(l*t+e.y*u*n/p),e.x*=u*n,e.y=(l-r(o.phi)*t)*p;break;case x:e.y=-e.y,o.phi=k-o.phi;break;case C:o.phi-=k}o.lam=0!=e.y||m!=S&&m!=A?c(e.x,e.y):0},i.fwd=function(e,o){var h,p,l;switch(l=r(e.phi),p=s(e.phi),h=s(e.lam),m){case S:case A:o.y=m==S?1+p*h:1+t*l+n*p*h,o.y<=g&&B(),o.y=u(2/o.y),o.x=o.y*p*r(e.lam),o.y*=m==S?l:n*l-t*p*h;break;case x:h=-h;case C:a(e.phi+i.phi0)<g&&B(),o.y=w-.5*e.phi,o.y=2*(m==C?s(o.y):r(o.y)),o.x=o.y*r(e.lam),o.y*=h}}},"laea","Lambert Azimuthal Equal Area","\n\tAzi, Sph&Ell"),ei(_n,"lonlat","Lat/long (Geodetic)","\n\t"),ei(_n,"longlat","Lat/long (Geodetic alias)","\n\t"),ei(_n,"latlon","Lat/long (Geodetic alias)","\n\t"),ei(_n,"latlong","Lat/long (Geodetic alias)","\n\t"),ei(function(i){var t,n,e,h,p,_,d,v,g,x,S,A=1e-10;i.inv=function(t,n){var a,e=t.x,r=t.y;e/=i.k0,r/=i.k0,0!=(a=y(e,r=d-r))?(_<0&&(a=-a,e=-e,r=-r),g?(n.phi=yn(f(a/v,1/_),i.e),n.phi==C&&V()):n.phi=2*l(f(v/a,1/_))-k,n.lam=c(e,r)/_):(n.lam=0,n.phi=_>0?k:-k)},i.fwd=function(t,n){var e,h=t.lam;a(a(t.phi)-k)<A?(t.phi*_<=0&&B(),e=0):e=v*(g?f(mn(t.phi,r(t.phi),i.e),_):f(o(w+.5*t.phi),-_)),h*=_,n.x=i.k0*(e*r(h)),n.y=i.k0*(d-e*s(h))},h=ii(i.params,"rlat_1"),ii(i.params,"tlat_2")?p=ii(i.params,"rlat_2"):(p=h,ii(i.params,"tlat_0")||(i.phi0=h));a(h+p)<A&&K(-21);_=n=r(h),t=s(h),e=a(h-p)>=A,(g=0!=i.es)?(i.e=u(i.es),S=Ht(n,t,i.es),x=mn(h,n,i.e),e&&(n=r(p),_=m(S/Ht(n,s(p),i.es)),_/=m(x/mn(p,n,i.e))),v=d=S*f(x,-_)/_,d*=a(a(i.phi0)-k)<A?0:f(mn(i.phi0,r(i.phi0),i.e),_)):(e&&(_=m(t/s(p))/m(o(w+.5*p)/o(w+.5*h))),v=t*f(o(w+.5*h),_)/_,d=a(a(i.phi0)-k)<A?0:v*f(o(w+.5*i.phi0),-_))},"lcc","Lambert Conformal Conic","\n\tConic, Sph&Ell\n\tlat_1= and lat_2= or lat_0="),ei(function(i){var t,n,e,r=1e-8;t=ii(i.params,"rlat_1"),n=s(t),e=o(w+.5*t),n<r&&K(-22);i.fwd=function(i,s){s.y=i.phi-t,a(s.y)<r?s.x=i.lam*n:(s.x=w+.5*i.phi,a(s.x)<r||a(a(s.x)-k)<r?s.x=0:s.x=i.lam*s.y/m(o(s.x)/e))},i.inv=function(i,s){s.phi=i.y+t,a(i.y)<r?s.lam=i.x/n:(s.lam=w+.5*s.phi,a(s.lam)<r||a(a(s.lam)-k)<r?s.lam=0:s.lam=i.x*m(o(s.lam)/e)/i.y)},i.es=0},"loxim","Loximuthal","\n\tPCyl Sph"),ei(function(i){var t=.9525793444156804,n=.9258200997725514,e=3.401680257083045,o=2/3,p=1/3,l=1.0000001;i.fwd=function(i,a){i.phi=h(t*r(i.phi)),a.x=n*i.lam*(2*s(o*i.phi)-1),a.y=e*r(p*i.phi)},i.inv=function(i,p){p.phi=i.y/e,a(p.phi)>=1?a(p.phi)>l?V():p.phi=p.phi<0?-k:k:p.phi=h(p.phi);p.lam=i.x/(n*(2*s(o*(p.phi*=3))-1)),a(p.phi=r(p.phi)/t)>=1?a(p.phi)>l?V():p.phi=p.phi<0?-k:k:p.phi=h(p.phi)},i.es=0},"mbt_fpp","McBride-Thomas Flat-Polar Parabolic","\n\tCyl., Sph."),ei(function(i){var t=20,n=1e-7,e=1.000001,o=1.7071067811865475,p=.585786437626905,l=1.874758284622695,c=.533402096794177,u=.3124597141037825,f=3.2004125807650623;i.fwd=function(i,e){var h,p,c;for(p=o*r(i.phi),c=t;c&&(i.phi-=h=(r(.5*i.phi)+r(i.phi)-p)/(.5*s(.5*i.phi)+s(i.phi)),!(a(h)<n));--c);e.x=u*i.lam*(1+2*s(i.phi)/s(.5*i.phi)),e.y=l*r(.5*i.phi)},i.inv=function(i,t){var n;t.phi=c*i.y,a(t.phi)>1?a(t.phi)>e?V():t.phi<0?(n=-1,t.phi=-S):(n=1,t.phi=S):t.phi=2*h(n=t.phi);t.lam=f*i.x/(1+2*s(t.phi)/s(.5*t.phi)),t.phi=p*(n+r(t.phi)),a(t.phi)>1?a(t.phi)>e?V():t.phi=t.phi<0?-k:k:t.phi=h(t.phi)},i.es=0},"mbt_fpq","McBryde-Thomas Flat-Polar Quartic","\n\tCyl., Sph."),ei(function(i){var t=10,n=1e-7,e=.45503,o=1.36509,h=1.41546,p=.22248,l=1.44492,c=1/3;i.fwd=function(i,u){var f,_,m,y;for(f=h*r(i.phi),y=t;y&&(m=i.phi/o,i.phi-=_=(e*r(m)+r(i.phi)-f)/(c*s(m)+s(i.phi)),!(a(_)<n));--y);m=i.phi/o,u.x=p*i.lam*(1+3*s(i.phi)/s(m)),u.y=l*r(m)},i.inv=function(i,t){var n;t.phi=o*(n=Kt(i.y/l)),t.lam=i.x/(p*(1+3*s(t.phi)/s(n))),t.phi=Kt((e*r(n)+r(t.phi))/h)},i.es=0},"mbt_fps","McBryde-Thomas Flat-Pole Sine (No. 2)","\n\tCyl., Sph."),ei(function(i){var t=1e-10,n=0,e=ii(i.params,"tlat_ts");e&&(n=ii(i.params,"rlat_ts"))>=k&&K(-24);i.es?(e&&(i.k0=Ht(r(n),s(n),i.es)),i.inv=function(t,n){n.phi=yn(_(-t.y/i.k0),i.e),n.phi===C&&V();n.lam=t.x/i.k0},i.fwd=function(n,e){a(a(n.phi)-k)<=t&&B();e.x=i.k0*n.lam,e.y=-i.k0*m(mn(n.phi,r(n.phi),i.e))}):(i.inv=function(t,n){n.phi=k-2*l(_(-t.y/i.k0)),n.lam=t.x/i.k0},i.fwd=function(n,e){a(a(n.phi)-k)<=t&&B();e.x=i.k0*n.lam,e.y=i.k0*m(o(w+.5*n.phi))})},"merc","Mercator","\n\tCyl, Sph&Ell\n\tlat_ts="),ei(function(i){i.fwd=function(i,t){t.x=i.lam,t.y=1.25*m(o(w+.4*i.phi))},i.inv=function(i,t){t.lam=i.x,t.phi=2.5*(l(_(.8*i.y))-w)},i.es=0},"mill","Miller Cylindrical","\n\tCyl, Sph"),ei(function(i){i.lam0=20*E,i.phi0=18*E,i.es=0,gn(i,[[.9245,0],[0,0],[.01943,0]])},"mil_os","Miller Oblated Stereographic","\n\tAzi(mod)"),ei(function(i){i.lam0=-165*E,i.phi0=-10*E,i.es=0,gn(i,[[.721316,0],[0,0],[-.0088162,-.00617325]])},"lee_os","Lee Oblated Stereographic","\n\tAzi(mod)"),ei(function(i){i.lam0=-96*E,i.phi0=39*E,i.es=0,i.a=6370997,gn(i,[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]])},"gs48","Mod Stereographic of 48 U.S.","\n\tAzi(mod)"),ei(function(i){var t;i.lam0=-152*E,i.phi0=64*E,0!=i.es?(t=[[.9945303,0],[.0052083,-.0027404],[.0072721,.0048181],[-.0151089,-.1932526],[.0642675,-.1381226],[.3582802,-.2884586]],i.a=6378206.4,i.e=u(i.es=.00676866)):(t=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],i.a=6370997);gn(i,t)},"alsk","Mod Stereographic of Alaska","\n\tAzi(mod)"),ei(function(i){var t;i.lam0=-120*E,i.phi0=45*E,0!=i.es?(t=[[.9827497,0],[.0210669,.0053804],[-.1031415,-.0571664],[-.0323337,-.0322847],[.0502303,.1211983],[.0251805,.0895678],[-.0012315,-.1416121],[.0072202,-.1317091],[-.0194029,.0759677],[-.0210072,.0834037]],i.a=6378206.4,i.e=u(i.es=.00676866)):(t=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],i.a=6370997);gn(i,t)},"gs50","Mod Stereographic of 50 U.S.","\n\tAzi(mod)"),ei(function(i){var t=.8707,n=-.131979,e=-.013791,r=.003971,s=-.001529,o=1.007226,h=.015085,p=-.044475,l=.028874,c=-.005916,u=o,f=3*h,_=7*p,m=9*l,y=11*c,d=1e-11,v=.8707*.52*S;i.es=0,i.fwd=function(i,a){var u,f;u=i.phi*i.phi,f=u*u,a.x=i.lam*(t+u*(n+u*(e+f*u*(r+u*s)))),a.y=i.phi*(o+u*(h+f*(p+l*u+c*f)))},i.inv=function(i,g){var x,C,S,A,E=i.x,M=i.y;M>v?M=v:M<-v&&(M=-v);for(x=M;x-=C=(x*(o+(S=x*x)*(h+(A=S*S)*(p+l*S+c*A)))-M)/(u+S*(f+A*(_+m*S+y*A))),!(a(C)<d););g.phi=x,S=x*x,g.lam=E/(t+S*(n+S*(e+S*S*S*(r+S*s))))}},"natearth","Natural Earth","\n\tPCyl., Sph."),ei(function(i){var t=.84719,n=-.13063,e=-.04515,r=.05494,s=-.02326,o=.00331,h=1.01183,p=-.02625,l=.01926,c=-.00396,u=h,f=9*p,_=11*l,m=13*c,y=1e-11,d=.45334622460635143*S;i.es=0,i.fwd=function(i,a){var u,f,_;u=i.phi*i.phi,_=u*(f=u*u),a.x=i.lam*(t+n*u+_*_*(e+r*u+s*f+o*_)),a.y=i.phi*(h+f*f*(p+l*u+c*f))},i.inv=function(i,v){var g,x,C,S,A,E=i.x,M=i.y;M>d?M=d:M<-d&&(M=-d);for(g=M;g-=x=(g*(h+(S=(C=g*g)*C)*S*(p+l*C+c*S))-M)/(u+S*S*(f+_*C+m*S)),!(a(x)<y););v.phi=g,A=(C=g*g)*(S=C*C),v.lam=E/(t+n*C+A*A*(e+r*C+s*S+o*A))}},"natearth2","Natural Earth 2","\n\tPCyl., Sph."),ei(function(i){var t=10,n=1e-7;i.inv=function(i,t){t.lam=2*i.x/(1+s(i.y)),t.phi=Kt(.5*(i.y+r(i.y)))},i.fwd=function(i,e){var o,h,p;for(o=2*r(i.phi),h=i.phi*i.phi,i.phi*=1.00371+h*(-.011412*h-.0935382),p=t;p&&(i.phi-=h=(i.phi+r(i.phi)-o)/(1+s(i.phi)),!(a(h)<n));--p);e.x=.5*i.lam*(1+s(i.phi)),e.y=i.phi},i.es=0},"nell","Nell","\n\tPCyl., Sph."),ei(function(i){var t=9,n=1e-7;i.es=0,i.fwd=function(i,t){t.x=.5*i.lam*(1+s(i.phi)),t.y=2*(i.phi-o(.5*i.phi))},i.inv=function(i,e){var r,h,p,l;for(p=.5*i.y,l=t;l>0&&(h=s(.5*e.phi),e.phi-=r=(e.phi-o(e.phi/2)-p)/(1-.5/(h*h)),!(a(r)<n));--l);l?e.lam=2*i.x/(1+s(e.phi)):(e.phi=p<0?-k:k,e.lam=2*i.x)}},"nell_h","Nell-Hammer","\n\tPCyl., Sph."),ei(function(i){xn(i,ii(i.params,"dh"))},"nsper","Near-sided perspective","\n\tAzi, Sph\n\th="),ei(function(i){var t=ii(i.params,"dtilt")*E,n=ii(i.params,"dazi")*E,a=ii(i.params,"dh");xn(i,a,t,n)},"tpers","Tilted perspective","\n\tAzi, Sph\n\ttilt= azi= h="),ei(function(i){var t=1e-10,n=.484813681109536,e=2.0626480624709638,r=[[.7557853228,0],[.249204646,.003371507],[-.001541739,.04105856],[-.10162907,.01727609],[-.26623489,-.36249218],[-.6870983,-1.1651967]],s=[1.5627014243,.5185406398,-.03333098,-.1052906,-.0368594,.007317,.0122,.00394,-.0013],o=[.6399175073,-.1358797613,.063294409,-.02526853,.0117879,-.0055161,.0026906,-.001333,67e-5,-34e-5];i.ra=1/(i.a=6378388),i.lam0=173*E,i.phi0=-41*E,i.x0=251e4,i.y0=6023150,i.inv=function(e,o){var h,p,l,c,u,f,_={r:e.y,i:e.x},m={};for(h=20;h>0&&((u=vn(_,r,m)).r-=e.y,u.i-=e.x,f=m.r*m.r+m.i*m.i,_.r+=l=-(u.r*m.r+u.i*m.i)/f,_.i+=c=-(u.i*m.r-u.r*m.i)/f,!(a(l)+a(c)<=t));--h);if(h>0){for(o.lam=_.i,p=s.length-1,o.phi=s[p],--p;p>=0;--p)o.phi=s[p]+_.r*o.phi;o.phi=i.phi0+_.r*o.phi*n}else o.lam=o.phi=C},i.fwd=function(t,n){var a=o.length-1,s={r:o[a]},h=(t.phi-i.phi0)*e;for(--a;a>=0;--a)s.r=o[a]+h*s.r;s.r*=h,s.i=t.lam,s=dn(s,r),n.x=s.i,n.y=s.r}},"nzmg","New Zealand Map Grid","\n\tfixed Earth"),ei(function(i){var t,n,e,h,p,u,f,_,m,y,d,v,g,x,S,M=1e-10;t=ii(i.params,"so_proj"),n=ai[t],t||K(-26);n&&"ob_tran"!=t||K(-37);i.es=0,e={},Object.keys(i).forEach(function(t){e[t]=i[t]}),n.init(e),e.is_latlong&&1==i.to_meter&&(i.to_meter=E,i.fr_meter=A);ii(i.params,"to_alpha")?(_=ii(i.params,"ro_lon_c"),m=ii(i.params,"ro_lat_c"),y=ii(i.params,"ro_alpha"),a(a(m)-k)<=M&&K(-32),h=_+Qt(-s(y),-r(y)*r(m)),f=Kt(s(m)*r(y))):ii(i.params,"to_lat_p")?(h=ii(i.params,"ro_lon_p"),f=ii(i.params,"ro_lat_p")):(d=ii(i.params,"ro_lon_1"),g=ii(i.params,"ro_lat_1"),v=ii(i.params,"ro_lon_2"),x=ii(i.params,"ro_lat_2"),(a(g-x)<=M||(S=a(g))<=M||a(S-k)<=M||a(a(x)-k)<=M)&&K(-33),h=c(s(g)*r(x)*s(d)-r(g)*s(x)*s(v),r(g)*s(x)*r(v)-s(g)*r(x)*r(d)),f=l(-s(h-d)/o(g)));a(f)>M?(p=s(f),u=r(f),i.fwd=function(i,t){var n,a,o;n=s(i.lam),a=r(i.phi),o=s(i.phi),i.lam=Ti(Qt(o*r(i.lam),u*o*n+p*a)+h),i.phi=Kt(u*a-p*o*n),e.fwd(i,t)},i.inv=e.inv?function(i,t){var n,a,o;e.inv(i,t),t.lam!=C&&(n=s(t.lam-=h),a=r(t.phi),o=s(t.phi),t.phi=Kt(u*a+p*o*n),t.lam=Qt(o*r(t.lam),u*o*n-p*a))}:null):(i.fwd=function(i,t){var n,a;n=s(i.phi),a=s(i.lam),i.lam=Ti(Qt(n*r(i.lam),r(i.phi))+h),i.phi=Kt(-n*a),e.fwd(i,t)},i.inv=e.inv?function(i,t){var n,a;e.inv(i,t),t.lam!=C&&(n=s(t.phi),a=t.lam-h,t.lam=Qt(n*r(a),-r(t.phi)),t.phi=Kt(n*s(a)))}:null)},"ob_tran","General Oblique Transformation","\n\tMisc Sph\n\to_proj= plus parameters for projection\n\to_lat_p= o_lon_p= (new pole) or\n\to_alpha= o_lon_c= o_lat_c= or\n\to_lon_1= o_lat_1= o_lon_2= o_lat_2="),ei(function(i){var t,n,a,e,p,f,_,m,y,d,v;_=1/i.k0,m=i.k0,ii(i.params,"talpha")?(f=ii(i.params,"ralpha"),p=ii(i.params,"rlonc"),v=l(-s(f)/(-r(0)*r(f)))+p,y=h(s(0)*r(f))):(t=ii(i.params,"rlat_1"),n=ii(i.params,"rlat_2"),a=ii(i.params,"rlon_1"),e=ii(i.params,"rlon_2"),v=c(s(t)*r(n)*s(a)-r(t)*s(n)*s(e),r(t)*s(n)*r(e)-s(t)*r(n)*r(a)),a==-k&&(v=-v),y=l(-s(v-a)/o(t)));i.lam0=v+k,d=s(y),y=r(y),s(v),v=r(v),i.es=0,i.fwd=function(i,t){var n;t.y=r(i.lam),n=s(i.lam),t.x=l((o(i.phi)*d+y*t.y)/n),n<0&&(t.x+=S);t.x*=m,t.y=_*(y*r(i.phi)-d*s(i.phi)*t.y)},i.inv=function(i,t){var n,a;i.y/=_,i.x/=m,n=u(1-i.y*i.y),t.phi=h(i.y*y+n*d*(a=r(i.x))),t.lam=c(n*y*a-i.y*d,n*s(i.x))}},"ocea","Oblique Cylindrical Equal Area","\n\tCyl, Sph lonc= alpha= or\n\tlat_1= lat_2= lon_1= lon_2="),ei(function(i){var t,n,e,p,y,d,v,g,x,A,E,M,b,I,G,N,O,R,T,D,L,q,z,W,j,H,F,J=1e-7,Z=0,$=0,Q=0,X=0,Y=0,ti=0,ni=0,ai=0;F=ii(i.params,"tno_rot"),0!=(M=ii(i.params,"talpha"))&&(ni=ii(i.params,"ralpha"));0!=(b=ii(i.params,"tgamma"))&&(Z=ii(i.params,"rgamma"));M||b?($=ii(i.params,"rlonc"),(ai=ii(i.params,"tno_off")||ii(i.params,"tno_uoff"))&&(ii(i.params,"sno_uoff"),ii(i.params,"sno_off"))):(Q=ii(i.params,"rlon_1"),Y=ii(i.params,"rlat_1"),X=ii(i.params,"rlon_2"),ti=ii(i.params,"rlat_2"),(a(Y-ti)<=J||(t=a(Y))<=J||a(t-k)<=J||a(a(i.phi0)-k)<=J||a(a(ti)-k)<=J)&&K(-33));n=u(i.one_es),a(i.phi0)>U?(g=r(i.phi0),e=s(i.phi0),t=1-i.es*g*g,G=e*e,G=u(1+i.es*G*G/i.one_es),I=G*i.k0*n/t,p=G*n/(e*u(t)),(y=p*p-1)<=0?y=0:(y=u(y),i.phi0<0&&(y=-y)),N=y+=p,N*=f(mn(i.phi0,g,i.e),G)):(G=1/n,I=i.k0,N=p=y=1);M||b?(M?(E=h(r(ni)/p),b||(Z=ni)):ni=h(p*r(E=Z)),i.lam0=$-h(.5*(y-1/y)*o(E))/G):(d=f(mn(Y,r(Y),i.e),G),v=f(mn(ti,r(ti),i.e),G),y=N/d,x=(v-d)/(v+d),A=((A=N*N)-v*d)/(A+v*d),(t=Q-X)<-S?X-=P:t>S&&(X+=P),i.lam0=Ti(.5*(Q+X)-l(A*o(.5*G*(Q-X))/x)/G),E=l(2*r(G*Ti(Q-i.lam0))/(y-1/y)),Z=ni=h(p*r(E)));D=r(E),L=s(E),q=r(Z),z=s(Z),R=1/(O=I*(T=1/G)),I*G,ai?H=0:(H=a(O*l(u(p*p-1)/s(ni))),i.phi0<0&&(H=-H));W=O*m(o(w-(y=.5*E))),j=O*m(o(w+y)),i.fwd=function(t,n){var e,o,h,p,l,u,_,y;a(a(t.phi)-k)>U?(l=N/f(mn(t.phi,r(t.phi),i.e),G),e=.5*(l-(u=1/l)),o=.5*(l+u),p=r(G*t.lam),a(a(h=(e*D-p*L)/o)-1)<U&&B(),y=.5*O*m((1-h)/(1+h)),u=s(G*t.lam),_=a(u)<J?I*t.lam:O*c(e*L+p*D,u)):(y=t.phi>0?W:j,_=O*t.phi);F?(n.x=_,n.y=y):(_-=H,n.x=y*z+_*q,n.y=_*z-y*q)},i.inv=function(t,n){var e,o,h,p,l,m,y;F?(o=t.y,e=t.x):(o=t.x*z-t.y*q,e=t.y*z+t.x*q+H);h=_(-R*o),p=.5*(h-1/h),l=.5*(h+1/h),m=r(R*e),a(a(y=(m*L+p*D)/l)-1)<U?(n.lam=0,n.phi=y<0?-k:k):(n.phi=N/u((1+y)/(1-y)),(n.phi=yn(f(n.phi,1/G),i.e))==C&&V(),n.lam=-T*c(p*L-m*D,s(R*e)))}},"omerc","Oblique Mercator","\n\tCyl, Sph&Ell no_rot\n\talpha= [gamma=] [no_off] lonc= or\n\t lon_1= lat_1= lon_2= lat_2="),ei(function(i){var t=1e-10,n=0,e=1,o=2,l=3,f={};a(a(i.phi0)-k)<=t?f.mode=i.phi0<0?e:n:a(i.phi0)>t?(f.mode=l,f.sinph0=r(i.phi0),f.cosph0=s(i.phi0)):f.mode=o;i.fwd=function(h,p){var c,u,_;switch(u=s(h.phi),c=s(h.lam),f.mode){case o:u*c<-t&&B(),p.y=r(h.phi);break;case l:f.sinph0*(_=r(h.phi))+f.cosph0*u*c<-t&&B(),p.y=f.cosph0*_-f.sinph0*u*c;break;case n:c=-c;case e:a(h.phi-i.phi0)-t>k&&B(),p.y=u*c}p.x=u*r(h.lam)},i.inv=function(r,s){var _,m,d;(d=_=y(r.x,r.y))>1&&(d-1>t&&V(),d=1);if(m=u(1-d*d),a(_)<=t)s.phi=i.phi0,s.lam=0;else{switch(f.mode){case n:r.y=-r.y,s.phi=p(d);break;case e:s.phi=-p(d);break;case o:case l:f.mode==o?(s.phi=r.y*d/_,r.x*=d,r.y=m*_):(s.phi=m*f.sinph0+r.y*d*f.cosph0/_,r.y=(m-f.sinph0*s.phi)*_,r.x*=d*f.cosph0),a(s.phi)>=1?s.phi=s.phi<0?-k:k:s.phi=h(s.phi)}s.lam=0!=r.y||f.mode!=l&&f.mode!=o?c(r.x,r.y):0==r.x?0:r.x<0?-k:k}},i.es=0},"ortho","Orthographic","\n\tAzi, Sph."),ei(function(i){var t,n,e=1e-10,p=1e-10,l=10,c=20,f=1e-12;i.es?(n=Bt(i.es),t=Vt(i.phi0,r(i.phi0),s(i.phi0),n),i.fwd=function(o,h){var p,l,c;a(o.phi)<=e?(h.x=o.lam,h.y=-t):(l=r(o.phi),p=a(c=s(o.phi))>e?Ht(l,c,i.es)/l:0,h.x=p*r(o.lam*=l),h.y=Vt(o.phi,l,c,n)-t+p*(1-s(o.lam)))},i.inv=function(p,l){var _,m,y,d,v,g,x,C,S,A,E=p.x,M=p.y;if(a(M+=t)<=e)l.lam=E,l.phi=0;else{for(_=M*M+E*E,l.phi=M,A=c;A>0&&(y=r(l.phi),v=y*(d=s(l.phi)),a(d)<f&&V(),m=y*(C=u(1-i.es*y*y))/d,g=Vt(l.phi,y,d,n),x=g*g+_,C=i.one_es/(C*C*C),l.phi+=S=(g+g+m*x-2*M*(m*g+1))/(i.es*v*(x-2*M*g)/m+2*(M-g)*(m*C-1/v)-C-C),!(a(S)<=f));--A);A||V(),m=r(l.phi),l.lam=h(E*o(l.phi)*u(1-i.es*m*m))/r(l.phi)}}):(t=-i.phi0,i.fwd=function(n,h){var p,l;a(n.phi)<=e?(h.x=n.lam,h.y=t):(p=1/o(n.phi),h.x=r(l=n.lam*r(n.phi))*p,h.y=n.phi-i.phi0+p*(1-s(l)))},i.inv=function(t,n){var s,c,u,f;if(a(t.y=i.phi0+t.y)<=e)n.lam=t.x,n.phi=0;else{n.phi=t.y,s=t.x*t.x+t.y*t.y,f=l;do{u=o(n.phi),n.phi-=c=(t.y*(n.phi*u+1)-n.phi-.5*(n.phi*n.phi+s)*u)/((n.phi-t.y)/u-1)}while(a(c)>p&&--f);f||V(),n.lam=h(t.x*o(n.phi))/r(n.phi)}})},"poly","Polyconic (American)","\n\tConic, Sph&Ell"),ei(function(i){var t=1.8949,n=1.71848,e=.6141848493043784,o=1e-10,h=10,p=1.0471975511965976;i.es=0,i.fwd=function(i,l){var c,u,f,_,m;for(c=e*r(i.phi),f=i.phi*i.phi,i.phi*=.615709+f*(.00909953+.0046292*f),m=h;m&&(u=s(i.phi),f=r(i.phi),i.phi-=_=(i.phi+f*(u-1)-c)/(1+u*(u-1)-f*f),!(a(_)<o));--m);m||(i.phi=i.phi<0?-p:p);l.x=t*i.lam*(s(i.phi)-.5),l.y=n*r(i.phi)},i.inv=function(i,a){var o;a.phi=Kt(i.y/n),a.lam=i.x/(t*((o=s(a.phi))-.5)),a.phi=Kt((a.phi+r(a.phi)*(o-1))/e)}},"putp2","Putnins P2","\n\tPCyl., Sph."),ei(Cn,"putp3","Putnins P3","\n\tPCyl., Sph."),ei(function(i){Cn(i,!0)},"putp3p","Putnins P3'","\n\tPCyl., Sph."),ei(function(i){Sn(i,.874038744,3.883251825)},"putp4p","Putnins P4'","\n\tPCyl., Sph."),ei(function(i){Sn(i,1,4.442882938)},"weren","Werenskiold I","\n\tPCyl., Sph."),ei(An,"putp5","Putnins P5","\n\tPCyl., Sph."),ei(function(i){An(i,!0)},"putp5p","Putnins P5'","\n\tPCyl., Sph."),ei(En,"putp6","Putnins P6","\n\tPCyl., Sph."),ei(function(i){En(i,!0)},"putp6p","Putnins P6'","\n\tPCyl., Sph."),ei(function(i){var t,n,e,h,f=1e-10,_=0,m=1,y=2,d=3,v=4,g=5,x=0,C=1,A=2,E=3;t=i.phi0>=k-w/2?v:i.phi0<=-(k-w/2)?g:a(i.lam0)<=w?_:a(i.lam0)<=k+w?i.lam0>0?m:d:y;0!==i.es&&(i.a*i.a,n=i.a*u(1-i.es),e=1-(i.a-n)/i.a,h=e*e);function M(i,t,n){var e,r;return i<f?(e=x,r=0):(r=c(t,n),a(r)<=w?e=x:r>w&&r<=k+w?(e=C,r-=k):r>k+w||r<=-(k+w)?(e=A,r=r>=0?r-S:r+S):(e=E,r+=k)),{area:e,theta:r}}function b(i,t){var n=i+t;return n<-S?n+=P:n>+S&&(n-=P),n}i.fwd=function(n,a){var e,c,f,P,G,N,O,R,T,D,L,q,U,z,W;e=0!==i.es?l(h*o(n.phi)):n.phi;c=n.lam,t==v?(P=k-e,c>=w&&c<=k+w?(O=x,f=c-k):c>k+w||c<=-(k+w)?(O=C,f=c>0?c-S:c+S):c>-(k+w)&&c<=-w?(O=A,f=c+k):(O=E,f=c)):t==g?(P=k+e,c>=w&&c<=k+w?(O=x,f=-c+k):c<w&&c>=-w?(O=C,f=-c):c<-w&&c>=-(k+w)?(O=A,f=-c-k):(O=E,f=c>0?-c+S:-c-S)):(t==m?c=b(c,+k):t==y?c=b(c,+S):t==d&&(c=b(c,-k)),L=r(e),q=s(e),U=r(c),z=s(c),R=q*z,T=q*U,D=L,t==_?(P=p(R),W=M(P,D,T)):t==m?(P=p(T),W=M(P,D,-R)):t==y?(P=p(-R),W=M(P,D,-T)):t==d?(P=p(-T),W=M(P,D,R)):(P=0,W={area:x,theta:0}),f=W.theta,O=W.area);N=l(12/S*(f+p(r(f)*s(w))-k)),G=u((1-s(P))/(s(N)*s(N))/(1-s(l(1/s(f))))),O==C?N+=k:O==A?N+=S:O==E&&(N+=I);a.x=G*s(N),a.y=G*r(N)},i.inv=function(f,_){var M,w,I,P,G,N,O,R,T,D;w=l(u(f.x*f.x+f.y*f.y)),M=c(f.y,f.x),f.x>=0&&f.x>=a(f.y)?D=x:f.y>=0&&f.y>=a(f.x)?(D=C,M-=k):f.x<0&&-f.x>=a(f.y)?(D=A,M=M<0?M+S:M-S):(D=E,M+=k);T=S/12*o(M),G=r(T)/(s(T)-1/u(2)),N=l(G),I=s(M),P=o(w),(O=1-I*I*P*P*(1-s(l(1/s(N)))))<-1?O=-1:O>1&&(O=1);if(t==v)R=p(O),_.phi=k-R,_.lam=D==x?N+k:D==C?N<0?N+S:N-S:D==A?N-k:N;else if(t==g)R=p(O),_.phi=R-k,_.lam=D==x?-N+k:D==C?-N:D==A?-N-k:N<0?-N-S:-N+S;else{var L,q,U;U=(T=(L=O)*L)>=1?0:u(1-T)*r(N),q=(T+=U*U)>=1?0:u(1-T),D==C?(T=q,q=-U,U=T):D==A?(q=-q,U=-U):D==E&&(T=q,q=U,U=-T),t==m?(T=L,L=-q,q=T):t==y?(L=-L,q=-q):t==d&&(T=L,L=q,q=-T),_.phi=p(-U)-k,_.lam=c(q,L),t==m?_.lam=b(_.lam,-k):t==y?_.lam=b(_.lam,-S):t==d&&(_.lam=b(_.lam,+k))}if(0!==i.es){var z,W,j;z=_.phi<0?1:0,W=o(_.phi),j=n/u(W*W+h),_.phi=l(u(i.a*i.a-j*j)/(e*j)),z&&(_.phi=-_.phi)}}},"qsc","Quadrilateralized Spherical Cube","\n\tAzi, Sph."),ei(function(i){var t=f([[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]]),n=f([[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]]),r=.8487,s=1.3523,o=11.459155902616464,h=.08726646259971647,p=18,l=1.000001,c=1e-8;function u(i,t){return i[0]+t*(i[1]+t*(i[2]+t*i[3]))}function f(i){return i.map(function(i){return new Float32Array(i)})}i.es=0,i.fwd=function(i,l){var c,f;(c=e((f=a(i.phi))*o))<0&&B();c>=p&&(c=p-1);f=A*(f-h*c),l.x=u(t[c],f)*r*i.lam,l.y=u(n[c],f)*s,i.phi<0&&(l.y=-l.y)},i.inv=function(i,o){var h,f,_,m;if(o.lam=i.x/r,o.phi=a(i.y/s),o.phi>=1)o.phi>l?V():(o.phi=i.y<0?-k:k,o.lam/=t[p][0]);else{if((m=e(o.phi*p))<0||m>=p)return V();for(;;)if(n[m][0]>o.phi)--m;else{if(!(n[m+1][0]<=o.phi))break;++m}for(_=new Float32Array(n[m]),h=5*(o.phi-_[0])/(n[m+1][0]-_[0]),_[0]-=o.phi;h-=f=u(_,h)/(d=h,(y=_)[1]+d*(y[2]+y[2]+3*d*y[3])),!(a(f)<c););o.phi=(5*m+h)*E,i.y<0&&(o.phi=-o.phi),o.lam/=u(t[m],h)}var y,d}},"robin","Robinson","\n\tPCyl., Sph."),ei(Mn("EULER"),"euler","Euler","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(Mn("MURD1"),"murd1","Murdoch I","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(Mn("MURD2"),"murd2","Murdoch II","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(Mn("MURD3"),"murd3","Murdoch III","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(Mn("PCONIC"),"pconic","Perspective Conic","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(Mn("TISSOT"),"tissot","Tissot","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(Mn("VITK1"),"vitk1","Vitkovsky I","\n\tConic, Sph\n\tlat_1= and lat_2="),ei(function(i){var t,n,e,h,p,c,f,y,d,v=1e-10,g=6;e=.5*i.e,f=s(i.phi0),f*=f,n=u(1+i.es*f*f*i.rone_es),d=r(i.phi0),p=s(y=Kt(c=d/n)),d*=i.e,t=m(o(w+.5*y))-n*(m(o(w+.5*i.phi0))-e*m((1+d)/(1-d))),h=i.k0*u(i.one_es)/(1-d*d),i.inv=function(u,f){var y,d,x,C,S,A,E,M,b;for(x=2*(l(_(u.y/h))-w),C=u.x/h,S=s(x),y=Kt(p*r(x)+c*S*s(C)),d=Kt(S*r(C)/s(y)),E=(t-m(o(w+.5*y)))/n,b=g;b&&(A=i.e*r(y),M=(E+m(o(w+.5*y))-e*m((1+A)/(1-A)))*(1-A*A)*s(y)*i.rone_es,y-=M,!(a(M)<v));--b);b?(f.phi=y,f.lam=d/n):V()},i.fwd=function(a,u){var f,y,d,v,g,x;g=i.e*r(a.phi),f=2*l(_(n*(m(o(w+.5*a.phi))-e*m((1+g)/(1-g)))+t))-k,y=n*a.lam,x=s(f),d=Kt(p*r(f)-c*x*s(y)),v=Kt(x*r(y)/s(d)),u.x=h*v,u.y=h*m(o(w+.5*d))}},"somerc","Swiss. Obl. Mercator","\n\tCyl, Ell\n\tFor CH1903"),ei(function(i){var t=ii(i.params,"tlat_ts")?ii(i.params,"rlat_ts"):k;bn(i,t)},"stere","Stereographic","\n\tAzi, Sph&Ell\n\tlat_ts="),ei(function(i){i.phi0=ii(i.params,"bsouth")?-k:k,i.k0=.994,i.x0=2e6,i.y0=2e6,i.lam0=0,i.es||K(-34);bn(i,k)},"ups","Universal Polar Stereographic","\n\tAzi, Sph&Ell\n\tsouth"),ei(function(i){var t=(m=i.e,d=i.phi0,v=m*m,g=r(d),x=s(d),C=u(1-v)/(1-v*g*g),S=u(1+v*x*x*x*x/(1-v)),A=h(g/S),E=.5*S*m,{e:m,K:o(.5*A+w)/(f(o(.5*d+w),S)*wn(m*g,E)),C:S,chi:A,ratexp:E,rc:C}),n=t.chi,e=2*t.rc,p=r(n),_=s(n);var m,d,v,g,x,C,S,A,E;i.fwd=function(n,a){var h,c,u,m;n=function(i,t){return{phi:2*l(t.K*f(o(.5*i.phi+w),t.C)*wn(t.e*r(i.phi),t.ratexp))-k,lam:t.C*i.lam}}(n,t),c=r(n.phi),h=s(n.phi),u=s(n.lam),m=i.k0*e/(1+p*c+_*h*u),a.x=m*h*r(n.lam),a.y=m*(_*c-p*h*u)},i.inv=function(u,m){var d,v,g,x,C=u.x/i.k0,S=u.y/i.k0;(d=y(C,S))?(v=2*c(d,e),g=r(v),x=s(v),m.phi=h(x*p+S*g*_/d),m.lam=c(C*g,d*_*x-S*p*g)):(m.phi=n,m.lam=0);!function(i,t){i.phi;var n,e,s=f(o(.5*i.phi+w)/t.K,1/t.C);for(i.lam/=t.C,n=20;n>0&&(e=2*l(s*wn(t.e*r(i.phi),-.5*t.e))-k,!(a(e-i.phi)<1e-14));--n)i.phi=e;n||F(-17)}(m,t)}},"sterea","Oblique Stereographic Alternative","\n\tAzimuthal, Sph&Ell"),ei(function(i){kn(i,1.50488,1.35439,!1)},"kav5","Kavraisky V","\n\tPCyl., Sph."),ei(function(i){kn(i,2,2,!1)},"qua_aut","Quartic Authalic","\n\tPCyl., Sph."),ei(function(i){kn(i,2,2,!0)},"fouc","Foucaut","\n\tPCyl., Sph."),ei(function(i){kn(i,1.48875,1.36509,!1)},"mbt_s","McBryde-Thomas Flat-Polar Sine (No. 1)","\n\tPCyl., Sph."),ei(function(i){i.es=0,i.fwd=function(t,n){n.x=s(t.phi)*r(t.lam)/i.k0,n.y=i.k0*(c(o(t.phi),s(t.lam))-i.phi0)},i.inv=function(t,n){var a;t.y=t.y/i.k0+i.phi0,t.x*=i.k0,a=u(1-t.x*t.x),n.phi=h(a*r(t.y)),n.lam=c(t.x,a*s(t.y))}},"tcea","Transverse Cylindrical Equal Area","\n\tCyl, Sph"),ei(function(i){i.es=0,i.fwd=function(i,t){var n=o(i.phi/2),a=r(w*n);t.x=i.lam*(.74482-.34588*a*a),t.y=1.70711*n},i.inv=function(i,t){var n=i.y/1.70711,a=r(w*n);t.lam=i.x/(.74482-.34588*a*a),t.phi=2*l(n)}},"times","Times","\n\tCyl, Sph"),ei(function(i){var t,n,e,o=1e-10,l=1,f=.5,y=.16666666666666666,d=.08333333333333333,v=.05,g=.03333333333333333,x=.023809523809523808,C=.017857142857142856;i.es?((e=Bt(i.es))||e_error_0(),n=Vt(i.phi0,r(i.phi0),s(i.phi0),e),t=i.es/(1-i.es),i.fwd=function(h,p){var c,_,m,S,A,E;if(h.lam<-k||h.lam>k)return void F(-14);c=r(h.phi),_=s(h.phi),m=a(_)>o?c/_:0,m*=m,S=_*h.lam,A=S*S,S/=u(1-i.es*c*c),E=t*_*_,p.x=i.k0*S*(l+y*A*(1-m+E+v*A*(5+m*(m-18)+E*(14-58*m)+x*A*(61+m*(m*(179-m)-479))))),p.y=i.k0*(Vt(h.phi,c,_,e)-n+c*S*h.lam*f*(1+d*A*(5-m+E*(9+4*E)+g*A*(61+m*(m-58)+E*(270-330*m)+C*A*(1385+m*(m*(543-m)-3111))))))},i.inv=function(o,h){var p,c,_,m,S,A,E;h.phi=Jt(n+o.y/i.k0,i.es,e),a(h.phi)>=k?(h.phi=o.y<0?-k:k,h.lam=0):(A=r(h.phi),_=s(h.phi),E=a(_)>1e-10?A/_:0,p=t*_*_,m=o.x*u(c=1-i.es*A*A)/i.k0,c*=E,E*=E,S=m*m,h.phi-=c*S/(1-i.es)*f*(1-S*d*(5+E*(3-9*p)+p*(1-4*p)-S*g*(61+E*(90-252*p+45*E)+46*p-S*C*(1385+E*(3633+E*(4095+1575*E)))))),h.lam=m*(l-S*y*(1+2*E+p-S*v*(5+E*(28+24*E+8*p)+6*p-S*x*(61+E*(662+E*(1320+720*E))))))/_)}):(t=i.k0,n=.5*t,i.fwd=function(e,h){var l,c;if(e.lam<-k||e.lam>k)return void F(-14);c=s(e.phi),l=c*r(e.lam),a(a(l)-1)<=o&&B();h.x=n*m((1+l)/(1-l)),h.y=c*s(e.lam)/u(1-l*l),(l=a(h.y))>=1?l-1>o?B():h.y=0:h.y=p(h.y);e.phi<0&&(h.y=-h.y);h.y=t*(h.y-i.phi0)},i.inv=function(n,a){var e=_(n.x/t),r=.5*(e-1/e);e=s(i.phi0+n.y/t),a.phi=h(u((1-e*e)/(1+r*r))),n.y<0&&-a.phi+i.phi0<0&&(a.phi=-a.phi);a.lam=r||e?c(r,e):0})},"tmerc","Transverse Mercator","\n\tCyl, Sph&Ell"),ei(function(i){var t,n,a,e,h,p,l,u,f,_,m,d,v,g,x,C,S,A,E,M,b,w,I;M=ii(i.params,"rlat_1"),A=ii(i.params,"rlon_1"),b=ii(i.params,"rlat_2"),E=ii(i.params,"rlon_2"),M==b&&A==E&&K(-25);i.lam0=Ti(.5*(A+E)),_=Ti(E-A),t=s(M),a=s(b),n=r(M),e=r(b),p=t*e,l=n*a,h=t*a*r(_),f=Zt(n*e+t*a*s(_)),m=.5*f,w=c(a*r(_),t*e-n*a*s(_)),g=s(I=Kt(t*r(w))),x=r(I),C=Ti(c(t*s(w),n)-m),_*=.5,S=k-c(r(w)*n,s(w))-_,d=o(m),v=.5/r(m),u=.5/f,f*=f,i.fwd=function(i,o){var c,m,y,d,v,g,x;g=r(i.phi),x=s(i.phi),m=Zt(n*g+t*x*s(d=i.lam+_)),y=Zt(e*g+a*x*s(v=i.lam-_)),m*=m,y*=y,o.x=u*(c=m-y),c=f-c,o.y=u*$t(4*f*y-c*c),h*g-x*(p*r(d)-l*r(v))<0&&(o.y=-o.y)},i.inv=function(i,t){var n,a,e,o,h,p;n=s(y(i.y,i.x+m)),a=s(y(i.y,i.x-m)),e=n+a,o=n-a,t.lam=-c(o,e*d),t.phi=Zt(y(d*e,o)*v),i.y<0&&(t.phi=-t.phi);p=r(t.phi),h=s(t.phi),t.phi=Kt(x*p+g*h*(e=s(t.lam-=C))),t.lam=c(h*r(t.lam),x*h*e-g*p)+S},i.es=0},"tpeqd","Two Point Equidistant","\n\tMisc Sph\n\tlat_1= lon_1= lat_2= lon_2="),ei(function(i){var t,n,a,e,o,h;(e=ii(i.params,"dn"))>0&&e<=1==0&&K(-40);a=ii(i.params,"dq")/3,o=ii(i.params,"ralpha"),h=e*r(o),t=s(o)/u(1-h*h),n=1/(t*e),i.fwd=function(i,o){var h=i.phi=Kt(e*r(i.phi));o.x=t*i.lam*s(i.phi),h*=h,o.y=i.phi*(1+h*a)*n},i.es=0},"urm5","Urmaev V","\n\tPCyl., Sph., no inv.\n\tn= q= alpha="),ei(function(i){var t=ii(i.params,"dn");(t<=0||t>1)&&K(-40);In(i,t)},"urmfps","Urmaev Flat-Polar Sinusoidal","\n\tPCyl, Sph.\n\tn="),ei(function(i){In(i,.8660254037844386)},"wag1","Wagner I (Kavraisky VI)","\n\tPCyl, Sph."),ei(function(i){var t=1e-10,n=.3333333333333333,e=.07407407407407407,r=4.188790204786391,l=9.869604401089358,c=19.739208802178716,f=4.934802200544679;i.fwd=function(i,n){var e,r,s,p,l;(l=a(i.phi/k))-t>1&&B();l>1&&(l=1);a(i.phi)<=t?(n.x=i.lam,n.y=0):a(i.lam)<=t||a(l-1)<t?(n.x=0,n.y=S*o(.5*h(l)),i.phi<0&&(n.y=-n.y)):(e=.5*a(S/i.lam-i.lam/S),r=e*e,s=u(1-l*l),p=(s/=l+s-1)*s,l=s*(2/l-1),l*=l,n.x=s-l,s=l+r,n.x=S*(e*n.x+u(r*n.x*n.x-s*(p-l)))/s,i.lam<0&&(n.x=-n.x),n.y=a(n.x/S),n.y=1-n.y*(n.y+2*e),n.y<-t&&B(),n.y<0?n.y=0:n.y=u(n.y)*(i.phi<0?-S:S))},i.inv=function(i,o){var h,_,m,y,d,v,g,x,C,A,E,M,b;if(M=i.x*i.x,(E=a(i.y))<t)return o.phi=0,h=M*M+c*(M+f),o.lam=a(i.x)<=t?0:.5*(M-l+u(h))/i.x,o;b=i.y*i.y,y=(m=-S*E*((x=M+b)+l))+l*(x-3*b),_=S*E,C=2*u(-n*(v=m/(d=(g=x*x)+P*(E*x+S*(b+S*(E+k))))-n*(y/=d)*y)),(h=a(A=3*(A=e*y*y*y+(_*_-n*y*m)/d)/(v*C)))-t<=1?(A=h>1?A>0?0:S:p(A),o.phi=S*(C*s(A*n+r)-n*y),i.y<0&&(o.phi=-o.phi),h=g+c*(M-b+f),o.lam=a(i.x)<=t?0:.5*(x-l+(h<=0?0:u(h)))/i.x):V()}},"vandg","van der Grinten (I)","\n\tMisc Sph"),ei(function(i){Pn(i,!1)},"vandg2","van der Grinten II","\n\tMisc Sph, no inv."),ei(function(i){Pn(i,!0)},"vandg3","van der Grinten III","\n\tMisc Sph, no inv."),ei(function(i){i.es=0,i.fwd=function(i,t){var n,e,r,s,o,h,p,l;a(i.phi)<1e-10?(t.x=i.lam,t.y=0):a(i.lam)<1e-10||a(a(i.phi)-k)<1e-10?(t.x=0,t.y=i.phi):(r=a(G*i.phi),h=(s=.5*(r*(8-r*(2+(o=r*r)))-5)/(o*(r-1)))*s,p=G*i.lam,p=u((p+=1/p)*p-4),a(i.lam)-k<0&&(p=-p),n=r+s,n=(p*((n*=n)+h-1)+2*u(n*(o+h*(l=p*p)-1)+(1-o)*(o*((e=r+3*s)*e+4*h)+h*(12*r*s+4*h))))/(4*n+l),t.x=k*n,t.y=k*u(1+p*a(n)-n*n),i.lam<0&&(t.x=-t.x),i.phi<0&&(t.y=-t.y))}},"vandg4","van der Grinten IV","\n\tMisc Sph, no inv."),ei(function(i){var t=.92483,n=1.38725,a=.88022,e=.8855;i.fwd=function(i,o){i.phi=Kt(a*r(e*i.phi)),o.x=t*i.lam*s(i.phi),o.y=n*i.phi},i.inv=function(i,o){o.phi=i.y/n,o.lam=i.x/(t*s(o.phi)),o.phi=Kt(r(o.phi)/a)/e}},"wag2","Wagner II","\n\tPCyl., Sph."),ei(function(i){var t=.6666666666666666,n=ii(i.params,"rlat_ts"),a=s(n)/s(2*n/3);i.es=0,i.fwd=function(i,n){n.x=a*i.lam*s(t*i.phi),n.y=i.phi},i.inv=function(i,n){n.phi=i.y,n.lam=i.x/(a*s(t*n.phi))}},"wag3","Wagner III","\n\tPCyl., Sph.\n\tlat_ts="),ei(function(i){i.es=0,i.fwd=function(i,t){var n,a,e;n=h(t.y=.9063077870366499*r(i.phi)),t.x=2.66723*(a=s(n))*r(i.lam/=3),t.y*=1.24104*(e=1/u(.5*(1+a*s(i.lam)))),t.x*=e}},"wag7","Wagner VII","\n\tMisc Sph, no inv."),ei(function(i){var t=s(ii(i.params,"rlat_ts"));i.fwd=function(i,n){n.x=.5*i.lam*(t+s(i.phi)),n.y=i.phi},i.inv=function(i,n){n.phi=i.y,n.lam=2*i.x/(t+s(n.phi))},i.es=0},"wink1","Winkel I","\n\tPCyl., Sph.\n\tlat_ts="),ei(function(i){var t=s(ii(i.params,"rlat_1")),n=10,e=1e-7;i.fwd=function(i,o){var h,p,l,c=i.phi;for(o.y=c*G,h=S*r(c),c*=1.8,l=n;l&&(c-=p=(c+r(c)-h)/(1+s(c)),!(a(p)<e));--l);l?c*=.5:c=c<0?-k:k;o.x=.5*i.lam*(s(c)+t),o.y=w*(r(c)+o.y)},i.inv=null,i.es=0},"wink2","Winkel II","\n\tPCyl., Sph., no inv.\n\tlat_1=");var Gn=Ui;Gn.pj_init=gi,Gn.pj_fwd=Di,Gn.pj_inv=Li,Gn.pj_transform=Gi,Gn.pj_fwd_deg=function(i,t){return Di({lam:i.lam*E,phi:i.phi*E},t)},Gn.pj_inv_deg=function(i,t){var n=Li(i,t);return{lam:n.lam*A,phi:n.phi*A}},Gn.pj_transform_point=Pi,Gn.internal={dmstod:Q,dmstor:$,get_rtodms:function(i,t,n,a){var e=qi(i,t,n,a);return function(i){return e(i*A)}},get_dtodms:qi,get_proj_defn:function(i){var t="datum,ellps,a,b,es,rf,f,towgs84,nadgrids,R,R_A,R_V,R_a,R_lat_a,R_lat_g,pm,init,no_defs".split(","),n="";return Object.keys(i.params).forEach(function(a){-1==t.indexOf(a)&&(n+=oi(i,a))}),(n+=si(i)).trim()},pj_latlong_from_proj:function(i){return gi("+proj=latlong"+si(i))},pj_get_params:ti,pj_datums:hi,pj_list:ai,pj_ellps:ci,pj_units:fi,pj_read_init_opts:vi,find_datum:li,DEG_TO_RAD:E,RAD_TO_DEG:A,wkt_parse:Ut,wkt_unpack:zt,wkt_to_proj4:function(i){var t,n=Ut(i);return n.PROJCS?t=it(n.PROJCS):n.GEOGCS?t="+proj=longlat "+Qi(n.GEOGCS):n.GEOCCS?Zi("geocentric coordinates are not supported"):Zi("missing a supported WKT CS type"),t},wkt_from_proj4:function(i){return i.length&&(i=gi(i)),Lt(ri(i)?{GEOGCS:at(i)}:st(i))},wkt_make_projcs:st,wkt_get_geogcs_name:et,wkt_stringify:Lt,mproj_insert_libcache:function(i,t){yi[i]=t},mproj_search_libcache:di},"function"==typeof i&&i.amd?i("mproj",Gn):"object"==("undefined"==typeof exports?"undefined":n(exports))?module.exports=Gn:this.mproj=Gn}();
},{"fs":51,"path":329}],50:[function(require,module,exports) {
module.exports="greenland.08f5de2d.geojson";
},{}],29:[function(require,module,exports) {
"use strict";require("ol/ol.css");var e=require("ol/Map"),t=R(e),o=require("ol/View"),r=R(o),n=require("ol/layer"),s=require("ol/source"),i=require("ol/format/GeoJSON"),u=R(i),l=require("ol/proj"),a=require("ol/style"),d=require("ol/proj/Projection"),c=R(d),f=require("mproj"),w=R(f),m=require("./data/greenland.geojson"),g=R(m);function R(e){return e&&e.__esModule?e:{default:e}}var S=[-51.694138,64.18141],p=2.29,E="+proj=utm +zone=22 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",G="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs",q=(0,w.default)(E),P=(0,w.default)(G,E),j=new c.default({units:"m",code:"EPSG:3128"});(0,l.addCoordinateTransforms)("EPSG:4326",j,q.forward,q.inverse),(0,l.addCoordinateTransforms)("EPSG:3857",j,P.forward,P.inverse);var v=new s.Vector({format:new u.default,url:g.default}),y=new s.Vector({format:new u.default,url:g.default}),V=new n.Vector({source:v,style:new a.Style({stroke:new a.Stroke({color:"rgba(0, 0, 255, 0.7)",width:1})})}),_=new t.default({target:"map",layers:[new n.Tile({source:new s.XYZ({url:"http://tile.stamen.com/terrain/{z}/{x}/{y}.jpg"})}),V]});(0,l.get)("EPSG:3857").setGetPointResolution(function(e,t){return e}),j.setGetPointResolution(function(e,t){return e*p});var k=new r.default({center:(0,l.transform)(S,"EPSG:4326","EPSG:3857"),resolution:22395.43779133036});_.setView(k);var C=new r.default({projection:j,maxResolution:k.getResolutionForZoom(4),extent:[-964261.03,6509913.55,784650.11,9827663.99]});document.getElementById("epsg3182").addEventListener("click",function(){_.getView()!==C&&(V.setSource(y),C.setResolution(C.constrainResolution(k.getResolution()/p)),C.setCenter((0,l.transform)(k.getCenter(),"EPSG:3857",j)),C.setRotation(k.getRotation()),_.setView(C))}),document.getElementById("epsg3857").addEventListener("click",function(){_.getView()!==k&&(V.setSource(v),k.setResolution(C.getResolution()*p),k.setCenter((0,l.transform)(C.getCenter(),j,"EPSG:3857")),k.setRotation(C.getRotation()),_.setView(k))});
},{"ol/ol.css":51,"ol/Map":53,"ol/View":54,"ol/layer":55,"ol/source":56,"ol/format/GeoJSON":57,"ol/proj":58,"ol/style":59,"ol/proj/Projection":60,"mproj":52,"./data/greenland.geojson":50}]},{},[29], null)
//# sourceMappingURL=reprojection.843bda05.map